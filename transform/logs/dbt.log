[0m14:59:38.813780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c1affca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c1ed7340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c1ed72e0>]}


============================== 14:59:38.816695 | 29bf2610-e5ee-431d-b487-18bfd7602b8e ==============================
[0m14:59:38.816695 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:59:38.817502 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m14:59:38.955739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29bf2610-e5ee-431d-b487-18bfd7602b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38bffbb0a0>]}
[0m14:59:38.985105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29bf2610-e5ee-431d-b487-18bfd7602b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38bffb8f70>]}
[0m14:59:38.988450 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:59:39.031674 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:59:39.032888 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:59:39.033401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '29bf2610-e5ee-431d-b487-18bfd7602b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38bc94e9e0>]}
[0m14:59:39.747642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29bf2610-e5ee-431d-b487-18bfd7602b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38b972a7d0>]}
[0m14:59:39.767520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29bf2610-e5ee-431d-b487-18bfd7602b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38ba1e4400>]}
[0m14:59:39.768076 [info ] [MainThread]: Found 2 models, 4 data tests, 421 macros
[0m14:59:39.768526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29bf2610-e5ee-431d-b487-18bfd7602b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38ba1e4040>]}
[0m14:59:39.769679 [info ] [MainThread]: 
[0m14:59:39.770235 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:59:39.773356 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m14:59:40.224679 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:59:40.225683 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:59:40.226531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:40.238297 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m14:59:40.239102 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:59:40.239719 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m14:59:40.253715 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m14:59:40.254798 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:59:40.255759 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:59:40.256157 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:59:40.258148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29bf2610-e5ee-431d-b487-18bfd7602b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38bff54160>]}
[0m14:59:40.258759 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:59:40.259172 [info ] [MainThread]: 
[0m14:59:40.260674 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m14:59:40.261383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.transform.my_first_dbt_model)
[0m14:59:40.261954 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m14:59:40.266273 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m14:59:40.273666 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m14:59:40.274817 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m14:59:40.276188 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m14:59:40.277192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m14:59:40.278126 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m14:59:40.282393 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m14:59:40.284382 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m14:59:40.285743 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m14:59:40.286670 [debug] [Thread-1 (]: Began running node test.transform.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:59:40.287561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_second_dbt_model, now test.transform.not_null_my_first_dbt_model_id.5fb22c2710)
[0m14:59:40.288379 [debug] [Thread-1 (]: Began compiling node test.transform.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:59:40.303712 [debug] [Thread-1 (]: Writing injected SQL for node "test.transform.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:59:40.306662 [debug] [Thread-1 (]: Began executing node test.transform.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:59:40.307976 [debug] [Thread-1 (]: Finished running node test.transform.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:59:40.308885 [debug] [Thread-1 (]: Began running node test.transform.unique_my_first_dbt_model_id.16e066b321
[0m14:59:40.309784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transform.not_null_my_first_dbt_model_id.5fb22c2710, now test.transform.unique_my_first_dbt_model_id.16e066b321)
[0m14:59:40.310669 [debug] [Thread-1 (]: Began compiling node test.transform.unique_my_first_dbt_model_id.16e066b321
[0m14:59:40.318414 [debug] [Thread-1 (]: Writing injected SQL for node "test.transform.unique_my_first_dbt_model_id.16e066b321"
[0m14:59:40.319728 [debug] [Thread-1 (]: Began executing node test.transform.unique_my_first_dbt_model_id.16e066b321
[0m14:59:40.320473 [debug] [Thread-1 (]: Finished running node test.transform.unique_my_first_dbt_model_id.16e066b321
[0m14:59:40.321027 [debug] [Thread-1 (]: Began running node test.transform.not_null_my_second_dbt_model_id.151b76d778
[0m14:59:40.321594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transform.unique_my_first_dbt_model_id.16e066b321, now test.transform.not_null_my_second_dbt_model_id.151b76d778)
[0m14:59:40.322115 [debug] [Thread-1 (]: Began compiling node test.transform.not_null_my_second_dbt_model_id.151b76d778
[0m14:59:40.324834 [debug] [Thread-1 (]: Writing injected SQL for node "test.transform.not_null_my_second_dbt_model_id.151b76d778"
[0m14:59:40.326072 [debug] [Thread-1 (]: Began executing node test.transform.not_null_my_second_dbt_model_id.151b76d778
[0m14:59:40.326813 [debug] [Thread-1 (]: Finished running node test.transform.not_null_my_second_dbt_model_id.151b76d778
[0m14:59:40.327250 [debug] [Thread-1 (]: Began running node test.transform.unique_my_second_dbt_model_id.57a0f8c493
[0m14:59:40.327666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transform.not_null_my_second_dbt_model_id.151b76d778, now test.transform.unique_my_second_dbt_model_id.57a0f8c493)
[0m14:59:40.328062 [debug] [Thread-1 (]: Began compiling node test.transform.unique_my_second_dbt_model_id.57a0f8c493
[0m14:59:40.330850 [debug] [Thread-1 (]: Writing injected SQL for node "test.transform.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:59:40.331994 [debug] [Thread-1 (]: Began executing node test.transform.unique_my_second_dbt_model_id.57a0f8c493
[0m14:59:40.332581 [debug] [Thread-1 (]: Finished running node test.transform.unique_my_second_dbt_model_id.57a0f8c493
[0m14:59:40.333436 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:59:40.333871 [debug] [MainThread]: Connection 'test.transform.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m14:59:40.334686 [debug] [MainThread]: Command end result
[0m14:59:40.407581 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m14:59:40.408421 [info ] [MainThread]: Building catalog
[0m14:59:40.422540 [debug] [ThreadPool]: Acquiring new duckdb connection 'dev.information_schema'
[0m14:59:40.432655 [debug] [ThreadPool]: Using duckdb connection "dev.information_schema"
[0m14:59:40.433495 [debug] [ThreadPool]: On dev.information_schema: BEGIN
[0m14:59:40.434394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:40.444386 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m14:59:40.445231 [debug] [ThreadPool]: Using duckdb connection "dev.information_schema"
[0m14:59:40.446008 [debug] [ThreadPool]: On dev.information_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "dev.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'dev'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'dev'
    )
    select
        'dev' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m14:59:40.465044 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m14:59:40.475164 [debug] [ThreadPool]: On dev.information_schema: ROLLBACK
[0m14:59:40.475807 [debug] [ThreadPool]: Failed to rollback 'dev.information_schema'
[0m14:59:40.476369 [debug] [ThreadPool]: On dev.information_schema: Close
[0m14:59:40.503418 [info ] [MainThread]: Catalog written to /home/ETUDIANT/e24a518u/Bureau/tp sql/transform/target/catalog.json
[0m14:59:40.504160 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.7210172, "process_in_blocks": "32", "process_kernel_time": 0.136981, "process_mem_max_rss": "139868", "process_out_blocks": "6264", "process_user_time": 1.705108}
[0m14:59:40.504772 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:59:40.504720 after 1.72 seconds
[0m14:59:40.505143 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:59:40.505491 [debug] [MainThread]: Connection 'dev.information_schema' was properly closed.
[0m14:59:40.505894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c1affca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38ba171360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38bffb8f70>]}
[0m14:59:40.506288 [debug] [MainThread]: Flushing usage events
[0m15:00:15.423966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e0eaafbc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e0eae2ace0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e0eae2bee0>]}


============================== 15:00:15.426682 | fc8c6138-7f61-4841-96f2-cfc66bd31b41 ==============================
[0m15:00:15.426682 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:00:15.427487 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'fail_fast': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m15:00:15.549880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc8c6138-7f61-4841-96f2-cfc66bd31b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e0eae66e30>]}
[0m15:00:15.579073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc8c6138-7f61-4841-96f2-cfc66bd31b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e0e94a49a0>]}
[0m15:02:54.963602 [error] [MainThread]: Encountered an error:

[0m15:02:54.970581 [error] [MainThread]: Traceback (most recent call last):
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m15:02:54.972763 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 159.5765, "process_in_blocks": "3784", "process_kernel_time": 0.058071, "process_mem_max_rss": "118656", "process_out_blocks": "3016", "process_user_time": 0.777344}
[0m15:02:54.974295 [debug] [MainThread]: Command `dbt docs serve` failed at 15:02:54.974124 after 159.58 seconds
[0m15:02:54.975206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e0eaafbc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e0e4f43010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e0e4f42e00>]}
[0m15:02:54.976015 [debug] [MainThread]: Flushing usage events
[0m15:03:15.579225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7783ed503c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7783ed836890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7783ed8370a0>]}


============================== 15:03:15.582314 | 496c00ba-2cc4-4d99-bb8d-b7df104dbaee ==============================
[0m15:03:15.582314 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:03:15.582997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:03:15.714909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '496c00ba-2cc4-4d99-bb8d-b7df104dbaee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7783eb959ea0>]}
[0m15:03:15.743740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '496c00ba-2cc4-4d99-bb8d-b7df104dbaee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7783ebeaf970>]}
[0m15:03:15.746713 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m15:03:15.786946 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:03:15.937111 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:03:15.938066 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:03:15.966043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '496c00ba-2cc4-4d99-bb8d-b7df104dbaee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7783e65d46a0>]}
[0m15:03:16.027696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '496c00ba-2cc4-4d99-bb8d-b7df104dbaee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7783e65e7c70>]}
[0m15:03:16.028252 [info ] [MainThread]: Found 2 models, 4 data tests, 421 macros
[0m15:03:16.028747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '496c00ba-2cc4-4d99-bb8d-b7df104dbaee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7783ed2f6c20>]}
[0m15:03:16.029940 [info ] [MainThread]: 
[0m15:03:16.030480 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:03:16.034074 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:03:16.333072 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:03:16.334064 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:03:16.334953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:16.348317 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m15:03:16.350500 [debug] [ThreadPool]: On list_dev: Close
[0m15:03:16.354789 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:03:16.356008 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:03:16.365866 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:03:16.366661 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m15:03:16.367319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:03:16.373963 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m15:03:16.375039 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:03:16.375504 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:03:16.376071 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:03:16.376491 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:03:16.376885 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:03:16.377393 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:03:16.378075 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:03:16.378485 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:03:16.378868 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:03:16.379351 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:03:16.379771 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:03:16.381645 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m15:03:16.386591 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:03:16.387099 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:03:16.387557 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:03:16.391935 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m15:03:16.392333 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:03:16.392748 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m15:03:16.405150 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m15:03:16.406053 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:03:16.406810 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:03:16.407177 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:03:16.408628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '496c00ba-2cc4-4d99-bb8d-b7df104dbaee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7783ed5e6da0>]}
[0m15:03:16.409119 [debug] [MainThread]: Using duckdb connection "master"
[0m15:03:16.409488 [debug] [MainThread]: On master: BEGIN
[0m15:03:16.409830 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:03:16.414420 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m15:03:16.414869 [debug] [MainThread]: On master: COMMIT
[0m15:03:16.415243 [debug] [MainThread]: Using duckdb connection "master"
[0m15:03:16.415588 [debug] [MainThread]: On master: COMMIT
[0m15:03:16.416028 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:03:16.416371 [debug] [MainThread]: On master: Close
[0m15:03:16.417536 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:03:16.417932 [info ] [MainThread]: 
[0m15:03:16.419108 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m15:03:16.419677 [info ] [Thread-1 (]: 1 of 2 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m15:03:16.420234 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.my_first_dbt_model'
[0m15:03:16.420700 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m15:03:16.427641 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m15:03:16.430296 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m15:03:16.455932 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m15:03:16.462097 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m15:03:16.462658 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m15:03:16.463158 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:03:16.470005 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m15:03:16.470825 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m15:03:16.471616 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m15:03:16.473288 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:03:16.483350 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m15:03:16.484232 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:03:16.485225 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:03:16.502069 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m15:03:16.502753 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m15:03:16.503257 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m15:03:16.504722 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:03:16.507849 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m15:03:16.508451 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m15:03:16.509355 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:03:16.511977 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m15:03:16.523031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '496c00ba-2cc4-4d99-bb8d-b7df104dbaee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7783ee23d570>]}
[0m15:03:16.524607 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.10s]
[0m15:03:16.526044 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m15:03:16.527727 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m15:03:16.528994 [info ] [Thread-1 (]: 2 of 2 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m15:03:16.530154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m15:03:16.531241 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m15:03:16.535374 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m15:03:16.537374 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m15:03:16.551701 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m15:03:16.553139 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m15:03:16.553616 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m15:03:16.554043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:16.562252 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m15:03:16.562723 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m15:03:16.563150 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m15:03:16.563827 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:03:16.565581 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m15:03:16.565990 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:03:16.566601 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:03:16.567588 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m15:03:16.568038 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m15:03:16.568456 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m15:03:16.569775 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:03:16.571167 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m15:03:16.571592 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m15:03:16.572118 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:03:16.573006 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m15:03:16.578167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '496c00ba-2cc4-4d99-bb8d-b7df104dbaee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7783e3d7cf40>]}
[0m15:03:16.578717 [info ] [Thread-1 (]: 2 of 2 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m15:03:16.579194 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m15:03:16.579981 [debug] [MainThread]: Using duckdb connection "master"
[0m15:03:16.580444 [debug] [MainThread]: On master: BEGIN
[0m15:03:16.580958 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:03:16.589647 [debug] [MainThread]: SQL status: OK in 0.009 seconds
[0m15:03:16.590101 [debug] [MainThread]: On master: COMMIT
[0m15:03:16.590496 [debug] [MainThread]: Using duckdb connection "master"
[0m15:03:16.590849 [debug] [MainThread]: On master: COMMIT
[0m15:03:16.591265 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:03:16.591620 [debug] [MainThread]: On master: Close
[0m15:03:16.592789 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:03:16.593211 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m15:03:16.593588 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m15:03:16.593987 [info ] [MainThread]: 
[0m15:03:16.594406 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m15:03:16.595009 [debug] [MainThread]: Command end result
[0m15:03:16.614526 [info ] [MainThread]: 
[0m15:03:16.615021 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:03:16.615426 [info ] [MainThread]: 
[0m15:03:16.615827 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:03:16.616466 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0654284, "process_in_blocks": "2192", "process_kernel_time": 0.16413, "process_mem_max_rss": "137176", "process_out_blocks": "4464", "process_user_time": 1.245403}
[0m15:03:16.616990 [debug] [MainThread]: Command `dbt run` succeeded at 15:03:16.616940 after 1.07 seconds
[0m15:03:16.617430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7783ed503c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7783ebeaf970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7783e6569300>]}
[0m15:03:16.617852 [debug] [MainThread]: Flushing usage events
[0m15:07:47.171302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b8fa897c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b8facd2890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b8facd30a0>]}


============================== 15:07:47.173162 | 341c73d4-7095-467b-af78-6b698d066ab6 ==============================
[0m15:07:47.173162 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:07:47.173792 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:07:47.303050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '341c73d4-7095-467b-af78-6b698d066ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b8fa2e1120>]}
[0m15:07:47.332239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '341c73d4-7095-467b-af78-6b698d066ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b8f9c44d90>]}
[0m15:07:47.334531 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m15:07:47.376160 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:07:47.525591 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:07:47.526532 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:07:47.554302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '341c73d4-7095-467b-af78-6b698d066ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b8f27846a0>]}
[0m15:07:47.616871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '341c73d4-7095-467b-af78-6b698d066ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b8f2797970>]}
[0m15:07:47.617398 [info ] [MainThread]: Found 2 models, 4 data tests, 421 macros
[0m15:07:47.617824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '341c73d4-7095-467b-af78-6b698d066ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b8f2797e20>]}
[0m15:07:47.618921 [info ] [MainThread]: 
[0m15:07:47.619453 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:07:47.622527 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:07:47.930674 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:07:47.931719 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:07:47.932491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:47.949146 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m15:07:47.951432 [debug] [ThreadPool]: On list_dev: Close
[0m15:07:47.955566 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:07:47.956583 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:07:47.962910 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:07:47.963457 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m15:07:47.963960 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:47.971743 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m15:07:47.972760 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:07:47.973199 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:07:47.973743 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:07:47.974145 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:07:47.974530 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:07:47.975013 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:07:47.975677 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:07:47.976022 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:07:47.976355 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:07:47.976809 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:07:47.977152 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:07:47.978803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m15:07:47.984578 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:07:47.985328 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:07:47.986024 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:47.998902 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m15:07:47.999824 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:07:48.000562 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m15:07:48.019926 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m15:07:48.020893 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:07:48.021741 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:07:48.022201 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:07:48.023785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '341c73d4-7095-467b-af78-6b698d066ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b8f27c6a40>]}
[0m15:07:48.024329 [debug] [MainThread]: Using duckdb connection "master"
[0m15:07:48.024743 [debug] [MainThread]: On master: BEGIN
[0m15:07:48.025130 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:07:48.033191 [debug] [MainThread]: SQL status: OK in 0.008 seconds
[0m15:07:48.033782 [debug] [MainThread]: On master: COMMIT
[0m15:07:48.034290 [debug] [MainThread]: Using duckdb connection "master"
[0m15:07:48.034785 [debug] [MainThread]: On master: COMMIT
[0m15:07:48.035448 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:07:48.036019 [debug] [MainThread]: On master: Close
[0m15:07:48.038526 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:07:48.039289 [info ] [MainThread]: 
[0m15:07:48.041807 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m15:07:48.043137 [info ] [Thread-1 (]: 1 of 2 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m15:07:48.044476 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.my_first_dbt_model'
[0m15:07:48.045528 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m15:07:48.055594 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m15:07:48.057646 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m15:07:48.075297 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m15:07:48.077492 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m15:07:48.077989 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m15:07:48.078422 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:07:48.086222 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m15:07:48.086738 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m15:07:48.087207 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m15:07:48.088066 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:07:48.091872 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m15:07:48.092330 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:07:48.092935 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:07:48.101939 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m15:07:48.102417 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m15:07:48.102837 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m15:07:48.104759 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:07:48.107500 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m15:07:48.107932 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m15:07:48.108609 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:07:48.110169 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m15:07:48.128092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '341c73d4-7095-467b-af78-6b698d066ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b8fb566290>]}
[0m15:07:48.129099 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.08s]
[0m15:07:48.130025 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m15:07:48.131323 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m15:07:48.132157 [info ] [Thread-1 (]: 2 of 2 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m15:07:48.133012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m15:07:48.133699 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m15:07:48.136536 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m15:07:48.137869 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m15:07:48.148393 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m15:07:48.149672 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m15:07:48.150137 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m15:07:48.150563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:48.161925 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m15:07:48.162599 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m15:07:48.163153 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m15:07:48.164024 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:07:48.166388 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m15:07:48.166927 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:07:48.167628 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:07:48.169102 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m15:07:48.169742 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m15:07:48.170311 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m15:07:48.172438 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:07:48.174827 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m15:07:48.175467 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m15:07:48.176178 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:07:48.177468 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m15:07:48.190738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '341c73d4-7095-467b-af78-6b698d066ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b8f27b71f0>]}
[0m15:07:48.191536 [info ] [Thread-1 (]: 2 of 2 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m15:07:48.192215 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m15:07:48.193358 [debug] [MainThread]: Using duckdb connection "master"
[0m15:07:48.193879 [debug] [MainThread]: On master: BEGIN
[0m15:07:48.194396 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:07:48.209809 [debug] [MainThread]: SQL status: OK in 0.015 seconds
[0m15:07:48.210642 [debug] [MainThread]: On master: COMMIT
[0m15:07:48.211306 [debug] [MainThread]: Using duckdb connection "master"
[0m15:07:48.211926 [debug] [MainThread]: On master: COMMIT
[0m15:07:48.212773 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:07:48.213446 [debug] [MainThread]: On master: Close
[0m15:07:48.216045 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:48.216783 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m15:07:48.217404 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m15:07:48.218047 [info ] [MainThread]: 
[0m15:07:48.218724 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m15:07:48.219926 [debug] [MainThread]: Command end result
[0m15:07:48.259149 [info ] [MainThread]: 
[0m15:07:48.260063 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:07:48.260706 [info ] [MainThread]: 
[0m15:07:48.261330 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:07:48.262324 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.118991, "process_in_blocks": "5544", "process_kernel_time": 0.159845, "process_mem_max_rss": "137848", "process_out_blocks": "5464", "process_user_time": 1.33033}
[0m15:07:48.263094 [debug] [MainThread]: Command `dbt run` succeeded at 15:07:48.263008 after 1.12 seconds
[0m15:07:48.263719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b8fa897c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b8eeb03730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b8f9c44d90>]}
[0m15:07:48.264342 [debug] [MainThread]: Flushing usage events
[0m15:12:19.941487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7622a7187bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7622a576b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7622a576b2b0>]}


============================== 15:12:19.943532 | 7b8e7764-b69f-44c3-8651-781345b2759d ==============================
[0m15:12:19.943532 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:12:19.944122 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m15:12:20.093359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b8e7764-b69f-44c3-8651-781345b2759d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7622a70b46d0>]}
[0m15:12:20.126255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b8e7764-b69f-44c3-8651-781345b2759d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7622a5f010f0>]}
[0m15:12:20.131199 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m15:12:20.175741 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:12:20.421830 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:12:20.422932 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:12:20.452628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b8e7764-b69f-44c3-8651-781345b2759d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76229f96be50>]}
[0m15:12:20.503986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b8e7764-b69f-44c3-8651-781345b2759d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7622a03f6fb0>]}
[0m15:12:20.505212 [info ] [MainThread]: Found 2 models, 4 data tests, 421 macros
[0m15:12:20.506223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b8e7764-b69f-44c3-8651-781345b2759d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7622a5ade410>]}
[0m15:12:20.509184 [info ] [MainThread]: 
[0m15:12:20.510508 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:12:20.518002 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m15:12:21.082422 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:12:21.083422 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:12:21.084188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:21.103667 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m15:12:21.104700 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:12:21.105451 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m15:12:21.124600 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m15:12:21.125704 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:12:21.126809 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:12:21.127243 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:12:21.129443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b8e7764-b69f-44c3-8651-781345b2759d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7622a03f6e60>]}
[0m15:12:21.130041 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:12:21.130507 [info ] [MainThread]: 
[0m15:12:21.132088 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m15:12:21.132805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.transform.my_first_dbt_model)
[0m15:12:21.133432 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m15:12:21.140736 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m15:12:21.144276 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m15:12:21.145015 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m15:12:21.145847 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m15:12:21.146372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m15:12:21.146851 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m15:12:21.148480 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m15:12:21.149852 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m15:12:21.150482 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m15:12:21.150956 [debug] [Thread-1 (]: Began running node test.transform.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:12:21.151433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_second_dbt_model, now test.transform.not_null_my_first_dbt_model_id.5fb22c2710)
[0m15:12:21.151896 [debug] [Thread-1 (]: Began compiling node test.transform.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:12:21.158334 [debug] [Thread-1 (]: Writing injected SQL for node "test.transform.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:12:21.160203 [debug] [Thread-1 (]: Began executing node test.transform.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:12:21.160930 [debug] [Thread-1 (]: Finished running node test.transform.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:12:21.161446 [debug] [Thread-1 (]: Began running node test.transform.unique_my_first_dbt_model_id.16e066b321
[0m15:12:21.161980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transform.not_null_my_first_dbt_model_id.5fb22c2710, now test.transform.unique_my_first_dbt_model_id.16e066b321)
[0m15:12:21.162451 [debug] [Thread-1 (]: Began compiling node test.transform.unique_my_first_dbt_model_id.16e066b321
[0m15:12:21.165853 [debug] [Thread-1 (]: Writing injected SQL for node "test.transform.unique_my_first_dbt_model_id.16e066b321"
[0m15:12:21.167269 [debug] [Thread-1 (]: Began executing node test.transform.unique_my_first_dbt_model_id.16e066b321
[0m15:12:21.167913 [debug] [Thread-1 (]: Finished running node test.transform.unique_my_first_dbt_model_id.16e066b321
[0m15:12:21.168338 [debug] [Thread-1 (]: Began running node test.transform.not_null_my_second_dbt_model_id.151b76d778
[0m15:12:21.168756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transform.unique_my_first_dbt_model_id.16e066b321, now test.transform.not_null_my_second_dbt_model_id.151b76d778)
[0m15:12:21.169143 [debug] [Thread-1 (]: Began compiling node test.transform.not_null_my_second_dbt_model_id.151b76d778
[0m15:12:21.171265 [debug] [Thread-1 (]: Writing injected SQL for node "test.transform.not_null_my_second_dbt_model_id.151b76d778"
[0m15:12:21.172640 [debug] [Thread-1 (]: Began executing node test.transform.not_null_my_second_dbt_model_id.151b76d778
[0m15:12:21.173215 [debug] [Thread-1 (]: Finished running node test.transform.not_null_my_second_dbt_model_id.151b76d778
[0m15:12:21.173672 [debug] [Thread-1 (]: Began running node test.transform.unique_my_second_dbt_model_id.57a0f8c493
[0m15:12:21.174105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transform.not_null_my_second_dbt_model_id.151b76d778, now test.transform.unique_my_second_dbt_model_id.57a0f8c493)
[0m15:12:21.174524 [debug] [Thread-1 (]: Began compiling node test.transform.unique_my_second_dbt_model_id.57a0f8c493
[0m15:12:21.177180 [debug] [Thread-1 (]: Writing injected SQL for node "test.transform.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:12:21.178554 [debug] [Thread-1 (]: Began executing node test.transform.unique_my_second_dbt_model_id.57a0f8c493
[0m15:12:21.179159 [debug] [Thread-1 (]: Finished running node test.transform.unique_my_second_dbt_model_id.57a0f8c493
[0m15:12:21.179895 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:12:21.180362 [debug] [MainThread]: Connection 'test.transform.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m15:12:21.181222 [debug] [MainThread]: Command end result
[0m15:12:21.246660 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m15:12:21.247314 [info ] [MainThread]: Building catalog
[0m15:12:21.254487 [debug] [ThreadPool]: Acquiring new duckdb connection 'dev.information_schema'
[0m15:12:21.260489 [debug] [ThreadPool]: Using duckdb connection "dev.information_schema"
[0m15:12:21.261145 [debug] [ThreadPool]: On dev.information_schema: BEGIN
[0m15:12:21.261668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:21.274348 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m15:12:21.275037 [debug] [ThreadPool]: Using duckdb connection "dev.information_schema"
[0m15:12:21.275618 [debug] [ThreadPool]: On dev.information_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "dev.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'dev'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'dev'
    )
    select
        'dev' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m15:12:21.295115 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m15:12:21.306303 [debug] [ThreadPool]: On dev.information_schema: ROLLBACK
[0m15:12:21.306836 [debug] [ThreadPool]: Failed to rollback 'dev.information_schema'
[0m15:12:21.307296 [debug] [ThreadPool]: On dev.information_schema: Close
[0m15:12:21.337684 [info ] [MainThread]: Catalog written to /home/ETUDIANT/e24a518u/Bureau/tp sql/transform/target/catalog.json
[0m15:12:21.338470 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.4256538, "process_in_blocks": "2240", "process_kernel_time": 0.120874, "process_mem_max_rss": "137248", "process_out_blocks": "5408", "process_user_time": 1.109486}
[0m15:12:21.339035 [debug] [MainThread]: Command `dbt docs generate` succeeded at 15:12:21.338980 after 1.43 seconds
[0m15:12:21.339438 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:12:21.339805 [debug] [MainThread]: Connection 'dev.information_schema' was properly closed.
[0m15:12:21.340202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7622a7187bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7622a75c7100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7622a03f6cb0>]}
[0m15:12:21.340622 [debug] [MainThread]: Flushing usage events
[0m15:12:27.150350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a835888fc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8358cc6ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8358cc7ee0>]}


============================== 15:12:27.153019 | a013f547-be24-40c3-8d89-0612dd0ea7ff ==============================
[0m15:12:27.153019 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:12:27.153862 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'fail_fast': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:12:27.283303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a013f547-be24-40c3-8d89-0612dd0ea7ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a83582e8cd0>]}
[0m15:12:27.312434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a013f547-be24-40c3-8d89-0612dd0ea7ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8357c38e20>]}
[0m15:13:40.106365 [error] [MainThread]: Encountered an error:

[0m15:13:40.113177 [error] [MainThread]: Traceback (most recent call last):
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m15:13:40.115396 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 72.99218, "process_in_blocks": "3792", "process_kernel_time": 0.06893, "process_mem_max_rss": "118196", "process_out_blocks": "3016", "process_user_time": 0.781213}
[0m15:13:40.117152 [debug] [MainThread]: Command `dbt docs serve` failed at 15:13:40.116877 after 72.99 seconds
[0m15:13:40.118173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a835888fc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a83525e2da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a83525e2d70>]}
[0m15:13:40.119212 [debug] [MainThread]: Flushing usage events
[0m15:13:44.333254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e4c31fbc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e4c35cb370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e4c35cb310>]}


============================== 15:13:44.335916 | 3914dce3-6e9c-4960-9646-3a72c00f154a ==============================
[0m15:13:44.335916 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:13:44.336585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:13:44.472654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3914dce3-6e9c-4960-9646-3a72c00f154a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e4c2c6dc30>]}
[0m15:13:44.502685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3914dce3-6e9c-4960-9646-3a72c00f154a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e4c1be5db0>]}
[0m15:13:44.505617 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m15:13:44.547416 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:13:44.693807 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:13:44.695016 [debug] [MainThread]: Partial parsing: added file: transform://models/example/test.sql
[0m15:13:44.826459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3914dce3-6e9c-4960-9646-3a72c00f154a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e4ba52c040>]}
[0m15:13:44.845447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3914dce3-6e9c-4960-9646-3a72c00f154a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e4bb9632b0>]}
[0m15:13:44.846007 [info ] [MainThread]: Found 3 models, 4 data tests, 421 macros
[0m15:13:44.846403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3914dce3-6e9c-4960-9646-3a72c00f154a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e4c31623e0>]}
[0m15:13:44.847473 [info ] [MainThread]: 
[0m15:13:44.848032 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:13:44.851100 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m15:13:45.123511 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:13:45.124512 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:13:45.125352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:45.144188 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m15:13:45.145099 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:13:45.145798 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m15:13:45.160705 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m15:13:45.161742 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:13:45.162503 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:13:45.162958 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:13:45.165252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3914dce3-6e9c-4960-9646-3a72c00f154a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e4bb9624a0>]}
[0m15:13:45.165872 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:13:45.166301 [info ] [MainThread]: 
[0m15:13:45.167727 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m15:13:45.168226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.transform.my_first_dbt_model)
[0m15:13:45.168688 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m15:13:45.173334 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m15:13:45.175087 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m15:13:45.175725 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m15:13:45.176213 [debug] [Thread-1 (]: Began running node model.transform.test
[0m15:13:45.176689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.test)
[0m15:13:45.177147 [debug] [Thread-1 (]: Began compiling node model.transform.test
[0m15:13:45.178286 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.test"
[0m15:13:45.178695 [debug] [Thread-1 (]: Began executing node model.transform.test
[0m15:13:45.179260 [debug] [Thread-1 (]: Finished running node model.transform.test
[0m15:13:45.179712 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m15:13:45.180147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.test, now model.transform.my_second_dbt_model)
[0m15:13:45.180565 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m15:13:45.182127 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m15:13:45.183218 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m15:13:45.183764 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m15:13:45.184178 [debug] [Thread-1 (]: Began running node test.transform.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:13:45.184599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_second_dbt_model, now test.transform.not_null_my_first_dbt_model_id.5fb22c2710)
[0m15:13:45.184991 [debug] [Thread-1 (]: Began compiling node test.transform.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:13:45.191062 [debug] [Thread-1 (]: Writing injected SQL for node "test.transform.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:13:45.192420 [debug] [Thread-1 (]: Began executing node test.transform.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:13:45.192986 [debug] [Thread-1 (]: Finished running node test.transform.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:13:45.193417 [debug] [Thread-1 (]: Began running node test.transform.unique_my_first_dbt_model_id.16e066b321
[0m15:13:45.193855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transform.not_null_my_first_dbt_model_id.5fb22c2710, now test.transform.unique_my_first_dbt_model_id.16e066b321)
[0m15:13:45.194255 [debug] [Thread-1 (]: Began compiling node test.transform.unique_my_first_dbt_model_id.16e066b321
[0m15:13:45.197567 [debug] [Thread-1 (]: Writing injected SQL for node "test.transform.unique_my_first_dbt_model_id.16e066b321"
[0m15:13:45.198694 [debug] [Thread-1 (]: Began executing node test.transform.unique_my_first_dbt_model_id.16e066b321
[0m15:13:45.199300 [debug] [Thread-1 (]: Finished running node test.transform.unique_my_first_dbt_model_id.16e066b321
[0m15:13:45.199757 [debug] [Thread-1 (]: Began running node test.transform.not_null_my_second_dbt_model_id.151b76d778
[0m15:13:45.200212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transform.unique_my_first_dbt_model_id.16e066b321, now test.transform.not_null_my_second_dbt_model_id.151b76d778)
[0m15:13:45.200646 [debug] [Thread-1 (]: Began compiling node test.transform.not_null_my_second_dbt_model_id.151b76d778
[0m15:13:45.202876 [debug] [Thread-1 (]: Writing injected SQL for node "test.transform.not_null_my_second_dbt_model_id.151b76d778"
[0m15:13:45.204024 [debug] [Thread-1 (]: Began executing node test.transform.not_null_my_second_dbt_model_id.151b76d778
[0m15:13:45.204658 [debug] [Thread-1 (]: Finished running node test.transform.not_null_my_second_dbt_model_id.151b76d778
[0m15:13:45.205134 [debug] [Thread-1 (]: Began running node test.transform.unique_my_second_dbt_model_id.57a0f8c493
[0m15:13:45.205601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transform.not_null_my_second_dbt_model_id.151b76d778, now test.transform.unique_my_second_dbt_model_id.57a0f8c493)
[0m15:13:45.206052 [debug] [Thread-1 (]: Began compiling node test.transform.unique_my_second_dbt_model_id.57a0f8c493
[0m15:13:45.208186 [debug] [Thread-1 (]: Writing injected SQL for node "test.transform.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:13:45.209327 [debug] [Thread-1 (]: Began executing node test.transform.unique_my_second_dbt_model_id.57a0f8c493
[0m15:13:45.209939 [debug] [Thread-1 (]: Finished running node test.transform.unique_my_second_dbt_model_id.57a0f8c493
[0m15:13:45.210934 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:45.211355 [debug] [MainThread]: Connection 'test.transform.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m15:13:45.212262 [debug] [MainThread]: Command end result
[0m15:13:45.276703 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m15:13:45.277490 [info ] [MainThread]: Building catalog
[0m15:13:45.283868 [debug] [ThreadPool]: Acquiring new duckdb connection 'dev.information_schema'
[0m15:13:45.288931 [debug] [ThreadPool]: Using duckdb connection "dev.information_schema"
[0m15:13:45.289680 [debug] [ThreadPool]: On dev.information_schema: BEGIN
[0m15:13:45.290160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:45.306241 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m15:13:45.307072 [debug] [ThreadPool]: Using duckdb connection "dev.information_schema"
[0m15:13:45.307767 [debug] [ThreadPool]: On dev.information_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "dev.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'dev'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'dev'
    )
    select
        'dev' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m15:13:45.324892 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m15:13:45.359542 [debug] [ThreadPool]: On dev.information_schema: ROLLBACK
[0m15:13:45.360454 [debug] [ThreadPool]: Failed to rollback 'dev.information_schema'
[0m15:13:45.361165 [debug] [ThreadPool]: On dev.information_schema: Close
[0m15:13:45.392174 [info ] [MainThread]: Catalog written to /home/ETUDIANT/e24a518u/Bureau/tp sql/transform/target/catalog.json
[0m15:13:45.393142 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.0875719, "process_in_blocks": "2240", "process_kernel_time": 0.165154, "process_mem_max_rss": "141028", "process_out_blocks": "6296", "process_user_time": 1.324255}
[0m15:13:45.393949 [debug] [MainThread]: Command `dbt docs generate` succeeded at 15:13:45.393862 after 1.09 seconds
[0m15:13:45.394570 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:13:45.395162 [debug] [MainThread]: Connection 'dev.information_schema' was properly closed.
[0m15:13:45.395731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e4c31fbc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e4c22e3760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e4c3f624a0>]}
[0m15:13:45.396397 [debug] [MainThread]: Flushing usage events
[0m15:13:49.929284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b79fc7fca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b7a00a7310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b7a00a72b0>]}


============================== 15:13:49.931404 | 4bb450d7-918b-4778-9737-727a8361db1e ==============================
[0m15:13:49.931404 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:13:49.932191 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:13:50.049002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bb450d7-918b-4778-9737-727a8361db1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b79fbad7e0>]}
[0m15:13:50.077228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4bb450d7-918b-4778-9737-727a8361db1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b79e669c90>]}
[0m15:13:50.377630 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m15:13:50.379254 [error] [MainThread]: Traceback (most recent call last):
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
  File "/usr/lib/python3.10/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/usr/lib/python3.10/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m15:13:50.380398 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 0.47931442, "process_in_blocks": "0", "process_kernel_time": 0.058205, "process_mem_max_rss": "116404", "process_out_blocks": "3016", "process_user_time": 0.748649}
[0m15:13:50.381239 [debug] [MainThread]: Command `dbt docs serve` failed at 15:13:50.381147 after 0.48 seconds
[0m15:13:50.381920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b79fc7fca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b79974eec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b79974ef20>]}
[0m15:13:50.382506 [debug] [MainThread]: Flushing usage events
[0m15:14:07.330398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715683bdfc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71568210ece0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71568210fee0>]}


============================== 15:14:07.333256 | 159ae71b-fc26-44eb-93ff-5b667d85d24a ==============================
[0m15:14:07.333256 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:14:07.334213 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:14:07.462762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '159ae71b-fc26-44eb-93ff-5b667d85d24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71568214ee30>]}
[0m15:14:07.491285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '159ae71b-fc26-44eb-93ff-5b667d85d24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7156825889a0>]}
[0m15:14:07.846461 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m15:14:07.847899 [error] [MainThread]: Traceback (most recent call last):
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
  File "/usr/lib/python3.10/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/usr/lib/python3.10/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m15:14:07.848806 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 0.54624796, "process_in_blocks": "0", "process_kernel_time": 0.048304, "process_mem_max_rss": "115804", "process_out_blocks": "3016", "process_user_time": 0.769859}
[0m15:14:07.849518 [debug] [MainThread]: Command `dbt docs serve` failed at 15:14:07.849459 after 0.55 seconds
[0m15:14:07.850065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715683bdfc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71567d722e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71567d722ec0>]}
[0m15:14:07.850543 [debug] [MainThread]: Flushing usage events
[0m15:14:38.241845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce0cd193cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce0cb76f460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce0cb76f400>]}


============================== 15:14:38.243550 | e15924af-6a72-4f50-b0d5-b30334fcbe84 ==============================
[0m15:14:38.243550 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:14:38.244180 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:14:38.361632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e15924af-6a72-4f50-b0d5-b30334fcbe84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce0c80ec9d0>]}
[0m15:14:38.391193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e15924af-6a72-4f50-b0d5-b30334fcbe84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce0cb7dfbe0>]}
[0m15:14:38.394453 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m15:14:38.435887 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:14:38.554207 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:14:38.555128 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:14:38.582107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e15924af-6a72-4f50-b0d5-b30334fcbe84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce0c5974d30>]}
[0m15:14:38.597256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e15924af-6a72-4f50-b0d5-b30334fcbe84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce0c6d86b60>]}
[0m15:14:38.597777 [info ] [MainThread]: Found 3 models, 4 data tests, 421 macros
[0m15:14:38.598218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e15924af-6a72-4f50-b0d5-b30334fcbe84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce0c6d860e0>]}
[0m15:14:38.599401 [info ] [MainThread]: 
[0m15:14:38.599940 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:14:38.603059 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m15:14:38.782798 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:14:38.783851 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:14:38.784643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:38.801791 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m15:14:38.802632 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:14:38.803330 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m15:14:38.819565 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m15:14:38.820594 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:14:38.821346 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:14:38.821770 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:14:38.824677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e15924af-6a72-4f50-b0d5-b30334fcbe84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce0c59058d0>]}
[0m15:14:38.825284 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:14:38.825659 [info ] [MainThread]: 
[0m15:14:38.827001 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m15:14:38.827650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.transform.my_first_dbt_model)
[0m15:14:38.828181 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m15:14:38.835859 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m15:14:38.837609 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m15:14:38.838954 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m15:14:38.839943 [debug] [Thread-1 (]: Began running node model.transform.test
[0m15:14:38.840895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.test)
[0m15:14:38.841680 [debug] [Thread-1 (]: Began compiling node model.transform.test
[0m15:14:38.844010 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.test"
[0m15:14:38.844777 [debug] [Thread-1 (]: Began executing node model.transform.test
[0m15:14:38.845779 [debug] [Thread-1 (]: Finished running node model.transform.test
[0m15:14:38.846479 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m15:14:38.847152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.test, now model.transform.my_second_dbt_model)
[0m15:14:38.847785 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m15:14:38.849942 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m15:14:38.851166 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m15:14:38.851820 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m15:14:38.852338 [debug] [Thread-1 (]: Began running node test.transform.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:14:38.852843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_second_dbt_model, now test.transform.not_null_my_first_dbt_model_id.5fb22c2710)
[0m15:14:38.853327 [debug] [Thread-1 (]: Began compiling node test.transform.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:14:38.863875 [debug] [Thread-1 (]: Writing injected SQL for node "test.transform.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:14:38.865411 [debug] [Thread-1 (]: Began executing node test.transform.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:14:38.866324 [debug] [Thread-1 (]: Finished running node test.transform.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:14:38.866986 [debug] [Thread-1 (]: Began running node test.transform.unique_my_first_dbt_model_id.16e066b321
[0m15:14:38.867650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transform.not_null_my_first_dbt_model_id.5fb22c2710, now test.transform.unique_my_first_dbt_model_id.16e066b321)
[0m15:14:38.868295 [debug] [Thread-1 (]: Began compiling node test.transform.unique_my_first_dbt_model_id.16e066b321
[0m15:14:38.873745 [debug] [Thread-1 (]: Writing injected SQL for node "test.transform.unique_my_first_dbt_model_id.16e066b321"
[0m15:14:38.875070 [debug] [Thread-1 (]: Began executing node test.transform.unique_my_first_dbt_model_id.16e066b321
[0m15:14:38.875885 [debug] [Thread-1 (]: Finished running node test.transform.unique_my_first_dbt_model_id.16e066b321
[0m15:14:38.876514 [debug] [Thread-1 (]: Began running node test.transform.not_null_my_second_dbt_model_id.151b76d778
[0m15:14:38.877129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transform.unique_my_first_dbt_model_id.16e066b321, now test.transform.not_null_my_second_dbt_model_id.151b76d778)
[0m15:14:38.877753 [debug] [Thread-1 (]: Began compiling node test.transform.not_null_my_second_dbt_model_id.151b76d778
[0m15:14:38.882258 [debug] [Thread-1 (]: Writing injected SQL for node "test.transform.not_null_my_second_dbt_model_id.151b76d778"
[0m15:14:38.883961 [debug] [Thread-1 (]: Began executing node test.transform.not_null_my_second_dbt_model_id.151b76d778
[0m15:14:38.885149 [debug] [Thread-1 (]: Finished running node test.transform.not_null_my_second_dbt_model_id.151b76d778
[0m15:14:38.886009 [debug] [Thread-1 (]: Began running node test.transform.unique_my_second_dbt_model_id.57a0f8c493
[0m15:14:38.886804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transform.not_null_my_second_dbt_model_id.151b76d778, now test.transform.unique_my_second_dbt_model_id.57a0f8c493)
[0m15:14:38.887537 [debug] [Thread-1 (]: Began compiling node test.transform.unique_my_second_dbt_model_id.57a0f8c493
[0m15:14:38.891933 [debug] [Thread-1 (]: Writing injected SQL for node "test.transform.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:14:38.893447 [debug] [Thread-1 (]: Began executing node test.transform.unique_my_second_dbt_model_id.57a0f8c493
[0m15:14:38.894298 [debug] [Thread-1 (]: Finished running node test.transform.unique_my_second_dbt_model_id.57a0f8c493
[0m15:14:38.895456 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:38.896084 [debug] [MainThread]: Connection 'test.transform.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m15:14:38.897524 [debug] [MainThread]: Command end result
[0m15:14:38.965835 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m15:14:38.966447 [info ] [MainThread]: Building catalog
[0m15:14:38.973293 [debug] [ThreadPool]: Acquiring new duckdb connection 'dev.information_schema'
[0m15:14:38.981392 [debug] [ThreadPool]: Using duckdb connection "dev.information_schema"
[0m15:14:38.982081 [debug] [ThreadPool]: On dev.information_schema: BEGIN
[0m15:14:38.982813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:38.999866 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m15:14:39.000717 [debug] [ThreadPool]: Using duckdb connection "dev.information_schema"
[0m15:14:39.001361 [debug] [ThreadPool]: On dev.information_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "dev.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'dev'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'dev'
    )
    select
        'dev' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m15:14:39.018236 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m15:14:39.030044 [debug] [ThreadPool]: On dev.information_schema: ROLLBACK
[0m15:14:39.030662 [debug] [ThreadPool]: Failed to rollback 'dev.information_schema'
[0m15:14:39.031162 [debug] [ThreadPool]: On dev.information_schema: Close
[0m15:14:39.062735 [info ] [MainThread]: Catalog written to /home/ETUDIANT/e24a518u/Bureau/tp sql/transform/target/catalog.json
[0m15:14:39.063501 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.8489994, "process_in_blocks": "3080", "process_kernel_time": 0.102456, "process_mem_max_rss": "137396", "process_out_blocks": "5464", "process_user_time": 1.100909}
[0m15:14:39.064139 [debug] [MainThread]: Command `dbt docs generate` succeeded at 15:14:39.064083 after 0.85 seconds
[0m15:14:39.064518 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:14:39.064866 [debug] [MainThread]: Connection 'dev.information_schema' was properly closed.
[0m15:14:39.065244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce0cd193cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce0c6d85d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce0c5906d40>]}
[0m15:14:39.065656 [debug] [MainThread]: Flushing usage events
[0m15:14:42.141419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f064303c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f064632ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f064633ee0>]}


============================== 15:14:42.143226 | 0de63c6d-2139-4acd-87e8-a01eb0aa053e ==============================
[0m15:14:42.143226 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:14:42.143869 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m15:14:42.260341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0de63c6d-2139-4acd-87e8-a01eb0aa053e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f064672e30>]}
[0m15:14:42.288575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0de63c6d-2139-4acd-87e8-a01eb0aa053e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f062cac9a0>]}
[0m15:14:59.484679 [error] [MainThread]: Encountered an error:

[0m15:14:59.487926 [error] [MainThread]: Traceback (most recent call last):
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m15:14:59.489749 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 17.375353, "process_in_blocks": "3792", "process_kernel_time": 0.073152, "process_mem_max_rss": "118684", "process_out_blocks": "3016", "process_user_time": 0.760188}
[0m15:14:59.491371 [debug] [MainThread]: Command `dbt docs serve` failed at 15:14:59.491184 after 17.38 seconds
[0m15:14:59.492280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f064303c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f05e74ed70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f05e74ee00>]}
[0m15:14:59.493244 [debug] [MainThread]: Flushing usage events
[0m10:33:50.736273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742177afbdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742177ed0ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742177ed0d00>]}


============================== 10:33:50.741335 | a4b68853-c2c4-4873-b8b8-4168898ab21c ==============================
[0m10:33:50.741335 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:33:50.742368 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s customers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:33:51.382450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4b68853-c2c4-4873-b8b8-4168898ab21c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742177a29870>]}
[0m10:33:51.415861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4b68853-c2c4-4873-b8b8-4168898ab21c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742175fa8040>]}
[0m10:33:51.421699 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m10:33:51.546425 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:33:51.812797 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:33:51.814096 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:33:51.844832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4b68853-c2c4-4873-b8b8-4168898ab21c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742170bdcd00>]}
[0m10:33:51.955607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4b68853-c2c4-4873-b8b8-4168898ab21c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742170bde140>]}
[0m10:33:51.957126 [info ] [MainThread]: Found 3 models, 4 data tests, 421 macros
[0m10:33:51.958302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4b68853-c2c4-4873-b8b8-4168898ab21c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742170bde110>]}
[0m10:33:51.960038 [warn ] [MainThread]: The selection criterion 'customers' does not match any enabled nodes
[0m10:33:51.962491 [info ] [MainThread]: 
[0m10:33:51.963661 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:33:51.967463 [debug] [MainThread]: Command end result
[0m10:33:51.995417 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2884312, "process_in_blocks": "95440", "process_kernel_time": 0.234784, "process_mem_max_rss": "121708", "process_out_blocks": "1856", "process_user_time": 1.5016}
[0m10:33:51.996358 [debug] [MainThread]: Command `dbt run` succeeded at 10:33:51.996259 after 1.29 seconds
[0m10:33:51.997066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742177afbdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742176cca0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742170be6710>]}
[0m10:33:51.997704 [debug] [MainThread]: Flushing usage events
[0m10:34:10.642940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7393bc987d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7393baf64c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7393baf64cd0>]}


============================== 10:34:10.646200 | 3ab66034-a9d4-4084-9762-f3b6a8ec1878 ==============================
[0m10:34:10.646200 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:34:10.647119 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -s my_first_dbt_model.sql', 'send_anonymous_usage_stats': 'True'}
[0m10:34:10.784144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ab66034-a9d4-4084-9762-f3b6a8ec1878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7393b78ec430>]}
[0m10:34:10.812889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ab66034-a9d4-4084-9762-f3b6a8ec1878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7393bafd6b30>]}
[0m10:34:10.816919 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m10:34:10.860522 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:34:11.048337 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:34:11.049584 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:34:11.079490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ab66034-a9d4-4084-9762-f3b6a8ec1878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7393b516cca0>]}
[0m10:34:11.148121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ab66034-a9d4-4084-9762-f3b6a8ec1878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7393b516e080>]}
[0m10:34:11.148954 [info ] [MainThread]: Found 3 models, 4 data tests, 421 macros
[0m10:34:11.149628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ab66034-a9d4-4084-9762-f3b6a8ec1878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7393b516dff0>]}
[0m10:34:11.151104 [info ] [MainThread]: 
[0m10:34:11.151797 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:34:11.152979 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m10:34:11.746161 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m10:34:11.747468 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m10:34:11.748493 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:34:11.804975 [debug] [ThreadPool]: SQL status: OK in 0.056 seconds
[0m10:34:11.807889 [debug] [ThreadPool]: On list_dev: Close
[0m10:34:11.813693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m10:34:11.815203 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m10:34:11.825754 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:34:11.826489 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m10:34:11.827045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:34:11.839201 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m10:34:11.840550 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:34:11.841196 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m10:34:11.841985 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:34:11.842556 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:34:11.843092 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m10:34:11.845013 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:34:11.846348 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:34:11.846985 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:34:11.847526 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:34:11.848268 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:34:11.848834 [debug] [ThreadPool]: On create_dev_main: Close
[0m10:34:11.854879 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m10:34:11.865727 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:34:11.866513 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m10:34:11.866961 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:34:11.883189 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m10:34:11.884435 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:34:11.885303 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m10:34:11.915891 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m10:34:11.917064 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m10:34:11.918958 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m10:34:11.919452 [debug] [ThreadPool]: On list_dev_main: Close
[0m10:34:11.921458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ab66034-a9d4-4084-9762-f3b6a8ec1878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7393b516d930>]}
[0m10:34:11.922060 [debug] [MainThread]: Using duckdb connection "master"
[0m10:34:11.922525 [debug] [MainThread]: On master: BEGIN
[0m10:34:11.922993 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:34:11.933810 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m10:34:11.934766 [debug] [MainThread]: On master: COMMIT
[0m10:34:11.935615 [debug] [MainThread]: Using duckdb connection "master"
[0m10:34:11.936472 [debug] [MainThread]: On master: COMMIT
[0m10:34:11.937725 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:34:11.938736 [debug] [MainThread]: On master: Close
[0m10:34:11.941984 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:34:11.942987 [info ] [MainThread]: 
[0m10:34:11.954000 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m10:34:11.955329 [info ] [Thread-1 (]: 1 of 1 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m10:34:11.956776 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.my_first_dbt_model'
[0m10:34:11.957734 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m10:34:11.969490 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m10:34:11.975819 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m10:34:11.999704 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m10:34:12.003799 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:34:12.004339 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m10:34:12.004823 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:34:12.014422 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:34:12.015038 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:34:12.015590 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m10:34:12.018542 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:34:12.023078 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:34:12.023861 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:34:12.024560 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:34:12.026399 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:34:12.026924 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:34:12.027517 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:34:12.037727 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m10:34:12.038372 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:34:12.038835 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m10:34:12.042414 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:34:12.045191 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:34:12.045760 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m10:34:12.046687 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:34:12.048336 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m10:34:12.057568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ab66034-a9d4-4084-9762-f3b6a8ec1878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7393b297c400>]}
[0m10:34:12.058243 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.10s]
[0m10:34:12.058859 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m10:34:12.060004 [debug] [MainThread]: Using duckdb connection "master"
[0m10:34:12.060509 [debug] [MainThread]: On master: BEGIN
[0m10:34:12.060934 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:34:12.069668 [debug] [MainThread]: SQL status: OK in 0.009 seconds
[0m10:34:12.070456 [debug] [MainThread]: On master: COMMIT
[0m10:34:12.070911 [debug] [MainThread]: Using duckdb connection "master"
[0m10:34:12.071341 [debug] [MainThread]: On master: COMMIT
[0m10:34:12.071828 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:34:12.072331 [debug] [MainThread]: On master: Close
[0m10:34:12.073953 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:34:12.074541 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m10:34:12.075023 [debug] [MainThread]: Connection 'model.transform.my_first_dbt_model' was properly closed.
[0m10:34:12.075545 [info ] [MainThread]: 
[0m10:34:12.076099 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m10:34:12.076971 [debug] [MainThread]: Command end result
[0m10:34:12.110367 [info ] [MainThread]: 
[0m10:34:12.111082 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:34:12.111727 [info ] [MainThread]: 
[0m10:34:12.112330 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:34:12.113150 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4986613, "process_in_blocks": "14768", "process_kernel_time": 0.199035, "process_mem_max_rss": "136408", "process_out_blocks": "3696", "process_user_time": 1.318102}
[0m10:34:12.113839 [debug] [MainThread]: Command `dbt run` succeeded at 10:34:12.113785 after 1.50 seconds
[0m10:34:12.114343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7393bc987d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7393b78ee080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7393b5102500>]}
[0m10:34:12.114835 [debug] [MainThread]: Flushing usage events
[0m08:29:50.663416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e97e3787ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e97e1d60d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e97e1d60dc0>]}


============================== 08:29:50.665541 | 5943e635-acba-4be6-9577-aeca89efb984 ==============================
[0m08:29:50.665541 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:29:50.666114 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:29:50.790605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5943e635-acba-4be6-9577-aeca89efb984', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e97e1d03730>]}
[0m08:29:50.821870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5943e635-acba-4be6-9577-aeca89efb984', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e97e2b35ae0>]}
[0m08:29:50.824280 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m08:29:50.871347 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m08:29:51.007288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:29:51.008068 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:29:51.016225 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m08:29:51.035086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5943e635-acba-4be6-9577-aeca89efb984', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e97dbf6bdf0>]}
[0m08:29:51.096623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5943e635-acba-4be6-9577-aeca89efb984', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e97dbf73a30>]}
[0m08:29:51.097021 [info ] [MainThread]: Found 2 models, 4 data tests, 421 macros
[0m08:29:51.097271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5943e635-acba-4be6-9577-aeca89efb984', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e97dbf73dc0>]}
[0m08:29:51.098484 [info ] [MainThread]: 
[0m08:29:51.098940 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:29:51.103547 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m08:29:51.459205 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m08:29:51.460059 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m08:29:51.460686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:29:51.531051 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m08:29:51.531978 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m08:29:51.533614 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:29:51.534418 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m08:29:51.535089 [info ] [MainThread]: 
[0m08:29:51.535746 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m08:29:51.536591 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/dev.duckdb": Conflicting lock is held in /home/ETUDIANT/e24a518u/Bureau/tp sql/transform/duckdb (PID 6692). See also https://duckdb.org/docs/connect/concurrency
[0m08:29:51.538421 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.90291977, "process_in_blocks": "8752", "process_kernel_time": 0.15742, "process_mem_max_rss": "130040", "process_out_blocks": "1088", "process_user_time": 1.053902}
[0m08:29:51.539485 [debug] [MainThread]: Command `dbt run` failed at 08:29:51.539301 after 0.90 seconds
[0m08:29:51.540201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e97e3787ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e97dbf736d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e97dbf7aec0>]}
[0m08:29:51.540915 [debug] [MainThread]: Flushing usage events
[0m08:30:06.312328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a4a3bf7d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a4a3fd3340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a4a3fd32e0>]}


============================== 08:30:06.315023 | 6296e4d2-1d84-4048-84ed-162890ba0d6f ==============================
[0m08:30:06.315023 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:30:06.315617 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:30:06.428193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6296e4d2-1d84-4048-84ed-162890ba0d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a4a3b25840>]}
[0m08:30:06.456147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6296e4d2-1d84-4048-84ed-162890ba0d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a4a2dded10>]}
[0m08:30:06.458367 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m08:30:06.498857 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m08:30:06.595469 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:30:06.595966 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:30:06.602152 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m08:30:06.620506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6296e4d2-1d84-4048-84ed-162890ba0d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a49c3d7eb0>]}
[0m08:30:06.675997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6296e4d2-1d84-4048-84ed-162890ba0d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a49c3fbc10>]}
[0m08:30:06.676311 [info ] [MainThread]: Found 2 models, 4 data tests, 421 macros
[0m08:30:06.676516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6296e4d2-1d84-4048-84ed-162890ba0d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a49cd1c520>]}
[0m08:30:06.677421 [info ] [MainThread]: 
[0m08:30:06.677741 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:30:06.680506 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m08:30:06.926942 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m08:30:06.927583 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m08:30:06.927995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:30:06.971505 [debug] [ThreadPool]: SQL status: OK in 0.043 seconds
[0m08:30:06.973988 [debug] [ThreadPool]: On list_dev: Close
[0m08:30:06.979342 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m08:30:06.980311 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m08:30:06.987759 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:30:06.988043 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m08:30:06.988364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:30:07.001596 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m08:30:07.002625 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:30:07.002945 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m08:30:07.003606 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:30:07.003921 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:30:07.004211 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m08:30:07.005842 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:30:07.006407 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m08:30:07.006633 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:30:07.006903 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m08:30:07.007367 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:30:07.007606 [debug] [ThreadPool]: On create_dev_main: Close
[0m08:30:07.009227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m08:30:07.013803 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m08:30:07.014142 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m08:30:07.014500 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:30:07.029641 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m08:30:07.030582 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m08:30:07.031371 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m08:30:07.061510 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m08:30:07.062228 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m08:30:07.063588 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m08:30:07.063775 [debug] [ThreadPool]: On list_dev_main: Close
[0m08:30:07.065680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6296e4d2-1d84-4048-84ed-162890ba0d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a49d7eaad0>]}
[0m08:30:07.065938 [debug] [MainThread]: Using duckdb connection "master"
[0m08:30:07.066105 [debug] [MainThread]: On master: BEGIN
[0m08:30:07.066331 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:30:07.077195 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m08:30:07.077583 [debug] [MainThread]: On master: COMMIT
[0m08:30:07.077886 [debug] [MainThread]: Using duckdb connection "master"
[0m08:30:07.078188 [debug] [MainThread]: On master: COMMIT
[0m08:30:07.078672 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:30:07.079043 [debug] [MainThread]: On master: Close
[0m08:30:07.081169 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:30:07.081704 [info ] [MainThread]: 
[0m08:30:07.091948 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m08:30:07.093085 [info ] [Thread-1 (]: 1 of 2 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m08:30:07.093985 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.my_first_dbt_model'
[0m08:30:07.094631 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m08:30:07.108338 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m08:30:07.110122 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m08:30:07.128023 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m08:30:07.129385 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:30:07.129615 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m08:30:07.129936 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:30:07.140259 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:30:07.140493 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:30:07.140796 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m08:30:07.143168 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:30:07.147056 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:30:07.147293 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m08:30:07.147884 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:30:07.149341 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:30:07.149582 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m08:30:07.149954 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:30:07.160132 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m08:30:07.160372 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:30:07.160710 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m08:30:07.161945 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:30:07.164476 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:30:07.164701 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m08:30:07.165316 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:30:07.166666 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m08:30:07.183350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6296e4d2-1d84-4048-84ed-162890ba0d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a49912c640>]}
[0m08:30:07.183741 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.09s]
[0m08:30:07.184060 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m08:30:07.184557 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m08:30:07.184822 [info ] [Thread-1 (]: 2 of 2 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m08:30:07.185191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m08:30:07.185394 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m08:30:07.186866 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m08:30:07.187827 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m08:30:07.198307 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m08:30:07.199327 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:30:07.199555 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m08:30:07.199803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:30:07.210136 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:30:07.210408 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:30:07.210719 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m08:30:07.211304 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:30:07.213169 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:30:07.213423 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m08:30:07.213862 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:30:07.216406 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:30:07.216708 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m08:30:07.217256 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:30:07.218278 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m08:30:07.218513 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:30:07.218758 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m08:30:07.219943 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:30:07.221268 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:30:07.221485 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m08:30:07.222042 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:30:07.222743 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m08:30:07.233853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6296e4d2-1d84-4048-84ed-162890ba0d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a4987adc30>]}
[0m08:30:07.234285 [info ] [Thread-1 (]: 2 of 2 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m08:30:07.234599 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m08:30:07.235244 [debug] [MainThread]: Using duckdb connection "master"
[0m08:30:07.235456 [debug] [MainThread]: On master: BEGIN
[0m08:30:07.235708 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:30:07.245983 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m08:30:07.246222 [debug] [MainThread]: On master: COMMIT
[0m08:30:07.246486 [debug] [MainThread]: Using duckdb connection "master"
[0m08:30:07.246754 [debug] [MainThread]: On master: COMMIT
[0m08:30:07.247160 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:30:07.247334 [debug] [MainThread]: On master: Close
[0m08:30:07.248496 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:30:07.248732 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m08:30:07.249002 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m08:30:07.249307 [info ] [MainThread]: 
[0m08:30:07.249552 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m08:30:07.250027 [debug] [MainThread]: Command end result
[0m08:30:07.270951 [info ] [MainThread]: 
[0m08:30:07.271416 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:30:07.271741 [info ] [MainThread]: 
[0m08:30:07.272069 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m08:30:07.272710 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9878986, "process_in_blocks": "13528", "process_kernel_time": 0.143469, "process_mem_max_rss": "138620", "process_out_blocks": "5536", "process_user_time": 1.129695}
[0m08:30:07.273169 [debug] [MainThread]: Command `dbt run` succeeded at 08:30:07.273092 after 0.99 seconds
[0m08:30:07.273489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a4a3bf7d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a49c363100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a49c361390>]}
[0m08:30:07.273806 [debug] [MainThread]: Flushing usage events
[0m08:31:20.153331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d08a88fd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d0890f8d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d0890f8d60>]}


============================== 08:31:20.155254 | 9ec68564-78ea-49ac-88bd-21ef7b73e6a8 ==============================
[0m08:31:20.155254 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:31:20.155786 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:31:20.280926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ec68564-78ea-49ac-88bd-21ef7b73e6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d08a31ace0>]}
[0m08:31:20.309024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ec68564-78ea-49ac-88bd-21ef7b73e6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d089224af0>]}
[0m08:31:20.311698 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m08:31:20.356036 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m08:31:20.489867 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:31:20.490652 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:31:20.498399 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m08:31:20.517189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ec68564-78ea-49ac-88bd-21ef7b73e6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d082777e80>]}
[0m08:31:20.578364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ec68564-78ea-49ac-88bd-21ef7b73e6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d08277feb0>]}
[0m08:31:20.578896 [info ] [MainThread]: Found 2 models, 4 data tests, 421 macros
[0m08:31:20.579278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ec68564-78ea-49ac-88bd-21ef7b73e6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d083158580>]}
[0m08:31:20.581003 [info ] [MainThread]: 
[0m08:31:20.581705 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:31:20.586870 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m08:31:20.833943 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m08:31:20.834208 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m08:31:20.834561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:31:20.852920 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m08:31:20.854451 [debug] [ThreadPool]: On list_dev: Close
[0m08:31:20.857108 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m08:31:20.857669 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m08:31:20.862259 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:31:20.862471 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m08:31:20.862746 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:31:20.867266 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m08:31:20.867897 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:31:20.868082 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m08:31:20.868535 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:31:20.868698 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:31:20.868949 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m08:31:20.869344 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:31:20.869760 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m08:31:20.869942 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:31:20.870194 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m08:31:20.870580 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:31:20.870756 [debug] [ThreadPool]: On create_dev_main: Close
[0m08:31:20.872512 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m08:31:20.875782 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m08:31:20.876013 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m08:31:20.876264 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:31:20.880695 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m08:31:20.880990 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m08:31:20.881384 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m08:31:20.896601 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m08:31:20.897217 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m08:31:20.897688 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m08:31:20.897861 [debug] [ThreadPool]: On list_dev_main: Close
[0m08:31:20.899082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ec68564-78ea-49ac-88bd-21ef7b73e6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d089184430>]}
[0m08:31:20.899363 [debug] [MainThread]: Using duckdb connection "master"
[0m08:31:20.899606 [debug] [MainThread]: On master: BEGIN
[0m08:31:20.899822 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:31:20.904184 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m08:31:20.904391 [debug] [MainThread]: On master: COMMIT
[0m08:31:20.904635 [debug] [MainThread]: Using duckdb connection "master"
[0m08:31:20.904836 [debug] [MainThread]: On master: COMMIT
[0m08:31:20.905137 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:31:20.905315 [debug] [MainThread]: On master: Close
[0m08:31:20.906302 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:31:20.906515 [info ] [MainThread]: 
[0m08:31:20.907629 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m08:31:20.908230 [info ] [Thread-1 (]: 1 of 2 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m08:31:20.908814 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.my_first_dbt_model'
[0m08:31:20.909260 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m08:31:20.916115 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m08:31:20.918055 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m08:31:20.938672 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m08:31:20.940597 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:31:20.940827 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m08:31:20.941097 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:31:20.945952 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:31:20.946230 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:31:20.946497 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m08:31:20.947187 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:31:20.950994 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:31:20.951233 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m08:31:20.951753 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:31:20.960815 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m08:31:20.961052 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:31:20.961363 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m08:31:20.965859 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:31:20.968317 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:31:20.968548 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m08:31:20.968995 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:31:20.970320 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m08:31:20.978184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ec68564-78ea-49ac-88bd-21ef7b73e6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d08b586fb0>]}
[0m08:31:20.978567 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.07s]
[0m08:31:20.978895 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m08:31:20.979424 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m08:31:20.979697 [info ] [Thread-1 (]: 2 of 2 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m08:31:20.980030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m08:31:20.980229 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m08:31:20.981656 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m08:31:20.982565 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m08:31:20.991524 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m08:31:20.992483 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:31:20.992685 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m08:31:20.992947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:31:21.001293 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m08:31:21.001557 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:31:21.001850 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m08:31:21.002317 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:31:21.003878 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:31:21.004090 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m08:31:21.004585 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:31:21.005389 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m08:31:21.005606 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:31:21.005895 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m08:31:21.010336 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:31:21.011533 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:31:21.011743 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m08:31:21.012171 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:31:21.012831 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m08:31:21.018019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ec68564-78ea-49ac-88bd-21ef7b73e6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d07ffb9210>]}
[0m08:31:21.018408 [info ] [Thread-1 (]: 2 of 2 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m08:31:21.018761 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m08:31:21.019593 [debug] [MainThread]: Using duckdb connection "master"
[0m08:31:21.019794 [debug] [MainThread]: On master: BEGIN
[0m08:31:21.020014 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:31:21.028045 [debug] [MainThread]: SQL status: OK in 0.008 seconds
[0m08:31:21.028253 [debug] [MainThread]: On master: COMMIT
[0m08:31:21.028480 [debug] [MainThread]: Using duckdb connection "master"
[0m08:31:21.028683 [debug] [MainThread]: On master: COMMIT
[0m08:31:21.028988 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:31:21.029175 [debug] [MainThread]: On master: Close
[0m08:31:21.030296 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:31:21.030514 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m08:31:21.030754 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m08:31:21.031016 [info ] [MainThread]: 
[0m08:31:21.031218 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m08:31:21.031688 [debug] [MainThread]: Command end result
[0m08:31:21.052060 [info ] [MainThread]: 
[0m08:31:21.052352 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:31:21.052550 [info ] [MainThread]: 
[0m08:31:21.052799 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m08:31:21.053276 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9275055, "process_in_blocks": "2224", "process_kernel_time": 0.155947, "process_mem_max_rss": "136432", "process_out_blocks": "4472", "process_user_time": 1.167607}
[0m08:31:21.053587 [debug] [MainThread]: Command `dbt run` succeeded at 08:31:21.053535 after 0.93 seconds
[0m08:31:21.053792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d08a88fd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d089224af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d082701270>]}
[0m08:31:21.054028 [debug] [MainThread]: Flushing usage events
[0m08:33:04.338499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59390ffcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5938b08820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59394d1ab0>]}


============================== 08:33:04.341492 | fcf8c14c-e511-4d37-9ec1-bef4f64b2a30 ==============================
[0m08:33:04.341492 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:33:04.342158 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:33:04.465807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcf8c14c-e511-4d37-9ec1-bef4f64b2a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f593902d7e0>]}
[0m08:33:04.493869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcf8c14c-e511-4d37-9ec1-bef4f64b2a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59382de770>]}
[0m08:33:04.496410 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m08:33:04.537909 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m08:33:04.672562 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m08:33:04.673664 [debug] [MainThread]: Partial parsing: added file: transform://models/example/clean.sql
[0m08:33:04.799250 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m08:33:04.801788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcf8c14c-e511-4d37-9ec1-bef4f64b2a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5930d28040>]}
[0m08:33:04.860980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcf8c14c-e511-4d37-9ec1-bef4f64b2a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f593217b640>]}
[0m08:33:04.861320 [info ] [MainThread]: Found 3 models, 4 data tests, 421 macros
[0m08:33:04.861510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcf8c14c-e511-4d37-9ec1-bef4f64b2a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5932178640>]}
[0m08:33:04.862448 [info ] [MainThread]: 
[0m08:33:04.862771 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:33:04.865600 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m08:33:05.114222 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m08:33:05.114940 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m08:33:05.115453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:33:05.131985 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m08:33:05.133304 [debug] [ThreadPool]: On list_dev: Close
[0m08:33:05.135788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m08:33:05.136189 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m08:33:05.140106 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:33:05.140328 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m08:33:05.140580 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:33:05.150724 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m08:33:05.151460 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:33:05.151652 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m08:33:05.152070 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:33:05.152245 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:33:05.152516 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m08:33:05.152898 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:33:05.153306 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m08:33:05.153480 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:33:05.153754 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m08:33:05.154118 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:33:05.154312 [debug] [ThreadPool]: On create_dev_main: Close
[0m08:33:05.155698 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m08:33:05.159900 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m08:33:05.160112 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m08:33:05.160389 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:33:05.170022 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m08:33:05.170259 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m08:33:05.170524 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m08:33:05.184590 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m08:33:05.185281 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m08:33:05.185821 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m08:33:05.185997 [debug] [ThreadPool]: On list_dev_main: Close
[0m08:33:05.187711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcf8c14c-e511-4d37-9ec1-bef4f64b2a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f593755d840>]}
[0m08:33:05.187977 [debug] [MainThread]: Using duckdb connection "master"
[0m08:33:05.188155 [debug] [MainThread]: On master: BEGIN
[0m08:33:05.188411 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:33:05.198544 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m08:33:05.198771 [debug] [MainThread]: On master: COMMIT
[0m08:33:05.199061 [debug] [MainThread]: Using duckdb connection "master"
[0m08:33:05.199311 [debug] [MainThread]: On master: COMMIT
[0m08:33:05.199671 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:33:05.199859 [debug] [MainThread]: On master: Close
[0m08:33:05.201092 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:33:05.201376 [info ] [MainThread]: 
[0m08:33:05.202594 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m08:33:05.203021 [info ] [Thread-1 (]: 1 of 3 START sql view model main.clean ......................................... [RUN]
[0m08:33:05.203437 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.clean'
[0m08:33:05.203718 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m08:33:05.209032 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m08:33:05.211794 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m08:33:05.228736 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m08:33:05.230589 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:33:05.230882 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m08:33:05.231211 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:33:05.242498 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m08:33:05.242734 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:33:05.243153 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS
 ( SELECT * , 
    TRY_CAST("Eolien (MW)" AS INT) AS Eolien 
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL 
    ),
  clean AS
   ( SELECT,COALESCE("Nucléaire (MW)", 0) + COALESCE(Eolien, 0) + COALESCE("Solaire (MW)", 0) + COALESCE("Hydraulique (MW)", 0) + COALESCE("Thermique (MW)", 0) 
   AS production_totale
    FROM data_clean ) 
   SELECT * FROM clean
  );

[0m08:33:05.253516 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS
 ( SELECT * , 
    TRY_CAST("Eolien (MW)" AS INT) AS Eolien 
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL 
    ),
  clean AS
   ( SELECT,COALESCE("Nucléaire (MW)", 0) + COALESCE(Eolien, 0) + COALESCE("Solaire (MW)", 0) + COALESCE("Hydraulique (MW)", 0) + COALESCE("Thermique (MW)", 0) 
   AS production_totale
    FROM data_clean ) 
   SELECT * FROM clean
  );

[0m08:33:05.253742 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:33:05.254076 [debug] [Thread-1 (]: On model.transform.clean: ROLLBACK
[0m08:33:05.270050 [debug] [Thread-1 (]: Failed to rollback 'model.transform.clean'
[0m08:33:05.270636 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m08:33:05.273466 [debug] [Thread-1 (]: Runtime Error in model clean (models/example/clean.sql)
  Parser Error: syntax error at or near ","
[0m08:33:05.275107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcf8c14c-e511-4d37-9ec1-bef4f64b2a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5930d686d0>]}
[0m08:33:05.275791 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.clean ................................ [[31mERROR[0m in 0.07s]
[0m08:33:05.276347 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m08:33:05.276729 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m08:33:05.277939 [info ] [Thread-1 (]: 2 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m08:33:05.278303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.my_first_dbt_model)
[0m08:33:05.278601 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m08:33:05.280704 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m08:33:05.281677 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m08:33:05.291404 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m08:33:05.292323 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:33:05.292530 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m08:33:05.292793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:33:05.302699 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:33:05.302976 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:33:05.303301 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m08:33:05.303944 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:33:05.307654 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:33:05.307889 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m08:33:05.308349 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:33:05.331587 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:33:05.331884 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m08:33:05.332618 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:33:05.343028 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m08:33:05.343285 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:33:05.343555 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m08:33:05.344895 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:33:05.347494 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:33:05.347731 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m08:33:05.348340 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:33:05.349658 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m08:33:05.364406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcf8c14c-e511-4d37-9ec1-bef4f64b2a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5939e3ef50>]}
[0m08:33:05.364853 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.09s]
[0m08:33:05.365180 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m08:33:05.365597 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m08:33:05.365854 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m08:33:05.366166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m08:33:05.366376 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m08:33:05.367854 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m08:33:05.368790 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m08:33:05.371064 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m08:33:05.372110 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:33:05.372437 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m08:33:05.372716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:33:05.385521 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m08:33:05.386002 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:33:05.386399 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m08:33:05.387203 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:33:05.389678 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:33:05.389977 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m08:33:05.390444 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:33:05.392223 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:33:05.392453 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m08:33:05.392860 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:33:05.393809 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m08:33:05.394045 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:33:05.394285 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m08:33:05.395413 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:33:05.397302 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:33:05.397562 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m08:33:05.398252 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:33:05.399084 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m08:33:05.412418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcf8c14c-e511-4d37-9ec1-bef4f64b2a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f592e585810>]}
[0m08:33:05.412812 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m08:33:05.413124 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m08:33:05.413748 [debug] [MainThread]: Using duckdb connection "master"
[0m08:33:05.413962 [debug] [MainThread]: On master: BEGIN
[0m08:33:05.414247 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:33:05.424659 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m08:33:05.424967 [debug] [MainThread]: On master: COMMIT
[0m08:33:05.425222 [debug] [MainThread]: Using duckdb connection "master"
[0m08:33:05.425514 [debug] [MainThread]: On master: COMMIT
[0m08:33:05.425901 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:33:05.426141 [debug] [MainThread]: On master: Close
[0m08:33:05.427600 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:33:05.427850 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m08:33:05.428095 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m08:33:05.428428 [info ] [MainThread]: 
[0m08:33:05.428650 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m08:33:05.429215 [debug] [MainThread]: Command end result
[0m08:33:05.448749 [info ] [MainThread]: 
[0m08:33:05.449027 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:33:05.449284 [info ] [MainThread]: 
[0m08:33:05.449596 [error] [MainThread]:   Runtime Error in model clean (models/example/clean.sql)
  Parser Error: syntax error at or near ","
[0m08:33:05.449825 [info ] [MainThread]: 
[0m08:33:05.450118 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m08:33:05.450607 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1399826, "process_in_blocks": "10736", "process_kernel_time": 0.141478, "process_mem_max_rss": "142600", "process_out_blocks": "6616", "process_user_time": 1.372343}
[0m08:33:05.450909 [debug] [MainThread]: Command `dbt run` failed at 08:33:05.450860 after 1.14 seconds
[0m08:33:05.451116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59390ffcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f593175bf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5933eda950>]}
[0m08:33:05.451318 [debug] [MainThread]: Flushing usage events
[0m08:34:08.701702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x764884d87c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7648851c28f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7648851c31f0>]}


============================== 08:34:08.704565 | 131364b7-a6a8-4b1f-b5f3-fc390c490dce ==============================
[0m08:34:08.704565 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:34:08.705053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:34:08.831351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '131364b7-a6a8-4b1f-b5f3-fc390c490dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x764884cb17e0>]}
[0m08:34:08.858927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '131364b7-a6a8-4b1f-b5f3-fc390c490dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x764884134e20>]}
[0m08:34:08.861066 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m08:34:08.901713 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m08:34:09.000665 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:34:09.001224 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:34:09.007761 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m08:34:09.026308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '131364b7-a6a8-4b1f-b5f3-fc390c490dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76487d56cb50>]}
[0m08:34:09.086705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '131364b7-a6a8-4b1f-b5f3-fc390c490dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76487d56dea0>]}
[0m08:34:09.087014 [info ] [MainThread]: Found 3 models, 4 data tests, 421 macros
[0m08:34:09.087282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '131364b7-a6a8-4b1f-b5f3-fc390c490dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76487d56de40>]}
[0m08:34:09.088374 [info ] [MainThread]: 
[0m08:34:09.088688 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:34:09.091482 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m08:34:09.343509 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m08:34:09.344270 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m08:34:09.344816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:34:09.367381 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m08:34:09.369407 [debug] [ThreadPool]: On list_dev: Close
[0m08:34:09.373390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m08:34:09.374071 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m08:34:09.379487 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:34:09.379712 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m08:34:09.379935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:34:09.390279 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m08:34:09.391136 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:34:09.391382 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m08:34:09.391774 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:34:09.391949 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:34:09.392230 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m08:34:09.392652 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:34:09.393086 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m08:34:09.393283 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:34:09.393547 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m08:34:09.393936 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:34:09.394117 [debug] [ThreadPool]: On create_dev_main: Close
[0m08:34:09.395633 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m08:34:09.398804 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m08:34:09.399016 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m08:34:09.399296 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:34:09.411478 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m08:34:09.412098 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m08:34:09.412808 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m08:34:09.428727 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m08:34:09.429434 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m08:34:09.430003 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m08:34:09.430207 [debug] [ThreadPool]: On list_dev_main: Close
[0m08:34:09.431851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '131364b7-a6a8-4b1f-b5f3-fc390c490dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7648833ece50>]}
[0m08:34:09.432109 [debug] [MainThread]: Using duckdb connection "master"
[0m08:34:09.432322 [debug] [MainThread]: On master: BEGIN
[0m08:34:09.432519 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:34:09.443234 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m08:34:09.443585 [debug] [MainThread]: On master: COMMIT
[0m08:34:09.443889 [debug] [MainThread]: Using duckdb connection "master"
[0m08:34:09.444341 [debug] [MainThread]: On master: COMMIT
[0m08:34:09.445272 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:34:09.445920 [debug] [MainThread]: On master: Close
[0m08:34:09.448297 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:34:09.448805 [info ] [MainThread]: 
[0m08:34:09.450795 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m08:34:09.451818 [info ] [Thread-1 (]: 1 of 3 START sql view model main.clean ......................................... [RUN]
[0m08:34:09.452667 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.clean'
[0m08:34:09.453088 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m08:34:09.460905 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m08:34:09.462437 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m08:34:09.482721 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m08:34:09.484476 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:34:09.484704 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m08:34:09.484956 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:34:09.495428 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:34:09.495701 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:34:09.495946 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT * FROM clean;
  );

[0m08:34:09.496358 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT * FROM clean;
  );

[0m08:34:09.496564 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:34:09.496895 [debug] [Thread-1 (]: On model.transform.clean: ROLLBACK
[0m08:34:09.499012 [debug] [Thread-1 (]: Failed to rollback 'model.transform.clean'
[0m08:34:09.499235 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m08:34:09.500589 [debug] [Thread-1 (]: Runtime Error in model clean (models/example/clean.sql)
  Parser Error: syntax error at or near ";"
[0m08:34:09.501435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '131364b7-a6a8-4b1f-b5f3-fc390c490dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x764884119c30>]}
[0m08:34:09.501819 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.clean ................................ [[31mERROR[0m in 0.05s]
[0m08:34:09.502148 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m08:34:09.502380 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m08:34:09.503207 [info ] [Thread-1 (]: 2 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m08:34:09.503459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.my_first_dbt_model)
[0m08:34:09.503647 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m08:34:09.505316 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m08:34:09.506148 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m08:34:09.516963 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m08:34:09.517897 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:34:09.518125 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m08:34:09.518377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:34:09.528583 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:34:09.528883 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:34:09.529149 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m08:34:09.529900 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:34:09.533237 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:34:09.533463 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m08:34:09.533857 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:34:09.535407 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:34:09.535635 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m08:34:09.536072 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:34:09.545897 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m08:34:09.546156 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:34:09.546434 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m08:34:09.547825 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:34:09.550321 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:34:09.550553 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m08:34:09.551285 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:34:09.552672 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m08:34:09.566631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '131364b7-a6a8-4b1f-b5f3-fc390c490dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76487ad7c070>]}
[0m08:34:09.567036 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m08:34:09.567365 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m08:34:09.567868 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m08:34:09.568114 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m08:34:09.568363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m08:34:09.568553 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m08:34:09.570517 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m08:34:09.571406 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m08:34:09.573363 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m08:34:09.574359 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:34:09.574657 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m08:34:09.574898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:34:09.586363 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m08:34:09.586725 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:34:09.587005 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m08:34:09.587600 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:34:09.589597 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:34:09.589839 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m08:34:09.590267 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:34:09.591735 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:34:09.591941 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m08:34:09.592340 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:34:09.593177 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m08:34:09.593382 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:34:09.593638 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m08:34:09.594860 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:34:09.596109 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:34:09.596320 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m08:34:09.597064 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:34:09.597751 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m08:34:09.609337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '131364b7-a6a8-4b1f-b5f3-fc390c490dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76487994cf40>]}
[0m08:34:09.609731 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m08:34:09.610035 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m08:34:09.610769 [debug] [MainThread]: Using duckdb connection "master"
[0m08:34:09.610976 [debug] [MainThread]: On master: BEGIN
[0m08:34:09.611168 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:34:09.622106 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m08:34:09.622445 [debug] [MainThread]: On master: COMMIT
[0m08:34:09.622747 [debug] [MainThread]: Using duckdb connection "master"
[0m08:34:09.622969 [debug] [MainThread]: On master: COMMIT
[0m08:34:09.623386 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:34:09.623618 [debug] [MainThread]: On master: Close
[0m08:34:09.624864 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:34:09.625086 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m08:34:09.625334 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m08:34:09.625656 [info ] [MainThread]: 
[0m08:34:09.625860 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m08:34:09.626410 [debug] [MainThread]: Command end result
[0m08:34:09.668384 [info ] [MainThread]: 
[0m08:34:09.668697 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:34:09.668919 [info ] [MainThread]: 
[0m08:34:09.669224 [error] [MainThread]:   Runtime Error in model clean (models/example/clean.sql)
  Parser Error: syntax error at or near ";"
[0m08:34:09.669444 [info ] [MainThread]: 
[0m08:34:09.669704 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m08:34:09.670218 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9957922, "process_in_blocks": "8992", "process_kernel_time": 0.151947, "process_mem_max_rss": "139488", "process_out_blocks": "5768", "process_user_time": 1.281991}
[0m08:34:09.670522 [debug] [MainThread]: Command `dbt run` failed at 08:34:09.670469 after 1.00 seconds
[0m08:34:09.670744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x764884d87c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x764884cb17e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x764883b29c60>]}
[0m08:34:09.670986 [debug] [MainThread]: Flushing usage events
[0m08:34:22.451351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f8eadffd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f8eb1d0cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f8eb1d0d30>]}


============================== 08:34:22.454001 | a6ac1a87-6a4c-48ee-a206-40b287cab13a ==============================
[0m08:34:22.454001 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:34:22.454535 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:34:22.569465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6ac1a87-6a4c-48ee-a206-40b287cab13a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f8ead2d840>]}
[0m08:34:22.598146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6ac1a87-6a4c-48ee-a206-40b287cab13a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f8e9fded10>]}
[0m08:34:22.600264 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m08:34:22.640545 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m08:34:22.748578 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:34:22.749319 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:34:22.758229 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m08:34:22.777821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6ac1a87-6a4c-48ee-a206-40b287cab13a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f8e35e0c40>]}
[0m08:34:22.834019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6ac1a87-6a4c-48ee-a206-40b287cab13a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f8e35e1f60>]}
[0m08:34:22.834352 [info ] [MainThread]: Found 3 models, 4 data tests, 421 macros
[0m08:34:22.834603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6ac1a87-6a4c-48ee-a206-40b287cab13a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f8e35e1ed0>]}
[0m08:34:22.835857 [info ] [MainThread]: 
[0m08:34:22.836274 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:34:22.840703 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m08:34:22.991138 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m08:34:22.991661 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m08:34:22.992085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:34:23.007594 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m08:34:23.008785 [debug] [ThreadPool]: On list_dev: Close
[0m08:34:23.011311 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m08:34:23.011700 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m08:34:23.015869 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:34:23.016083 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m08:34:23.016450 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:34:23.026478 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m08:34:23.027260 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:34:23.027470 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m08:34:23.027750 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:34:23.027927 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:34:23.028117 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m08:34:23.028458 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:34:23.028876 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m08:34:23.029060 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:34:23.029258 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m08:34:23.029589 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:34:23.029759 [debug] [ThreadPool]: On create_dev_main: Close
[0m08:34:23.031231 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m08:34:23.035579 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m08:34:23.035823 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m08:34:23.036082 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:34:23.048799 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m08:34:23.049547 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m08:34:23.050154 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m08:34:23.077996 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m08:34:23.078709 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m08:34:23.079271 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m08:34:23.079456 [debug] [ThreadPool]: On list_dev_main: Close
[0m08:34:23.081402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6ac1a87-6a4c-48ee-a206-40b287cab13a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f8eaee3760>]}
[0m08:34:23.081663 [debug] [MainThread]: Using duckdb connection "master"
[0m08:34:23.081897 [debug] [MainThread]: On master: BEGIN
[0m08:34:23.082165 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:34:23.093414 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m08:34:23.093813 [debug] [MainThread]: On master: COMMIT
[0m08:34:23.094160 [debug] [MainThread]: Using duckdb connection "master"
[0m08:34:23.094467 [debug] [MainThread]: On master: COMMIT
[0m08:34:23.095006 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:34:23.095396 [debug] [MainThread]: On master: Close
[0m08:34:23.097444 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:34:23.097979 [info ] [MainThread]: 
[0m08:34:23.100312 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m08:34:23.101470 [info ] [Thread-1 (]: 1 of 3 START sql view model main.clean ......................................... [RUN]
[0m08:34:23.102724 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.clean'
[0m08:34:23.103590 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m08:34:23.114789 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m08:34:23.116265 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m08:34:23.132733 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m08:34:23.133892 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:34:23.134109 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m08:34:23.134386 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:34:23.144758 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:34:23.144995 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:34:23.145260 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT * FROM clean
  );

[0m08:34:23.145891 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:34:23.149316 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:34:23.149543 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m08:34:23.150122 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:34:23.159160 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m08:34:23.159447 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:34:23.159712 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m08:34:23.161252 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:34:23.163702 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:34:23.163979 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m08:34:23.164498 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:34:23.165812 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m08:34:23.178060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6ac1a87-6a4c-48ee-a206-40b287cab13a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f8e0334b20>]}
[0m08:34:23.178454 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.clean .................................... [[32mOK[0m in 0.08s]
[0m08:34:23.178773 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m08:34:23.179001 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m08:34:23.179304 [info ] [Thread-1 (]: 2 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m08:34:23.179550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.my_first_dbt_model)
[0m08:34:23.179779 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m08:34:23.181202 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m08:34:23.182204 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m08:34:23.191731 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m08:34:23.192763 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:34:23.192969 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m08:34:23.193247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:34:23.203678 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:34:23.203926 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:34:23.204217 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m08:34:23.204761 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:34:23.206370 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:34:23.206581 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m08:34:23.207068 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:34:23.209162 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:34:23.209386 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m08:34:23.209834 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:34:23.213405 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m08:34:23.213626 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:34:23.213900 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m08:34:23.215218 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:34:23.216477 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:34:23.216693 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m08:34:23.217428 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:34:23.218130 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m08:34:23.232682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6ac1a87-6a4c-48ee-a206-40b287cab13a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f8df969e10>]}
[0m08:34:23.233140 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m08:34:23.233489 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m08:34:23.234040 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m08:34:23.234356 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m08:34:23.234670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m08:34:23.234892 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m08:34:23.236353 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m08:34:23.237350 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m08:34:23.239254 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m08:34:23.240089 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:34:23.240297 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m08:34:23.240503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:34:23.250454 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:34:23.250713 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:34:23.250978 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m08:34:23.251470 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:34:23.253174 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:34:23.253391 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m08:34:23.253944 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:34:23.255463 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:34:23.255676 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m08:34:23.256122 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:34:23.256943 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m08:34:23.257155 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:34:23.257409 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m08:34:23.258609 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:34:23.259848 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:34:23.260052 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m08:34:23.260703 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:34:23.261372 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m08:34:23.272827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6ac1a87-6a4c-48ee-a206-40b287cab13a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f8e0350d90>]}
[0m08:34:23.273221 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m08:34:23.273569 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m08:34:23.274221 [debug] [MainThread]: Using duckdb connection "master"
[0m08:34:23.274432 [debug] [MainThread]: On master: BEGIN
[0m08:34:23.274690 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:34:23.285242 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m08:34:23.285527 [debug] [MainThread]: On master: COMMIT
[0m08:34:23.285823 [debug] [MainThread]: Using duckdb connection "master"
[0m08:34:23.286092 [debug] [MainThread]: On master: COMMIT
[0m08:34:23.286510 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:34:23.286731 [debug] [MainThread]: On master: Close
[0m08:34:23.287896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:34:23.288107 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m08:34:23.288332 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m08:34:23.288577 [info ] [MainThread]: 
[0m08:34:23.288764 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m08:34:23.289237 [debug] [MainThread]: Command end result
[0m08:34:23.330664 [info ] [MainThread]: 
[0m08:34:23.330980 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:34:23.331186 [info ] [MainThread]: 
[0m08:34:23.331422 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m08:34:23.331875 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9077417, "process_in_blocks": "8960", "process_kernel_time": 0.11444, "process_mem_max_rss": "140132", "process_out_blocks": "6856", "process_user_time": 1.205112}
[0m08:34:23.332167 [debug] [MainThread]: Command `dbt run` succeeded at 08:34:23.332113 after 0.91 seconds
[0m08:34:23.332368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f8eadffd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f8e35c91b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f8e35cb790>]}
[0m08:34:23.332579 [debug] [MainThread]: Flushing usage events
[0m08:37:02.057994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790b6328fca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790b61b032b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790b61b03250>]}


============================== 08:37:02.060747 | c75128ba-388e-4cba-84ab-989674a45590 ==============================
[0m08:37:02.060747 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:37:02.061237 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:37:02.185452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c75128ba-388e-4cba-84ab-989674a45590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790b61a9f730>]}
[0m08:37:02.213635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c75128ba-388e-4cba-84ab-989674a45590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790b62635ae0>]}
[0m08:37:02.215860 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m08:37:02.257680 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m08:37:02.359535 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:37:02.360313 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:37:02.369421 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m08:37:02.389484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c75128ba-388e-4cba-84ab-989674a45590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790b5b178b80>]}
[0m08:37:02.450828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c75128ba-388e-4cba-84ab-989674a45590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790b5b17a050>]}
[0m08:37:02.451132 [info ] [MainThread]: Found 3 models, 4 data tests, 421 macros
[0m08:37:02.451326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c75128ba-388e-4cba-84ab-989674a45590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790b5b17a020>]}
[0m08:37:02.452459 [info ] [MainThread]: 
[0m08:37:02.452786 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:37:02.455705 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m08:37:02.715158 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m08:37:02.715832 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m08:37:02.716321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:37:02.741435 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m08:37:02.743601 [debug] [ThreadPool]: On list_dev: Close
[0m08:37:02.749147 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m08:37:02.750595 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m08:37:02.760618 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:37:02.761088 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m08:37:02.761455 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:37:02.773784 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m08:37:02.774887 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:37:02.775190 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m08:37:02.775646 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:37:02.775917 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:37:02.776194 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m08:37:02.776659 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:37:02.777257 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m08:37:02.777475 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:37:02.777738 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m08:37:02.778164 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:37:02.778364 [debug] [ThreadPool]: On create_dev_main: Close
[0m08:37:02.779854 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m08:37:02.785153 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m08:37:02.785469 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m08:37:02.785714 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:37:02.800618 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m08:37:02.801318 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m08:37:02.801873 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m08:37:02.819633 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m08:37:02.820352 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m08:37:02.820836 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m08:37:02.821012 [debug] [ThreadPool]: On list_dev_main: Close
[0m08:37:02.822864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c75128ba-388e-4cba-84ab-989674a45590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790b61b84820>]}
[0m08:37:02.823238 [debug] [MainThread]: Using duckdb connection "master"
[0m08:37:02.823421 [debug] [MainThread]: On master: BEGIN
[0m08:37:02.823619 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:37:02.833601 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m08:37:02.833822 [debug] [MainThread]: On master: COMMIT
[0m08:37:02.834075 [debug] [MainThread]: Using duckdb connection "master"
[0m08:37:02.834309 [debug] [MainThread]: On master: COMMIT
[0m08:37:02.834616 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:37:02.834789 [debug] [MainThread]: On master: Close
[0m08:37:02.835989 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:37:02.836234 [info ] [MainThread]: 
[0m08:37:02.837463 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m08:37:02.837990 [info ] [Thread-1 (]: 1 of 3 START sql view model main.clean ......................................... [RUN]
[0m08:37:02.838637 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.clean'
[0m08:37:02.838995 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m08:37:02.844519 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m08:37:02.846080 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m08:37:02.867790 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m08:37:02.869439 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:37:02.869663 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m08:37:02.869906 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:37:02.879863 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:37:02.880104 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:37:02.880460 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT * FROM clean
  );

[0m08:37:02.881232 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:37:02.884484 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:37:02.884715 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m08:37:02.885184 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:37:02.886743 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:37:02.886983 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m08:37:02.887398 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:37:02.895970 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m08:37:02.896254 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:37:02.896613 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m08:37:02.897985 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:37:02.900596 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:37:02.900822 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m08:37:02.901491 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:37:02.902794 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m08:37:02.915134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c75128ba-388e-4cba-84ab-989674a45590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790b58988c10>]}
[0m08:37:02.915513 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.clean .................................... [[32mOK[0m in 0.08s]
[0m08:37:02.915831 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m08:37:02.916062 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m08:37:02.916374 [info ] [Thread-1 (]: 2 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m08:37:02.916611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.my_first_dbt_model)
[0m08:37:02.916816 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m08:37:02.918222 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m08:37:02.919089 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m08:37:02.928792 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m08:37:02.929801 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:37:02.930013 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m08:37:02.930256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:37:02.940416 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:37:02.940676 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:37:02.940926 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m08:37:02.941508 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:37:02.943611 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:37:02.943837 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m08:37:02.944295 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:37:02.945762 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:37:02.945975 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m08:37:02.946447 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:37:02.949131 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m08:37:02.949354 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:37:02.949625 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m08:37:02.950808 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:37:02.951973 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:37:02.952189 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m08:37:02.952823 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:37:02.953477 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m08:37:02.967580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c75128ba-388e-4cba-84ab-989674a45590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790b5751bc70>]}
[0m08:37:02.967982 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m08:37:02.968306 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m08:37:02.968724 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m08:37:02.969038 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m08:37:02.969298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m08:37:02.969553 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m08:37:02.970989 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m08:37:02.971883 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m08:37:02.973918 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m08:37:02.974889 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:37:02.975181 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m08:37:02.975416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:37:02.987668 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m08:37:02.988163 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:37:02.988545 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m08:37:02.989448 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:37:02.992232 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:37:02.992655 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m08:37:02.993364 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:37:02.996715 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:37:02.996923 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m08:37:02.997375 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:37:02.998217 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m08:37:02.998424 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:37:02.998612 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m08:37:02.999777 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:37:03.001532 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:37:03.001749 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m08:37:03.002317 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:37:03.002964 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m08:37:03.014208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c75128ba-388e-4cba-84ab-989674a45590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790b5754ff70>]}
[0m08:37:03.014600 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m08:37:03.014908 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m08:37:03.015641 [debug] [MainThread]: Using duckdb connection "master"
[0m08:37:03.015857 [debug] [MainThread]: On master: BEGIN
[0m08:37:03.016096 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:37:03.027353 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m08:37:03.027782 [debug] [MainThread]: On master: COMMIT
[0m08:37:03.028123 [debug] [MainThread]: Using duckdb connection "master"
[0m08:37:03.028463 [debug] [MainThread]: On master: COMMIT
[0m08:37:03.029054 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:37:03.029469 [debug] [MainThread]: On master: Close
[0m08:37:03.031535 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:37:03.031984 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m08:37:03.032344 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m08:37:03.032775 [info ] [MainThread]: 
[0m08:37:03.033149 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m08:37:03.034007 [debug] [MainThread]: Command end result
[0m08:37:03.075985 [info ] [MainThread]: 
[0m08:37:03.076296 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:37:03.076532 [info ] [MainThread]: 
[0m08:37:03.076795 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m08:37:03.077284 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.046344, "process_in_blocks": "8960", "process_kernel_time": 0.185587, "process_mem_max_rss": "138156", "process_out_blocks": "6880", "process_user_time": 1.31777}
[0m08:37:03.077612 [debug] [MainThread]: Command `dbt run` succeeded at 08:37:03.077561 after 1.05 seconds
[0m08:37:03.077818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790b6328fca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790b5cf25060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790b5cf25db0>]}
[0m08:37:03.078082 [debug] [MainThread]: Flushing usage events
[0m08:48:47.108788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f2c12f7d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f2c16c8d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f2c16c8d90>]}


============================== 08:48:47.111765 | b1e3264c-50c9-4e6c-9a29-01dc2a9835e8 ==============================
[0m08:48:47.111765 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:48:47.112281 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m08:48:47.240232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1e3264c-50c9-4e6c-9a29-01dc2a9835e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f2c0d54dc0>]}
[0m08:48:47.271332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1e3264c-50c9-4e6c-9a29-01dc2a9835e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f2c04ded10>]}
[0m08:48:47.273911 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m08:48:47.315386 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m08:48:47.415111 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:48:47.415634 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:48:47.421814 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m08:48:47.440497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1e3264c-50c9-4e6c-9a29-01dc2a9835e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f2ba3d4be0>]}
[0m08:48:47.508191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1e3264c-50c9-4e6c-9a29-01dc2a9835e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f2ba3d5f90>]}
[0m08:48:47.509038 [info ] [MainThread]: Found 3 models, 4 data tests, 421 macros
[0m08:48:47.509631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1e3264c-50c9-4e6c-9a29-01dc2a9835e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f2ba3d5f00>]}
[0m08:48:47.512646 [info ] [MainThread]: 
[0m08:48:47.513816 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:48:47.523292 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m08:48:47.812982 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m08:48:47.813991 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m08:48:47.814675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:48:47.832436 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m08:48:47.833684 [debug] [ThreadPool]: On list_dev: Close
[0m08:48:47.836269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m08:48:47.836724 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m08:48:47.840996 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:48:47.841270 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m08:48:47.841515 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:48:47.851751 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m08:48:47.852521 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:48:47.852731 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m08:48:47.853151 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:48:47.853330 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:48:47.853580 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m08:48:47.853951 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:48:47.854365 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m08:48:47.854536 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:48:47.854777 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m08:48:47.855155 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:48:47.855325 [debug] [ThreadPool]: On create_dev_main: Close
[0m08:48:47.856786 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m08:48:47.860886 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m08:48:47.861090 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m08:48:47.861358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:48:47.871123 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m08:48:47.871399 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m08:48:47.871639 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m08:48:47.883882 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m08:48:47.884579 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m08:48:47.885119 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m08:48:47.885302 [debug] [ThreadPool]: On list_dev_main: Close
[0m08:48:47.887021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1e3264c-50c9-4e6c-9a29-01dc2a9835e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f2c13db010>]}
[0m08:48:47.887292 [debug] [MainThread]: Using duckdb connection "master"
[0m08:48:47.887528 [debug] [MainThread]: On master: BEGIN
[0m08:48:47.887785 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:48:47.897993 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m08:48:47.898264 [debug] [MainThread]: On master: COMMIT
[0m08:48:47.898497 [debug] [MainThread]: Using duckdb connection "master"
[0m08:48:47.898689 [debug] [MainThread]: On master: COMMIT
[0m08:48:47.899030 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:48:47.899266 [debug] [MainThread]: On master: Close
[0m08:48:47.900564 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:48:47.900886 [info ] [MainThread]: 
[0m08:48:47.902351 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m08:48:47.902864 [info ] [Thread-1 (]: 1 of 3 START sql view model main.clean ......................................... [RUN]
[0m08:48:47.903534 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.clean'
[0m08:48:47.903915 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m08:48:47.912263 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m08:48:47.914405 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m08:48:47.934181 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m08:48:47.935733 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:48:47.935948 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m08:48:47.936196 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:48:47.946696 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:48:47.946932 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:48:47.947286 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT * FROM clean




CREATE VIEW vue_journaliere AS
SELECT 
    Date, 
    Région,
    SUM(COALESCE("Consommation (MW)", 0)) AS consommation_totale,
    SUM(COALESCE("Thermique (MW)", 0)) AS production_thermique_totale,
    SUM(COALESCE("Nucléaire (MW)", 0)) AS production_nucleaire_totale,
    SUM(COALESCE("Eolien (MW)", 0)) AS production_eolienne_totale,
    SUM(COALESCE("Solaire (MW)", 0)) AS production_solaire_totale,
    SUM(COALESCE("Hydraulique (MW)", 0)) AS production_hydraulique_totale,
    SUM(COALESCE("Bioénergies (MW)", 0)) AS production_bioenergies_totale,
    SUM(COALESCE("Pompage (MW)", 0)) AS pompage_total,
    SUM(COALESCE("Ech. physiques (MW)", 0)) AS echanges_physiques_totaux,
    SUM(COALESCE("Stockage batterie", 0)) AS stockage_batterie_total,
    SUM(COALESCE("Déstockage batterie", 0)) AS destockage_batterie_total,
    SUM(COALESCE("Eolien terrestre", 0)) AS production_eolien_terrestre_totale,
    SUM(COALESCE("Eolien offshore", 0)) AS production_eolien_offshore_totale,
    AVG(COALESCE("TCO Thermique (%)", 0)) AS tco_thermique_moyen,
    AVG(COALESCE("TCH Thermique (%)", 0)) AS tch_thermique_moyen,
    AVG(COALESCE("TCO Nucléaire (%)", 0)) AS tco_nucleaire_moyen,
    AVG(COALESCE("TCH Nucléaire (%)", 0)) AS tch_nucleaire_moyen,
    AVG(COALESCE("TCO Eolien (%)", 0)) AS tco_eolien_moyen,
    AVG(COALESCE("TCH Eolien (%)", 0)) AS tch_eolien_moyen,
    AVG(COALESCE("TCO Solaire (%)", 0)) AS tco_solaire_moyen,
    AVG(COALESCE("TCH Solaire (%)", 0)) AS tch_solaire_moyen,
    AVG(COALESCE("TCO Hydraulique (%)", 0)) AS tco_hydraulique_moyen,
    AVG(COALESCE("TCH Hydraulique (%)", 0)) AS tch_hydraulique_moyen,
    AVG(COALESCE("TCO Bioénergies (%)", 0)) AS tco_bioenergies_moyen,
    AVG(COALESCE("TCH Bioénergies (%)", 0)) AS tch_bioenergies_moyen,
    SUM(COALESCE("Column 30 Poduction_total", 0)) AS production_totale
FROM eco2
WHERE Région IS NOT NULL AND Date IS NOT NULL
GROUP BY Date, Région;
  );

[0m08:48:47.947744 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT * FROM clean




CREATE VIEW vue_journaliere AS
SELECT 
    Date, 
    Région,
    SUM(COALESCE("Consommation (MW)", 0)) AS consommation_totale,
    SUM(COALESCE("Thermique (MW)", 0)) AS production_thermique_totale,
    SUM(COALESCE("Nucléaire (MW)", 0)) AS production_nucleaire_totale,
    SUM(COALESCE("Eolien (MW)", 0)) AS production_eolienne_totale,
    SUM(COALESCE("Solaire (MW)", 0)) AS production_solaire_totale,
    SUM(COALESCE("Hydraulique (MW)", 0)) AS production_hydraulique_totale,
    SUM(COALESCE("Bioénergies (MW)", 0)) AS production_bioenergies_totale,
    SUM(COALESCE("Pompage (MW)", 0)) AS pompage_total,
    SUM(COALESCE("Ech. physiques (MW)", 0)) AS echanges_physiques_totaux,
    SUM(COALESCE("Stockage batterie", 0)) AS stockage_batterie_total,
    SUM(COALESCE("Déstockage batterie", 0)) AS destockage_batterie_total,
    SUM(COALESCE("Eolien terrestre", 0)) AS production_eolien_terrestre_totale,
    SUM(COALESCE("Eolien offshore", 0)) AS production_eolien_offshore_totale,
    AVG(COALESCE("TCO Thermique (%)", 0)) AS tco_thermique_moyen,
    AVG(COALESCE("TCH Thermique (%)", 0)) AS tch_thermique_moyen,
    AVG(COALESCE("TCO Nucléaire (%)", 0)) AS tco_nucleaire_moyen,
    AVG(COALESCE("TCH Nucléaire (%)", 0)) AS tch_nucleaire_moyen,
    AVG(COALESCE("TCO Eolien (%)", 0)) AS tco_eolien_moyen,
    AVG(COALESCE("TCH Eolien (%)", 0)) AS tch_eolien_moyen,
    AVG(COALESCE("TCO Solaire (%)", 0)) AS tco_solaire_moyen,
    AVG(COALESCE("TCH Solaire (%)", 0)) AS tch_solaire_moyen,
    AVG(COALESCE("TCO Hydraulique (%)", 0)) AS tco_hydraulique_moyen,
    AVG(COALESCE("TCH Hydraulique (%)", 0)) AS tch_hydraulique_moyen,
    AVG(COALESCE("TCO Bioénergies (%)", 0)) AS tco_bioenergies_moyen,
    AVG(COALESCE("TCH Bioénergies (%)", 0)) AS tch_bioenergies_moyen,
    SUM(COALESCE("Column 30 Poduction_total", 0)) AS production_totale
FROM eco2
WHERE Région IS NOT NULL AND Date IS NOT NULL
GROUP BY Date, Région;
  );

[0m08:48:47.947993 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:48:47.948307 [debug] [Thread-1 (]: On model.transform.clean: ROLLBACK
[0m08:48:47.950415 [debug] [Thread-1 (]: Failed to rollback 'model.transform.clean'
[0m08:48:47.950656 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m08:48:47.952170 [debug] [Thread-1 (]: Runtime Error in model clean (models/example/clean.sql)
  Parser Error: syntax error at or near "CREATE"
[0m08:48:47.953002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1e3264c-50c9-4e6c-9a29-01dc2a9835e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f2c04c1cc0>]}
[0m08:48:47.953375 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.clean ................................ [[31mERROR[0m in 0.05s]
[0m08:48:47.953700 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m08:48:47.953929 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m08:48:47.954675 [info ] [Thread-1 (]: 2 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m08:48:47.954930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.my_first_dbt_model)
[0m08:48:47.955158 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m08:48:47.956691 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m08:48:47.957575 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m08:48:47.967264 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m08:48:47.968175 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:48:47.968395 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m08:48:47.968594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:47.978464 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:48:47.978713 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:48:47.979026 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m08:48:47.979565 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:48:47.982871 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:48:47.983106 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m08:48:47.983578 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:48:47.985120 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:48:47.985330 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m08:48:47.985713 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:48:47.995693 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m08:48:47.995930 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:48:47.996201 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m08:48:47.997529 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:48:47.999965 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:48:48.000203 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m08:48:48.000765 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:48:48.002117 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m08:48:48.016143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1e3264c-50c9-4e6c-9a29-01dc2a9835e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f2b71303a0>]}
[0m08:48:48.016562 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m08:48:48.016885 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m08:48:48.017363 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m08:48:48.017614 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m08:48:48.017854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m08:48:48.018053 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m08:48:48.019983 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m08:48:48.020803 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m08:48:48.022627 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m08:48:48.023556 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:48:48.023781 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m08:48:48.023970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:48.033859 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:48:48.034137 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:48:48.034410 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m08:48:48.034877 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:48:48.036983 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:48:48.037313 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m08:48:48.037923 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:48:48.040327 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:48:48.040686 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m08:48:48.041184 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:48:48.042424 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m08:48:48.042714 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:48:48.042955 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m08:48:48.044176 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:48:48.045665 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:48:48.045913 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m08:48:48.046514 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:48:48.047232 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m08:48:48.059151 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1e3264c-50c9-4e6c-9a29-01dc2a9835e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f2b67a4dc0>]}
[0m08:48:48.059580 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m08:48:48.059905 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m08:48:48.060503 [debug] [MainThread]: Using duckdb connection "master"
[0m08:48:48.060716 [debug] [MainThread]: On master: BEGIN
[0m08:48:48.060895 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:48:48.072186 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m08:48:48.072633 [debug] [MainThread]: On master: COMMIT
[0m08:48:48.072980 [debug] [MainThread]: Using duckdb connection "master"
[0m08:48:48.073319 [debug] [MainThread]: On master: COMMIT
[0m08:48:48.073835 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:48:48.074249 [debug] [MainThread]: On master: Close
[0m08:48:48.076382 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:48:48.076945 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m08:48:48.077378 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m08:48:48.077901 [info ] [MainThread]: 
[0m08:48:48.078287 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m08:48:48.078773 [debug] [MainThread]: Command end result
[0m08:48:48.139338 [info ] [MainThread]: 
[0m08:48:48.139641 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:48:48.139920 [info ] [MainThread]: 
[0m08:48:48.140218 [error] [MainThread]:   Runtime Error in model clean (models/example/clean.sql)
  Parser Error: syntax error at or near "CREATE"
[0m08:48:48.140473 [info ] [MainThread]: 
[0m08:48:48.140722 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m08:48:48.141211 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0597484, "process_in_blocks": "8960", "process_kernel_time": 0.155544, "process_mem_max_rss": "139396", "process_out_blocks": "5792", "process_user_time": 1.311589}
[0m08:48:48.141580 [debug] [MainThread]: Command `dbt run` failed at 08:48:48.141498 after 1.06 seconds
[0m08:48:48.141827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f2c12f7d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f2c1224220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f2ba3623b0>]}
[0m08:48:48.142067 [debug] [MainThread]: Flushing usage events
[0m08:50:25.959542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7819b8e9fd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7819b7708d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7819b7708d90>]}


============================== 08:50:25.961641 | e5d32730-81e2-4ea9-b713-00d45715c12a ==============================
[0m08:50:25.961641 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:50:25.962184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:50:26.087119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5d32730-81e2-4ea9-b713-00d45715c12a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7819b88e4dc0>]}
[0m08:50:26.115158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5d32730-81e2-4ea9-b713-00d45715c12a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7819b824ed10>]}
[0m08:50:26.117692 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m08:50:26.158280 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m08:50:26.258916 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:50:26.259729 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:50:26.269345 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m08:50:26.288653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5d32730-81e2-4ea9-b713-00d45715c12a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7819b0d8cbe0>]}
[0m08:50:26.349395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5d32730-81e2-4ea9-b713-00d45715c12a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7819b0d8df90>]}
[0m08:50:26.349696 [info ] [MainThread]: Found 3 models, 4 data tests, 421 macros
[0m08:50:26.349925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5d32730-81e2-4ea9-b713-00d45715c12a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7819b0d8df00>]}
[0m08:50:26.350975 [info ] [MainThread]: 
[0m08:50:26.351313 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:50:26.354099 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m08:50:26.601749 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m08:50:26.602388 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m08:50:26.602882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:50:26.618202 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m08:50:26.619334 [debug] [ThreadPool]: On list_dev: Close
[0m08:50:26.621858 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m08:50:26.622257 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m08:50:26.626304 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:50:26.626518 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m08:50:26.626734 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:50:26.638736 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m08:50:26.640621 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:50:26.641207 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m08:50:26.641931 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:50:26.642422 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:50:26.642851 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m08:50:26.643509 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:50:26.644545 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m08:50:26.644931 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:50:26.645270 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m08:50:26.645973 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:50:26.646366 [debug] [ThreadPool]: On create_dev_main: Close
[0m08:50:26.648584 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m08:50:26.655979 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m08:50:26.656562 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m08:50:26.657058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:50:26.675616 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m08:50:26.676351 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m08:50:26.676917 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m08:50:26.693111 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m08:50:26.693818 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m08:50:26.694431 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m08:50:26.694626 [debug] [ThreadPool]: On list_dev_main: Close
[0m08:50:26.696355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5d32730-81e2-4ea9-b713-00d45715c12a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7819b8fe3010>]}
[0m08:50:26.696618 [debug] [MainThread]: Using duckdb connection "master"
[0m08:50:26.696792 [debug] [MainThread]: On master: BEGIN
[0m08:50:26.697026 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:50:26.707563 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m08:50:26.707873 [debug] [MainThread]: On master: COMMIT
[0m08:50:26.708142 [debug] [MainThread]: Using duckdb connection "master"
[0m08:50:26.708394 [debug] [MainThread]: On master: COMMIT
[0m08:50:26.708862 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:50:26.709389 [debug] [MainThread]: On master: Close
[0m08:50:26.711794 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:50:26.712416 [info ] [MainThread]: 
[0m08:50:26.714590 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m08:50:26.715666 [info ] [Thread-1 (]: 1 of 3 START sql view model main.clean ......................................... [RUN]
[0m08:50:26.716697 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.clean'
[0m08:50:26.717252 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m08:50:26.723741 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m08:50:26.725313 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m08:50:26.742189 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m08:50:26.743844 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:50:26.744064 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m08:50:26.744304 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:50:26.754576 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:50:26.754822 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:50:26.755189 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT * FROM clean




WITH vue_journaliere AS(

SELECT 
    Date, 
    Région,
    SUM(COALESCE("Consommation (MW)", 0)) AS consommation_totale,
    SUM(COALESCE("Thermique (MW)", 0)) AS production_thermique_totale,
    SUM(COALESCE("Nucléaire (MW)", 0)) AS production_nucleaire_totale,
    SUM(COALESCE("Eolien (MW)", 0)) AS production_eolienne_totale,
    SUM(COALESCE("Solaire (MW)", 0)) AS production_solaire_totale,
    SUM(COALESCE("Hydraulique (MW)", 0)) AS production_hydraulique_totale,
    SUM(COALESCE("Bioénergies (MW)", 0)) AS production_bioenergies_totale,
    SUM(COALESCE("Pompage (MW)", 0)) AS pompage_total,
    SUM(COALESCE("Ech. physiques (MW)", 0)) AS echanges_physiques_totaux,
    SUM(COALESCE("Stockage batterie", 0)) AS stockage_batterie_total,
    SUM(COALESCE("Déstockage batterie", 0)) AS destockage_batterie_total,
    SUM(COALESCE("Eolien terrestre", 0)) AS production_eolien_terrestre_totale,
    SUM(COALESCE("Eolien offshore", 0)) AS production_eolien_offshore_totale,
    AVG(COALESCE("TCO Thermique (%)", 0)) AS tco_thermique_moyen,
    AVG(COALESCE("TCH Thermique (%)", 0)) AS tch_thermique_moyen,
    AVG(COALESCE("TCO Nucléaire (%)", 0)) AS tco_nucleaire_moyen,
    AVG(COALESCE("TCH Nucléaire (%)", 0)) AS tch_nucleaire_moyen,
    AVG(COALESCE("TCO Eolien (%)", 0)) AS tco_eolien_moyen,
    AVG(COALESCE("TCH Eolien (%)", 0)) AS tch_eolien_moyen,
    AVG(COALESCE("TCO Solaire (%)", 0)) AS tco_solaire_moyen,
    AVG(COALESCE("TCH Solaire (%)", 0)) AS tch_solaire_moyen,
    AVG(COALESCE("TCO Hydraulique (%)", 0)) AS tco_hydraulique_moyen,
    AVG(COALESCE("TCH Hydraulique (%)", 0)) AS tch_hydraulique_moyen,
    AVG(COALESCE("TCO Bioénergies (%)", 0)) AS tco_bioenergies_moyen,
    AVG(COALESCE("TCH Bioénergies (%)", 0)) AS tch_bioenergies_moyen,
    SUM(COALESCE("Column 30 Poduction_total", 0)) AS production_totale
FROM eco2
WHERE Région IS NOT NULL AND Date IS NOT NULL
GROUP BY Date, Région;)
SELECT * FROM vue_journaliere
  );

[0m08:50:26.755631 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT * FROM clean




WITH vue_journaliere AS(

SELECT 
    Date, 
    Région,
    SUM(COALESCE("Consommation (MW)", 0)) AS consommation_totale,
    SUM(COALESCE("Thermique (MW)", 0)) AS production_thermique_totale,
    SUM(COALESCE("Nucléaire (MW)", 0)) AS production_nucleaire_totale,
    SUM(COALESCE("Eolien (MW)", 0)) AS production_eolienne_totale,
    SUM(COALESCE("Solaire (MW)", 0)) AS production_solaire_totale,
    SUM(COALESCE("Hydraulique (MW)", 0)) AS production_hydraulique_totale,
    SUM(COALESCE("Bioénergies (MW)", 0)) AS production_bioenergies_totale,
    SUM(COALESCE("Pompage (MW)", 0)) AS pompage_total,
    SUM(COALESCE("Ech. physiques (MW)", 0)) AS echanges_physiques_totaux,
    SUM(COALESCE("Stockage batterie", 0)) AS stockage_batterie_total,
    SUM(COALESCE("Déstockage batterie", 0)) AS destockage_batterie_total,
    SUM(COALESCE("Eolien terrestre", 0)) AS production_eolien_terrestre_totale,
    SUM(COALESCE("Eolien offshore", 0)) AS production_eolien_offshore_totale,
    AVG(COALESCE("TCO Thermique (%)", 0)) AS tco_thermique_moyen,
    AVG(COALESCE("TCH Thermique (%)", 0)) AS tch_thermique_moyen,
    AVG(COALESCE("TCO Nucléaire (%)", 0)) AS tco_nucleaire_moyen,
    AVG(COALESCE("TCH Nucléaire (%)", 0)) AS tch_nucleaire_moyen,
    AVG(COALESCE("TCO Eolien (%)", 0)) AS tco_eolien_moyen,
    AVG(COALESCE("TCH Eolien (%)", 0)) AS tch_eolien_moyen,
    AVG(COALESCE("TCO Solaire (%)", 0)) AS tco_solaire_moyen,
    AVG(COALESCE("TCH Solaire (%)", 0)) AS tch_solaire_moyen,
    AVG(COALESCE("TCO Hydraulique (%)", 0)) AS tco_hydraulique_moyen,
    AVG(COALESCE("TCH Hydraulique (%)", 0)) AS tch_hydraulique_moyen,
    AVG(COALESCE("TCO Bioénergies (%)", 0)) AS tco_bioenergies_moyen,
    AVG(COALESCE("TCH Bioénergies (%)", 0)) AS tch_bioenergies_moyen,
    SUM(COALESCE("Column 30 Poduction_total", 0)) AS production_totale
FROM eco2
WHERE Région IS NOT NULL AND Date IS NOT NULL
GROUP BY Date, Région;)
SELECT * FROM vue_journaliere
  );

[0m08:50:26.755885 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:50:26.756232 [debug] [Thread-1 (]: On model.transform.clean: ROLLBACK
[0m08:50:26.758261 [debug] [Thread-1 (]: Failed to rollback 'model.transform.clean'
[0m08:50:26.758468 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m08:50:26.759862 [debug] [Thread-1 (]: Runtime Error in model clean (models/example/clean.sql)
  Parser Error: syntax error at or near "WITH"
[0m08:50:26.760705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5d32730-81e2-4ea9-b713-00d45715c12a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7819b8235cc0>]}
[0m08:50:26.761077 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.clean ................................ [[31mERROR[0m in 0.04s]
[0m08:50:26.761398 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m08:50:26.761626 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m08:50:26.762305 [info ] [Thread-1 (]: 2 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m08:50:26.762553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.my_first_dbt_model)
[0m08:50:26.762757 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m08:50:26.764327 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m08:50:26.765176 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m08:50:26.774796 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m08:50:26.775741 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:50:26.775954 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m08:50:26.776206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:50:26.786200 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:50:26.786464 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:50:26.786767 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m08:50:26.787430 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:50:26.790696 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:50:26.790931 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m08:50:26.791499 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:50:26.793025 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:50:26.793236 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m08:50:26.793699 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:50:26.803656 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m08:50:26.803884 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:50:26.804179 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m08:50:26.805452 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:50:26.807912 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:50:26.808148 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m08:50:26.808892 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:50:26.810314 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m08:50:26.824279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5d32730-81e2-4ea9-b713-00d45715c12a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7819ae5783a0>]}
[0m08:50:26.824684 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m08:50:26.824996 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m08:50:26.825558 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m08:50:26.825801 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m08:50:26.826042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m08:50:26.826270 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m08:50:26.828350 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m08:50:26.829275 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m08:50:26.831106 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m08:50:26.832009 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:50:26.832212 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m08:50:26.832476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:50:26.842743 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:50:26.842981 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:50:26.843240 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m08:50:26.843701 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:50:26.845293 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:50:26.845521 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m08:50:26.846001 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:50:26.847426 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:50:26.847638 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m08:50:26.848034 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:50:26.848858 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m08:50:26.849063 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:50:26.849280 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m08:50:26.850507 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:50:26.851688 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:50:26.851891 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m08:50:26.852540 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:50:26.853199 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m08:50:26.864761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5d32730-81e2-4ea9-b713-00d45715c12a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7819ad168dc0>]}
[0m08:50:26.865180 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m08:50:26.865500 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m08:50:26.866082 [debug] [MainThread]: Using duckdb connection "master"
[0m08:50:26.866298 [debug] [MainThread]: On master: BEGIN
[0m08:50:26.866555 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:50:26.877293 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m08:50:26.877605 [debug] [MainThread]: On master: COMMIT
[0m08:50:26.877877 [debug] [MainThread]: Using duckdb connection "master"
[0m08:50:26.878173 [debug] [MainThread]: On master: COMMIT
[0m08:50:26.878658 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:50:26.878988 [debug] [MainThread]: On master: Close
[0m08:50:26.880628 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:50:26.881005 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m08:50:26.881327 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m08:50:26.881732 [info ] [MainThread]: 
[0m08:50:26.882110 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m08:50:26.883028 [debug] [MainThread]: Command end result
[0m08:50:26.926523 [info ] [MainThread]: 
[0m08:50:26.926817 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:50:26.927073 [info ] [MainThread]: 
[0m08:50:26.927395 [error] [MainThread]:   Runtime Error in model clean (models/example/clean.sql)
  Parser Error: syntax error at or near "WITH"
[0m08:50:26.927632 [info ] [MainThread]: 
[0m08:50:26.927939 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m08:50:26.928436 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9959496, "process_in_blocks": "8992", "process_kernel_time": 0.145439, "process_mem_max_rss": "139964", "process_out_blocks": "5800", "process_user_time": 1.251385}
[0m08:50:26.928729 [debug] [MainThread]: Command `dbt run` failed at 08:50:26.928679 after 1.00 seconds
[0m08:50:26.928943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7819b8e9fd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7819b8dc8220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7819b0d163b0>]}
[0m08:50:26.929160 [debug] [MainThread]: Flushing usage events
[0m08:50:37.948067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7356518f3ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735651ccf2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735651ccf250>]}


============================== 08:50:37.950768 | ca975610-1941-4b75-9809-7252eac7ef7e ==============================
[0m08:50:37.950768 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:50:37.951253 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'debug': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:50:38.066157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca975610-1941-4b75-9809-7252eac7ef7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735651c67730>]}
[0m08:50:38.096027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca975610-1941-4b75-9809-7252eac7ef7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735650ad9ae0>]}
[0m08:50:38.098181 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m08:50:38.139942 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m08:50:38.244110 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:50:38.245069 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:50:38.255301 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m08:50:38.275278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca975610-1941-4b75-9809-7252eac7ef7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73564a9d0b80>]}
[0m08:50:38.331257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca975610-1941-4b75-9809-7252eac7ef7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73564a9d2050>]}
[0m08:50:38.331556 [info ] [MainThread]: Found 3 models, 4 data tests, 421 macros
[0m08:50:38.331752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca975610-1941-4b75-9809-7252eac7ef7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73564a9d2020>]}
[0m08:50:38.332745 [info ] [MainThread]: 
[0m08:50:38.333161 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:50:38.336053 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m08:50:38.479991 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m08:50:38.480871 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m08:50:38.481524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:50:38.501619 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m08:50:38.504339 [debug] [ThreadPool]: On list_dev: Close
[0m08:50:38.509311 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m08:50:38.510396 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m08:50:38.522112 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:50:38.522619 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m08:50:38.522971 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:50:38.535930 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m08:50:38.537100 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:50:38.537420 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m08:50:38.537953 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:50:38.538209 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:50:38.538459 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m08:50:38.538846 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:50:38.539450 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m08:50:38.539654 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:50:38.539902 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m08:50:38.540236 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:50:38.540432 [debug] [ThreadPool]: On create_dev_main: Close
[0m08:50:38.541986 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m08:50:38.545733 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m08:50:38.546021 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m08:50:38.546271 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:50:38.560227 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m08:50:38.561034 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m08:50:38.561763 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m08:50:38.583628 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m08:50:38.584339 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m08:50:38.584917 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m08:50:38.585116 [debug] [ThreadPool]: On list_dev_main: Close
[0m08:50:38.587105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca975610-1941-4b75-9809-7252eac7ef7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73564fd50820>]}
[0m08:50:38.587365 [debug] [MainThread]: Using duckdb connection "master"
[0m08:50:38.587539 [debug] [MainThread]: On master: BEGIN
[0m08:50:38.587708 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:50:38.598017 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m08:50:38.598297 [debug] [MainThread]: On master: COMMIT
[0m08:50:38.598537 [debug] [MainThread]: Using duckdb connection "master"
[0m08:50:38.598735 [debug] [MainThread]: On master: COMMIT
[0m08:50:38.599019 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:50:38.599241 [debug] [MainThread]: On master: Close
[0m08:50:38.600377 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:50:38.600610 [info ] [MainThread]: 
[0m08:50:38.601878 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m08:50:38.602204 [info ] [Thread-1 (]: 1 of 3 START sql view model main.clean ......................................... [RUN]
[0m08:50:38.602584 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.clean'
[0m08:50:38.602792 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m08:50:38.606540 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m08:50:38.607444 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m08:50:38.624078 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m08:50:38.625053 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:50:38.625274 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m08:50:38.625502 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:50:38.635645 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:50:38.635882 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:50:38.636193 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT * FROM clean;




WITH vue_journaliere AS(

SELECT 
    Date, 
    Région,
    SUM(COALESCE("Consommation (MW)", 0)) AS consommation_totale,
    SUM(COALESCE("Thermique (MW)", 0)) AS production_thermique_totale,
    SUM(COALESCE("Nucléaire (MW)", 0)) AS production_nucleaire_totale,
    SUM(COALESCE("Eolien (MW)", 0)) AS production_eolienne_totale,
    SUM(COALESCE("Solaire (MW)", 0)) AS production_solaire_totale,
    SUM(COALESCE("Hydraulique (MW)", 0)) AS production_hydraulique_totale,
    SUM(COALESCE("Bioénergies (MW)", 0)) AS production_bioenergies_totale,
    SUM(COALESCE("Pompage (MW)", 0)) AS pompage_total,
    SUM(COALESCE("Ech. physiques (MW)", 0)) AS echanges_physiques_totaux,
    SUM(COALESCE("Stockage batterie", 0)) AS stockage_batterie_total,
    SUM(COALESCE("Déstockage batterie", 0)) AS destockage_batterie_total,
    SUM(COALESCE("Eolien terrestre", 0)) AS production_eolien_terrestre_totale,
    SUM(COALESCE("Eolien offshore", 0)) AS production_eolien_offshore_totale,
    AVG(COALESCE("TCO Thermique (%)", 0)) AS tco_thermique_moyen,
    AVG(COALESCE("TCH Thermique (%)", 0)) AS tch_thermique_moyen,
    AVG(COALESCE("TCO Nucléaire (%)", 0)) AS tco_nucleaire_moyen,
    AVG(COALESCE("TCH Nucléaire (%)", 0)) AS tch_nucleaire_moyen,
    AVG(COALESCE("TCO Eolien (%)", 0)) AS tco_eolien_moyen,
    AVG(COALESCE("TCH Eolien (%)", 0)) AS tch_eolien_moyen,
    AVG(COALESCE("TCO Solaire (%)", 0)) AS tco_solaire_moyen,
    AVG(COALESCE("TCH Solaire (%)", 0)) AS tch_solaire_moyen,
    AVG(COALESCE("TCO Hydraulique (%)", 0)) AS tco_hydraulique_moyen,
    AVG(COALESCE("TCH Hydraulique (%)", 0)) AS tch_hydraulique_moyen,
    AVG(COALESCE("TCO Bioénergies (%)", 0)) AS tco_bioenergies_moyen,
    AVG(COALESCE("TCH Bioénergies (%)", 0)) AS tch_bioenergies_moyen,
    SUM(COALESCE("Column 30 Poduction_total", 0)) AS production_totale
FROM eco2
WHERE Région IS NOT NULL AND Date IS NOT NULL
GROUP BY Date, Région;)
SELECT * FROM vue_journaliere
  );

[0m08:50:38.636639 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT * FROM clean;




WITH vue_journaliere AS(

SELECT 
    Date, 
    Région,
    SUM(COALESCE("Consommation (MW)", 0)) AS consommation_totale,
    SUM(COALESCE("Thermique (MW)", 0)) AS production_thermique_totale,
    SUM(COALESCE("Nucléaire (MW)", 0)) AS production_nucleaire_totale,
    SUM(COALESCE("Eolien (MW)", 0)) AS production_eolienne_totale,
    SUM(COALESCE("Solaire (MW)", 0)) AS production_solaire_totale,
    SUM(COALESCE("Hydraulique (MW)", 0)) AS production_hydraulique_totale,
    SUM(COALESCE("Bioénergies (MW)", 0)) AS production_bioenergies_totale,
    SUM(COALESCE("Pompage (MW)", 0)) AS pompage_total,
    SUM(COALESCE("Ech. physiques (MW)", 0)) AS echanges_physiques_totaux,
    SUM(COALESCE("Stockage batterie", 0)) AS stockage_batterie_total,
    SUM(COALESCE("Déstockage batterie", 0)) AS destockage_batterie_total,
    SUM(COALESCE("Eolien terrestre", 0)) AS production_eolien_terrestre_totale,
    SUM(COALESCE("Eolien offshore", 0)) AS production_eolien_offshore_totale,
    AVG(COALESCE("TCO Thermique (%)", 0)) AS tco_thermique_moyen,
    AVG(COALESCE("TCH Thermique (%)", 0)) AS tch_thermique_moyen,
    AVG(COALESCE("TCO Nucléaire (%)", 0)) AS tco_nucleaire_moyen,
    AVG(COALESCE("TCH Nucléaire (%)", 0)) AS tch_nucleaire_moyen,
    AVG(COALESCE("TCO Eolien (%)", 0)) AS tco_eolien_moyen,
    AVG(COALESCE("TCH Eolien (%)", 0)) AS tch_eolien_moyen,
    AVG(COALESCE("TCO Solaire (%)", 0)) AS tco_solaire_moyen,
    AVG(COALESCE("TCH Solaire (%)", 0)) AS tch_solaire_moyen,
    AVG(COALESCE("TCO Hydraulique (%)", 0)) AS tco_hydraulique_moyen,
    AVG(COALESCE("TCH Hydraulique (%)", 0)) AS tch_hydraulique_moyen,
    AVG(COALESCE("TCO Bioénergies (%)", 0)) AS tco_bioenergies_moyen,
    AVG(COALESCE("TCH Bioénergies (%)", 0)) AS tch_bioenergies_moyen,
    SUM(COALESCE("Column 30 Poduction_total", 0)) AS production_totale
FROM eco2
WHERE Région IS NOT NULL AND Date IS NOT NULL
GROUP BY Date, Région;)
SELECT * FROM vue_journaliere
  );

[0m08:50:38.636888 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:50:38.637207 [debug] [Thread-1 (]: On model.transform.clean: ROLLBACK
[0m08:50:38.639318 [debug] [Thread-1 (]: Failed to rollback 'model.transform.clean'
[0m08:50:38.639533 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m08:50:38.640871 [debug] [Thread-1 (]: Runtime Error in model clean (models/example/clean.sql)
  Parser Error: syntax error at or near ";"
[0m08:50:38.641701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca975610-1941-4b75-9809-7252eac7ef7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735650cb9c60>]}
[0m08:50:38.642074 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.clean ................................ [[31mERROR[0m in 0.04s]
[0m08:50:38.642402 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m08:50:38.642628 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m08:50:38.642876 [info ] [Thread-1 (]: 2 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m08:50:38.643552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.my_first_dbt_model)
[0m08:50:38.643742 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m08:50:38.645187 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m08:50:38.645998 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m08:50:38.655956 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m08:50:38.656937 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:50:38.657168 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m08:50:38.657374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:50:38.667305 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:50:38.667542 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:50:38.667853 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m08:50:38.668485 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:50:38.671757 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:50:38.671985 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m08:50:38.672452 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:50:38.673986 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:50:38.674201 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m08:50:38.674661 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:50:38.684685 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m08:50:38.684936 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:50:38.685242 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m08:50:38.686545 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:50:38.689026 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:50:38.689259 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m08:50:38.689874 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:50:38.691252 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m08:50:38.705713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca975610-1941-4b75-9809-7252eac7ef7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73564772d8a0>]}
[0m08:50:38.706158 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m08:50:38.706484 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m08:50:38.706936 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m08:50:38.707204 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m08:50:38.707453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m08:50:38.707649 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m08:50:38.709741 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m08:50:38.710680 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m08:50:38.713053 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m08:50:38.713996 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:50:38.714223 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m08:50:38.714470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:50:38.724978 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:50:38.725306 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:50:38.725648 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m08:50:38.726143 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:50:38.727889 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:50:38.728105 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m08:50:38.728598 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:50:38.730071 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:50:38.730286 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m08:50:38.730668 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:50:38.731500 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m08:50:38.731706 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:50:38.731962 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m08:50:38.733277 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:50:38.734504 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:50:38.734712 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m08:50:38.735457 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:50:38.736112 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m08:50:38.747877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca975610-1941-4b75-9809-7252eac7ef7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735646da0eb0>]}
[0m08:50:38.748280 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m08:50:38.748600 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m08:50:38.749213 [debug] [MainThread]: Using duckdb connection "master"
[0m08:50:38.749436 [debug] [MainThread]: On master: BEGIN
[0m08:50:38.749629 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:50:38.761556 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m08:50:38.762028 [debug] [MainThread]: On master: COMMIT
[0m08:50:38.762375 [debug] [MainThread]: Using duckdb connection "master"
[0m08:50:38.762683 [debug] [MainThread]: On master: COMMIT
[0m08:50:38.763135 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:50:38.763454 [debug] [MainThread]: On master: Close
[0m08:50:38.765047 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:50:38.765371 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m08:50:38.765616 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m08:50:38.765965 [info ] [MainThread]: 
[0m08:50:38.766240 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m08:50:38.767006 [debug] [MainThread]: Command end result
[0m08:50:38.809721 [info ] [MainThread]: 
[0m08:50:38.810033 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:50:38.810262 [info ] [MainThread]: 
[0m08:50:38.810566 [error] [MainThread]:   Runtime Error in model clean (models/example/clean.sql)
  Parser Error: syntax error at or near ";"
[0m08:50:38.810755 [info ] [MainThread]: 
[0m08:50:38.811015 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m08:50:38.811513 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.89054066, "process_in_blocks": "8960", "process_kernel_time": 0.138433, "process_mem_max_rss": "141072", "process_out_blocks": "5792", "process_user_time": 1.191333}
[0m08:50:38.811823 [debug] [MainThread]: Command `dbt run` failed at 08:50:38.811771 after 0.89 seconds
[0m08:50:38.812029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7356518f3ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73564a95dfc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735651767310>]}
[0m08:50:38.812273 [debug] [MainThread]: Flushing usage events
[0m08:52:33.126984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78040788bd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780406103310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7804061032b0>]}


============================== 08:52:33.129910 | 16ec74d9-375e-45a0-813b-5e5d6fd66352 ==============================
[0m08:52:33.129910 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:52:33.130442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'fail_fast': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:52:33.263119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16ec74d9-375e-45a0-813b-5e5d6fd66352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780407316ce0>]}
[0m08:52:33.291009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16ec74d9-375e-45a0-813b-5e5d6fd66352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780406220af0>]}
[0m08:52:33.293457 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m08:52:33.333408 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m08:52:33.432401 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m08:52:33.433185 [debug] [MainThread]: Partial parsing: added file: transform://models/example/grain_jour.sql
[0m08:52:33.433655 [debug] [MainThread]: Partial parsing: deleted file: transform://models/grain_jour.sql
[0m08:52:33.563173 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m08:52:33.566019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16ec74d9-375e-45a0-813b-5e5d6fd66352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7803fedc4130>]}
[0m08:52:33.627259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16ec74d9-375e-45a0-813b-5e5d6fd66352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7803ff712c50>]}
[0m08:52:33.627670 [info ] [MainThread]: Found 4 models, 4 data tests, 421 macros
[0m08:52:33.627998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16ec74d9-375e-45a0-813b-5e5d6fd66352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7803ff712ef0>]}
[0m08:52:33.629383 [info ] [MainThread]: 
[0m08:52:33.629893 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:52:33.635679 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m08:52:33.901188 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m08:52:33.902044 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m08:52:33.902705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:33.922320 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m08:52:33.923618 [debug] [ThreadPool]: On list_dev: Close
[0m08:52:33.926018 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m08:52:33.926420 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m08:52:33.930481 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:52:33.930698 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m08:52:33.930999 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:33.941042 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m08:52:33.941749 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:52:33.941938 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m08:52:33.942289 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:52:33.942459 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:52:33.942651 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m08:52:33.942935 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:52:33.943357 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m08:52:33.943531 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:52:33.943728 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m08:52:33.944005 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:52:33.944180 [debug] [ThreadPool]: On create_dev_main: Close
[0m08:52:33.945601 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m08:52:33.949161 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m08:52:33.949380 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m08:52:33.949612 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:33.961292 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m08:52:33.961856 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m08:52:33.962347 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m08:52:33.979966 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m08:52:33.980738 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m08:52:33.981402 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m08:52:33.981597 [debug] [ThreadPool]: On list_dev_main: Close
[0m08:52:33.983496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16ec74d9-375e-45a0-813b-5e5d6fd66352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7804079cf940>]}
[0m08:52:33.983748 [debug] [MainThread]: Using duckdb connection "master"
[0m08:52:33.983917 [debug] [MainThread]: On master: BEGIN
[0m08:52:33.984164 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:33.994510 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m08:52:33.994780 [debug] [MainThread]: On master: COMMIT
[0m08:52:33.995078 [debug] [MainThread]: Using duckdb connection "master"
[0m08:52:33.995346 [debug] [MainThread]: On master: COMMIT
[0m08:52:33.995727 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:52:33.995978 [debug] [MainThread]: On master: Close
[0m08:52:33.997570 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:52:33.997906 [info ] [MainThread]: 
[0m08:52:33.999540 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m08:52:34.000499 [info ] [Thread-1 (]: 1 of 4 START sql view model main.clean ......................................... [RUN]
[0m08:52:34.001741 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.clean'
[0m08:52:34.002491 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m08:52:34.013918 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m08:52:34.015525 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m08:52:34.039806 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m08:52:34.041822 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:52:34.042154 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m08:52:34.042445 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:52:34.058261 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m08:52:34.058900 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:52:34.059459 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT * FROM clean
  );

[0m08:52:34.061058 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:52:34.068133 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:52:34.068672 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m08:52:34.069641 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:52:34.072236 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:52:34.072572 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m08:52:34.073123 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:34.082063 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m08:52:34.082304 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:52:34.082619 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m08:52:34.083992 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:52:34.109609 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:52:34.109909 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m08:52:34.111174 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:52:34.112608 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m08:52:34.124970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16ec74d9-375e-45a0-813b-5e5d6fd66352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780408556fb0>]}
[0m08:52:34.125365 [info ] [Thread-1 (]: 1 of 4 OK created sql view model main.clean .................................... [[32mOK[0m in 0.12s]
[0m08:52:34.125697 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m08:52:34.125933 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m08:52:34.126252 [info ] [Thread-1 (]: 2 of 4 START sql view model main.grain_jour .................................... [RUN]
[0m08:52:34.126504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m08:52:34.126742 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m08:52:34.127845 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m08:52:34.128951 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m08:52:34.130747 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m08:52:34.135005 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m08:52:34.135224 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m08:52:34.135427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:34.145288 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:52:34.145520 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m08:52:34.145851 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH vue_journaliere AS(

SELECT 
    Date, 
    Région,
    SUM(COALESCE("Consommation (MW)", 0)) AS consommation_totale,
    SUM(COALESCE("Thermique (MW)", 0)) AS production_thermique_totale,
    SUM(COALESCE("Nucléaire (MW)", 0)) AS production_nucleaire_totale,
    SUM(COALESCE("Eolien (MW)", 0)) AS production_eolienne_totale,
    SUM(COALESCE("Solaire (MW)", 0)) AS production_solaire_totale,
    SUM(COALESCE("Hydraulique (MW)", 0)) AS production_hydraulique_totale,
    SUM(COALESCE("Bioénergies (MW)", 0)) AS production_bioenergies_totale,
    SUM(COALESCE("Pompage (MW)", 0)) AS pompage_total,
    SUM(COALESCE("Ech. physiques (MW)", 0)) AS echanges_physiques_totaux,
    SUM(COALESCE("Stockage batterie", 0)) AS stockage_batterie_total,
    SUM(COALESCE("Déstockage batterie", 0)) AS destockage_batterie_total,
    SUM(COALESCE("Eolien terrestre", 0)) AS production_eolien_terrestre_totale,
    SUM(COALESCE("Eolien offshore", 0)) AS production_eolien_offshore_totale,
    AVG(COALESCE("TCO Thermique (%)", 0)) AS tco_thermique_moyen,
    AVG(COALESCE("TCH Thermique (%)", 0)) AS tch_thermique_moyen,
    AVG(COALESCE("TCO Nucléaire (%)", 0)) AS tco_nucleaire_moyen,
    AVG(COALESCE("TCH Nucléaire (%)", 0)) AS tch_nucleaire_moyen,
    AVG(COALESCE("TCO Eolien (%)", 0)) AS tco_eolien_moyen,
    AVG(COALESCE("TCH Eolien (%)", 0)) AS tch_eolien_moyen,
    AVG(COALESCE("TCO Solaire (%)", 0)) AS tco_solaire_moyen,
    AVG(COALESCE("TCH Solaire (%)", 0)) AS tch_solaire_moyen,
    AVG(COALESCE("TCO Hydraulique (%)", 0)) AS tco_hydraulique_moyen,
    AVG(COALESCE("TCH Hydraulique (%)", 0)) AS tch_hydraulique_moyen,
    AVG(COALESCE("TCO Bioénergies (%)", 0)) AS tco_bioenergies_moyen,
    AVG(COALESCE("TCH Bioénergies (%)", 0)) AS tch_bioenergies_moyen,
    SUM(COALESCE("Column 30 Poduction_total", 0)) AS production_totale
FROM eco2
WHERE Région IS NOT NULL AND Date IS NOT NULL
GROUP BY Date, Région;)
SELECT * FROM vue_journaliere
  );

[0m08:52:34.146302 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH vue_journaliere AS(

SELECT 
    Date, 
    Région,
    SUM(COALESCE("Consommation (MW)", 0)) AS consommation_totale,
    SUM(COALESCE("Thermique (MW)", 0)) AS production_thermique_totale,
    SUM(COALESCE("Nucléaire (MW)", 0)) AS production_nucleaire_totale,
    SUM(COALESCE("Eolien (MW)", 0)) AS production_eolienne_totale,
    SUM(COALESCE("Solaire (MW)", 0)) AS production_solaire_totale,
    SUM(COALESCE("Hydraulique (MW)", 0)) AS production_hydraulique_totale,
    SUM(COALESCE("Bioénergies (MW)", 0)) AS production_bioenergies_totale,
    SUM(COALESCE("Pompage (MW)", 0)) AS pompage_total,
    SUM(COALESCE("Ech. physiques (MW)", 0)) AS echanges_physiques_totaux,
    SUM(COALESCE("Stockage batterie", 0)) AS stockage_batterie_total,
    SUM(COALESCE("Déstockage batterie", 0)) AS destockage_batterie_total,
    SUM(COALESCE("Eolien terrestre", 0)) AS production_eolien_terrestre_totale,
    SUM(COALESCE("Eolien offshore", 0)) AS production_eolien_offshore_totale,
    AVG(COALESCE("TCO Thermique (%)", 0)) AS tco_thermique_moyen,
    AVG(COALESCE("TCH Thermique (%)", 0)) AS tch_thermique_moyen,
    AVG(COALESCE("TCO Nucléaire (%)", 0)) AS tco_nucleaire_moyen,
    AVG(COALESCE("TCH Nucléaire (%)", 0)) AS tch_nucleaire_moyen,
    AVG(COALESCE("TCO Eolien (%)", 0)) AS tco_eolien_moyen,
    AVG(COALESCE("TCH Eolien (%)", 0)) AS tch_eolien_moyen,
    AVG(COALESCE("TCO Solaire (%)", 0)) AS tco_solaire_moyen,
    AVG(COALESCE("TCH Solaire (%)", 0)) AS tch_solaire_moyen,
    AVG(COALESCE("TCO Hydraulique (%)", 0)) AS tco_hydraulique_moyen,
    AVG(COALESCE("TCH Hydraulique (%)", 0)) AS tch_hydraulique_moyen,
    AVG(COALESCE("TCO Bioénergies (%)", 0)) AS tco_bioenergies_moyen,
    AVG(COALESCE("TCH Bioénergies (%)", 0)) AS tch_bioenergies_moyen,
    SUM(COALESCE("Column 30 Poduction_total", 0)) AS production_totale
FROM eco2
WHERE Région IS NOT NULL AND Date IS NOT NULL
GROUP BY Date, Région;)
SELECT * FROM vue_journaliere
  );

[0m08:52:34.146539 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:52:34.146880 [debug] [Thread-1 (]: On model.transform.grain_jour: ROLLBACK
[0m08:52:34.149081 [debug] [Thread-1 (]: Failed to rollback 'model.transform.grain_jour'
[0m08:52:34.149329 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m08:52:34.150944 [debug] [Thread-1 (]: Runtime Error in model grain_jour (models/example/grain_jour.sql)
  Parser Error: syntax error at or near ";"
[0m08:52:34.151224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16ec74d9-375e-45a0-813b-5e5d6fd66352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7803fe332500>]}
[0m08:52:34.151579 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model main.grain_jour ........................... [[31mERROR[0m in 0.02s]
[0m08:52:34.151897 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m08:52:34.152117 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m08:52:34.152902 [info ] [Thread-1 (]: 3 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m08:52:34.153149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m08:52:34.153362 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m08:52:34.155037 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m08:52:34.156005 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m08:52:34.167588 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m08:52:34.168595 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:52:34.168809 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m08:52:34.169066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:34.178976 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:52:34.179220 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:52:34.179554 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m08:52:34.180241 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:34.181820 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:52:34.182045 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m08:52:34.182537 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:34.184646 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:52:34.184879 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m08:52:34.185291 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:34.187986 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m08:52:34.188219 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:52:34.188519 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m08:52:34.189802 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:52:34.191009 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:52:34.191221 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m08:52:34.191853 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:34.192536 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m08:52:34.207208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16ec74d9-375e-45a0-813b-5e5d6fd66352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7803ff712ef0>]}
[0m08:52:34.207900 [info ] [Thread-1 (]: 3 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m08:52:34.208513 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m08:52:34.209258 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m08:52:34.209706 [info ] [Thread-1 (]: 4 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m08:52:34.210136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m08:52:34.210463 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m08:52:34.211973 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m08:52:34.212888 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m08:52:34.214769 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m08:52:34.215645 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:52:34.215851 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m08:52:34.216107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:34.226113 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:52:34.226358 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:52:34.226657 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m08:52:34.227145 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:34.228657 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:52:34.228871 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m08:52:34.229343 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:34.230771 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:52:34.230982 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m08:52:34.231399 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:34.232246 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m08:52:34.232456 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:52:34.232704 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m08:52:34.233794 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:52:34.235035 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:52:34.235252 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m08:52:34.235771 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:34.236430 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m08:52:34.247671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16ec74d9-375e-45a0-813b-5e5d6fd66352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7803ff76cfa0>]}
[0m08:52:34.248070 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m08:52:34.248388 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m08:52:34.249165 [debug] [MainThread]: Using duckdb connection "master"
[0m08:52:34.249521 [debug] [MainThread]: On master: BEGIN
[0m08:52:34.249821 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:34.261725 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m08:52:34.262108 [debug] [MainThread]: On master: COMMIT
[0m08:52:34.262453 [debug] [MainThread]: Using duckdb connection "master"
[0m08:52:34.262751 [debug] [MainThread]: On master: COMMIT
[0m08:52:34.263216 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:52:34.263542 [debug] [MainThread]: On master: Close
[0m08:52:34.265393 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:34.265857 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m08:52:34.266209 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m08:52:34.266681 [info ] [MainThread]: 
[0m08:52:34.267049 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m08:52:34.268057 [debug] [MainThread]: Command end result
[0m08:52:34.293441 [info ] [MainThread]: 
[0m08:52:34.293725 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:52:34.293969 [info ] [MainThread]: 
[0m08:52:34.294284 [error] [MainThread]:   Runtime Error in model grain_jour (models/example/grain_jour.sql)
  Parser Error: syntax error at or near ";"
[0m08:52:34.294500 [info ] [MainThread]: 
[0m08:52:34.294778 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m08:52:34.295293 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1958473, "process_in_blocks": "10080", "process_kernel_time": 0.187319, "process_mem_max_rss": "141972", "process_out_blocks": "7992", "process_user_time": 1.421655}
[0m08:52:34.295612 [debug] [MainThread]: Command `dbt run` failed at 08:52:34.295560 after 1.20 seconds
[0m08:52:34.295832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78040788bd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7803fb183010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7803fb180b50>]}
[0m08:52:34.296036 [debug] [MainThread]: Flushing usage events
[0m08:52:52.760526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76761d2ffd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76761d6d0cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76761d6d0d30>]}


============================== 08:52:52.763243 | 91f339c1-9075-43c2-a8e9-78430399d693 ==============================
[0m08:52:52.763243 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:52:52.763894 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m08:52:52.882085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91f339c1-9075-43c2-a8e9-78430399d693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76761d22d840>]}
[0m08:52:52.910043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91f339c1-9075-43c2-a8e9-78430399d693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76761c4ded10>]}
[0m08:52:52.912166 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m08:52:52.953549 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m08:52:53.070497 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:52:53.071598 [debug] [MainThread]: Partial parsing: updated file: transform://models/example/grain_jour.sql
[0m08:52:53.200334 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m08:52:53.203030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91f339c1-9075-43c2-a8e9-78430399d693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767614f2c040>]}
[0m08:52:53.257707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91f339c1-9075-43c2-a8e9-78430399d693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767616375f30>]}
[0m08:52:53.258023 [info ] [MainThread]: Found 4 models, 4 data tests, 421 macros
[0m08:52:53.258296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91f339c1-9075-43c2-a8e9-78430399d693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767616375f00>]}
[0m08:52:53.259264 [info ] [MainThread]: 
[0m08:52:53.259615 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:52:53.262551 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m08:52:53.398142 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m08:52:53.398777 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m08:52:53.399215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:53.420046 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m08:52:53.421812 [debug] [ThreadPool]: On list_dev: Close
[0m08:52:53.425444 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m08:52:53.425994 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m08:52:53.431057 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:52:53.431274 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m08:52:53.431560 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:53.441720 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m08:52:53.442493 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:52:53.442713 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m08:52:53.443041 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:52:53.443239 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:52:53.443470 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m08:52:53.443864 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:52:53.444293 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m08:52:53.444469 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:52:53.444719 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m08:52:53.445049 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:52:53.445244 [debug] [ThreadPool]: On create_dev_main: Close
[0m08:52:53.447497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m08:52:53.451489 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m08:52:53.451709 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m08:52:53.451930 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:53.462045 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m08:52:53.462385 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m08:52:53.462677 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m08:52:53.475801 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m08:52:53.476690 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m08:52:53.477263 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m08:52:53.477462 [debug] [ThreadPool]: On list_dev_main: Close
[0m08:52:53.479869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91f339c1-9075-43c2-a8e9-78430399d693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76761d3e3760>]}
[0m08:52:53.480246 [debug] [MainThread]: Using duckdb connection "master"
[0m08:52:53.480547 [debug] [MainThread]: On master: BEGIN
[0m08:52:53.480733 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:53.491135 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m08:52:53.491375 [debug] [MainThread]: On master: COMMIT
[0m08:52:53.491778 [debug] [MainThread]: Using duckdb connection "master"
[0m08:52:53.492077 [debug] [MainThread]: On master: COMMIT
[0m08:52:53.492452 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:52:53.492647 [debug] [MainThread]: On master: Close
[0m08:52:53.494006 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:52:53.494246 [info ] [MainThread]: 
[0m08:52:53.495496 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m08:52:53.496057 [info ] [Thread-1 (]: 1 of 4 START sql view model main.clean ......................................... [RUN]
[0m08:52:53.496579 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.clean'
[0m08:52:53.496799 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m08:52:53.500633 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m08:52:53.501633 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m08:52:53.517877 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m08:52:53.518880 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:52:53.519106 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m08:52:53.519342 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:52:53.529831 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:52:53.530087 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:52:53.530344 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT * FROM clean
  );

[0m08:52:53.531062 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:53.534471 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:52:53.534706 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m08:52:53.535152 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:53.536653 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:52:53.536867 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m08:52:53.537339 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:53.545607 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m08:52:53.545868 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:52:53.546105 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m08:52:53.547426 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:52:53.573152 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:52:53.573452 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m08:52:53.574398 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:52:53.575760 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m08:52:53.588301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91f339c1-9075-43c2-a8e9-78430399d693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76761e016fe0>]}
[0m08:52:53.588698 [info ] [Thread-1 (]: 1 of 4 OK created sql view model main.clean .................................... [[32mOK[0m in 0.09s]
[0m08:52:53.589013 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m08:52:53.589253 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m08:52:53.589562 [info ] [Thread-1 (]: 2 of 4 START sql view model main.grain_jour .................................... [RUN]
[0m08:52:53.589804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m08:52:53.590007 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m08:52:53.591073 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m08:52:53.592110 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m08:52:53.593887 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m08:52:53.594992 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m08:52:53.595301 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m08:52:53.595528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:53.607682 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m08:52:53.608107 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m08:52:53.608433 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH vue_journaliere AS(

SELECT 
    Date, 
    Région,
    SUM(COALESCE("Consommation (MW)", 0)) AS consommation_totale,
    SUM(COALESCE("Thermique (MW)", 0)) AS production_thermique_totale,
    SUM(COALESCE("Nucléaire (MW)", 0)) AS production_nucleaire_totale,
    SUM(COALESCE("Eolien (MW)", 0)) AS production_eolienne_totale,
    SUM(COALESCE("Solaire (MW)", 0)) AS production_solaire_totale,
    SUM(COALESCE("Hydraulique (MW)", 0)) AS production_hydraulique_totale,
    SUM(COALESCE("Bioénergies (MW)", 0)) AS production_bioenergies_totale,
    SUM(COALESCE("Pompage (MW)", 0)) AS pompage_total,
    SUM(COALESCE("Ech. physiques (MW)", 0)) AS echanges_physiques_totaux,
    SUM(COALESCE("Stockage batterie", 0)) AS stockage_batterie_total,
    SUM(COALESCE("Déstockage batterie", 0)) AS destockage_batterie_total,
    SUM(COALESCE("Eolien terrestre", 0)) AS production_eolien_terrestre_totale,
    SUM(COALESCE("Eolien offshore", 0)) AS production_eolien_offshore_totale,
    AVG(COALESCE("TCO Thermique (%)", 0)) AS tco_thermique_moyen,
    AVG(COALESCE("TCH Thermique (%)", 0)) AS tch_thermique_moyen,
    AVG(COALESCE("TCO Nucléaire (%)", 0)) AS tco_nucleaire_moyen,
    AVG(COALESCE("TCH Nucléaire (%)", 0)) AS tch_nucleaire_moyen,
    AVG(COALESCE("TCO Eolien (%)", 0)) AS tco_eolien_moyen,
    AVG(COALESCE("TCH Eolien (%)", 0)) AS tch_eolien_moyen,
    AVG(COALESCE("TCO Solaire (%)", 0)) AS tco_solaire_moyen,
    AVG(COALESCE("TCH Solaire (%)", 0)) AS tch_solaire_moyen,
    AVG(COALESCE("TCO Hydraulique (%)", 0)) AS tco_hydraulique_moyen,
    AVG(COALESCE("TCH Hydraulique (%)", 0)) AS tch_hydraulique_moyen,
    AVG(COALESCE("TCO Bioénergies (%)", 0)) AS tco_bioenergies_moyen,
    AVG(COALESCE("TCH Bioénergies (%)", 0)) AS tch_bioenergies_moyen,
    SUM(COALESCE("Column 30 Poduction_total", 0)) AS production_totale
FROM eco2
WHERE Région IS NOT NULL AND Date IS NOT NULL
GROUP BY Date, Région)
SELECT * FROM vue_journaliere
  );

[0m08:52:53.617927 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH vue_journaliere AS(

SELECT 
    Date, 
    Région,
    SUM(COALESCE("Consommation (MW)", 0)) AS consommation_totale,
    SUM(COALESCE("Thermique (MW)", 0)) AS production_thermique_totale,
    SUM(COALESCE("Nucléaire (MW)", 0)) AS production_nucleaire_totale,
    SUM(COALESCE("Eolien (MW)", 0)) AS production_eolienne_totale,
    SUM(COALESCE("Solaire (MW)", 0)) AS production_solaire_totale,
    SUM(COALESCE("Hydraulique (MW)", 0)) AS production_hydraulique_totale,
    SUM(COALESCE("Bioénergies (MW)", 0)) AS production_bioenergies_totale,
    SUM(COALESCE("Pompage (MW)", 0)) AS pompage_total,
    SUM(COALESCE("Ech. physiques (MW)", 0)) AS echanges_physiques_totaux,
    SUM(COALESCE("Stockage batterie", 0)) AS stockage_batterie_total,
    SUM(COALESCE("Déstockage batterie", 0)) AS destockage_batterie_total,
    SUM(COALESCE("Eolien terrestre", 0)) AS production_eolien_terrestre_totale,
    SUM(COALESCE("Eolien offshore", 0)) AS production_eolien_offshore_totale,
    AVG(COALESCE("TCO Thermique (%)", 0)) AS tco_thermique_moyen,
    AVG(COALESCE("TCH Thermique (%)", 0)) AS tch_thermique_moyen,
    AVG(COALESCE("TCO Nucléaire (%)", 0)) AS tco_nucleaire_moyen,
    AVG(COALESCE("TCH Nucléaire (%)", 0)) AS tch_nucleaire_moyen,
    AVG(COALESCE("TCO Eolien (%)", 0)) AS tco_eolien_moyen,
    AVG(COALESCE("TCH Eolien (%)", 0)) AS tch_eolien_moyen,
    AVG(COALESCE("TCO Solaire (%)", 0)) AS tco_solaire_moyen,
    AVG(COALESCE("TCH Solaire (%)", 0)) AS tch_solaire_moyen,
    AVG(COALESCE("TCO Hydraulique (%)", 0)) AS tco_hydraulique_moyen,
    AVG(COALESCE("TCH Hydraulique (%)", 0)) AS tch_hydraulique_moyen,
    AVG(COALESCE("TCO Bioénergies (%)", 0)) AS tco_bioenergies_moyen,
    AVG(COALESCE("TCH Bioénergies (%)", 0)) AS tch_bioenergies_moyen,
    SUM(COALESCE("Column 30 Poduction_total", 0)) AS production_totale
FROM eco2
WHERE Région IS NOT NULL AND Date IS NOT NULL
GROUP BY Date, Région)
SELECT * FROM vue_journaliere
  );

[0m08:52:53.618217 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:52:53.618723 [debug] [Thread-1 (]: On model.transform.grain_jour: ROLLBACK
[0m08:52:53.620739 [debug] [Thread-1 (]: Failed to rollback 'model.transform.grain_jour'
[0m08:52:53.620959 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m08:52:53.622768 [debug] [Thread-1 (]: Runtime Error in model grain_jour (models/example/grain_jour.sql)
  Binder Error: Cannot mix values of type VARCHAR and INTEGER_LITERAL in COALESCE operator - an explicit cast is required
[0m08:52:53.623051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91f339c1-9075-43c2-a8e9-78430399d693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767614f910c0>]}
[0m08:52:53.623455 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model main.grain_jour ........................... [[31mERROR[0m in 0.03s]
[0m08:52:53.623779 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m08:52:53.624006 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m08:52:53.624611 [info ] [Thread-1 (]: 3 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m08:52:53.624872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m08:52:53.625075 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m08:52:53.626588 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m08:52:53.627493 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m08:52:53.637530 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m08:52:53.638441 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:52:53.638662 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m08:52:53.638847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:53.650426 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m08:52:53.650861 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:52:53.651260 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m08:52:53.652200 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:52:53.653861 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:52:53.654098 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m08:52:53.654644 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:53.656748 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:52:53.656989 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m08:52:53.657480 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:53.660130 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m08:52:53.660362 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:52:53.660589 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m08:52:53.661801 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:52:53.663293 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:52:53.663574 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m08:52:53.664318 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:53.665181 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m08:52:53.680649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91f339c1-9075-43c2-a8e9-78430399d693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7676163765c0>]}
[0m08:52:53.681416 [info ] [Thread-1 (]: 3 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m08:52:53.681985 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m08:52:53.682709 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m08:52:53.683137 [info ] [Thread-1 (]: 4 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m08:52:53.683542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m08:52:53.683859 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m08:52:53.685839 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m08:52:53.686789 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m08:52:53.688794 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m08:52:53.689649 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:52:53.689847 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m08:52:53.690028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:53.700052 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:52:53.700361 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:52:53.700655 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m08:52:53.701176 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:53.702865 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:52:53.703083 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m08:52:53.703536 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:53.705047 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:52:53.705262 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m08:52:53.705589 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:53.706436 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m08:52:53.706648 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:52:53.706894 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m08:52:53.708060 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:52:53.709303 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:52:53.709543 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m08:52:53.710141 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:53.710806 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m08:52:53.722415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91f339c1-9075-43c2-a8e9-78430399d693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76761d632050>]}
[0m08:52:53.722820 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m08:52:53.723142 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m08:52:53.723706 [debug] [MainThread]: Using duckdb connection "master"
[0m08:52:53.723922 [debug] [MainThread]: On master: BEGIN
[0m08:52:53.724174 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:53.734966 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m08:52:53.735361 [debug] [MainThread]: On master: COMMIT
[0m08:52:53.735678 [debug] [MainThread]: Using duckdb connection "master"
[0m08:52:53.735978 [debug] [MainThread]: On master: COMMIT
[0m08:52:53.736429 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:52:53.736779 [debug] [MainThread]: On master: Close
[0m08:52:53.738763 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:53.739258 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m08:52:53.739591 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m08:52:53.740014 [info ] [MainThread]: 
[0m08:52:53.740406 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m08:52:53.741374 [debug] [MainThread]: Command end result
[0m08:52:53.762672 [info ] [MainThread]: 
[0m08:52:53.762951 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:52:53.763146 [info ] [MainThread]: 
[0m08:52:53.763432 [error] [MainThread]:   Runtime Error in model grain_jour (models/example/grain_jour.sql)
  Binder Error: Cannot mix values of type VARCHAR and INTEGER_LITERAL in COALESCE operator - an explicit cast is required
[0m08:52:53.763600 [info ] [MainThread]: 
[0m08:52:53.763842 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m08:52:53.764321 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0307752, "process_in_blocks": "12408", "process_kernel_time": 0.115746, "process_mem_max_rss": "142796", "process_out_blocks": "7984", "process_user_time": 1.289597}
[0m08:52:53.764639 [debug] [MainThread]: Command `dbt run` failed at 08:52:53.764586 after 1.03 seconds
[0m08:52:53.764850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76761d2ffd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76761c4df6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76761b74bbe0>]}
[0m08:52:53.765073 [debug] [MainThread]: Flushing usage events
[0m08:55:10.087276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9681587cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9680f78820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c967fb61ab0>]}


============================== 08:55:10.090337 | 9b3cd5e6-282b-4974-bd9d-2e6c60633864 ==============================
[0m08:55:10.090337 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:55:10.090946 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'fail_fast': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:55:10.231587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b3cd5e6-282b-4974-bd9d-2e6c60633864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c96814b17e0>]}
[0m08:55:10.259130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b3cd5e6-282b-4974-bd9d-2e6c60633864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9680936770>]}
[0m08:55:10.261727 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m08:55:10.302719 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m08:55:10.403535 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:55:10.404299 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:55:10.414082 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m08:55:10.433485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b3cd5e6-282b-4974-bd9d-2e6c60633864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9679d69030>]}
[0m08:55:10.493597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b3cd5e6-282b-4974-bd9d-2e6c60633864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9679d680a0>]}
[0m08:55:10.493897 [info ] [MainThread]: Found 4 models, 4 data tests, 421 macros
[0m08:55:10.494264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b3cd5e6-282b-4974-bd9d-2e6c60633864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9679d68100>]}
[0m08:55:10.495289 [info ] [MainThread]: 
[0m08:55:10.495609 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:55:10.498412 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m08:55:10.741381 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m08:55:10.741662 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m08:55:10.742004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:55:10.761984 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m08:55:10.763506 [debug] [ThreadPool]: On list_dev: Close
[0m08:55:10.766406 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m08:55:10.766895 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m08:55:10.771481 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:55:10.771717 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m08:55:10.771937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:55:10.782074 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m08:55:10.782860 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:55:10.783095 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m08:55:10.783479 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:55:10.783652 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:55:10.783908 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m08:55:10.784308 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:55:10.784738 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m08:55:10.784913 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:55:10.785179 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m08:55:10.785490 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:55:10.785668 [debug] [ThreadPool]: On create_dev_main: Close
[0m08:55:10.787134 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m08:55:10.792230 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m08:55:10.792649 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m08:55:10.793040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:55:10.808462 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m08:55:10.808899 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m08:55:10.809328 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m08:55:10.835027 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m08:55:10.835931 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m08:55:10.836520 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m08:55:10.836717 [debug] [ThreadPool]: On list_dev_main: Close
[0m08:55:10.838664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b3cd5e6-282b-4974-bd9d-2e6c60633864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c96816cb190>]}
[0m08:55:10.838932 [debug] [MainThread]: Using duckdb connection "master"
[0m08:55:10.839177 [debug] [MainThread]: On master: BEGIN
[0m08:55:10.839506 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:55:10.851759 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m08:55:10.852362 [debug] [MainThread]: On master: COMMIT
[0m08:55:10.852850 [debug] [MainThread]: Using duckdb connection "master"
[0m08:55:10.853305 [debug] [MainThread]: On master: COMMIT
[0m08:55:10.854014 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:55:10.854557 [debug] [MainThread]: On master: Close
[0m08:55:10.857057 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:55:10.857572 [info ] [MainThread]: 
[0m08:55:10.859707 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m08:55:10.860775 [info ] [Thread-1 (]: 1 of 4 START sql view model main.clean ......................................... [RUN]
[0m08:55:10.861599 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.clean'
[0m08:55:10.862055 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m08:55:10.869872 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m08:55:10.871555 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m08:55:10.889059 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m08:55:10.890562 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:55:10.890796 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m08:55:10.891158 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:55:10.902024 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m08:55:10.902272 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:55:10.902560 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT * FROM clean
  );

[0m08:55:10.903266 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:10.906590 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:55:10.906817 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m08:55:10.907290 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:10.908807 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:55:10.909039 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m08:55:10.909511 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:10.918184 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m08:55:10.918421 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:55:10.918746 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m08:55:10.919988 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:55:10.922518 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:55:10.922740 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m08:55:10.923372 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:10.924715 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m08:55:10.937008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b3cd5e6-282b-4974-bd9d-2e6c60633864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9682282f50>]}
[0m08:55:10.937413 [info ] [Thread-1 (]: 1 of 4 OK created sql view model main.clean .................................... [[32mOK[0m in 0.08s]
[0m08:55:10.937743 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m08:55:10.937974 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m08:55:10.938297 [info ] [Thread-1 (]: 2 of 4 START sql view model main.grain_jour .................................... [RUN]
[0m08:55:10.938541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m08:55:10.938755 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m08:55:10.939791 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m08:55:10.940723 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m08:55:10.942506 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m08:55:10.943399 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m08:55:10.943615 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m08:55:10.943911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:55:10.956363 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m08:55:10.956816 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m08:55:10.957274 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    CREATE VIEW vue_journaliere AS
SELECT 
    Date, 
    Région,
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS production_thermique_totale,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS production_nucleaire_totale,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS production_eolienne_totale,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS production_solaire_totale,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS production_hydraulique_totale,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS production_bioenergies_totale,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_totaux,
    SUM(COALESCE(TRY_CAST("Stockage batterie" AS INT), 0)) AS stockage_batterie_total,
    SUM(COALESCE(TRY_CAST("Déstockage batterie" AS INT), 0)) AS destockage_batterie_total,
    SUM(COALESCE(TRY_CAST("Eolien terrestre" AS INT), 0)) AS production_eolien_terrestre_totale,
    SUM(COALESCE(TRY_CAST("Eolien offshore" AS INT), 0)) AS production_eolien_offshore_totale,
    AVG(COALESCE(TRY_CAST("TCO Thermique (%)" AS FLOAT), 0)) AS tco_thermique_moyen,
    AVG(COALESCE(TRY_CAST("TCH Thermique (%)" AS FLOAT), 0)) AS tch_thermique_moyen,
    AVG(COALESCE(TRY_CAST("TCO Nucléaire (%)" AS FLOAT), 0)) AS tco_nucleaire_moyen,
    AVG(COALESCE(TRY_CAST("TCH Nucléaire (%)" AS FLOAT), 0)) AS tch_nucleaire_moyen,
    AVG(COALESCE(TRY_CAST("TCO Eolien (%)" AS FLOAT), 0)) AS tco_eolien_moyen,
    AVG(COALESCE(TRY_CAST("TCH Eolien (%)" AS FLOAT), 0)) AS tch_eolien_moyen,
    AVG(COALESCE(TRY_CAST("TCO Solaire (%)" AS FLOAT), 0)) AS tco_solaire_moyen,
    AVG(COALESCE(TRY_CAST("TCH Solaire (%)" AS FLOAT), 0)) AS tch_solaire_moyen,
    AVG(COALESCE(TRY_CAST("TCO Hydraulique (%)" AS FLOAT), 0)) AS tco_hydraulique_moyen,
    AVG(COALESCE(TRY_CAST("TCH Hydraulique (%)" AS FLOAT), 0)) AS tch_hydraulique_moyen,
    AVG(COALESCE(TRY_CAST("TCO Bioénergies (%)" AS FLOAT), 0)) AS tco_bioenergies_moyen,
    AVG(COALESCE(TRY_CAST("TCH Bioénergies (%)" AS FLOAT), 0)) AS tch_bioenergies_moyen,
    SUM(COALESCE(TRY_CAST("Column 30 Poduction_total" AS INT), 0)) AS production_totale
FROM eco2
WHERE Région IS NOT NULL AND Date IS NOT NULL
GROUP BY Date, Région;
  );

[0m08:55:10.958013 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    CREATE VIEW vue_journaliere AS
SELECT 
    Date, 
    Région,
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS production_thermique_totale,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS production_nucleaire_totale,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS production_eolienne_totale,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS production_solaire_totale,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS production_hydraulique_totale,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS production_bioenergies_totale,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_totaux,
    SUM(COALESCE(TRY_CAST("Stockage batterie" AS INT), 0)) AS stockage_batterie_total,
    SUM(COALESCE(TRY_CAST("Déstockage batterie" AS INT), 0)) AS destockage_batterie_total,
    SUM(COALESCE(TRY_CAST("Eolien terrestre" AS INT), 0)) AS production_eolien_terrestre_totale,
    SUM(COALESCE(TRY_CAST("Eolien offshore" AS INT), 0)) AS production_eolien_offshore_totale,
    AVG(COALESCE(TRY_CAST("TCO Thermique (%)" AS FLOAT), 0)) AS tco_thermique_moyen,
    AVG(COALESCE(TRY_CAST("TCH Thermique (%)" AS FLOAT), 0)) AS tch_thermique_moyen,
    AVG(COALESCE(TRY_CAST("TCO Nucléaire (%)" AS FLOAT), 0)) AS tco_nucleaire_moyen,
    AVG(COALESCE(TRY_CAST("TCH Nucléaire (%)" AS FLOAT), 0)) AS tch_nucleaire_moyen,
    AVG(COALESCE(TRY_CAST("TCO Eolien (%)" AS FLOAT), 0)) AS tco_eolien_moyen,
    AVG(COALESCE(TRY_CAST("TCH Eolien (%)" AS FLOAT), 0)) AS tch_eolien_moyen,
    AVG(COALESCE(TRY_CAST("TCO Solaire (%)" AS FLOAT), 0)) AS tco_solaire_moyen,
    AVG(COALESCE(TRY_CAST("TCH Solaire (%)" AS FLOAT), 0)) AS tch_solaire_moyen,
    AVG(COALESCE(TRY_CAST("TCO Hydraulique (%)" AS FLOAT), 0)) AS tco_hydraulique_moyen,
    AVG(COALESCE(TRY_CAST("TCH Hydraulique (%)" AS FLOAT), 0)) AS tch_hydraulique_moyen,
    AVG(COALESCE(TRY_CAST("TCO Bioénergies (%)" AS FLOAT), 0)) AS tco_bioenergies_moyen,
    AVG(COALESCE(TRY_CAST("TCH Bioénergies (%)" AS FLOAT), 0)) AS tch_bioenergies_moyen,
    SUM(COALESCE(TRY_CAST("Column 30 Poduction_total" AS INT), 0)) AS production_totale
FROM eco2
WHERE Région IS NOT NULL AND Date IS NOT NULL
GROUP BY Date, Région;
  );

[0m08:55:10.958431 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:55:10.958843 [debug] [Thread-1 (]: On model.transform.grain_jour: ROLLBACK
[0m08:55:10.961498 [debug] [Thread-1 (]: Failed to rollback 'model.transform.grain_jour'
[0m08:55:10.961835 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m08:55:10.964449 [debug] [Thread-1 (]: Runtime Error in model grain_jour (models/example/grain_jour.sql)
  Parser Error: syntax error at or near "CREATE"
[0m08:55:10.964930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b3cd5e6-282b-4974-bd9d-2e6c60633864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c96775944c0>]}
[0m08:55:10.965551 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model main.grain_jour ........................... [[31mERROR[0m in 0.03s]
[0m08:55:10.966150 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m08:55:10.966591 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m08:55:10.967863 [info ] [Thread-1 (]: 3 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m08:55:10.968346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m08:55:10.968694 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m08:55:10.971528 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m08:55:10.972512 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m08:55:10.982507 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m08:55:10.983672 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:55:10.983967 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m08:55:10.984311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:55:10.996354 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m08:55:10.996823 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:55:10.997231 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m08:55:10.998207 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:55:11.000550 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:55:11.000843 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m08:55:11.001443 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:11.003223 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:55:11.003464 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m08:55:11.003870 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:11.006545 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m08:55:11.006771 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:55:11.007050 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m08:55:11.008353 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:55:11.009618 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:55:11.009840 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m08:55:11.010455 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:11.011219 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m08:55:11.026245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b3cd5e6-282b-4974-bd9d-2e6c60633864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c967c507010>]}
[0m08:55:11.027152 [info ] [Thread-1 (]: 3 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m08:55:11.027881 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m08:55:11.028757 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m08:55:11.029297 [info ] [Thread-1 (]: 4 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m08:55:11.029800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m08:55:11.030189 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m08:55:11.032463 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m08:55:11.033602 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m08:55:11.036018 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m08:55:11.036928 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:55:11.037153 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m08:55:11.037406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:55:11.048551 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m08:55:11.049074 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:55:11.049493 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m08:55:11.050426 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:11.077869 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:55:11.078194 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m08:55:11.078869 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:11.080403 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:55:11.080619 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m08:55:11.081151 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:11.082080 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m08:55:11.082292 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:55:11.082501 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m08:55:11.083832 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:55:11.085212 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:55:11.085447 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m08:55:11.086006 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:11.086673 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m08:55:11.101239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b3cd5e6-282b-4974-bd9d-2e6c60633864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c967c507010>]}
[0m08:55:11.102123 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.07s]
[0m08:55:11.102815 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m08:55:11.104009 [debug] [MainThread]: Using duckdb connection "master"
[0m08:55:11.104431 [debug] [MainThread]: On master: BEGIN
[0m08:55:11.104761 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:55:11.120324 [debug] [MainThread]: SQL status: OK in 0.015 seconds
[0m08:55:11.120868 [debug] [MainThread]: On master: COMMIT
[0m08:55:11.121390 [debug] [MainThread]: Using duckdb connection "master"
[0m08:55:11.121839 [debug] [MainThread]: On master: COMMIT
[0m08:55:11.122437 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:55:11.122835 [debug] [MainThread]: On master: Close
[0m08:55:11.124751 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:55:11.125136 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m08:55:11.125484 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m08:55:11.125900 [info ] [MainThread]: 
[0m08:55:11.126302 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m08:55:11.127349 [debug] [MainThread]: Command end result
[0m08:55:11.154212 [info ] [MainThread]: 
[0m08:55:11.154679 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:55:11.155008 [info ] [MainThread]: 
[0m08:55:11.155423 [error] [MainThread]:   Runtime Error in model grain_jour (models/example/grain_jour.sql)
  Parser Error: syntax error at or near "CREATE"
[0m08:55:11.155619 [info ] [MainThread]: 
[0m08:55:11.155887 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m08:55:11.156374 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0969827, "process_in_blocks": "10080", "process_kernel_time": 0.190503, "process_mem_max_rss": "139456", "process_out_blocks": "7136", "process_user_time": 1.330625}
[0m08:55:11.156682 [debug] [MainThread]: Command `dbt run` failed at 08:55:11.156630 after 1.10 seconds
[0m08:55:11.156993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9681587cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9679d6f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9679d6d9f0>]}
[0m08:55:11.157197 [debug] [MainThread]: Flushing usage events
[0m08:57:15.317913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be139dffcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be139808820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be13a1df0d0>]}


============================== 08:57:15.319740 | c3ebf819-e346-4b50-a7e5-d66105544d40 ==============================
[0m08:57:15.319740 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:57:15.320186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m08:57:15.444238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3ebf819-e346-4b50-a7e5-d66105544d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be139d2d7e0>]}
[0m08:57:15.478679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3ebf819-e346-4b50-a7e5-d66105544d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be138fde770>]}
[0m08:57:15.481060 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m08:57:15.522962 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m08:57:15.623088 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:57:15.623688 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:57:15.630870 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m08:57:15.650392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3ebf819-e346-4b50-a7e5-d66105544d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be1325e1030>]}
[0m08:57:15.710957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3ebf819-e346-4b50-a7e5-d66105544d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be1325e00a0>]}
[0m08:57:15.711261 [info ] [MainThread]: Found 4 models, 4 data tests, 421 macros
[0m08:57:15.711578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3ebf819-e346-4b50-a7e5-d66105544d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be1325e0100>]}
[0m08:57:15.712645 [info ] [MainThread]: 
[0m08:57:15.712996 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:57:15.716004 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m08:57:15.951883 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m08:57:15.952784 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m08:57:15.953420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:57:15.975404 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m08:57:15.977082 [debug] [ThreadPool]: On list_dev: Close
[0m08:57:15.980270 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m08:57:15.980773 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m08:57:15.985510 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:57:15.985726 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m08:57:15.986002 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:57:15.996112 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m08:57:15.996833 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:57:15.997028 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m08:57:15.997440 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:57:15.997613 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:57:15.997873 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m08:57:15.998318 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:57:15.998730 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m08:57:15.998908 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:57:15.999178 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m08:57:15.999555 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:57:15.999720 [debug] [ThreadPool]: On create_dev_main: Close
[0m08:57:16.001308 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m08:57:16.004270 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m08:57:16.004472 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m08:57:16.004713 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:57:16.016118 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m08:57:16.016663 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m08:57:16.017092 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m08:57:16.033669 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m08:57:16.034438 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m08:57:16.034984 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m08:57:16.035165 [debug] [ThreadPool]: On list_dev_main: Close
[0m08:57:16.036923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3ebf819-e346-4b50-a7e5-d66105544d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be139ee3190>]}
[0m08:57:16.037190 [debug] [MainThread]: Using duckdb connection "master"
[0m08:57:16.037429 [debug] [MainThread]: On master: BEGIN
[0m08:57:16.037629 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:57:16.048391 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m08:57:16.048773 [debug] [MainThread]: On master: COMMIT
[0m08:57:16.049101 [debug] [MainThread]: Using duckdb connection "master"
[0m08:57:16.049424 [debug] [MainThread]: On master: COMMIT
[0m08:57:16.049974 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:57:16.050337 [debug] [MainThread]: On master: Close
[0m08:57:16.052339 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:57:16.052853 [info ] [MainThread]: 
[0m08:57:16.055348 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m08:57:16.056272 [info ] [Thread-1 (]: 1 of 4 START sql view model main.clean ......................................... [RUN]
[0m08:57:16.057252 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.clean'
[0m08:57:16.057809 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m08:57:16.067762 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m08:57:16.069437 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m08:57:16.087337 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m08:57:16.089092 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:57:16.089321 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m08:57:16.089577 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:57:16.099989 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:57:16.100237 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:57:16.100475 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT * FROM clean
  );

[0m08:57:16.101273 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:57:16.104642 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:57:16.104875 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m08:57:16.105378 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:57:16.107013 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:57:16.107241 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m08:57:16.107711 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:57:16.115982 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m08:57:16.116227 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:57:16.116525 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m08:57:16.117912 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:57:16.120389 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:57:16.120621 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m08:57:16.121378 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:57:16.122726 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m08:57:16.134598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3ebf819-e346-4b50-a7e5-d66105544d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be13ab16f50>]}
[0m08:57:16.135015 [info ] [Thread-1 (]: 1 of 4 OK created sql view model main.clean .................................... [[32mOK[0m in 0.08s]
[0m08:57:16.135352 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m08:57:16.135594 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m08:57:16.135914 [info ] [Thread-1 (]: 2 of 4 START sql view model main.grain_jour .................................... [RUN]
[0m08:57:16.136164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m08:57:16.136366 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m08:57:16.137337 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m08:57:16.138270 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m08:57:16.140083 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m08:57:16.141064 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m08:57:16.141266 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m08:57:16.141597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:57:16.152607 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m08:57:16.153003 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m08:57:16.153447 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH vue_journaliere AS(
SELECT 
    Date, 
    Région,
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS production_thermique_totale,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS production_nucleaire_totale,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS production_eolienne_totale,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS production_solaire_totale,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS production_hydraulique_totale,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS production_bioenergies_totale,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_totaux,
    SUM(COALESCE(TRY_CAST("Stockage batterie" AS INT), 0)) AS stockage_batterie_total,
    SUM(COALESCE(TRY_CAST("Déstockage batterie" AS INT), 0)) AS destockage_batterie_total,
    SUM(COALESCE(TRY_CAST("Eolien terrestre" AS INT), 0)) AS production_eolien_terrestre_totale,
    SUM(COALESCE(TRY_CAST("Eolien offshore" AS INT), 0)) AS production_eolien_offshore_totale,
    AVG(COALESCE(TRY_CAST("TCO Thermique (%)" AS FLOAT), 0)) AS tco_thermique_moyen,
    AVG(COALESCE(TRY_CAST("TCH Thermique (%)" AS FLOAT), 0)) AS tch_thermique_moyen,
    AVG(COALESCE(TRY_CAST("TCO Nucléaire (%)" AS FLOAT), 0)) AS tco_nucleaire_moyen,
    AVG(COALESCE(TRY_CAST("TCH Nucléaire (%)" AS FLOAT), 0)) AS tch_nucleaire_moyen,
    AVG(COALESCE(TRY_CAST("TCO Eolien (%)" AS FLOAT), 0)) AS tco_eolien_moyen,
    AVG(COALESCE(TRY_CAST("TCH Eolien (%)" AS FLOAT), 0)) AS tch_eolien_moyen,
    AVG(COALESCE(TRY_CAST("TCO Solaire (%)" AS FLOAT), 0)) AS tco_solaire_moyen,
    AVG(COALESCE(TRY_CAST("TCH Solaire (%)" AS FLOAT), 0)) AS tch_solaire_moyen,
    AVG(COALESCE(TRY_CAST("TCO Hydraulique (%)" AS FLOAT), 0)) AS tco_hydraulique_moyen,
    AVG(COALESCE(TRY_CAST("TCH Hydraulique (%)" AS FLOAT), 0)) AS tch_hydraulique_moyen,
    AVG(COALESCE(TRY_CAST("TCO Bioénergies (%)" AS FLOAT), 0)) AS tco_bioenergies_moyen,
    AVG(COALESCE(TRY_CAST("TCH Bioénergies (%)" AS FLOAT), 0)) AS tch_bioenergies_moyen,
    SUM(COALESCE(TRY_CAST("Poduction_total" AS INT), 0)) AS production_totale
FROM clean
WHERE Région IS NOT NULL AND Date IS NOT NULL
GROUP BY Date, Région)

SELECT * from vue_journaliere
  );

[0m08:57:16.156750 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH vue_journaliere AS(
SELECT 
    Date, 
    Région,
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS production_thermique_totale,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS production_nucleaire_totale,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS production_eolienne_totale,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS production_solaire_totale,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS production_hydraulique_totale,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS production_bioenergies_totale,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_totaux,
    SUM(COALESCE(TRY_CAST("Stockage batterie" AS INT), 0)) AS stockage_batterie_total,
    SUM(COALESCE(TRY_CAST("Déstockage batterie" AS INT), 0)) AS destockage_batterie_total,
    SUM(COALESCE(TRY_CAST("Eolien terrestre" AS INT), 0)) AS production_eolien_terrestre_totale,
    SUM(COALESCE(TRY_CAST("Eolien offshore" AS INT), 0)) AS production_eolien_offshore_totale,
    AVG(COALESCE(TRY_CAST("TCO Thermique (%)" AS FLOAT), 0)) AS tco_thermique_moyen,
    AVG(COALESCE(TRY_CAST("TCH Thermique (%)" AS FLOAT), 0)) AS tch_thermique_moyen,
    AVG(COALESCE(TRY_CAST("TCO Nucléaire (%)" AS FLOAT), 0)) AS tco_nucleaire_moyen,
    AVG(COALESCE(TRY_CAST("TCH Nucléaire (%)" AS FLOAT), 0)) AS tch_nucleaire_moyen,
    AVG(COALESCE(TRY_CAST("TCO Eolien (%)" AS FLOAT), 0)) AS tco_eolien_moyen,
    AVG(COALESCE(TRY_CAST("TCH Eolien (%)" AS FLOAT), 0)) AS tch_eolien_moyen,
    AVG(COALESCE(TRY_CAST("TCO Solaire (%)" AS FLOAT), 0)) AS tco_solaire_moyen,
    AVG(COALESCE(TRY_CAST("TCH Solaire (%)" AS FLOAT), 0)) AS tch_solaire_moyen,
    AVG(COALESCE(TRY_CAST("TCO Hydraulique (%)" AS FLOAT), 0)) AS tco_hydraulique_moyen,
    AVG(COALESCE(TRY_CAST("TCH Hydraulique (%)" AS FLOAT), 0)) AS tch_hydraulique_moyen,
    AVG(COALESCE(TRY_CAST("TCO Bioénergies (%)" AS FLOAT), 0)) AS tco_bioenergies_moyen,
    AVG(COALESCE(TRY_CAST("TCH Bioénergies (%)" AS FLOAT), 0)) AS tch_bioenergies_moyen,
    SUM(COALESCE(TRY_CAST("Poduction_total" AS INT), 0)) AS production_totale
FROM clean
WHERE Région IS NOT NULL AND Date IS NOT NULL
GROUP BY Date, Région)

SELECT * from vue_journaliere
  );

[0m08:57:16.157191 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:57:16.157661 [debug] [Thread-1 (]: On model.transform.grain_jour: ROLLBACK
[0m08:57:16.160280 [debug] [Thread-1 (]: Failed to rollback 'model.transform.grain_jour'
[0m08:57:16.160635 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m08:57:16.163177 [debug] [Thread-1 (]: Runtime Error in model grain_jour (models/example/grain_jour.sql)
  Binder Error: Referenced column "Poduction_total" not found in FROM clause!
  Candidate bindings: "clean.production_totale", "clean.Eolien", "clean.Column 30"
  LINE 34:     SUM(COALESCE(TRY_CAST("Poduction_total" AS INT), 0)) AS production_totale
  FROM clean
  WHERE Région IS NOT NULL AND Date IS NOT NULL
  GROUP BY Date, Région)
  
  SELECT * from vue_journaliere
    );
  ...
                                     ^
[0m08:57:16.163708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3ebf819-e346-4b50-a7e5-d66105544d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be12f33c4c0>]}
[0m08:57:16.164372 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model main.grain_jour ........................... [[31mERROR[0m in 0.03s]
[0m08:57:16.165059 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m08:57:16.165549 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m08:57:16.166868 [info ] [Thread-1 (]: 3 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m08:57:16.167265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m08:57:16.167549 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m08:57:16.169941 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m08:57:16.170822 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m08:57:16.180589 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m08:57:16.181474 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:57:16.181681 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m08:57:16.181899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:57:16.191782 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:57:16.192035 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:57:16.192284 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m08:57:16.192856 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:57:16.194474 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:57:16.194698 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m08:57:16.195198 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:57:16.196735 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:57:16.196951 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m08:57:16.197421 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:57:16.200094 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m08:57:16.200321 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:57:16.200614 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m08:57:16.201993 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:57:16.203186 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:57:16.203390 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m08:57:16.204039 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:57:16.204783 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m08:57:16.219057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3ebf819-e346-4b50-a7e5-d66105544d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be1385cf010>]}
[0m08:57:16.219487 [info ] [Thread-1 (]: 3 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m08:57:16.219862 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m08:57:16.220454 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m08:57:16.220721 [info ] [Thread-1 (]: 4 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m08:57:16.220971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m08:57:16.221181 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m08:57:16.222698 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m08:57:16.223584 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m08:57:16.226220 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m08:57:16.227273 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:57:16.227617 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m08:57:16.227908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:57:16.242135 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m08:57:16.242649 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:57:16.243043 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m08:57:16.243804 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:57:16.269275 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:57:16.269588 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m08:57:16.270252 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:57:16.271807 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:57:16.272036 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m08:57:16.272478 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:57:16.273480 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m08:57:16.273716 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:57:16.273988 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m08:57:16.275164 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:57:16.276347 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:57:16.276560 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m08:57:16.277122 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:57:16.277785 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m08:57:16.289525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3ebf819-e346-4b50-a7e5-d66105544d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be1385cf010>]}
[0m08:57:16.289915 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.07s]
[0m08:57:16.290237 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m08:57:16.290925 [debug] [MainThread]: Using duckdb connection "master"
[0m08:57:16.291113 [debug] [MainThread]: On master: BEGIN
[0m08:57:16.291328 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:57:16.301190 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m08:57:16.301410 [debug] [MainThread]: On master: COMMIT
[0m08:57:16.301656 [debug] [MainThread]: Using duckdb connection "master"
[0m08:57:16.301894 [debug] [MainThread]: On master: COMMIT
[0m08:57:16.302266 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:57:16.302449 [debug] [MainThread]: On master: Close
[0m08:57:16.303587 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:57:16.303789 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m08:57:16.304074 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m08:57:16.304375 [info ] [MainThread]: 
[0m08:57:16.304567 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m08:57:16.305134 [debug] [MainThread]: Command end result
[0m08:57:16.324861 [info ] [MainThread]: 
[0m08:57:16.325143 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:57:16.325357 [info ] [MainThread]: 
[0m08:57:16.325653 [error] [MainThread]:   Runtime Error in model grain_jour (models/example/grain_jour.sql)
  Binder Error: Referenced column "Poduction_total" not found in FROM clause!
  Candidate bindings: "clean.production_totale", "clean.Eolien", "clean.Column 30"
  LINE 34:     SUM(COALESCE(TRY_CAST("Poduction_total" AS INT), 0)) AS production_totale
  FROM clean
  WHERE Région IS NOT NULL AND Date IS NOT NULL
  GROUP BY Date, Région)
  
  SELECT * from vue_journaliere
    );
  ...
                                     ^
[0m08:57:16.325850 [info ] [MainThread]: 
[0m08:57:16.326112 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m08:57:16.326594 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0356618, "process_in_blocks": "10320", "process_kernel_time": 0.131299, "process_mem_max_rss": "140528", "process_out_blocks": "7136", "process_user_time": 1.272988}
[0m08:57:16.326900 [debug] [MainThread]: Command `dbt run` failed at 08:57:16.326848 after 1.04 seconds
[0m08:57:16.327109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be139dffcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be1325eb010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be1325e8490>]}
[0m08:57:16.327343 [debug] [MainThread]: Flushing usage events
[0m08:58:41.902870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f46fbdfd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f46e1acd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f46e1acd60>]}


============================== 08:58:41.905646 | 8e1d37cb-ddd9-49ad-90c8-5390afc8f61e ==============================
[0m08:58:41.905646 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:58:41.906055 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:58:42.030236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e1d37cb-ddd9-49ad-90c8-5390afc8f61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f46f682ce0>]}
[0m08:58:42.057649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e1d37cb-ddd9-49ad-90c8-5390afc8f61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f46e5c8af0>]}
[0m08:58:42.060279 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m08:58:42.101372 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m08:58:42.202862 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:58:42.203441 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:58:42.209850 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m08:58:42.228723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e1d37cb-ddd9-49ad-90c8-5390afc8f61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4683b9090>]}
[0m08:58:42.290095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e1d37cb-ddd9-49ad-90c8-5390afc8f61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4683bbc70>]}
[0m08:58:42.290405 [info ] [MainThread]: Found 4 models, 4 data tests, 421 macros
[0m08:58:42.290774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e1d37cb-ddd9-49ad-90c8-5390afc8f61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4683b8040>]}
[0m08:58:42.291746 [info ] [MainThread]: 
[0m08:58:42.292072 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:58:42.294887 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m08:58:42.548431 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m08:58:42.549093 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m08:58:42.549542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:58:42.555816 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m08:58:42.556145 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m08:58:42.556862 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:58:42.557138 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m08:58:42.557378 [info ] [MainThread]: 
[0m08:58:42.557611 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m08:58:42.557900 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/dev.duckdb": Conflicting lock is held in /home/ETUDIANT/e24a518u/Bureau/tp sql/transform/duckdb (PID 54806). See also https://duckdb.org/docs/connect/concurrency
[0m08:58:42.558392 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.68256634, "process_in_blocks": "0", "process_kernel_time": 0.154031, "process_mem_max_rss": "130808", "process_out_blocks": "1112", "process_user_time": 1.019587}
[0m08:58:42.558773 [debug] [MainThread]: Command `dbt run` failed at 08:58:42.558705 after 0.68 seconds
[0m08:58:42.559029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f46fbdfd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4683b9ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4683c0b80>]}
[0m08:58:42.559312 [debug] [MainThread]: Flushing usage events
[0m08:58:52.694140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7517f387bd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7517f32e9ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7517f3cb30d0>]}


============================== 08:58:52.696238 | cbbde91f-12b9-4605-b985-aec49e8742ac ==============================
[0m08:58:52.696238 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:58:52.696700 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:58:52.808842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbbde91f-12b9-4605-b985-aec49e8742ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7517f37a9810>]}
[0m08:58:52.837062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbbde91f-12b9-4605-b985-aec49e8742ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7517f2a62d10>]}
[0m08:58:52.839246 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m08:58:52.880167 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m08:58:52.977384 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:58:52.977879 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:58:52.983889 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m08:58:53.002912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbbde91f-12b9-4605-b985-aec49e8742ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7517ebfe1030>]}
[0m08:58:53.060188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbbde91f-12b9-4605-b985-aec49e8742ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7517ebfe0190>]}
[0m08:58:53.060703 [info ] [MainThread]: Found 4 models, 4 data tests, 421 macros
[0m08:58:53.061051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbbde91f-12b9-4605-b985-aec49e8742ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7517ebfe01f0>]}
[0m08:58:53.062581 [info ] [MainThread]: 
[0m08:58:53.063072 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:58:53.067159 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m08:58:53.214592 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m08:58:53.215785 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m08:58:53.216500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:58:53.243067 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m08:58:53.245678 [debug] [ThreadPool]: On list_dev: Close
[0m08:58:53.251155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m08:58:53.252190 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m08:58:53.259969 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:58:53.260320 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m08:58:53.260567 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:58:53.271581 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m08:58:53.272539 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:58:53.272799 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m08:58:53.273306 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:58:53.273527 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:58:53.273783 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m08:58:53.274152 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:58:53.274666 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m08:58:53.274850 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m08:58:53.275088 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m08:58:53.275471 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:58:53.275653 [debug] [ThreadPool]: On create_dev_main: Close
[0m08:58:53.277223 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m08:58:53.281685 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m08:58:53.281954 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m08:58:53.282211 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:58:53.294597 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m08:58:53.295037 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m08:58:53.295431 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m08:58:53.310580 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m08:58:53.311265 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m08:58:53.311799 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m08:58:53.311988 [debug] [ThreadPool]: On list_dev_main: Close
[0m08:58:53.313884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbbde91f-12b9-4605-b985-aec49e8742ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7517f39bf010>]}
[0m08:58:53.314145 [debug] [MainThread]: Using duckdb connection "master"
[0m08:58:53.314324 [debug] [MainThread]: On master: BEGIN
[0m08:58:53.314550 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:58:53.324525 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m08:58:53.324791 [debug] [MainThread]: On master: COMMIT
[0m08:58:53.325021 [debug] [MainThread]: Using duckdb connection "master"
[0m08:58:53.325251 [debug] [MainThread]: On master: COMMIT
[0m08:58:53.325644 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:58:53.325875 [debug] [MainThread]: On master: Close
[0m08:58:53.327374 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:58:53.327683 [info ] [MainThread]: 
[0m08:58:53.329223 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m08:58:53.330081 [info ] [Thread-1 (]: 1 of 4 START sql view model main.clean ......................................... [RUN]
[0m08:58:53.330950 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.clean'
[0m08:58:53.331378 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m08:58:53.339560 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m08:58:53.340986 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m08:58:53.361700 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m08:58:53.363314 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:58:53.363535 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m08:58:53.363798 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:58:53.374480 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m08:58:53.374816 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:58:53.375154 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT * FROM clean
  );

[0m08:58:53.376138 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:53.381992 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:58:53.382368 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m08:58:53.382980 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:58:53.385024 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:58:53.385276 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m08:58:53.385632 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:58:53.393961 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m08:58:53.394200 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:58:53.394485 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m08:58:53.395602 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:53.398130 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m08:58:53.398355 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m08:58:53.399054 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:58:53.400372 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m08:58:53.412747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbbde91f-12b9-4605-b985-aec49e8742ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7517f4536f80>]}
[0m08:58:53.413139 [info ] [Thread-1 (]: 1 of 4 OK created sql view model main.clean .................................... [[32mOK[0m in 0.08s]
[0m08:58:53.413460 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m08:58:53.413691 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m08:58:53.414005 [info ] [Thread-1 (]: 2 of 4 START sql view model main.grain_jour .................................... [RUN]
[0m08:58:53.414247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m08:58:53.414448 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m08:58:53.415486 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m08:58:53.416430 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m08:58:53.418267 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m08:58:53.419113 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m08:58:53.419320 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m08:58:53.419559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:58:53.429605 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:58:53.429845 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m08:58:53.430121 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH vue_journaliere AS(
SELECT 
    Date, 
    Région,
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS production_thermique_totale,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS production_nucleaire_totale,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS production_eolienne_totale,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS production_solaire_totale,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS production_hydraulique_totale,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS production_bioenergies_totale,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_totaux,
    SUM(COALESCE(TRY_CAST("Stockage batterie" AS INT), 0)) AS stockage_batterie_total,
    SUM(COALESCE(TRY_CAST("Déstockage batterie" AS INT), 0)) AS destockage_batterie_total,
    SUM(COALESCE(TRY_CAST("Eolien terrestre" AS INT), 0)) AS production_eolien_terrestre_totale,
    SUM(COALESCE(TRY_CAST("Eolien offshore" AS INT), 0)) AS production_eolien_offshore_totale,
    AVG(COALESCE(TRY_CAST("TCO Thermique (%)" AS FLOAT), 0)) AS tco_thermique_moyen,
    AVG(COALESCE(TRY_CAST("TCH Thermique (%)" AS FLOAT), 0)) AS tch_thermique_moyen,
    AVG(COALESCE(TRY_CAST("TCO Nucléaire (%)" AS FLOAT), 0)) AS tco_nucleaire_moyen,
    AVG(COALESCE(TRY_CAST("TCH Nucléaire (%)" AS FLOAT), 0)) AS tch_nucleaire_moyen,
    AVG(COALESCE(TRY_CAST("TCO Eolien (%)" AS FLOAT), 0)) AS tco_eolien_moyen,
    AVG(COALESCE(TRY_CAST("TCH Eolien (%)" AS FLOAT), 0)) AS tch_eolien_moyen,
    AVG(COALESCE(TRY_CAST("TCO Solaire (%)" AS FLOAT), 0)) AS tco_solaire_moyen,
    AVG(COALESCE(TRY_CAST("TCH Solaire (%)" AS FLOAT), 0)) AS tch_solaire_moyen,
    AVG(COALESCE(TRY_CAST("TCO Hydraulique (%)" AS FLOAT), 0)) AS tco_hydraulique_moyen,
    AVG(COALESCE(TRY_CAST("TCH Hydraulique (%)" AS FLOAT), 0)) AS tch_hydraulique_moyen,
    AVG(COALESCE(TRY_CAST("TCO Bioénergies (%)" AS FLOAT), 0)) AS tco_bioenergies_moyen,
    AVG(COALESCE(TRY_CAST("TCH Bioénergies (%)" AS FLOAT), 0)) AS tch_bioenergies_moyen,
    SUM(COALESCE(TRY_CAST("Poduction_totale" AS INT), 0)) AS production_totale
FROM clean
WHERE Région IS NOT NULL AND Date IS NOT NULL
GROUP BY Date, Région)

SELECT * from vue_journaliere
  );

[0m08:58:53.431323 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH vue_journaliere AS(
SELECT 
    Date, 
    Région,
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS production_thermique_totale,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS production_nucleaire_totale,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS production_eolienne_totale,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS production_solaire_totale,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS production_hydraulique_totale,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS production_bioenergies_totale,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_totaux,
    SUM(COALESCE(TRY_CAST("Stockage batterie" AS INT), 0)) AS stockage_batterie_total,
    SUM(COALESCE(TRY_CAST("Déstockage batterie" AS INT), 0)) AS destockage_batterie_total,
    SUM(COALESCE(TRY_CAST("Eolien terrestre" AS INT), 0)) AS production_eolien_terrestre_totale,
    SUM(COALESCE(TRY_CAST("Eolien offshore" AS INT), 0)) AS production_eolien_offshore_totale,
    AVG(COALESCE(TRY_CAST("TCO Thermique (%)" AS FLOAT), 0)) AS tco_thermique_moyen,
    AVG(COALESCE(TRY_CAST("TCH Thermique (%)" AS FLOAT), 0)) AS tch_thermique_moyen,
    AVG(COALESCE(TRY_CAST("TCO Nucléaire (%)" AS FLOAT), 0)) AS tco_nucleaire_moyen,
    AVG(COALESCE(TRY_CAST("TCH Nucléaire (%)" AS FLOAT), 0)) AS tch_nucleaire_moyen,
    AVG(COALESCE(TRY_CAST("TCO Eolien (%)" AS FLOAT), 0)) AS tco_eolien_moyen,
    AVG(COALESCE(TRY_CAST("TCH Eolien (%)" AS FLOAT), 0)) AS tch_eolien_moyen,
    AVG(COALESCE(TRY_CAST("TCO Solaire (%)" AS FLOAT), 0)) AS tco_solaire_moyen,
    AVG(COALESCE(TRY_CAST("TCH Solaire (%)" AS FLOAT), 0)) AS tch_solaire_moyen,
    AVG(COALESCE(TRY_CAST("TCO Hydraulique (%)" AS FLOAT), 0)) AS tco_hydraulique_moyen,
    AVG(COALESCE(TRY_CAST("TCH Hydraulique (%)" AS FLOAT), 0)) AS tch_hydraulique_moyen,
    AVG(COALESCE(TRY_CAST("TCO Bioénergies (%)" AS FLOAT), 0)) AS tco_bioenergies_moyen,
    AVG(COALESCE(TRY_CAST("TCH Bioénergies (%)" AS FLOAT), 0)) AS tch_bioenergies_moyen,
    SUM(COALESCE(TRY_CAST("Poduction_totale" AS INT), 0)) AS production_totale
FROM clean
WHERE Région IS NOT NULL AND Date IS NOT NULL
GROUP BY Date, Région)

SELECT * from vue_journaliere
  );

[0m08:58:53.431600 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:58:53.431888 [debug] [Thread-1 (]: On model.transform.grain_jour: ROLLBACK
[0m08:58:53.433954 [debug] [Thread-1 (]: Failed to rollback 'model.transform.grain_jour'
[0m08:58:53.434240 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m08:58:53.435534 [debug] [Thread-1 (]: Runtime Error in model grain_jour (models/example/grain_jour.sql)
  Binder Error: Referenced column "Poduction_totale" not found in FROM clause!
  Candidate bindings: "clean.production_totale", "clean.Eolien", "clean.Eolien offshore", "clean.Stockage batterie", "clean.TCH Nucléaire (%)"
  LINE 34:     SUM(COALESCE(TRY_CAST("Poduction_totale" AS INT), 0)) AS production_totale
  FROM clean
  WHERE Région IS NOT NULL AND Date IS NOT NULL
  GROUP BY Date, Région)
  
  SELECT * from vue_journaliere
    );
  ...
                                     ^
[0m08:58:53.435812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbbde91f-12b9-4605-b985-aec49e8742ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7517e8d484c0>]}
[0m08:58:53.436158 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model main.grain_jour ........................... [[31mERROR[0m in 0.02s]
[0m08:58:53.436470 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m08:58:53.436689 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m08:58:53.437496 [info ] [Thread-1 (]: 3 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m08:58:53.437791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m08:58:53.438003 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m08:58:53.440022 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m08:58:53.440891 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m08:58:53.451656 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m08:58:53.452695 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:58:53.452943 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m08:58:53.453212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:58:53.463313 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:58:53.463564 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:58:53.463806 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m08:58:53.464365 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:58:53.465953 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:58:53.466177 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m08:58:53.466650 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:58:53.468260 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:58:53.468500 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m08:58:53.468857 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:58:53.472033 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m08:58:53.472275 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:58:53.472507 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m08:58:53.473738 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:53.474904 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m08:58:53.475106 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m08:58:53.475844 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:58:53.476584 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m08:58:53.490474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbbde91f-12b9-4605-b985-aec49e8742ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7517f204c0a0>]}
[0m08:58:53.490914 [info ] [Thread-1 (]: 3 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m08:58:53.491301 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m08:58:53.491821 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m08:58:53.492183 [info ] [Thread-1 (]: 4 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m08:58:53.492495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m08:58:53.492735 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m08:58:53.494589 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m08:58:53.495551 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m08:58:53.497638 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m08:58:53.498556 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:58:53.498758 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m08:58:53.499006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:58:53.509113 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:58:53.509422 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:58:53.509660 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m08:58:53.510109 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:58:53.532651 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:58:53.532958 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m08:58:53.533601 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:58:53.535245 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:58:53.535463 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m08:58:53.536043 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:58:53.536944 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m08:58:53.537168 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:58:53.537404 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m08:58:53.538589 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:53.539822 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m08:58:53.540039 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m08:58:53.540669 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:58:53.541360 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m08:58:53.553591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbbde91f-12b9-4605-b985-aec49e8742ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7517f204c0a0>]}
[0m08:58:53.554186 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m08:58:53.554669 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m08:58:53.555536 [debug] [MainThread]: Using duckdb connection "master"
[0m08:58:53.555848 [debug] [MainThread]: On master: BEGIN
[0m08:58:53.556107 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:58:53.569901 [debug] [MainThread]: SQL status: OK in 0.014 seconds
[0m08:58:53.570624 [debug] [MainThread]: On master: COMMIT
[0m08:58:53.571168 [debug] [MainThread]: Using duckdb connection "master"
[0m08:58:53.571643 [debug] [MainThread]: On master: COMMIT
[0m08:58:53.572528 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:58:53.572984 [debug] [MainThread]: On master: Close
[0m08:58:53.575090 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:58:53.575530 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m08:58:53.575841 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m08:58:53.576253 [info ] [MainThread]: 
[0m08:58:53.576625 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m08:58:53.577619 [debug] [MainThread]: Command end result
[0m08:58:53.598313 [info ] [MainThread]: 
[0m08:58:53.598594 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:58:53.598818 [info ] [MainThread]: 
[0m08:58:53.599118 [error] [MainThread]:   Runtime Error in model grain_jour (models/example/grain_jour.sql)
  Binder Error: Referenced column "Poduction_totale" not found in FROM clause!
  Candidate bindings: "clean.production_totale", "clean.Eolien", "clean.Eolien offshore", "clean.Stockage batterie", "clean.TCH Nucléaire (%)"
  LINE 34:     SUM(COALESCE(TRY_CAST("Poduction_totale" AS INT), 0)) AS production_totale
  FROM clean
  WHERE Région IS NOT NULL AND Date IS NOT NULL
  GROUP BY Date, Région)
  
  SELECT * from vue_journaliere
    );
  ...
                                     ^
[0m08:58:53.599334 [info ] [MainThread]: 
[0m08:58:53.599608 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m08:58:53.600013 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9330021, "process_in_blocks": "10080", "process_kernel_time": 0.130244, "process_mem_max_rss": "140004", "process_out_blocks": "7144", "process_user_time": 1.22613}
[0m08:58:53.600319 [debug] [MainThread]: Command `dbt run` failed at 08:58:53.600267 after 0.93 seconds
[0m08:58:53.600530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7517f387bd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7517f202a920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7517f2028ee0>]}
[0m08:58:53.600726 [debug] [MainThread]: Flushing usage events
[0m09:07:18.966516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713b460fbd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713b464d72e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713b464d7280>]}


============================== 09:07:18.969491 | a21ea604-5ccf-47cf-9ad6-9f4a8b394d5f ==============================
[0m09:07:18.969491 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:07:18.969979 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:07:19.097854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a21ea604-5ccf-47cf-9ad6-9f4a8b394d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713b45b58dc0>]}
[0m09:07:19.137827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a21ea604-5ccf-47cf-9ad6-9f4a8b394d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713b452e2d10>]}
[0m09:07:19.140133 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m09:07:19.180431 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:07:19.284473 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:07:19.285245 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:07:19.291170 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m09:07:19.309711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a21ea604-5ccf-47cf-9ad6-9f4a8b394d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713b3f1d9450>]}
[0m09:07:19.372196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a21ea604-5ccf-47cf-9ad6-9f4a8b394d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713b3f1d9a80>]}
[0m09:07:19.372578 [info ] [MainThread]: Found 5 models, 4 data tests, 421 macros
[0m09:07:19.372917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a21ea604-5ccf-47cf-9ad6-9f4a8b394d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713b3f1d9b10>]}
[0m09:07:19.374078 [info ] [MainThread]: 
[0m09:07:19.374476 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:07:19.377531 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m09:07:19.620799 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m09:07:19.621490 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m09:07:19.621977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:07:19.643541 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m09:07:19.645903 [debug] [ThreadPool]: On list_dev: Close
[0m09:07:19.649439 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m09:07:19.650082 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m09:07:19.655528 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:07:19.655759 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m09:07:19.656095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:07:19.666862 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m09:07:19.667607 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:07:19.667808 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m09:07:19.668232 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:07:19.668420 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:07:19.668681 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m09:07:19.669101 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:07:19.669597 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m09:07:19.669807 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:07:19.670089 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m09:07:19.670471 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:07:19.670713 [debug] [ThreadPool]: On create_dev_main: Close
[0m09:07:19.672976 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m09:07:19.681737 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:07:19.682264 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m09:07:19.682658 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:07:19.696039 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m09:07:19.696458 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:07:19.696847 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m09:07:19.711882 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m09:07:19.712660 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m09:07:19.713210 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m09:07:19.713393 [debug] [ThreadPool]: On list_dev_main: Close
[0m09:07:19.715112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a21ea604-5ccf-47cf-9ad6-9f4a8b394d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713b461df010>]}
[0m09:07:19.715370 [debug] [MainThread]: Using duckdb connection "master"
[0m09:07:19.715585 [debug] [MainThread]: On master: BEGIN
[0m09:07:19.715793 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:07:19.725935 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m09:07:19.726150 [debug] [MainThread]: On master: COMMIT
[0m09:07:19.726483 [debug] [MainThread]: Using duckdb connection "master"
[0m09:07:19.726690 [debug] [MainThread]: On master: COMMIT
[0m09:07:19.727031 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:07:19.727224 [debug] [MainThread]: On master: Close
[0m09:07:19.728463 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:07:19.728681 [info ] [MainThread]: 
[0m09:07:19.729895 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m09:07:19.730418 [info ] [Thread-1 (]: 1 of 5 START sql view model main.clean ......................................... [RUN]
[0m09:07:19.731045 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.clean'
[0m09:07:19.731363 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m09:07:19.735206 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m09:07:19.736913 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m09:07:19.753287 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m09:07:19.755165 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m09:07:19.755385 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m09:07:19.755659 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:07:19.766671 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m09:07:19.766917 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m09:07:19.767239 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT  "Code INSEE région",
    "Région",
    "Nature",
    "Date",
    "Heure",
    "Date - Heure",
    "Consommation (MW)",
    "Thermique (MW)",
    "Nucléaire (MW)",
    "Eolien (MW)",
    "Solaire (MW)",
    "Hydraulique (MW)",
    "Pompage (MW)",
    "Bioénergies (MW)",
    "Ech. physiques (MW)",
    "Stockage batterie",
    "Déstockage batterie",
    "Eolien terrestre",
    "Eolien offshore",
    "TCO Thermique (%)",
    "TCH Thermique (%)",
    "TCO Nucléaire (%)",
    "TCH Nucléaire (%)",
    "TCO Eolien (%)",
    "TCH Eolien (%)",
    "TCO Solaire (%)",
    "TCH Solaire (%)",
    "TCO Hydraulique (%)",
    "TCH Hydraulique (%)",
    "TCO Bioénergies (%)",
    "TCH Bioénergies (%) "
    FROM clean
  );

[0m09:07:19.768132 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT  "Code INSEE région",
    "Région",
    "Nature",
    "Date",
    "Heure",
    "Date - Heure",
    "Consommation (MW)",
    "Thermique (MW)",
    "Nucléaire (MW)",
    "Eolien (MW)",
    "Solaire (MW)",
    "Hydraulique (MW)",
    "Pompage (MW)",
    "Bioénergies (MW)",
    "Ech. physiques (MW)",
    "Stockage batterie",
    "Déstockage batterie",
    "Eolien terrestre",
    "Eolien offshore",
    "TCO Thermique (%)",
    "TCH Thermique (%)",
    "TCO Nucléaire (%)",
    "TCH Nucléaire (%)",
    "TCO Eolien (%)",
    "TCH Eolien (%)",
    "TCO Solaire (%)",
    "TCH Solaire (%)",
    "TCO Hydraulique (%)",
    "TCH Hydraulique (%)",
    "TCO Bioénergies (%)",
    "TCH Bioénergies (%) "
    FROM clean
  );

[0m09:07:19.768389 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:07:19.768785 [debug] [Thread-1 (]: On model.transform.clean: ROLLBACK
[0m09:07:19.771096 [debug] [Thread-1 (]: Failed to rollback 'model.transform.clean'
[0m09:07:19.771398 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m09:07:19.772920 [debug] [Thread-1 (]: Runtime Error in model clean (models/example/clean.sql)
  Binder Error: Referenced column "TCH Bioénergies (%) " not found in FROM clause!
  Candidate bindings: "clean.TCH Bioénergies (%)", "clean.TCO Bioénergies (%)", "clean.TCH Eolien (%)", "clean.TCH Solaire (%)", "clean.TCH Thermique (%)"
  LINE 49:     "TCH Bioénergies (%) "
               ^
[0m09:07:19.773777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a21ea604-5ccf-47cf-9ad6-9f4a8b394d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713b3f1daa10>]}
[0m09:07:19.774152 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model main.clean ................................ [[31mERROR[0m in 0.04s]
[0m09:07:19.774479 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m09:07:19.774713 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m09:07:19.775506 [info ] [Thread-1 (]: 2 of 5 START sql view model main.grain_jour .................................... [RUN]
[0m09:07:19.775744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m09:07:19.775978 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m09:07:19.777142 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m09:07:19.778122 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m09:07:19.779938 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m09:07:19.780969 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m09:07:19.781216 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m09:07:19.781480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:19.793326 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m09:07:19.793738 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m09:07:19.794208 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH vue_journaliere AS(
SELECT 
    Date, 
    Région,
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS production_thermique_totale,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS production_nucleaire_totale,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS production_eolienne_totale,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS production_solaire_totale,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS production_hydraulique_totale,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS production_bioenergies_totale,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_totaux,
    SUM(COALESCE(TRY_CAST("Stockage batterie" AS INT), 0)) AS stockage_batterie_total,
    SUM(COALESCE(TRY_CAST("Déstockage batterie" AS INT), 0)) AS destockage_batterie_total,
    SUM(COALESCE(TRY_CAST("Eolien terrestre" AS INT), 0)) AS production_eolien_terrestre_totale,
    SUM(COALESCE(TRY_CAST("Eolien offshore" AS INT), 0)) AS production_eolien_offshore_totale,
    AVG(COALESCE(TRY_CAST("TCO Thermique (%)" AS FLOAT), 0)) AS tco_thermique_moyen,
    AVG(COALESCE(TRY_CAST("TCH Thermique (%)" AS FLOAT), 0)) AS tch_thermique_moyen,
    AVG(COALESCE(TRY_CAST("TCO Nucléaire (%)" AS FLOAT), 0)) AS tco_nucleaire_moyen,
    AVG(COALESCE(TRY_CAST("TCH Nucléaire (%)" AS FLOAT), 0)) AS tch_nucleaire_moyen,
    AVG(COALESCE(TRY_CAST("TCO Eolien (%)" AS FLOAT), 0)) AS tco_eolien_moyen,
    AVG(COALESCE(TRY_CAST("TCH Eolien (%)" AS FLOAT), 0)) AS tch_eolien_moyen,
    AVG(COALESCE(TRY_CAST("TCO Solaire (%)" AS FLOAT), 0)) AS tco_solaire_moyen,
    AVG(COALESCE(TRY_CAST("TCH Solaire (%)" AS FLOAT), 0)) AS tch_solaire_moyen,
    AVG(COALESCE(TRY_CAST("TCO Hydraulique (%)" AS FLOAT), 0)) AS tco_hydraulique_moyen,
    AVG(COALESCE(TRY_CAST("TCH Hydraulique (%)" AS FLOAT), 0)) AS tch_hydraulique_moyen,
    AVG(COALESCE(TRY_CAST("TCO Bioénergies (%)" AS FLOAT), 0)) AS tco_bioenergies_moyen,
    AVG(COALESCE(TRY_CAST("TCH Bioénergies (%)" AS FLOAT), 0)) AS tch_bioenergies_moyen,
    SUM(COALESCE(TRY_CAST("Poduction_totale" AS INT), 0)) AS production_totale
FROM clean
WHERE Région IS NOT NULL AND Date IS NOT NULL
GROUP BY Date, Région)

SELECT * from vue_journaliere
  );

[0m09:07:19.795936 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH vue_journaliere AS(
SELECT 
    Date, 
    Région,
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS production_thermique_totale,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS production_nucleaire_totale,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS production_eolienne_totale,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS production_solaire_totale,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS production_hydraulique_totale,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS production_bioenergies_totale,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_totaux,
    SUM(COALESCE(TRY_CAST("Stockage batterie" AS INT), 0)) AS stockage_batterie_total,
    SUM(COALESCE(TRY_CAST("Déstockage batterie" AS INT), 0)) AS destockage_batterie_total,
    SUM(COALESCE(TRY_CAST("Eolien terrestre" AS INT), 0)) AS production_eolien_terrestre_totale,
    SUM(COALESCE(TRY_CAST("Eolien offshore" AS INT), 0)) AS production_eolien_offshore_totale,
    AVG(COALESCE(TRY_CAST("TCO Thermique (%)" AS FLOAT), 0)) AS tco_thermique_moyen,
    AVG(COALESCE(TRY_CAST("TCH Thermique (%)" AS FLOAT), 0)) AS tch_thermique_moyen,
    AVG(COALESCE(TRY_CAST("TCO Nucléaire (%)" AS FLOAT), 0)) AS tco_nucleaire_moyen,
    AVG(COALESCE(TRY_CAST("TCH Nucléaire (%)" AS FLOAT), 0)) AS tch_nucleaire_moyen,
    AVG(COALESCE(TRY_CAST("TCO Eolien (%)" AS FLOAT), 0)) AS tco_eolien_moyen,
    AVG(COALESCE(TRY_CAST("TCH Eolien (%)" AS FLOAT), 0)) AS tch_eolien_moyen,
    AVG(COALESCE(TRY_CAST("TCO Solaire (%)" AS FLOAT), 0)) AS tco_solaire_moyen,
    AVG(COALESCE(TRY_CAST("TCH Solaire (%)" AS FLOAT), 0)) AS tch_solaire_moyen,
    AVG(COALESCE(TRY_CAST("TCO Hydraulique (%)" AS FLOAT), 0)) AS tco_hydraulique_moyen,
    AVG(COALESCE(TRY_CAST("TCH Hydraulique (%)" AS FLOAT), 0)) AS tch_hydraulique_moyen,
    AVG(COALESCE(TRY_CAST("TCO Bioénergies (%)" AS FLOAT), 0)) AS tco_bioenergies_moyen,
    AVG(COALESCE(TRY_CAST("TCH Bioénergies (%)" AS FLOAT), 0)) AS tch_bioenergies_moyen,
    SUM(COALESCE(TRY_CAST("Poduction_totale" AS INT), 0)) AS production_totale
FROM clean
WHERE Région IS NOT NULL AND Date IS NOT NULL
GROUP BY Date, Région)

SELECT * from vue_journaliere
  );

[0m09:07:19.796361 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:07:19.796813 [debug] [Thread-1 (]: On model.transform.grain_jour: ROLLBACK
[0m09:07:19.797428 [debug] [Thread-1 (]: Failed to rollback 'model.transform.grain_jour'
[0m09:07:19.797664 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m09:07:19.799251 [debug] [Thread-1 (]: Runtime Error in model grain_jour (models/example/grain_jour.sql)
  Binder Error: Referenced column "Poduction_totale" not found in FROM clause!
  Candidate bindings: "clean.production_totale", "clean.Eolien", "clean.Eolien offshore", "clean.Stockage batterie", "clean.TCH Nucléaire (%)"
  LINE 34:     SUM(COALESCE(TRY_CAST("Poduction_totale" AS INT), 0)) AS production_totale
  FROM clean
  WHERE Région IS NOT NULL AND Date IS NOT NULL
  GROUP BY Date, Région)
  
  SELECT * from vue_journaliere
    );
  ...
                                     ^
[0m09:07:19.799583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a21ea604-5ccf-47cf-9ad6-9f4a8b394d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713b3e710eb0>]}
[0m09:07:19.799983 [error] [Thread-1 (]: 2 of 5 ERROR creating sql view model main.grain_jour ........................... [[31mERROR[0m in 0.02s]
[0m09:07:19.800335 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m09:07:19.800557 [debug] [Thread-1 (]: Began running node model.transform.jour
[0m09:07:19.800876 [info ] [Thread-1 (]: 3 of 5 START sql view model main.jour .......................................... [RUN]
[0m09:07:19.801110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.jour)
[0m09:07:19.801345 [debug] [Thread-1 (]: Began compiling node model.transform.jour
[0m09:07:19.802355 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.jour"
[0m09:07:19.803371 [debug] [Thread-1 (]: Began executing node model.transform.jour
[0m09:07:19.805191 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.jour"
[0m09:07:19.810353 [debug] [Thread-1 (]: Using duckdb connection "model.transform.jour"
[0m09:07:19.810543 [debug] [Thread-1 (]: On model.transform.jour: BEGIN
[0m09:07:19.810816 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:19.820825 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m09:07:19.821070 [debug] [Thread-1 (]: Using duckdb connection "model.transform.jour"
[0m09:07:19.821375 [debug] [Thread-1 (]: On model.transform.jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.jour"} */

  
  create view "dev"."main"."jour__dbt_tmp" as (
    select
  );

[0m09:07:19.821756 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.jour"} */

  
  create view "dev"."main"."jour__dbt_tmp" as (
    select
  );

[0m09:07:19.821947 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:07:19.822305 [debug] [Thread-1 (]: On model.transform.jour: ROLLBACK
[0m09:07:19.822750 [debug] [Thread-1 (]: Failed to rollback 'model.transform.jour'
[0m09:07:19.822925 [debug] [Thread-1 (]: On model.transform.jour: Close
[0m09:07:19.824497 [debug] [Thread-1 (]: Runtime Error in model jour (models/example/jour.sql)
  Parser Error: SELECT clause without selection list
[0m09:07:19.824755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a21ea604-5ccf-47cf-9ad6-9f4a8b394d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713b3bf35060>]}
[0m09:07:19.825176 [error] [Thread-1 (]: 3 of 5 ERROR creating sql view model main.jour ................................. [[31mERROR[0m in 0.02s]
[0m09:07:19.825483 [debug] [Thread-1 (]: Finished running node model.transform.jour
[0m09:07:19.825703 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m09:07:19.826031 [info ] [Thread-1 (]: 4 of 5 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m09:07:19.826338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.jour, now model.transform.my_first_dbt_model)
[0m09:07:19.826579 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m09:07:19.828106 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m09:07:19.829080 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m09:07:19.839282 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m09:07:19.840300 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m09:07:19.840501 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m09:07:19.840775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:19.850821 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m09:07:19.851064 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m09:07:19.851396 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m09:07:19.852141 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:07:19.855325 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m09:07:19.855557 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m09:07:19.856015 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:07:19.857556 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m09:07:19.857771 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m09:07:19.858214 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:07:19.868085 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m09:07:19.868320 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m09:07:19.868695 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m09:07:19.870237 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:19.872753 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m09:07:19.873012 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m09:07:19.873861 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:07:19.875317 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m09:07:19.890147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a21ea604-5ccf-47cf-9ad6-9f4a8b394d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713b3bf351e0>]}
[0m09:07:19.890678 [info ] [Thread-1 (]: 4 of 5 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m09:07:19.891080 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m09:07:19.891759 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m09:07:19.892108 [info ] [Thread-1 (]: 5 of 5 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m09:07:19.892468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m09:07:19.892758 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m09:07:19.894971 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m09:07:19.896364 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m09:07:19.900224 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m09:07:19.901788 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m09:07:19.902354 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m09:07:19.902830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:19.917582 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m09:07:19.918196 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m09:07:19.918660 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m09:07:19.919559 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:07:19.922962 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m09:07:19.923266 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m09:07:19.923865 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:07:19.946957 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m09:07:19.947256 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m09:07:19.948215 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:07:19.949187 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m09:07:19.949402 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m09:07:19.949805 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m09:07:19.951367 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:19.952557 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m09:07:19.952765 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m09:07:19.953533 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:07:19.954230 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m09:07:19.965743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a21ea604-5ccf-47cf-9ad6-9f4a8b394d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713b3b5fda80>]}
[0m09:07:19.966124 [info ] [Thread-1 (]: 5 of 5 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.07s]
[0m09:07:19.966439 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m09:07:19.967120 [debug] [MainThread]: Using duckdb connection "master"
[0m09:07:19.967335 [debug] [MainThread]: On master: BEGIN
[0m09:07:19.967548 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:07:19.977793 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m09:07:19.978040 [debug] [MainThread]: On master: COMMIT
[0m09:07:19.978320 [debug] [MainThread]: Using duckdb connection "master"
[0m09:07:19.978560 [debug] [MainThread]: On master: COMMIT
[0m09:07:19.978926 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:07:19.979101 [debug] [MainThread]: On master: Close
[0m09:07:19.980378 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:07:19.980588 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m09:07:19.980799 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m09:07:19.981107 [info ] [MainThread]: 
[0m09:07:19.981386 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m09:07:19.982107 [debug] [MainThread]: Command end result
[0m09:07:20.003107 [info ] [MainThread]: 
[0m09:07:20.003399 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m09:07:20.003767 [info ] [MainThread]: 
[0m09:07:20.004105 [error] [MainThread]:   Runtime Error in model clean (models/example/clean.sql)
  Binder Error: Referenced column "TCH Bioénergies (%) " not found in FROM clause!
  Candidate bindings: "clean.TCH Bioénergies (%)", "clean.TCO Bioénergies (%)", "clean.TCH Eolien (%)", "clean.TCH Solaire (%)", "clean.TCH Thermique (%)"
  LINE 49:     "TCH Bioénergies (%) "
               ^
[0m09:07:20.004368 [info ] [MainThread]: 
[0m09:07:20.004691 [error] [MainThread]:   Runtime Error in model grain_jour (models/example/grain_jour.sql)
  Binder Error: Referenced column "Poduction_totale" not found in FROM clause!
  Candidate bindings: "clean.production_totale", "clean.Eolien", "clean.Eolien offshore", "clean.Stockage batterie", "clean.TCH Nucléaire (%)"
  LINE 34:     SUM(COALESCE(TRY_CAST("Poduction_totale" AS INT), 0)) AS production_totale
  FROM clean
  WHERE Région IS NOT NULL AND Date IS NOT NULL
  GROUP BY Date, Région)
  
  SELECT * from vue_journaliere
    );
  ...
                                     ^
[0m09:07:20.004941 [info ] [MainThread]: 
[0m09:07:20.005274 [error] [MainThread]:   Runtime Error in model jour (models/example/jour.sql)
  Parser Error: SELECT clause without selection list
[0m09:07:20.005494 [info ] [MainThread]: 
[0m09:07:20.005783 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 TOTAL=5
[0m09:07:20.006295 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0684854, "process_in_blocks": "11200", "process_kernel_time": 0.165534, "process_mem_max_rss": "140020", "process_out_blocks": "6256", "process_user_time": 1.315301}
[0m09:07:20.006581 [debug] [MainThread]: Command `dbt run` failed at 09:07:20.006532 after 1.07 seconds
[0m09:07:20.006786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713b460fbd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713b452e14e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713b44aa74f0>]}
[0m09:07:20.007053 [debug] [MainThread]: Flushing usage events
[0m09:21:51.982700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73002cb8fd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73002b168d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73002b168d90>]}


============================== 09:21:51.985627 | 071d982c-2e44-4cd3-a1cb-6a29406aa7b9 ==============================
[0m09:21:51.985627 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:21:51.986117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:21:52.114410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '071d982c-2e44-4cd3-a1cb-6a29406aa7b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73002c5d4dc0>]}
[0m09:21:52.147619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '071d982c-2e44-4cd3-a1cb-6a29406aa7b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73002bf36d10>]}
[0m09:21:52.149960 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m09:21:52.190150 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:21:52.287342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:21:52.287831 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:21:52.293830 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m09:21:52.312471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '071d982c-2e44-4cd3-a1cb-6a29406aa7b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730025375450>]}
[0m09:21:52.373141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '071d982c-2e44-4cd3-a1cb-6a29406aa7b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730025375a80>]}
[0m09:21:52.373451 [info ] [MainThread]: Found 5 models, 4 data tests, 421 macros
[0m09:21:52.373862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '071d982c-2e44-4cd3-a1cb-6a29406aa7b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730025375b10>]}
[0m09:21:52.374885 [info ] [MainThread]: 
[0m09:21:52.375210 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:21:52.378069 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m09:21:52.622164 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m09:21:52.622875 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m09:21:52.623348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:21:52.640958 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m09:21:52.641968 [debug] [ThreadPool]: On list_dev: Close
[0m09:21:52.643772 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m09:21:52.644113 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m09:21:52.647773 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:21:52.647984 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m09:21:52.648205 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:21:52.658263 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m09:21:52.658979 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:21:52.659172 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m09:21:52.659559 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:21:52.659766 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:21:52.660007 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m09:21:52.660401 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:21:52.660809 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m09:21:52.660991 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:21:52.661228 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m09:21:52.661572 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:21:52.661771 [debug] [ThreadPool]: On create_dev_main: Close
[0m09:21:52.663265 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m09:21:52.666223 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:21:52.666425 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m09:21:52.666660 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:21:52.677742 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m09:21:52.678221 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:21:52.678611 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m09:21:52.695178 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m09:21:52.695914 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m09:21:52.696448 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m09:21:52.696635 [debug] [ThreadPool]: On list_dev_main: Close
[0m09:21:52.698547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '071d982c-2e44-4cd3-a1cb-6a29406aa7b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73002ccd3010>]}
[0m09:21:52.698809 [debug] [MainThread]: Using duckdb connection "master"
[0m09:21:52.699069 [debug] [MainThread]: On master: BEGIN
[0m09:21:52.699316 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:21:52.709570 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m09:21:52.709921 [debug] [MainThread]: On master: COMMIT
[0m09:21:52.710191 [debug] [MainThread]: Using duckdb connection "master"
[0m09:21:52.710431 [debug] [MainThread]: On master: COMMIT
[0m09:21:52.710829 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:21:52.711082 [debug] [MainThread]: On master: Close
[0m09:21:52.712685 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:21:52.713068 [info ] [MainThread]: 
[0m09:21:52.714795 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m09:21:52.715655 [info ] [Thread-1 (]: 1 of 5 START sql view model main.clean ......................................... [RUN]
[0m09:21:52.716611 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.clean'
[0m09:21:52.716993 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m09:21:52.723159 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m09:21:52.724799 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m09:21:52.741603 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m09:21:52.743233 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m09:21:52.743464 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m09:21:52.743704 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:21:52.754267 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m09:21:52.754524 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m09:21:52.754811 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT "Code INSEE région",	"Région"	,"Nature",	"Date",	"Heure",	"Date - Heure",	
"Consommation (MW)"	,"Thermique (MW)",	"Nucléaire (MW)",	"Eolien (MW)",	"Solaire (MW)",	"Hydraulique (MW)",	"Pompage (MW)",	"Bioénergies (MW)",	"Ech. physiques (MW)","production_totale"

     FROM clean
  );

[0m09:21:52.755589 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:21:52.759037 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m09:21:52.759270 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m09:21:52.759680 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:21:52.761246 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m09:21:52.761457 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m09:21:52.761902 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:21:52.770466 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m09:21:52.770717 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m09:21:52.770945 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m09:21:52.772415 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:21:52.774958 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m09:21:52.775184 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m09:21:52.775942 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:21:52.777325 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m09:21:52.790388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '071d982c-2e44-4cd3-a1cb-6a29406aa7b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730025376a10>]}
[0m09:21:52.790852 [info ] [Thread-1 (]: 1 of 5 OK created sql view model main.clean .................................... [[32mOK[0m in 0.07s]
[0m09:21:52.791193 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m09:21:52.791437 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m09:21:52.791752 [info ] [Thread-1 (]: 2 of 5 START sql view model main.grain_jour .................................... [RUN]
[0m09:21:52.792008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m09:21:52.792233 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m09:21:52.793397 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m09:21:52.794434 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m09:21:52.796369 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m09:21:52.797304 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m09:21:52.797503 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m09:21:52.797742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:52.807780 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m09:21:52.808041 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m09:21:52.808343 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH vue_journaliere AS(
SELECT 
    Date, 
    Région,
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS production_thermique_totale,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS production_nucleaire_totale,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS production_eolienne_totale,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS production_solaire_totale,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS production_hydraulique_totale,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS production_bioenergies_totale,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_totaux,
    SUM(COALESCE(TRY_CAST("Stockage batterie" AS INT), 0)) AS stockage_batterie_total,
    SUM(COALESCE(TRY_CAST("Déstockage batterie" AS INT), 0)) AS destockage_batterie_total,
    SUM(COALESCE(TRY_CAST("Eolien terrestre" AS INT), 0)) AS production_eolien_terrestre_totale,
    SUM(COALESCE(TRY_CAST("Eolien offshore" AS INT), 0)) AS production_eolien_offshore_totale,
    AVG(COALESCE(TRY_CAST("TCO Thermique (%)" AS FLOAT), 0)) AS tco_thermique_moyen,
    AVG(COALESCE(TRY_CAST("TCH Thermique (%)" AS FLOAT), 0)) AS tch_thermique_moyen,
    AVG(COALESCE(TRY_CAST("TCO Nucléaire (%)" AS FLOAT), 0)) AS tco_nucleaire_moyen,
    AVG(COALESCE(TRY_CAST("TCH Nucléaire (%)" AS FLOAT), 0)) AS tch_nucleaire_moyen,
    AVG(COALESCE(TRY_CAST("TCO Eolien (%)" AS FLOAT), 0)) AS tco_eolien_moyen,
    AVG(COALESCE(TRY_CAST("TCH Eolien (%)" AS FLOAT), 0)) AS tch_eolien_moyen,
    AVG(COALESCE(TRY_CAST("TCO Solaire (%)" AS FLOAT), 0)) AS tco_solaire_moyen,
    AVG(COALESCE(TRY_CAST("TCH Solaire (%)" AS FLOAT), 0)) AS tch_solaire_moyen,
    AVG(COALESCE(TRY_CAST("TCO Hydraulique (%)" AS FLOAT), 0)) AS tco_hydraulique_moyen,
    AVG(COALESCE(TRY_CAST("TCH Hydraulique (%)" AS FLOAT), 0)) AS tch_hydraulique_moyen,
    AVG(COALESCE(TRY_CAST("TCO Bioénergies (%)" AS FLOAT), 0)) AS tco_bioenergies_moyen,
    AVG(COALESCE(TRY_CAST("TCH Bioénergies (%)" AS FLOAT), 0)) AS tch_bioenergies_moyen,
    SUM(COALESCE(TRY_CAST("Poduction_totale" AS INT), 0)) AS production_totale
FROM clean
WHERE Région IS NOT NULL AND Date IS NOT NULL
GROUP BY Date, Région)

SELECT * from vue_journaliere
  );

[0m09:21:52.809528 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH vue_journaliere AS(
SELECT 
    Date, 
    Région,
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS production_thermique_totale,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS production_nucleaire_totale,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS production_eolienne_totale,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS production_solaire_totale,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS production_hydraulique_totale,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS production_bioenergies_totale,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_totaux,
    SUM(COALESCE(TRY_CAST("Stockage batterie" AS INT), 0)) AS stockage_batterie_total,
    SUM(COALESCE(TRY_CAST("Déstockage batterie" AS INT), 0)) AS destockage_batterie_total,
    SUM(COALESCE(TRY_CAST("Eolien terrestre" AS INT), 0)) AS production_eolien_terrestre_totale,
    SUM(COALESCE(TRY_CAST("Eolien offshore" AS INT), 0)) AS production_eolien_offshore_totale,
    AVG(COALESCE(TRY_CAST("TCO Thermique (%)" AS FLOAT), 0)) AS tco_thermique_moyen,
    AVG(COALESCE(TRY_CAST("TCH Thermique (%)" AS FLOAT), 0)) AS tch_thermique_moyen,
    AVG(COALESCE(TRY_CAST("TCO Nucléaire (%)" AS FLOAT), 0)) AS tco_nucleaire_moyen,
    AVG(COALESCE(TRY_CAST("TCH Nucléaire (%)" AS FLOAT), 0)) AS tch_nucleaire_moyen,
    AVG(COALESCE(TRY_CAST("TCO Eolien (%)" AS FLOAT), 0)) AS tco_eolien_moyen,
    AVG(COALESCE(TRY_CAST("TCH Eolien (%)" AS FLOAT), 0)) AS tch_eolien_moyen,
    AVG(COALESCE(TRY_CAST("TCO Solaire (%)" AS FLOAT), 0)) AS tco_solaire_moyen,
    AVG(COALESCE(TRY_CAST("TCH Solaire (%)" AS FLOAT), 0)) AS tch_solaire_moyen,
    AVG(COALESCE(TRY_CAST("TCO Hydraulique (%)" AS FLOAT), 0)) AS tco_hydraulique_moyen,
    AVG(COALESCE(TRY_CAST("TCH Hydraulique (%)" AS FLOAT), 0)) AS tch_hydraulique_moyen,
    AVG(COALESCE(TRY_CAST("TCO Bioénergies (%)" AS FLOAT), 0)) AS tco_bioenergies_moyen,
    AVG(COALESCE(TRY_CAST("TCH Bioénergies (%)" AS FLOAT), 0)) AS tch_bioenergies_moyen,
    SUM(COALESCE(TRY_CAST("Poduction_totale" AS INT), 0)) AS production_totale
FROM clean
WHERE Région IS NOT NULL AND Date IS NOT NULL
GROUP BY Date, Région)

SELECT * from vue_journaliere
  );

[0m09:21:52.809822 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:21:52.810123 [debug] [Thread-1 (]: On model.transform.grain_jour: ROLLBACK
[0m09:21:52.812358 [debug] [Thread-1 (]: Failed to rollback 'model.transform.grain_jour'
[0m09:21:52.812624 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m09:21:52.814197 [debug] [Thread-1 (]: Runtime Error in model grain_jour (models/example/grain_jour.sql)
  Binder Error: Referenced column "Stockage batterie" not found in FROM clause!
  Candidate bindings: "clean.Date - Heure", "clean.Solaire (MW)", "clean.Pompage (MW)", "clean.Date", "clean.production_totale"
  LINE 18:     SUM(COALESCE(TRY_CAST("Stockage batterie" AS INT), 0)) AS stockage_batterie_total,
      SUM(COALESCE(TRY_CAST("Déstockage batterie" AS INT), 0)) AS destockage_batterie_total,
      SUM(COALESCE(TRY_CAST("Eolien terrestre" AS INT), 0)) AS production_eolien_terrestre_totale,
      SUM(COALESCE(TRY_CAST("Eolien offshore" AS INT), 0)) AS production_eolien_offshore_totale,
      AVG(COALESCE(TRY_CAST("TCO Thermique (%)" AS FLOAT), 0)) AS tco_thermique_moyen,
      AVG(COALESCE(TRY_CAST("TCH Thermique (%)" AS FLOAT), 0)) AS tch_thermique_moyen,
      AVG(COALESCE(TRY_CAST("TCO Nucléaire (%)" AS FLOAT), 0)) AS tco_nucleaire_moyen,
      AVG(COALESCE(TRY_CAST("TCH Nucléaire (%)" AS FLOAT), 0)) AS tch_nucleaire_moyen,
      AVG(COALESCE(TRY_CAST("TCO Eolien (%)" AS FLOAT), 0)) AS tco_eolien_moyen,
      AVG(COALESCE(TRY_CAST("TCH Eolien (%)" AS FLOAT), 0)) AS tch_eolien_moyen,
      AVG(COALESCE(TRY_CAST("TCO Solaire (%)" AS FLOAT), 0)) AS tco_solaire_moyen,
      AVG(COALESCE(TRY_CAST("TCH Solaire (%)" AS FLOAT), 0)) AS tch_solaire_moyen,
      AVG(COALESCE(TRY_CAST("TCO Hydraulique (%)" AS FLOAT), 0)) AS tco_hydraulique_moyen,
      AVG(COALESCE(TRY_CAST("TCH Hydraulique (%)" AS FLOAT), 0)) AS tch_hydraulique_moyen,
      AVG(COALESCE(TRY_CAST("TCO Bioénergies (%)" AS FLOAT), 0)) AS tco_bioenergies_moyen,
      AVG(COALESCE(TRY_CAST("TCH Bioénergies (%)" AS FLOAT), 0)) AS tch_bioenergies_moyen,
      SUM(COALESCE(TRY_CAST("Poduction_totale" AS INT), 0)) AS production_totale
  FROM clean
  WHERE Région IS NOT NULL AND Date IS NOT NULL
  GROUP BY Date, Région)
  
  SELECT * from vue_journaliere
    );
  ...
                                     ^
[0m09:21:52.814516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '071d982c-2e44-4cd3-a1cb-6a29406aa7b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730022b84a00>]}
[0m09:21:52.814955 [error] [Thread-1 (]: 2 of 5 ERROR creating sql view model main.grain_jour ........................... [[31mERROR[0m in 0.02s]
[0m09:21:52.815317 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m09:21:52.815541 [debug] [Thread-1 (]: Began running node model.transform.jour
[0m09:21:52.816379 [info ] [Thread-1 (]: 3 of 5 START sql view model main.jour .......................................... [RUN]
[0m09:21:52.816673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.jour)
[0m09:21:52.816896 [debug] [Thread-1 (]: Began compiling node model.transform.jour
[0m09:21:52.818525 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.jour"
[0m09:21:52.819549 [debug] [Thread-1 (]: Began executing node model.transform.jour
[0m09:21:52.821414 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.jour"
[0m09:21:52.822438 [debug] [Thread-1 (]: Using duckdb connection "model.transform.jour"
[0m09:21:52.822634 [debug] [Thread-1 (]: On model.transform.jour: BEGIN
[0m09:21:52.822905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:52.833183 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m09:21:52.833441 [debug] [Thread-1 (]: Using duckdb connection "model.transform.jour"
[0m09:21:52.833759 [debug] [Thread-1 (]: On model.transform.jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.jour"} */

  
  create view "dev"."main"."jour__dbt_tmp" as (
    SELECT "Déstockage batterie", COUNT(*) AS value_count
FROM eco2
GROUP BY "Déstockage batterie"
ORDER BY value_count DESC;
  );

[0m09:21:52.834147 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.jour"} */

  
  create view "dev"."main"."jour__dbt_tmp" as (
    SELECT "Déstockage batterie", COUNT(*) AS value_count
FROM eco2
GROUP BY "Déstockage batterie"
ORDER BY value_count DESC;
  );

[0m09:21:52.834354 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:21:52.834695 [debug] [Thread-1 (]: On model.transform.jour: ROLLBACK
[0m09:21:52.835122 [debug] [Thread-1 (]: Failed to rollback 'model.transform.jour'
[0m09:21:52.835303 [debug] [Thread-1 (]: On model.transform.jour: Close
[0m09:21:52.836725 [debug] [Thread-1 (]: Runtime Error in model jour (models/example/jour.sql)
  Parser Error: syntax error at or near ";"
[0m09:21:52.836985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '071d982c-2e44-4cd3-a1cb-6a29406aa7b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7300221fab60>]}
[0m09:21:52.837329 [error] [Thread-1 (]: 3 of 5 ERROR creating sql view model main.jour ................................. [[31mERROR[0m in 0.02s]
[0m09:21:52.837621 [debug] [Thread-1 (]: Finished running node model.transform.jour
[0m09:21:52.837840 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m09:21:52.838151 [info ] [Thread-1 (]: 4 of 5 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m09:21:52.838392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.jour, now model.transform.my_first_dbt_model)
[0m09:21:52.838576 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m09:21:52.840028 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m09:21:52.840888 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m09:21:52.851012 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m09:21:52.852010 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m09:21:52.852248 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m09:21:52.852496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:52.862704 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m09:21:52.862963 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m09:21:52.863202 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m09:21:52.863805 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:21:52.865444 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m09:21:52.865670 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m09:21:52.866118 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:21:52.867663 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m09:21:52.867881 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m09:21:52.868330 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:21:52.871029 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m09:21:52.871254 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m09:21:52.871519 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m09:21:52.872948 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:21:52.874118 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m09:21:52.874326 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m09:21:52.874972 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:21:52.876190 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m09:21:52.890389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '071d982c-2e44-4cd3-a1cb-6a29406aa7b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7300217a3a60>]}
[0m09:21:52.890820 [info ] [Thread-1 (]: 4 of 5 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m09:21:52.891142 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m09:21:52.891584 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m09:21:52.891923 [info ] [Thread-1 (]: 5 of 5 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m09:21:52.892200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m09:21:52.892402 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m09:21:52.916701 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m09:21:52.917867 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m09:21:52.919710 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m09:21:52.920650 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m09:21:52.920962 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m09:21:52.921214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:52.931777 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m09:21:52.932016 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m09:21:52.932294 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m09:21:52.932838 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:21:52.934405 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m09:21:52.934626 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m09:21:52.935020 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:21:52.936601 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m09:21:52.936841 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m09:21:52.937218 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:21:52.938071 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m09:21:52.938281 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m09:21:52.938533 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m09:21:52.939595 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:21:52.940792 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m09:21:52.941004 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m09:21:52.941653 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:21:52.942404 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m09:21:52.953954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '071d982c-2e44-4cd3-a1cb-6a29406aa7b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730025376a10>]}
[0m09:21:52.954364 [info ] [Thread-1 (]: 5 of 5 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m09:21:52.954681 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m09:21:52.955253 [debug] [MainThread]: Using duckdb connection "master"
[0m09:21:52.955464 [debug] [MainThread]: On master: BEGIN
[0m09:21:52.955700 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:21:52.965954 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m09:21:52.966190 [debug] [MainThread]: On master: COMMIT
[0m09:21:52.966515 [debug] [MainThread]: Using duckdb connection "master"
[0m09:21:52.966755 [debug] [MainThread]: On master: COMMIT
[0m09:21:52.967136 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:21:52.967307 [debug] [MainThread]: On master: Close
[0m09:21:52.968395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:21:52.968607 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m09:21:52.968865 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m09:21:52.969181 [info ] [MainThread]: 
[0m09:21:52.969381 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m09:21:52.970050 [debug] [MainThread]: Command end result
[0m09:21:52.990641 [info ] [MainThread]: 
[0m09:21:52.990936 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m09:21:52.991304 [info ] [MainThread]: 
[0m09:21:52.991668 [error] [MainThread]:   Runtime Error in model grain_jour (models/example/grain_jour.sql)
  Binder Error: Referenced column "Stockage batterie" not found in FROM clause!
  Candidate bindings: "clean.Date - Heure", "clean.Solaire (MW)", "clean.Pompage (MW)", "clean.Date", "clean.production_totale"
  LINE 18:     SUM(COALESCE(TRY_CAST("Stockage batterie" AS INT), 0)) AS stockage_batterie_total,
      SUM(COALESCE(TRY_CAST("Déstockage batterie" AS INT), 0)) AS destockage_batterie_total,
      SUM(COALESCE(TRY_CAST("Eolien terrestre" AS INT), 0)) AS production_eolien_terrestre_totale,
      SUM(COALESCE(TRY_CAST("Eolien offshore" AS INT), 0)) AS production_eolien_offshore_totale,
      AVG(COALESCE(TRY_CAST("TCO Thermique (%)" AS FLOAT), 0)) AS tco_thermique_moyen,
      AVG(COALESCE(TRY_CAST("TCH Thermique (%)" AS FLOAT), 0)) AS tch_thermique_moyen,
      AVG(COALESCE(TRY_CAST("TCO Nucléaire (%)" AS FLOAT), 0)) AS tco_nucleaire_moyen,
      AVG(COALESCE(TRY_CAST("TCH Nucléaire (%)" AS FLOAT), 0)) AS tch_nucleaire_moyen,
      AVG(COALESCE(TRY_CAST("TCO Eolien (%)" AS FLOAT), 0)) AS tco_eolien_moyen,
      AVG(COALESCE(TRY_CAST("TCH Eolien (%)" AS FLOAT), 0)) AS tch_eolien_moyen,
      AVG(COALESCE(TRY_CAST("TCO Solaire (%)" AS FLOAT), 0)) AS tco_solaire_moyen,
      AVG(COALESCE(TRY_CAST("TCH Solaire (%)" AS FLOAT), 0)) AS tch_solaire_moyen,
      AVG(COALESCE(TRY_CAST("TCO Hydraulique (%)" AS FLOAT), 0)) AS tco_hydraulique_moyen,
      AVG(COALESCE(TRY_CAST("TCH Hydraulique (%)" AS FLOAT), 0)) AS tch_hydraulique_moyen,
      AVG(COALESCE(TRY_CAST("TCO Bioénergies (%)" AS FLOAT), 0)) AS tco_bioenergies_moyen,
      AVG(COALESCE(TRY_CAST("TCH Bioénergies (%)" AS FLOAT), 0)) AS tch_bioenergies_moyen,
      SUM(COALESCE(TRY_CAST("Poduction_totale" AS INT), 0)) AS production_totale
  FROM clean
  WHERE Région IS NOT NULL AND Date IS NOT NULL
  GROUP BY Date, Région)
  
  SELECT * from vue_journaliere
    );
  ...
                                     ^
[0m09:21:52.991876 [info ] [MainThread]: 
[0m09:21:52.992204 [error] [MainThread]:   Runtime Error in model jour (models/example/jour.sql)
  Parser Error: syntax error at or near ";"
[0m09:21:52.992405 [info ] [MainThread]: 
[0m09:21:52.992697 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m09:21:52.993212 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0378866, "process_in_blocks": "11232", "process_kernel_time": 0.159073, "process_mem_max_rss": "140056", "process_out_blocks": "7376", "process_user_time": 1.311333}
[0m09:21:52.993532 [debug] [MainThread]: Command `dbt run` failed at 09:21:52.993479 after 1.04 seconds
[0m09:21:52.993747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73002cb8fd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73002b526560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73002b4e4eb0>]}
[0m09:21:52.993986 [debug] [MainThread]: Flushing usage events
[0m09:25:30.828679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f371dfbc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f37212f1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f37212f310>]}


============================== 09:25:30.830446 | 6be45071-de45-4ebb-a82b-d5664260f74e ==============================
[0m09:25:30.830446 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:25:30.830842 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:25:30.956158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6be45071-de45-4ebb-a82b-d5664260f74e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f3705a7850>]}
[0m09:25:30.984325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6be45071-de45-4ebb-a82b-d5664260f74e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f370638ac0>]}
[0m09:25:30.986723 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m09:25:31.027547 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:25:31.123778 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:25:31.124264 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:25:31.130456 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m09:25:31.149201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6be45071-de45-4ebb-a82b-d5664260f74e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f36a5dcfa0>]}
[0m09:25:31.209695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6be45071-de45-4ebb-a82b-d5664260f74e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f36a5dffa0>]}
[0m09:25:31.209995 [info ] [MainThread]: Found 4 models, 4 data tests, 421 macros
[0m09:25:31.210197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6be45071-de45-4ebb-a82b-d5664260f74e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f371c6cdf0>]}
[0m09:25:31.211181 [info ] [MainThread]: 
[0m09:25:31.211590 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:25:31.214472 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m09:25:31.460887 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m09:25:31.461582 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m09:25:31.462119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:25:31.478228 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m09:25:31.480303 [debug] [ThreadPool]: On list_dev: Close
[0m09:25:31.484545 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m09:25:31.485366 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m09:25:31.491745 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:25:31.492020 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m09:25:31.492312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:25:31.502821 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m09:25:31.503700 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:25:31.503948 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m09:25:31.504380 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:25:31.504571 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:25:31.504833 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m09:25:31.505237 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:25:31.505703 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m09:25:31.505893 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:25:31.506149 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m09:25:31.506496 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:25:31.506675 [debug] [ThreadPool]: On create_dev_main: Close
[0m09:25:31.508204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m09:25:31.511320 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:25:31.511526 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m09:25:31.511805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:25:31.522483 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m09:25:31.522911 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:25:31.523290 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m09:25:31.545197 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m09:25:31.546741 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m09:25:31.547644 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m09:25:31.547983 [debug] [ThreadPool]: On list_dev_main: Close
[0m09:25:31.550789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6be45071-de45-4ebb-a82b-d5664260f74e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f371edf670>]}
[0m09:25:31.551248 [debug] [MainThread]: Using duckdb connection "master"
[0m09:25:31.551559 [debug] [MainThread]: On master: BEGIN
[0m09:25:31.551843 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:25:31.567027 [debug] [MainThread]: SQL status: OK in 0.015 seconds
[0m09:25:31.567535 [debug] [MainThread]: On master: COMMIT
[0m09:25:31.567909 [debug] [MainThread]: Using duckdb connection "master"
[0m09:25:31.568249 [debug] [MainThread]: On master: COMMIT
[0m09:25:31.568806 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:25:31.569163 [debug] [MainThread]: On master: Close
[0m09:25:31.570971 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:25:31.571334 [info ] [MainThread]: 
[0m09:25:31.572760 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m09:25:31.573437 [info ] [Thread-1 (]: 1 of 4 START sql view model main.clean ......................................... [RUN]
[0m09:25:31.574204 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.clean'
[0m09:25:31.574657 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m09:25:31.583089 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m09:25:31.585064 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m09:25:31.605518 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m09:25:31.607406 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m09:25:31.607631 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m09:25:31.607988 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:25:31.618558 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m09:25:31.618808 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m09:25:31.619100 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT "Code INSEE région",	"Région"	,	"Date",	"Heure",	
"Consommation (MW)"	,"Thermique (MW)",	"Nucléaire (MW)",	"Eolien (MW)",	"Solaire (MW)",	"Hydraulique (MW)",	"Pompage (MW)",	"Bioénergies (MW)",	"Ech. physiques (MW)","production_totale"

     FROM clean
  );

[0m09:25:31.619871 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:25:31.623223 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m09:25:31.623458 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m09:25:31.623985 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:25:31.625413 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m09:25:31.625623 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m09:25:31.626003 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:25:31.634622 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m09:25:31.634880 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m09:25:31.635266 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m09:25:31.636694 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:25:31.639184 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m09:25:31.639413 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m09:25:31.640029 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:25:31.641342 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m09:25:31.653459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6be45071-de45-4ebb-a82b-d5664260f74e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f372b3eef0>]}
[0m09:25:31.653882 [info ] [Thread-1 (]: 1 of 4 OK created sql view model main.clean .................................... [[32mOK[0m in 0.08s]
[0m09:25:31.654216 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m09:25:31.654446 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m09:25:31.654763 [info ] [Thread-1 (]: 2 of 4 START sql view model main.grain_jour .................................... [RUN]
[0m09:25:31.655009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m09:25:31.655209 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m09:25:31.656256 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m09:25:31.657162 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m09:25:31.659022 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m09:25:31.659932 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m09:25:31.660160 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m09:25:31.660395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:25:31.670612 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m09:25:31.670924 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m09:25:31.671250 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Date", 
    "Heure", 
    "Région", 
    SUM("Consommation (MW)") AS consommation_totale,
    SUM("Thermique (MW)") AS thermique_total,
    SUM("Nucléaire (MW)") AS nucleaire_total,
    SUM("Eolien (MW)") AS eolien_total,
    SUM("Solaire (MW)") AS solaire_total,
    SUM("Hydraulique (MW)") AS hydraulique_total,
    SUM("Pompage (MW)") AS pompage_total,
    SUM("Bioénergies (MW)") AS bioenergies_total,
    SUM("Ech. physiques (MW)") AS echanges_physiques_total,
    SUM(production_totale) AS production_totale
FROM clean
GROUP BY "Date", "Heure", "Région"
ORDER BY "Date", "Heure", "Région"
  );

[0m09:25:31.672215 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Date", 
    "Heure", 
    "Région", 
    SUM("Consommation (MW)") AS consommation_totale,
    SUM("Thermique (MW)") AS thermique_total,
    SUM("Nucléaire (MW)") AS nucleaire_total,
    SUM("Eolien (MW)") AS eolien_total,
    SUM("Solaire (MW)") AS solaire_total,
    SUM("Hydraulique (MW)") AS hydraulique_total,
    SUM("Pompage (MW)") AS pompage_total,
    SUM("Bioénergies (MW)") AS bioenergies_total,
    SUM("Ech. physiques (MW)") AS echanges_physiques_total,
    SUM(production_totale) AS production_totale
FROM clean
GROUP BY "Date", "Heure", "Région"
ORDER BY "Date", "Heure", "Région"
  );

[0m09:25:31.672504 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:25:31.672840 [debug] [Thread-1 (]: On model.transform.grain_jour: ROLLBACK
[0m09:25:31.674951 [debug] [Thread-1 (]: Failed to rollback 'model.transform.grain_jour'
[0m09:25:31.675166 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m09:25:31.676720 [debug] [Thread-1 (]: Runtime Error in model grain_jour (models/example/grain_jour.sql)
  Binder Error: No function matches the given name and argument types 'sum(VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	sum(DECIMAL) -> DECIMAL
  	sum(SMALLINT) -> HUGEINT
  	sum(INTEGER) -> HUGEINT
  	sum(BIGINT) -> HUGEINT
  	sum(HUGEINT) -> HUGEINT
  	sum(DOUBLE) -> DOUBLE
  
  LINE 27:     SUM("Eolien (MW)") AS eolien_total,
               ^
[0m09:25:31.677005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6be45071-de45-4ebb-a82b-d5664260f74e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f367343520>]}
[0m09:25:31.677441 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model main.grain_jour ........................... [[31mERROR[0m in 0.02s]
[0m09:25:31.677756 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m09:25:31.677980 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m09:25:31.678803 [info ] [Thread-1 (]: 3 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m09:25:31.679068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m09:25:31.679267 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m09:25:31.681385 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m09:25:31.682248 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m09:25:31.692331 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m09:25:31.693297 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m09:25:31.693502 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m09:25:31.693746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:25:31.703613 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m09:25:31.703876 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m09:25:31.704109 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m09:25:31.704787 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:25:31.706405 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m09:25:31.706635 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m09:25:31.707007 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:25:31.708553 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m09:25:31.708768 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m09:25:31.709188 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:25:31.711890 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m09:25:31.712116 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m09:25:31.712356 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m09:25:31.713500 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:25:31.714842 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m09:25:31.715064 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m09:25:31.715625 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:25:31.716386 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m09:25:31.731397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6be45071-de45-4ebb-a82b-d5664260f74e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f366906d10>]}
[0m09:25:31.732122 [info ] [Thread-1 (]: 3 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m09:25:31.732791 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m09:25:31.733878 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m09:25:31.734421 [info ] [Thread-1 (]: 4 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m09:25:31.734917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m09:25:31.735305 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m09:25:31.737634 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m09:25:31.738775 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m09:25:31.741346 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m09:25:31.742168 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m09:25:31.742374 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m09:25:31.742554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:25:31.752711 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m09:25:31.752995 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m09:25:31.753257 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m09:25:31.753709 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:25:31.777062 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m09:25:31.777358 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m09:25:31.777997 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:25:31.779542 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m09:25:31.779765 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m09:25:31.780228 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:25:31.781168 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m09:25:31.781378 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m09:25:31.781747 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m09:25:31.782983 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:25:31.784185 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m09:25:31.784397 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m09:25:31.785046 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:25:31.785748 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m09:25:31.797621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6be45071-de45-4ebb-a82b-d5664260f74e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f365f13f70>]}
[0m09:25:31.798041 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m09:25:31.798387 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m09:25:31.799083 [debug] [MainThread]: Using duckdb connection "master"
[0m09:25:31.799275 [debug] [MainThread]: On master: BEGIN
[0m09:25:31.799542 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:25:31.810005 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m09:25:31.810327 [debug] [MainThread]: On master: COMMIT
[0m09:25:31.810665 [debug] [MainThread]: Using duckdb connection "master"
[0m09:25:31.810935 [debug] [MainThread]: On master: COMMIT
[0m09:25:31.811368 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:25:31.811664 [debug] [MainThread]: On master: Close
[0m09:25:31.813418 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:25:31.813777 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m09:25:31.814042 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m09:25:31.814414 [info ] [MainThread]: 
[0m09:25:31.814759 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m09:25:31.815645 [debug] [MainThread]: Command end result
[0m09:25:31.836380 [info ] [MainThread]: 
[0m09:25:31.836673 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:25:31.836858 [info ] [MainThread]: 
[0m09:25:31.837091 [error] [MainThread]:   Runtime Error in model grain_jour (models/example/grain_jour.sql)
  Binder Error: No function matches the given name and argument types 'sum(VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	sum(DECIMAL) -> DECIMAL
  	sum(SMALLINT) -> HUGEINT
  	sum(INTEGER) -> HUGEINT
  	sum(BIGINT) -> HUGEINT
  	sum(HUGEINT) -> HUGEINT
  	sum(DOUBLE) -> DOUBLE
  
  LINE 27:     SUM("Eolien (MW)") AS eolien_total,
               ^
[0m09:25:31.837272 [info ] [MainThread]: 
[0m09:25:31.837515 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m09:25:31.837975 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0362184, "process_in_blocks": "10080", "process_kernel_time": 0.164084, "process_mem_max_rss": "140060", "process_out_blocks": "7128", "process_user_time": 1.28414}
[0m09:25:31.838292 [debug] [MainThread]: Command `dbt run` failed at 09:25:31.838239 after 1.04 seconds
[0m09:25:31.838505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f371dfbc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f36734d270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f36734d390>]}
[0m09:25:31.838723 [debug] [MainThread]: Flushing usage events
[0m09:26:50.307726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b89efbcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b89904820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b8a2d30d0>]}


============================== 09:26:50.309534 | 31e2d827-c8f1-464e-9227-8bdf514db405 ==============================
[0m09:26:50.309534 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:26:50.309943 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'fail_fast': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:26:50.433247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31e2d827-c8f1-464e-9227-8bdf514db405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b89e297e0>]}
[0m09:26:50.461182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31e2d827-c8f1-464e-9227-8bdf514db405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b890de770>]}
[0m09:26:50.463570 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m09:26:50.504093 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:26:50.603359 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:26:50.603877 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:26:50.610111 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m09:26:50.628939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31e2d827-c8f1-464e-9227-8bdf514db405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b82fd9030>]}
[0m09:26:50.690269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31e2d827-c8f1-464e-9227-8bdf514db405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b82fd80a0>]}
[0m09:26:50.690569 [info ] [MainThread]: Found 4 models, 4 data tests, 421 macros
[0m09:26:50.690940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31e2d827-c8f1-464e-9227-8bdf514db405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b82fd8100>]}
[0m09:26:50.691960 [info ] [MainThread]: 
[0m09:26:50.692283 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:26:50.695179 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m09:26:50.943919 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m09:26:50.944600 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m09:26:50.945042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:26:50.965874 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m09:26:50.968112 [debug] [ThreadPool]: On list_dev: Close
[0m09:26:50.972068 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m09:26:50.972908 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m09:26:50.983825 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:26:50.984310 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m09:26:50.984668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:26:50.997481 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m09:26:50.998657 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:26:50.998968 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m09:26:50.999386 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:26:50.999668 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:26:50.999944 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m09:26:51.000418 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:26:51.000991 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m09:26:51.001197 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:26:51.001478 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m09:26:51.001846 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:26:51.002041 [debug] [ThreadPool]: On create_dev_main: Close
[0m09:26:51.003582 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m09:26:51.007022 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:26:51.007311 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m09:26:51.007566 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:26:51.021903 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m09:26:51.022523 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:26:51.022989 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m09:26:51.039335 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m09:26:51.040017 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m09:26:51.040524 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m09:26:51.040702 [debug] [ThreadPool]: On list_dev_main: Close
[0m09:26:51.042373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31e2d827-c8f1-464e-9227-8bdf514db405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b89fdf190>]}
[0m09:26:51.042674 [debug] [MainThread]: Using duckdb connection "master"
[0m09:26:51.042847 [debug] [MainThread]: On master: BEGIN
[0m09:26:51.043090 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:26:51.053677 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m09:26:51.053960 [debug] [MainThread]: On master: COMMIT
[0m09:26:51.054240 [debug] [MainThread]: Using duckdb connection "master"
[0m09:26:51.054508 [debug] [MainThread]: On master: COMMIT
[0m09:26:51.054888 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:26:51.055148 [debug] [MainThread]: On master: Close
[0m09:26:51.056696 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:26:51.057073 [info ] [MainThread]: 
[0m09:26:51.058922 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m09:26:51.059733 [info ] [Thread-1 (]: 1 of 4 START sql view model main.clean ......................................... [RUN]
[0m09:26:51.060568 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.clean'
[0m09:26:51.061025 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m09:26:51.067007 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m09:26:51.068480 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m09:26:51.085076 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m09:26:51.086667 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m09:26:51.086899 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m09:26:51.087157 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:26:51.097588 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m09:26:51.097841 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m09:26:51.098121 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT "Code INSEE région",	"Région"	,	"Date",	"Heure",	
"Consommation (MW)"	,"Thermique (MW)",	"Nucléaire (MW)",	"Eolien (MW)",	"Solaire (MW)",	"Hydraulique (MW)",	"Pompage (MW)",	"Bioénergies (MW)",	"Ech. physiques (MW)","production_totale"

     FROM clean
  );

[0m09:26:51.098840 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:26:51.102367 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m09:26:51.102610 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m09:26:51.103051 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:26:51.104527 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m09:26:51.104733 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m09:26:51.105099 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:26:51.113661 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m09:26:51.113901 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m09:26:51.114161 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m09:26:51.115809 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:26:51.118338 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m09:26:51.118565 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m09:26:51.119222 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:26:51.120547 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m09:26:51.132573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31e2d827-c8f1-464e-9227-8bdf514db405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b8ac3af50>]}
[0m09:26:51.132965 [info ] [Thread-1 (]: 1 of 4 OK created sql view model main.clean .................................... [[32mOK[0m in 0.07s]
[0m09:26:51.133299 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m09:26:51.133535 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m09:26:51.133872 [info ] [Thread-1 (]: 2 of 4 START sql view model main.grain_jour .................................... [RUN]
[0m09:26:51.134117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m09:26:51.134324 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m09:26:51.135337 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m09:26:51.136360 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m09:26:51.138168 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m09:26:51.139079 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m09:26:51.139281 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m09:26:51.139531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:26:51.149370 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m09:26:51.149652 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m09:26:51.149975 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Date", 
    "Heure", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS thermique_total,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS nucleaire_total,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS eolien_total,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS solaire_total,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS hydraulique_total,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS bioenergies_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_total,
    SUM(COALESCE(production_totale, 0)) AS production_totale
FROM clean
GROUP BY "Date", "Heure", "Région"
ORDER BY "Date", "Heure", "Région"
  );

[0m09:26:51.150744 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:26:51.152873 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m09:26:51.153096 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour__dbt_tmp" rename to "grain_jour"
[0m09:26:51.153566 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:26:51.154346 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m09:26:51.154546 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m09:26:51.154790 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m09:26:51.156509 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:26:51.157729 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m09:26:51.157939 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
drop view if exists "dev"."main"."grain_jour__dbt_backup" cascade
[0m09:26:51.158319 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:26:51.158984 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m09:26:51.170721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31e2d827-c8f1-464e-9227-8bdf514db405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b7f380760>]}
[0m09:26:51.171108 [info ] [Thread-1 (]: 2 of 4 OK created sql view model main.grain_jour ............................... [[32mOK[0m in 0.04s]
[0m09:26:51.171443 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m09:26:51.171670 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m09:26:51.171962 [info ] [Thread-1 (]: 3 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m09:26:51.172210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m09:26:51.172436 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m09:26:51.173910 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m09:26:51.174792 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m09:26:51.184692 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m09:26:51.185699 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m09:26:51.185907 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m09:26:51.186100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:26:51.195940 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m09:26:51.196199 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m09:26:51.196475 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m09:26:51.197046 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:26:51.198664 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m09:26:51.198883 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m09:26:51.199278 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:26:51.200787 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m09:26:51.201002 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m09:26:51.201431 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:26:51.204074 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m09:26:51.204294 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m09:26:51.204540 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m09:26:51.206017 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:26:51.207215 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m09:26:51.207422 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m09:26:51.208039 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:26:51.208757 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m09:26:51.222644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31e2d827-c8f1-464e-9227-8bdf514db405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b7f381ea0>]}
[0m09:26:51.223046 [info ] [Thread-1 (]: 3 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m09:26:51.223370 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m09:26:51.223896 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m09:26:51.224146 [info ] [Thread-1 (]: 4 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m09:26:51.224396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m09:26:51.224615 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m09:26:51.226660 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m09:26:51.227531 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m09:26:51.250477 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m09:26:51.251580 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m09:26:51.251809 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m09:26:51.252001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:26:51.262420 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m09:26:51.262658 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m09:26:51.262903 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m09:26:51.263299 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:26:51.264957 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m09:26:51.265190 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m09:26:51.265667 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:26:51.267206 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m09:26:51.267449 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m09:26:51.267808 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:26:51.268752 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m09:26:51.268968 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m09:26:51.269217 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m09:26:51.270980 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:26:51.272165 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m09:26:51.272374 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m09:26:51.272941 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:26:51.273598 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m09:26:51.285315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31e2d827-c8f1-464e-9227-8bdf514db405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b82fd8430>]}
[0m09:26:51.285706 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m09:26:51.286021 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m09:26:51.286784 [debug] [MainThread]: Using duckdb connection "master"
[0m09:26:51.286977 [debug] [MainThread]: On master: BEGIN
[0m09:26:51.287228 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:26:51.297396 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m09:26:51.297623 [debug] [MainThread]: On master: COMMIT
[0m09:26:51.297929 [debug] [MainThread]: Using duckdb connection "master"
[0m09:26:51.298113 [debug] [MainThread]: On master: COMMIT
[0m09:26:51.298402 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:26:51.298602 [debug] [MainThread]: On master: Close
[0m09:26:51.299666 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:26:51.299903 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m09:26:51.300091 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m09:26:51.300345 [info ] [MainThread]: 
[0m09:26:51.300539 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m09:26:51.301058 [debug] [MainThread]: Command end result
[0m09:26:51.321197 [info ] [MainThread]: 
[0m09:26:51.321492 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:26:51.321680 [info ] [MainThread]: 
[0m09:26:51.321909 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m09:26:51.322353 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0417337, "process_in_blocks": "10080", "process_kernel_time": 0.175777, "process_mem_max_rss": "137712", "process_out_blocks": "8224", "process_user_time": 1.318328}
[0m09:26:51.322671 [debug] [MainThread]: Command `dbt run` succeeded at 09:26:51.322618 after 1.04 seconds
[0m09:26:51.322879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b89efbcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b82504d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712b82507880>]}
[0m09:26:51.323112 [debug] [MainThread]: Flushing usage events
[0m09:57:34.668083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e1f15fbbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e1f19ce410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e1f19ce470>]}


============================== 09:57:34.670922 | d9484218-3885-4cee-8098-453543715548 ==============================
[0m09:57:34.670922 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:57:34.671719 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:57:34.828008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9484218-3885-4cee-8098-453543715548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e1f105e260>]}
[0m09:57:34.858191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9484218-3885-4cee-8098-453543715548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e1efe2fc10>]}
[0m09:57:34.862343 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m09:57:34.914599 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:57:35.122943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:57:35.123704 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:57:35.134520 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m09:57:35.153908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9484218-3885-4cee-8098-453543715548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e1e9dd8f10>]}
[0m09:57:35.246536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9484218-3885-4cee-8098-453543715548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e1e9dd8190>]}
[0m09:57:35.246885 [info ] [MainThread]: Found 4 models, 4 data tests, 421 macros
[0m09:57:35.247240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9484218-3885-4cee-8098-453543715548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e1e9dd81f0>]}
[0m09:57:35.248461 [info ] [MainThread]: 
[0m09:57:35.248834 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:57:35.252273 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m09:57:35.811465 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m09:57:35.812309 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m09:57:35.812900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:35.880132 [debug] [ThreadPool]: SQL status: OK in 0.067 seconds
[0m09:57:35.882451 [debug] [ThreadPool]: On list_dev: Close
[0m09:57:35.887770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m09:57:35.888825 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m09:57:35.898843 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:57:35.899222 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m09:57:35.899643 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:57:35.915708 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m09:57:35.916543 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:57:35.916764 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m09:57:35.917254 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:57:35.917423 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:57:35.917743 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m09:57:35.919279 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:57:35.919712 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m09:57:35.919947 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:57:35.920303 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m09:57:35.920855 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:57:35.921052 [debug] [ThreadPool]: On create_dev_main: Close
[0m09:57:35.923053 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m09:57:35.928352 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:57:35.928681 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m09:57:35.929067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:57:35.945865 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m09:57:35.946582 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:57:35.947241 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m09:57:35.975940 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m09:57:35.976649 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m09:57:35.978755 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m09:57:35.978934 [debug] [ThreadPool]: On list_dev_main: Close
[0m09:57:35.981012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9484218-3885-4cee-8098-453543715548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e1efd42050>]}
[0m09:57:35.981306 [debug] [MainThread]: Using duckdb connection "master"
[0m09:57:35.981605 [debug] [MainThread]: On master: BEGIN
[0m09:57:35.981917 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:57:35.995575 [debug] [MainThread]: SQL status: OK in 0.014 seconds
[0m09:57:35.996009 [debug] [MainThread]: On master: COMMIT
[0m09:57:35.996571 [debug] [MainThread]: Using duckdb connection "master"
[0m09:57:35.997077 [debug] [MainThread]: On master: COMMIT
[0m09:57:35.997675 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:57:35.997975 [debug] [MainThread]: On master: Close
[0m09:57:35.999659 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:57:36.000002 [info ] [MainThread]: 
[0m09:57:36.009965 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m09:57:36.011287 [info ] [Thread-1 (]: 1 of 4 START sql view model main.clean ......................................... [RUN]
[0m09:57:36.012921 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.clean'
[0m09:57:36.013814 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m09:57:36.025355 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m09:57:36.029405 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m09:57:36.048158 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m09:57:36.052285 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m09:57:36.052493 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m09:57:36.052825 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:57:36.063888 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m09:57:36.064113 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m09:57:36.064696 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT "Code INSEE région",	"Région"	,	"Date",	"Heure",	
"Consommation (MW)"	,"Thermique (MW)",	"Nucléaire (MW)",	"Eolien (MW)",	"Solaire (MW)",	"Hydraulique (MW)",	"Pompage (MW)",	"Bioénergies (MW)",	"Ech. physiques (MW)","production_totale"

     FROM clean
  );

[0m09:57:36.065460 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:57:36.068675 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m09:57:36.068893 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m09:57:36.069377 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:57:36.070828 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m09:57:36.071029 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m09:57:36.071484 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:57:36.079575 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m09:57:36.079798 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m09:57:36.080312 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m09:57:36.083465 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:57:36.085940 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m09:57:36.086152 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m09:57:36.086951 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:57:36.088229 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m09:57:36.105774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9484218-3885-4cee-8098-453543715548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e1ea7201f0>]}
[0m09:57:36.106143 [info ] [Thread-1 (]: 1 of 4 OK created sql view model main.clean .................................... [[32mOK[0m in 0.09s]
[0m09:57:36.106446 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m09:57:36.106677 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m09:57:36.107052 [info ] [Thread-1 (]: 2 of 4 START sql view model main.grain_jour .................................... [RUN]
[0m09:57:36.107287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m09:57:36.107553 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m09:57:36.108633 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m09:57:36.110058 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m09:57:36.111827 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m09:57:36.113384 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m09:57:36.113566 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m09:57:36.113884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:36.124599 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m09:57:36.124850 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m09:57:36.125441 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS thermique_total,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS nucleaire_total,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS eolien_total,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS solaire_total,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS hydraulique_total,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS bioenergies_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_total,
    SUM(COALESCE(production_totale, 0)) AS production_totale
FROM clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m09:57:36.126298 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:57:36.128277 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m09:57:36.128481 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour" rename to "grain_jour__dbt_backup"
[0m09:57:36.128997 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:57:36.130397 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m09:57:36.130597 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour__dbt_tmp" rename to "grain_jour"
[0m09:57:36.131175 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:57:36.132003 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m09:57:36.132198 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m09:57:36.132506 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m09:57:36.134401 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:57:36.135528 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m09:57:36.135728 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
drop view if exists "dev"."main"."grain_jour__dbt_backup" cascade
[0m09:57:36.136482 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:57:36.137132 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m09:57:36.148911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9484218-3885-4cee-8098-453543715548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e1e6b386a0>]}
[0m09:57:36.149263 [info ] [Thread-1 (]: 2 of 4 OK created sql view model main.grain_jour ............................... [[32mOK[0m in 0.04s]
[0m09:57:36.149592 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m09:57:36.149817 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m09:57:36.150161 [info ] [Thread-1 (]: 3 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m09:57:36.150438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m09:57:36.150724 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m09:57:36.152241 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m09:57:36.153501 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m09:57:36.162930 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m09:57:36.164364 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m09:57:36.164575 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m09:57:36.164954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:36.176100 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m09:57:36.176325 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m09:57:36.176871 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m09:57:36.177543 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:57:36.179019 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m09:57:36.179228 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m09:57:36.179680 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:57:36.181143 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m09:57:36.181349 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m09:57:36.181846 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:57:36.184444 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m09:57:36.184661 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m09:57:36.184999 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m09:57:36.187082 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:57:36.188741 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m09:57:36.188947 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m09:57:36.189727 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:57:36.190359 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m09:57:36.205857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9484218-3885-4cee-8098-453543715548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e1e61dfd00>]}
[0m09:57:36.206460 [info ] [Thread-1 (]: 3 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m09:57:36.207033 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m09:57:36.207787 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m09:57:36.208158 [info ] [Thread-1 (]: 4 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m09:57:36.208447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m09:57:36.208739 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m09:57:36.231416 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m09:57:36.233484 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m09:57:36.235369 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m09:57:36.237144 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m09:57:36.237439 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m09:57:36.237756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:36.249260 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m09:57:36.249485 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m09:57:36.250056 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m09:57:36.250602 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:57:36.252588 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m09:57:36.252803 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m09:57:36.253336 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:57:36.254762 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m09:57:36.254966 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m09:57:36.255445 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:57:36.256300 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m09:57:36.256498 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m09:57:36.256812 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m09:57:36.258225 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:57:36.259371 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m09:57:36.259571 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m09:57:36.260445 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:57:36.261091 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m09:57:36.273215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9484218-3885-4cee-8098-453543715548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e1e61ce620>]}
[0m09:57:36.273572 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m09:57:36.273886 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m09:57:36.274579 [debug] [MainThread]: Using duckdb connection "master"
[0m09:57:36.274832 [debug] [MainThread]: On master: BEGIN
[0m09:57:36.275152 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:57:36.286878 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m09:57:36.287085 [debug] [MainThread]: On master: COMMIT
[0m09:57:36.287625 [debug] [MainThread]: Using duckdb connection "master"
[0m09:57:36.287937 [debug] [MainThread]: On master: COMMIT
[0m09:57:36.288367 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:57:36.288570 [debug] [MainThread]: On master: Close
[0m09:57:36.289942 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:57:36.290153 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m09:57:36.290398 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m09:57:36.290773 [info ] [MainThread]: 
[0m09:57:36.291041 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 1.04 seconds (1.04s).
[0m09:57:36.291688 [debug] [MainThread]: Command end result
[0m09:57:36.313053 [info ] [MainThread]: 
[0m09:57:36.313296 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:57:36.313601 [info ] [MainThread]: 
[0m09:57:36.313941 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m09:57:36.322450 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6843911, "process_in_blocks": "19352", "process_kernel_time": 0.244129, "process_mem_max_rss": "137436", "process_out_blocks": "8256", "process_user_time": 1.623161}
[0m09:57:36.322764 [debug] [MainThread]: Command `dbt run` succeeded at 09:57:36.322714 after 1.68 seconds
[0m09:57:36.323033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e1f15fbbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e1ebb8e9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e1e758e860>]}
[0m09:57:36.323293 [debug] [MainThread]: Flushing usage events
[0m10:21:15.151384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03649fbc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0364d2f1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0364d2f310>]}


============================== 10:21:15.154654 | af65de8b-9cfc-4cb3-994a-ccca2ebcb3cf ==============================
[0m10:21:15.154654 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:21:15.155324 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:21:15.295478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af65de8b-9cfc-4cb3-994a-ccca2ebcb3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03631a7850>]}
[0m10:21:15.324303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af65de8b-9cfc-4cb3-994a-ccca2ebcb3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0363238ac0>]}
[0m10:21:15.327054 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m10:21:15.368690 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:21:15.493878 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:21:15.494631 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:21:15.503657 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m10:21:15.522820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af65de8b-9cfc-4cb3-994a-ccca2ebcb3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03631c01c0>]}
[0m10:21:15.597553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af65de8b-9cfc-4cb3-994a-ccca2ebcb3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f035d1f0d60>]}
[0m10:21:15.598345 [info ] [MainThread]: Found 5 models, 4 data tests, 421 macros
[0m10:21:15.598888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af65de8b-9cfc-4cb3-994a-ccca2ebcb3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f035d171ae0>]}
[0m10:21:15.601658 [info ] [MainThread]: 
[0m10:21:15.602756 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:21:15.607115 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m10:21:16.082674 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m10:21:16.083507 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m10:21:16.084218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:21:16.105596 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m10:21:16.106783 [debug] [ThreadPool]: On list_dev: Close
[0m10:21:16.109389 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m10:21:16.109756 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m10:21:16.113863 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:21:16.114067 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m10:21:16.114422 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:21:16.126681 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m10:21:16.127725 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:21:16.128037 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m10:21:16.128559 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:21:16.128790 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:21:16.129052 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m10:21:16.129496 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:21:16.130053 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:21:16.130272 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:21:16.130591 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:21:16.130992 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:21:16.131323 [debug] [ThreadPool]: On create_dev_main: Close
[0m10:21:16.133077 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m10:21:16.140115 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:21:16.140406 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m10:21:16.140768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:21:16.159275 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m10:21:16.159781 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:21:16.160397 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m10:21:16.174372 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m10:21:16.175053 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m10:21:16.175638 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m10:21:16.175811 [debug] [ThreadPool]: On list_dev_main: Close
[0m10:21:16.177757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af65de8b-9cfc-4cb3-994a-ccca2ebcb3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03647ef820>]}
[0m10:21:16.178000 [debug] [MainThread]: Using duckdb connection "master"
[0m10:21:16.178300 [debug] [MainThread]: On master: BEGIN
[0m10:21:16.178558 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:21:16.191240 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m10:21:16.191741 [debug] [MainThread]: On master: COMMIT
[0m10:21:16.192365 [debug] [MainThread]: Using duckdb connection "master"
[0m10:21:16.192878 [debug] [MainThread]: On master: COMMIT
[0m10:21:16.193649 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:21:16.194144 [debug] [MainThread]: On master: Close
[0m10:21:16.196731 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:21:16.197258 [info ] [MainThread]: 
[0m10:21:16.199976 [debug] [Thread-1 (]: Began running node model.transform.3_1
[0m10:21:16.201603 [info ] [Thread-1 (]: 1 of 5 START sql view model main.3_1 ........................................... [RUN]
[0m10:21:16.202915 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.3_1'
[0m10:21:16.203841 [debug] [Thread-1 (]: Began compiling node model.transform.3_1
[0m10:21:16.214990 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_1"
[0m10:21:16.219762 [debug] [Thread-1 (]: Began executing node model.transform.3_1
[0m10:21:16.240375 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_1"
[0m10:21:16.246147 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:21:16.246365 [debug] [Thread-1 (]: On model.transform.3_1: BEGIN
[0m10:21:16.246893 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:21:16.258325 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:21:16.258558 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:21:16.259173 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(production_totale, 0)) AS production_totale,

    MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m10:21:16.307444 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(production_totale, 0)) AS production_totale,

    MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m10:21:16.308316 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:21:16.309366 [debug] [Thread-1 (]: On model.transform.3_1: ROLLBACK
[0m10:21:16.335645 [debug] [Thread-1 (]: Failed to rollback 'model.transform.3_1'
[0m10:21:16.336448 [debug] [Thread-1 (]: On model.transform.3_1: Close
[0m10:21:16.341745 [debug] [Thread-1 (]: Runtime Error in model 3_1 (models/example/3_1.sql)
  Binder Error: Referenced column "Date" not found in FROM clause!
  LINE 20: GROUP BY "Date", "Région"
                    ^
[0m10:21:16.344636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af65de8b-9cfc-4cb3-994a-ccca2ebcb3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0363bc9c30>]}
[0m10:21:16.345946 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model main.3_1 .................................. [[31mERROR[0m in 0.14s]
[0m10:21:16.347102 [debug] [Thread-1 (]: Finished running node model.transform.3_1
[0m10:21:16.347893 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m10:21:16.348735 [info ] [Thread-1 (]: 2 of 5 START sql view model main.clean ......................................... [RUN]
[0m10:21:16.349563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_1, now model.transform.clean)
[0m10:21:16.351876 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m10:21:16.355311 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m10:21:16.357064 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m10:21:16.360985 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m10:21:16.362452 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:21:16.362750 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m10:21:16.363072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:21:16.375580 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m10:21:16.375965 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:21:16.376596 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT "Code INSEE région",	"Région"	,	"Date",	"Heure",	
"Consommation (MW)"	,"Thermique (MW)",	"Nucléaire (MW)",	"Eolien (MW)",	"Solaire (MW)",	"Hydraulique (MW)",	"Pompage (MW)",	"Bioénergies (MW)",	"Ech. physiques (MW)","production_totale"

     FROM clean
  );

[0m10:21:16.377738 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:21:16.381427 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:21:16.381645 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m10:21:16.382156 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:21:16.383630 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:21:16.383832 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m10:21:16.384443 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:21:16.392443 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m10:21:16.392659 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:21:16.392988 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m10:21:16.394581 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:21:16.397025 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:21:16.397238 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m10:21:16.398063 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:21:16.399324 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m10:21:16.411756 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af65de8b-9cfc-4cb3-994a-ccca2ebcb3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f035c7172b0>]}
[0m10:21:16.412127 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main.clean .................................... [[32mOK[0m in 0.06s]
[0m10:21:16.412427 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m10:21:16.412674 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m10:21:16.412987 [info ] [Thread-1 (]: 3 of 5 START sql view model main.grain_jour .................................... [RUN]
[0m10:21:16.413249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m10:21:16.413505 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m10:21:16.415026 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m10:21:16.416404 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m10:21:16.418171 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m10:21:16.419329 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:21:16.419537 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m10:21:16.419839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:21:16.430374 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:21:16.430613 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:21:16.431219 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS thermique_total,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS nucleaire_total,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS eolien_total,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS solaire_total,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS hydraulique_total,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS bioenergies_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_total,
    SUM(COALESCE(production_totale, 0)) AS production_totale
FROM clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m10:21:16.432210 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:21:16.434271 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:21:16.434643 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour" rename to "grain_jour__dbt_backup"
[0m10:21:16.435304 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:21:16.437851 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:21:16.438268 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour__dbt_tmp" rename to "grain_jour"
[0m10:21:16.438922 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:21:16.440596 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m10:21:16.440988 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:21:16.441356 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m10:21:16.443306 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:21:16.445640 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:21:16.445996 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
drop view if exists "dev"."main"."grain_jour__dbt_backup" cascade
[0m10:21:16.446938 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:21:16.447962 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m10:21:16.461483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af65de8b-9cfc-4cb3-994a-ccca2ebcb3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f035c7177c0>]}
[0m10:21:16.461849 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.grain_jour ............................... [[32mOK[0m in 0.05s]
[0m10:21:16.462178 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m10:21:16.462420 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m10:21:16.462750 [info ] [Thread-1 (]: 4 of 5 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m10:21:16.463033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m10:21:16.463297 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m10:21:16.464760 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m10:21:16.465881 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m10:21:16.475339 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m10:21:16.476540 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:21:16.476731 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m10:21:16.477019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:21:16.487949 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:21:16.488177 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:21:16.488752 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m10:21:16.489415 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:21:16.491392 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:21:16.491601 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:21:16.492130 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:21:16.515041 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:21:16.515328 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:21:16.516388 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:21:16.519159 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m10:21:16.519382 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:21:16.519915 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m10:21:16.521656 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:21:16.522928 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:21:16.523127 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m10:21:16.523833 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:21:16.524505 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m10:21:16.539798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af65de8b-9cfc-4cb3-994a-ccca2ebcb3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f036487ba30>]}
[0m10:21:16.540251 [info ] [Thread-1 (]: 4 of 5 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.08s]
[0m10:21:16.540570 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m10:21:16.541111 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m10:21:16.541368 [info ] [Thread-1 (]: 5 of 5 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m10:21:16.541686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m10:21:16.541917 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m10:21:16.543384 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m10:21:16.544548 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m10:21:16.546444 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m10:21:16.547603 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:21:16.547805 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m10:21:16.548109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:21:16.558823 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:21:16.559058 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:21:16.559580 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m10:21:16.560179 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:21:16.561778 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:21:16.562000 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m10:21:16.562483 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:21:16.563928 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:21:16.564140 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:21:16.564586 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:21:16.565406 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m10:21:16.565603 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:21:16.565911 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m10:21:16.567511 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:21:16.568689 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:21:16.568900 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m10:21:16.569694 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:21:16.570336 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m10:21:16.582577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af65de8b-9cfc-4cb3-994a-ccca2ebcb3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f035d169900>]}
[0m10:21:16.582948 [info ] [Thread-1 (]: 5 of 5 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m10:21:16.583340 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m10:21:16.584091 [debug] [MainThread]: Using duckdb connection "master"
[0m10:21:16.584301 [debug] [MainThread]: On master: BEGIN
[0m10:21:16.584669 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:21:16.596347 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m10:21:16.596607 [debug] [MainThread]: On master: COMMIT
[0m10:21:16.597056 [debug] [MainThread]: Using duckdb connection "master"
[0m10:21:16.597387 [debug] [MainThread]: On master: COMMIT
[0m10:21:16.597806 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:21:16.598017 [debug] [MainThread]: On master: Close
[0m10:21:16.599449 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:21:16.599656 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m10:21:16.600034 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m10:21:16.600401 [info ] [MainThread]: 
[0m10:21:16.600673 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m10:21:16.601319 [debug] [MainThread]: Command end result
[0m10:21:16.621770 [info ] [MainThread]: 
[0m10:21:16.622013 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:21:16.622308 [info ] [MainThread]: 
[0m10:21:16.622655 [error] [MainThread]:   Runtime Error in model 3_1 (models/example/3_1.sql)
  Binder Error: Referenced column "Date" not found in FROM clause!
  LINE 20: GROUP BY "Date", "Région"
                    ^
[0m10:21:16.622916 [info ] [MainThread]: 
[0m10:21:16.623221 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m10:21:16.623735 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5003413, "process_in_blocks": "16856", "process_kernel_time": 0.204662, "process_mem_max_rss": "139784", "process_out_blocks": "8472", "process_user_time": 1.486663}
[0m10:21:16.624014 [debug] [MainThread]: Command `dbt run` failed at 10:21:16.623967 after 1.50 seconds
[0m10:21:16.624210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03649fbc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03631c9510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03631c9fc0>]}
[0m10:21:16.624433 [debug] [MainThread]: Flushing usage events
[0m10:22:07.918764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eec9b8fbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eec8166410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eec8166470>]}


============================== 10:22:07.921889 | da46b7fb-e7b0-45ca-aec4-86dd21c111b2 ==============================
[0m10:22:07.921889 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:22:07.922563 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:22:08.065353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da46b7fb-e7b0-45ca-aec4-86dd21c111b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eec95da260>]}
[0m10:22:08.093251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da46b7fb-e7b0-45ca-aec4-86dd21c111b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eec856bc10>]}
[0m10:22:08.096500 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m10:22:08.138203 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:22:08.273674 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:22:08.274440 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:22:08.286500 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m10:22:08.312825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da46b7fb-e7b0-45ca-aec4-86dd21c111b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eec81041f0>]}
[0m10:22:08.382411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da46b7fb-e7b0-45ca-aec4-86dd21c111b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eec2373fa0>]}
[0m10:22:08.382798 [info ] [MainThread]: Found 5 models, 4 data tests, 421 macros
[0m10:22:08.383320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da46b7fb-e7b0-45ca-aec4-86dd21c111b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eec2373b80>]}
[0m10:22:08.384781 [info ] [MainThread]: 
[0m10:22:08.385261 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:22:08.390605 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m10:22:08.745116 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m10:22:08.745946 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m10:22:08.746643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:22:08.768640 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m10:22:08.770984 [debug] [ThreadPool]: On list_dev: Close
[0m10:22:08.776714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m10:22:08.777744 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m10:22:08.785642 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:22:08.785949 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m10:22:08.786333 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:22:08.798753 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m10:22:08.799817 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:22:08.800107 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m10:22:08.800799 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:22:08.801033 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:22:08.801385 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m10:22:08.801983 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:22:08.802526 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:22:08.802734 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:22:08.803074 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:22:08.803584 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:22:08.803787 [debug] [ThreadPool]: On create_dev_main: Close
[0m10:22:08.805724 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m10:22:08.808704 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:22:08.808898 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m10:22:08.809195 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:22:08.819623 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m10:22:08.819869 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:22:08.820452 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m10:22:08.832165 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m10:22:08.832828 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m10:22:08.833385 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m10:22:08.833553 [debug] [ThreadPool]: On list_dev_main: Close
[0m10:22:08.835611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da46b7fb-e7b0-45ca-aec4-86dd21c111b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eec9a77580>]}
[0m10:22:08.835863 [debug] [MainThread]: Using duckdb connection "master"
[0m10:22:08.836171 [debug] [MainThread]: On master: BEGIN
[0m10:22:08.836464 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:22:08.847634 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m10:22:08.847869 [debug] [MainThread]: On master: COMMIT
[0m10:22:08.848500 [debug] [MainThread]: Using duckdb connection "master"
[0m10:22:08.848802 [debug] [MainThread]: On master: COMMIT
[0m10:22:08.849188 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:22:08.849500 [debug] [MainThread]: On master: Close
[0m10:22:08.850799 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:22:08.851012 [info ] [MainThread]: 
[0m10:22:08.852564 [debug] [Thread-1 (]: Began running node model.transform.3_1
[0m10:22:08.853210 [info ] [Thread-1 (]: 1 of 5 START sql view model main.3_1 ........................................... [RUN]
[0m10:22:08.853602 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.3_1'
[0m10:22:08.853864 [debug] [Thread-1 (]: Began compiling node model.transform.3_1
[0m10:22:08.859702 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_1"
[0m10:22:08.861338 [debug] [Thread-1 (]: Began executing node model.transform.3_1
[0m10:22:08.882536 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_1"
[0m10:22:08.884401 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:22:08.884601 [debug] [Thread-1 (]: On model.transform.3_1: BEGIN
[0m10:22:08.885032 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:22:08.896382 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:22:08.896578 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:22:08.897235 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(production_totale, 0)) AS production_totale,

    MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale

from grain_jour
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m10:22:08.898296 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(production_totale, 0)) AS production_totale,

    MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale

from grain_jour
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m10:22:08.898532 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:22:08.898945 [debug] [Thread-1 (]: On model.transform.3_1: ROLLBACK
[0m10:22:08.902125 [debug] [Thread-1 (]: Failed to rollback 'model.transform.3_1'
[0m10:22:08.902325 [debug] [Thread-1 (]: On model.transform.3_1: Close
[0m10:22:08.903984 [debug] [Thread-1 (]: Runtime Error in model 3_1 (models/example/3_1.sql)
  Binder Error: Referenced column "Consommation (MW)" not found in FROM clause!
  Candidate bindings: "grain_jour.consommation_totale", "grain_jour.Date", "grain_jour.bioenergies_total", "grain_jour.eolien_total"
  LINE 8:     SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
      SUM(COALESCE(production_totale, 0)) AS production_totale,
  
      MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
      MIN(COALESCE(production_totale, 0)) AS min_production_totale,
  
      MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
      MAX(COALESCE(production_totale, 0)) AS max_production_totale,
      
      AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,
  
      AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
  
  from grain_jour
  GROUP BY "Date", "Région"
  ORDER BY "Date", "Région"
    );
  ...
                                    ^
[0m10:22:08.904814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da46b7fb-e7b0-45ca-aec4-86dd21c111b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eec9a77580>]}
[0m10:22:08.905171 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model main.3_1 .................................. [[31mERROR[0m in 0.05s]
[0m10:22:08.905504 [debug] [Thread-1 (]: Finished running node model.transform.3_1
[0m10:22:08.905735 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m10:22:08.906504 [info ] [Thread-1 (]: 2 of 5 START sql view model main.clean ......................................... [RUN]
[0m10:22:08.906772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_1, now model.transform.clean)
[0m10:22:08.907001 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m10:22:08.908130 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m10:22:08.909360 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m10:22:08.911602 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m10:22:08.912770 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:22:08.913007 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m10:22:08.913268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:08.923945 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:22:08.924169 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:22:08.924535 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT "Code INSEE région",	"Région"	,	"Date",	"Heure",	
"Consommation (MW)"	,"Thermique (MW)",	"Nucléaire (MW)",	"Eolien (MW)",	"Solaire (MW)",	"Hydraulique (MW)",	"Pompage (MW)",	"Bioénergies (MW)",	"Ech. physiques (MW)","production_totale"

     FROM clean
  );

[0m10:22:08.925303 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:22:08.928469 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:22:08.928693 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m10:22:08.929257 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:22:08.930724 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:22:08.930928 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m10:22:08.931443 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:22:08.939585 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m10:22:08.939813 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:22:08.940270 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m10:22:08.941925 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:08.944415 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:22:08.944634 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m10:22:08.945329 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:22:08.946591 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m10:22:08.958592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da46b7fb-e7b0-45ca-aec4-86dd21c111b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eec9a77ee0>]}
[0m10:22:08.958959 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main.clean .................................... [[32mOK[0m in 0.05s]
[0m10:22:08.959306 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m10:22:08.959567 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m10:22:08.959878 [info ] [Thread-1 (]: 3 of 5 START sql view model main.grain_jour .................................... [RUN]
[0m10:22:08.960167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m10:22:08.960439 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m10:22:08.961962 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m10:22:08.963075 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m10:22:08.964775 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m10:22:08.965813 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:22:08.965998 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m10:22:08.966293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:08.976629 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:22:08.976848 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:22:08.977328 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS thermique_total,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS nucleaire_total,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS eolien_total,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS solaire_total,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS hydraulique_total,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS bioenergies_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_total,
    SUM(COALESCE(production_totale, 0)) AS production_totale
FROM clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m10:22:08.978218 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:08.979697 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:22:08.979942 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour" rename to "grain_jour__dbt_backup"
[0m10:22:08.980462 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:22:08.981861 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:22:08.982066 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour__dbt_tmp" rename to "grain_jour"
[0m10:22:08.982555 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:22:08.983351 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m10:22:08.983551 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:22:08.983851 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m10:22:08.985566 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:08.986795 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:22:08.986997 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
drop view if exists "dev"."main"."grain_jour__dbt_backup" cascade
[0m10:22:08.987838 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:22:08.988475 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m10:22:09.000476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da46b7fb-e7b0-45ca-aec4-86dd21c111b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eebe787a30>]}
[0m10:22:09.000846 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.grain_jour ............................... [[32mOK[0m in 0.04s]
[0m10:22:09.001198 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m10:22:09.001421 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m10:22:09.001740 [info ] [Thread-1 (]: 4 of 5 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m10:22:09.001996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m10:22:09.002260 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m10:22:09.003737 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m10:22:09.004902 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m10:22:09.014328 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m10:22:09.015519 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:22:09.015713 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m10:22:09.015994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:09.026921 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:22:09.027188 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:22:09.027564 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m10:22:09.028271 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:22:09.030914 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:22:09.031217 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:22:09.031988 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:22:09.061049 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:22:09.061334 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:22:09.062262 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:22:09.064952 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m10:22:09.065173 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:22:09.065544 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m10:22:09.067437 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:09.068708 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:22:09.068930 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m10:22:09.069686 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:22:09.070387 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m10:22:09.085979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da46b7fb-e7b0-45ca-aec4-86dd21c111b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eebe79ecb0>]}
[0m10:22:09.086407 [info ] [Thread-1 (]: 4 of 5 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.08s]
[0m10:22:09.086746 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m10:22:09.087357 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m10:22:09.087600 [info ] [Thread-1 (]: 5 of 5 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m10:22:09.087947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m10:22:09.088170 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m10:22:09.089723 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m10:22:09.090881 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m10:22:09.092766 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m10:22:09.093987 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:22:09.094189 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m10:22:09.094499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:09.105892 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:22:09.106138 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:22:09.106684 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m10:22:09.107297 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:22:09.108988 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:22:09.109203 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m10:22:09.109796 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:22:09.111370 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:22:09.111606 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:22:09.112104 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:22:09.112941 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m10:22:09.113143 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:22:09.113432 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m10:22:09.115102 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:09.116248 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:22:09.116450 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m10:22:09.117242 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:22:09.117887 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m10:22:09.130521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da46b7fb-e7b0-45ca-aec4-86dd21c111b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eec23832e0>]}
[0m10:22:09.130893 [info ] [Thread-1 (]: 5 of 5 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m10:22:09.131239 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m10:22:09.132168 [debug] [MainThread]: Using duckdb connection "master"
[0m10:22:09.132381 [debug] [MainThread]: On master: BEGIN
[0m10:22:09.132774 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:22:09.144616 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m10:22:09.144979 [debug] [MainThread]: On master: COMMIT
[0m10:22:09.145665 [debug] [MainThread]: Using duckdb connection "master"
[0m10:22:09.145975 [debug] [MainThread]: On master: COMMIT
[0m10:22:09.146455 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:22:09.146806 [debug] [MainThread]: On master: Close
[0m10:22:09.148848 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:22:09.149317 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m10:22:09.149694 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m10:22:09.150177 [info ] [MainThread]: 
[0m10:22:09.150617 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m10:22:09.152001 [debug] [MainThread]: Command end result
[0m10:22:09.174802 [info ] [MainThread]: 
[0m10:22:09.175126 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:22:09.175392 [info ] [MainThread]: 
[0m10:22:09.175767 [error] [MainThread]:   Runtime Error in model 3_1 (models/example/3_1.sql)
  Binder Error: Referenced column "Consommation (MW)" not found in FROM clause!
  Candidate bindings: "grain_jour.consommation_totale", "grain_jour.Date", "grain_jour.bioenergies_total", "grain_jour.eolien_total"
  LINE 8:     SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
      SUM(COALESCE(production_totale, 0)) AS production_totale,
  
      MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
      MIN(COALESCE(production_totale, 0)) AS min_production_totale,
  
      MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
      MAX(COALESCE(production_totale, 0)) AS max_production_totale,
      
      AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,
  
      AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
  
  from grain_jour
  GROUP BY "Date", "Région"
  ORDER BY "Date", "Région"
    );
  ...
                                    ^
[0m10:22:09.176002 [info ] [MainThread]: 
[0m10:22:09.176307 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m10:22:09.176949 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2862704, "process_in_blocks": "11200", "process_kernel_time": 0.187554, "process_mem_max_rss": "139448", "process_out_blocks": "8480", "process_user_time": 1.496469}
[0m10:22:09.177262 [debug] [MainThread]: Command `dbt run` failed at 10:22:09.177209 after 1.29 seconds
[0m10:22:09.177478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eec9b8fbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eebfbd3cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eebfbd2110>]}
[0m10:22:09.177754 [debug] [MainThread]: Flushing usage events
[0m10:23:32.208704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709ad6d87c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709ad71b68f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709ad71b71f0>]}


============================== 10:23:32.212008 | ddc61fc5-a882-4485-a8ef-0f6dde932f26 ==============================
[0m10:23:32.212008 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:23:32.212719 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'fail_fast': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:23:32.369368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ddc61fc5-a882-4485-a8ef-0f6dde932f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709ad6cb17e0>]}
[0m10:23:32.398234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ddc61fc5-a882-4485-a8ef-0f6dde932f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709ad6134e20>]}
[0m10:23:32.401574 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m10:23:32.442645 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:23:32.569463 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:23:32.570234 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:23:32.580615 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m10:23:32.599937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ddc61fc5-a882-4485-a8ef-0f6dde932f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709acf571420>]}
[0m10:23:32.669446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ddc61fc5-a882-4485-a8ef-0f6dde932f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709acf573d60>]}
[0m10:23:32.669852 [info ] [MainThread]: Found 5 models, 4 data tests, 421 macros
[0m10:23:32.670451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddc61fc5-a882-4485-a8ef-0f6dde932f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709ad6bf0df0>]}
[0m10:23:32.671981 [info ] [MainThread]: 
[0m10:23:32.672411 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:23:32.676128 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m10:23:33.049551 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m10:23:33.050306 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m10:23:33.050910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:23:33.070807 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m10:23:33.072190 [debug] [ThreadPool]: On list_dev: Close
[0m10:23:33.075532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m10:23:33.076006 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m10:23:33.080361 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:23:33.080564 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m10:23:33.080969 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:23:33.092541 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m10:23:33.093567 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:23:33.093801 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m10:23:33.094256 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:23:33.094493 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:23:33.094836 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m10:23:33.095277 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:23:33.095752 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:23:33.095942 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:23:33.096263 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:23:33.096717 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:23:33.096893 [debug] [ThreadPool]: On create_dev_main: Close
[0m10:23:33.098516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m10:23:33.103058 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:23:33.103372 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m10:23:33.103748 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:23:33.120759 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m10:23:33.121689 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:23:33.122432 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m10:23:33.142982 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m10:23:33.143651 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m10:23:33.144425 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m10:23:33.144613 [debug] [ThreadPool]: On list_dev_main: Close
[0m10:23:33.146734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddc61fc5-a882-4485-a8ef-0f6dde932f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709ad6ba4bb0>]}
[0m10:23:33.146983 [debug] [MainThread]: Using duckdb connection "master"
[0m10:23:33.147301 [debug] [MainThread]: On master: BEGIN
[0m10:23:33.147677 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:23:33.159753 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m10:23:33.160123 [debug] [MainThread]: On master: COMMIT
[0m10:23:33.160712 [debug] [MainThread]: Using duckdb connection "master"
[0m10:23:33.161084 [debug] [MainThread]: On master: COMMIT
[0m10:23:33.161645 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:23:33.162012 [debug] [MainThread]: On master: Close
[0m10:23:33.164086 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:23:33.164590 [info ] [MainThread]: 
[0m10:23:33.167144 [debug] [Thread-1 (]: Began running node model.transform.3_1
[0m10:23:33.168665 [info ] [Thread-1 (]: 1 of 5 START sql view model main.3_1 ........................................... [RUN]
[0m10:23:33.169974 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.3_1'
[0m10:23:33.170882 [debug] [Thread-1 (]: Began compiling node model.transform.3_1
[0m10:23:33.182190 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_1"
[0m10:23:33.184618 [debug] [Thread-1 (]: Began executing node model.transform.3_1
[0m10:23:33.214158 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_1"
[0m10:23:33.217094 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:23:33.217348 [debug] [Thread-1 (]: On model.transform.3_1: BEGIN
[0m10:23:33.218007 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:23:33.231862 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m10:23:33.232518 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:23:33.233296 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("consommation_totale" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(production_totale, 0)) AS production_totale,

    MIN(COALESCE(TRY_CAST("consommation_totale" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("consommation_totale" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("consommation_totale" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale

from grain_jour
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m10:23:33.236027 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:23:33.244328 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:23:33.244721 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1__dbt_tmp" rename to "3_1"
[0m10:23:33.245418 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:23:33.254554 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m10:23:33.254821 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:23:33.255504 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m10:23:33.257434 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:23:33.260316 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:23:33.260628 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
drop view if exists "dev"."main"."3_1__dbt_backup" cascade
[0m10:23:33.261179 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:23:33.262667 [debug] [Thread-1 (]: On model.transform.3_1: Close
[0m10:23:33.277050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddc61fc5-a882-4485-a8ef-0f6dde932f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709ad1d6b5e0>]}
[0m10:23:33.277641 [info ] [Thread-1 (]: 1 of 5 OK created sql view model main.3_1 ...................................... [[32mOK[0m in 0.11s]
[0m10:23:33.278033 [debug] [Thread-1 (]: Finished running node model.transform.3_1
[0m10:23:33.278299 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m10:23:33.278676 [info ] [Thread-1 (]: 2 of 5 START sql view model main.clean ......................................... [RUN]
[0m10:23:33.278981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_1, now model.transform.clean)
[0m10:23:33.279261 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m10:23:33.280517 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m10:23:33.281807 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m10:23:33.283971 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m10:23:33.285229 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:23:33.285462 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m10:23:33.285804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:23:33.297385 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m10:23:33.297656 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:23:33.298285 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT "Code INSEE région",	"Région"	,	"Date",	"Heure",	
"Consommation (MW)"	,"Thermique (MW)",	"Nucléaire (MW)",	"Eolien (MW)",	"Solaire (MW)",	"Hydraulique (MW)",	"Pompage (MW)",	"Bioénergies (MW)",	"Ech. physiques (MW)","production_totale"

     FROM clean
  );

[0m10:23:33.299117 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:23:33.300971 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:23:33.301217 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m10:23:33.301691 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:23:33.303926 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:23:33.304179 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m10:23:33.304694 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:23:33.306875 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m10:23:33.307124 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:23:33.307462 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m10:23:33.309055 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:23:33.310586 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:23:33.310833 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m10:23:33.311602 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:23:33.312374 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m10:23:33.325083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddc61fc5-a882-4485-a8ef-0f6dde932f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709acc3faa70>]}
[0m10:23:33.325453 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main.clean .................................... [[32mOK[0m in 0.05s]
[0m10:23:33.325751 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m10:23:33.326015 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m10:23:33.326330 [info ] [Thread-1 (]: 3 of 5 START sql view model main.grain_jour .................................... [RUN]
[0m10:23:33.326585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m10:23:33.326857 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m10:23:33.327906 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m10:23:33.329125 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m10:23:33.330882 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m10:23:33.332004 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:23:33.332198 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m10:23:33.332487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:23:33.343673 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:23:33.343955 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:23:33.344632 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS thermique_total,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS nucleaire_total,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS eolien_total,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS solaire_total,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS hydraulique_total,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS bioenergies_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_total,
    SUM(COALESCE(production_totale, 0)) AS production_totale
FROM clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m10:23:33.345627 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:23:33.347463 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:23:33.347709 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour" rename to "grain_jour__dbt_backup"
[0m10:23:33.348357 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:23:33.350041 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:23:33.350282 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour__dbt_tmp" rename to "grain_jour"
[0m10:23:33.350788 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:23:33.351798 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m10:23:33.352038 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:23:33.352367 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m10:23:33.354423 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:23:33.355798 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:23:33.356041 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
drop view if exists "dev"."main"."grain_jour__dbt_backup" cascade
[0m10:23:33.356861 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:23:33.357665 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m10:23:33.370641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddc61fc5-a882-4485-a8ef-0f6dde932f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709acc3fbe50>]}
[0m10:23:33.371093 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.grain_jour ............................... [[32mOK[0m in 0.04s]
[0m10:23:33.371462 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m10:23:33.371722 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m10:23:33.372086 [info ] [Thread-1 (]: 4 of 5 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m10:23:33.372356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m10:23:33.372617 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m10:23:33.375036 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m10:23:33.376230 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m10:23:33.409807 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m10:23:33.411563 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:23:33.411796 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m10:23:33.412229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:23:33.423053 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:23:33.423279 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:23:33.423901 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m10:23:33.424565 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:23:33.426069 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:23:33.426274 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:23:33.427022 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:23:33.428881 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:23:33.429139 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:23:33.429726 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:23:33.432860 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m10:23:33.433121 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:23:33.433589 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m10:23:33.434890 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:23:33.436319 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:23:33.436632 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m10:23:33.437409 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:23:33.438257 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m10:23:33.453627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddc61fc5-a882-4485-a8ef-0f6dde932f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709ad611dc30>]}
[0m10:23:33.454127 [info ] [Thread-1 (]: 4 of 5 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.08s]
[0m10:23:33.454508 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m10:23:33.455115 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m10:23:33.455405 [info ] [Thread-1 (]: 5 of 5 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m10:23:33.455680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m10:23:33.455945 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m10:23:33.457667 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m10:23:33.458905 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m10:23:33.461104 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m10:23:33.462347 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:23:33.462580 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m10:23:33.462894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:23:33.474647 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m10:23:33.474922 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:23:33.475570 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m10:23:33.476106 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:23:33.478612 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:23:33.478872 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m10:23:33.479433 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:23:33.481072 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:23:33.481318 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:23:33.481892 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:23:33.482847 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m10:23:33.483089 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:23:33.483432 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m10:23:33.484923 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:23:33.486496 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:23:33.486748 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m10:23:33.487560 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:23:33.488335 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m10:23:33.500915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddc61fc5-a882-4485-a8ef-0f6dde932f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709acf5a8820>]}
[0m10:23:33.501349 [info ] [Thread-1 (]: 5 of 5 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m10:23:33.501706 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m10:23:33.502546 [debug] [MainThread]: Using duckdb connection "master"
[0m10:23:33.502911 [debug] [MainThread]: On master: BEGIN
[0m10:23:33.503337 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:23:33.515955 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m10:23:33.516290 [debug] [MainThread]: On master: COMMIT
[0m10:23:33.516952 [debug] [MainThread]: Using duckdb connection "master"
[0m10:23:33.517442 [debug] [MainThread]: On master: COMMIT
[0m10:23:33.517916 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:23:33.518159 [debug] [MainThread]: On master: Close
[0m10:23:33.519681 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:23:33.519975 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m10:23:33.520340 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m10:23:33.520701 [info ] [MainThread]: 
[0m10:23:33.520954 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m10:23:33.521664 [debug] [MainThread]: Command end result
[0m10:23:33.550967 [info ] [MainThread]: 
[0m10:23:33.551484 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:23:33.551833 [info ] [MainThread]: 
[0m10:23:33.552225 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m10:23:33.552955 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3731366, "process_in_blocks": "11200", "process_kernel_time": 0.205092, "process_mem_max_rss": "137848", "process_out_blocks": "9544", "process_user_time": 1.539199}
[0m10:23:33.553432 [debug] [MainThread]: Command `dbt run` succeeded at 10:23:33.553351 after 1.37 seconds
[0m10:23:33.553736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709ad6d87c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709ad576c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709ad1d69ea0>]}
[0m10:23:33.554062 [debug] [MainThread]: Flushing usage events
[0m10:29:32.266574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713c0a38fbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713c0a7c6fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713c0a7c71c0>]}


============================== 10:29:32.269751 | f4b358db-72fd-47ad-adcf-46a47e0be7fe ==============================
[0m10:29:32.269751 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:29:32.270382 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'version_check': 'True', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:29:32.415227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4b358db-72fd-47ad-adcf-46a47e0be7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713c09dd9270>]}
[0m10:29:32.443996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4b358db-72fd-47ad-adcf-46a47e0be7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713c08d6bc10>]}
[0m10:29:32.446925 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m10:29:32.488151 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:29:32.617471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:29:32.618221 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:29:32.627026 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m10:29:32.645711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4b358db-72fd-47ad-adcf-46a47e0be7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713c0890c1f0>]}
[0m10:29:32.716074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4b358db-72fd-47ad-adcf-46a47e0be7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713c02b75360>]}
[0m10:29:32.716464 [info ] [MainThread]: Found 5 models, 4 data tests, 421 macros
[0m10:29:32.716979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4b358db-72fd-47ad-adcf-46a47e0be7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713c02b77af0>]}
[0m10:29:32.718350 [info ] [MainThread]: 
[0m10:29:32.718748 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:29:32.722180 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m10:29:33.095618 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m10:29:33.096463 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m10:29:33.097249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:33.119316 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m10:29:33.120318 [debug] [ThreadPool]: On list_dev: Close
[0m10:29:33.123732 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m10:29:33.124357 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m10:29:33.134761 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:29:33.135314 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m10:29:33.135815 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:33.151247 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m10:29:33.152477 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:29:33.152804 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m10:29:33.153491 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:29:33.153735 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:29:33.154117 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m10:29:33.154710 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:29:33.155291 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:29:33.155520 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:29:33.155854 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:29:33.156210 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:29:33.156454 [debug] [ThreadPool]: On create_dev_main: Close
[0m10:29:33.158451 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m10:29:33.165643 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:29:33.166183 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m10:29:33.166729 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:33.186156 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m10:29:33.186909 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:29:33.187578 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m10:29:33.203976 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m10:29:33.204635 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m10:29:33.205307 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m10:29:33.205494 [debug] [ThreadPool]: On list_dev_main: Close
[0m10:29:33.207569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4b358db-72fd-47ad-adcf-46a47e0be7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713c05373d00>]}
[0m10:29:33.207816 [debug] [MainThread]: Using duckdb connection "master"
[0m10:29:33.208200 [debug] [MainThread]: On master: BEGIN
[0m10:29:33.208657 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:29:33.220815 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m10:29:33.221192 [debug] [MainThread]: On master: COMMIT
[0m10:29:33.221943 [debug] [MainThread]: Using duckdb connection "master"
[0m10:29:33.222348 [debug] [MainThread]: On master: COMMIT
[0m10:29:33.222917 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:29:33.223303 [debug] [MainThread]: On master: Close
[0m10:29:33.225579 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:29:33.226137 [info ] [MainThread]: 
[0m10:29:33.228640 [debug] [Thread-1 (]: Began running node model.transform.3_1
[0m10:29:33.230168 [info ] [Thread-1 (]: 1 of 5 START sql view model main.3_1 ........................................... [RUN]
[0m10:29:33.231449 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.3_1'
[0m10:29:33.232364 [debug] [Thread-1 (]: Began compiling node model.transform.3_1
[0m10:29:33.244521 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_1"
[0m10:29:33.247090 [debug] [Thread-1 (]: Began executing node model.transform.3_1
[0m10:29:33.283747 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_1"
[0m10:29:33.286462 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:29:33.286672 [debug] [Thread-1 (]: On model.transform.3_1: BEGIN
[0m10:29:33.287074 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:29:33.299102 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m10:29:33.299406 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:29:33.300024 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(production_totale, 0)) AS production_totale,

    MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale

from clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m10:29:33.301109 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:29:33.304498 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:29:33.304723 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1" rename to "3_1__dbt_backup"
[0m10:29:33.305389 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:29:33.306774 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:29:33.306978 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1__dbt_tmp" rename to "3_1"
[0m10:29:33.307526 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:29:33.315521 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m10:29:33.315747 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:29:33.316130 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m10:29:33.317872 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:29:33.320335 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:29:33.320546 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
drop view if exists "dev"."main"."3_1__dbt_backup" cascade
[0m10:29:33.321502 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:29:33.322780 [debug] [Thread-1 (]: On model.transform.3_1: Close
[0m10:29:33.336237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4b358db-72fd-47ad-adcf-46a47e0be7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713c0a207910>]}
[0m10:29:33.336630 [info ] [Thread-1 (]: 1 of 5 OK created sql view model main.3_1 ...................................... [[32mOK[0m in 0.10s]
[0m10:29:33.336946 [debug] [Thread-1 (]: Finished running node model.transform.3_1
[0m10:29:33.337201 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m10:29:33.337530 [info ] [Thread-1 (]: 2 of 5 START sql view model main.clean ......................................... [RUN]
[0m10:29:33.337826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_1, now model.transform.clean)
[0m10:29:33.338114 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m10:29:33.339226 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m10:29:33.340384 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m10:29:33.342170 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m10:29:33.343269 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:29:33.343457 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m10:29:33.343760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:33.354212 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:29:33.354439 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:29:33.354999 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT "Code INSEE région",	"Région"	,	"Date",	"Heure",	
"Consommation (MW)"	,"Thermique (MW)",	"Nucléaire (MW)",	"Eolien (MW)",	"Solaire (MW)",	"Hydraulique (MW)",	"Pompage (MW)",	"Bioénergies (MW)",	"Ech. physiques (MW)","production_totale"

     FROM clean
  );

[0m10:29:33.355701 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:29:33.357743 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:29:33.357953 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m10:29:33.358445 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:29:33.359853 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:29:33.360054 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m10:29:33.360543 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:29:33.361390 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m10:29:33.361585 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:29:33.362028 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m10:29:33.363581 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:29:33.364726 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:29:33.364932 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m10:29:33.365733 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:29:33.366371 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m10:29:33.378924 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4b358db-72fd-47ad-adcf-46a47e0be7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713c00385150>]}
[0m10:29:33.379344 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main.clean .................................... [[32mOK[0m in 0.04s]
[0m10:29:33.379680 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m10:29:33.379961 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m10:29:33.380303 [info ] [Thread-1 (]: 3 of 5 START sql view model main.grain_jour .................................... [RUN]
[0m10:29:33.380592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m10:29:33.380885 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m10:29:33.382005 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m10:29:33.383182 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m10:29:33.385047 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m10:29:33.386274 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:29:33.386491 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m10:29:33.386790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:33.397628 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:29:33.397865 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:29:33.398248 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS thermique_total,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS nucleaire_total,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS eolien_total,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS solaire_total,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS hydraulique_total,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS bioenergies_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_total,
    SUM(COALESCE(production_totale, 0)) AS production_totale
FROM clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m10:29:33.399063 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:29:33.400563 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:29:33.400770 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour" rename to "grain_jour__dbt_backup"
[0m10:29:33.401296 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:29:33.402815 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:29:33.403019 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour__dbt_tmp" rename to "grain_jour"
[0m10:29:33.403468 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:29:33.404257 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m10:29:33.404455 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:29:33.404751 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m10:29:33.406471 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:29:33.407624 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:29:33.407829 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
drop view if exists "dev"."main"."grain_jour__dbt_backup" cascade
[0m10:29:33.408600 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:29:33.409777 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m10:29:33.421681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4b358db-72fd-47ad-adcf-46a47e0be7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713bfef3bee0>]}
[0m10:29:33.422044 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.grain_jour ............................... [[32mOK[0m in 0.04s]
[0m10:29:33.422342 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m10:29:33.422549 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m10:29:33.422869 [info ] [Thread-1 (]: 4 of 5 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m10:29:33.423199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m10:29:33.423401 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m10:29:33.446110 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m10:29:33.447753 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m10:29:33.457334 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m10:29:33.458907 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:29:33.459123 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m10:29:33.459531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:33.470205 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:29:33.470429 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:29:33.471027 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m10:29:33.471704 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:29:33.473194 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:29:33.473402 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:29:33.473913 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:29:33.475385 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:29:33.475596 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:29:33.476094 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:29:33.478706 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m10:29:33.478953 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:29:33.479340 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m10:29:33.480889 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:29:33.482142 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:29:33.482345 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m10:29:33.483123 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:29:33.483824 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m10:29:33.499143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4b358db-72fd-47ad-adcf-46a47e0be7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713bfef5c910>]}
[0m10:29:33.499573 [info ] [Thread-1 (]: 4 of 5 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.08s]
[0m10:29:33.499893 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m10:29:33.500574 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m10:29:33.500833 [info ] [Thread-1 (]: 5 of 5 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m10:29:33.501096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m10:29:33.501355 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m10:29:33.502908 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m10:29:33.503982 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m10:29:33.506435 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m10:29:33.507459 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:29:33.507671 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m10:29:33.507978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:33.519440 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:29:33.519779 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:29:33.520384 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m10:29:33.521113 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:29:33.523830 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:29:33.524250 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m10:29:33.524931 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:29:33.527695 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:29:33.528039 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:29:33.528684 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:29:33.529875 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m10:29:33.530150 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:29:33.530489 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m10:29:33.531956 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:29:33.533408 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:29:33.533643 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m10:29:33.534425 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:29:33.535102 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m10:29:33.547244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4b358db-72fd-47ad-adcf-46a47e0be7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713c02b0c670>]}
[0m10:29:33.547662 [info ] [Thread-1 (]: 5 of 5 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m10:29:33.548030 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m10:29:33.548777 [debug] [MainThread]: Using duckdb connection "master"
[0m10:29:33.549004 [debug] [MainThread]: On master: BEGIN
[0m10:29:33.549327 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:29:33.561191 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m10:29:33.561513 [debug] [MainThread]: On master: COMMIT
[0m10:29:33.562060 [debug] [MainThread]: Using duckdb connection "master"
[0m10:29:33.562413 [debug] [MainThread]: On master: COMMIT
[0m10:29:33.562849 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:29:33.563076 [debug] [MainThread]: On master: Close
[0m10:29:33.564801 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:33.565052 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m10:29:33.565422 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m10:29:33.565816 [info ] [MainThread]: 
[0m10:29:33.566057 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m10:29:33.566881 [debug] [MainThread]: Command end result
[0m10:29:33.587957 [info ] [MainThread]: 
[0m10:29:33.588246 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:29:33.588470 [info ] [MainThread]: 
[0m10:29:33.588723 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m10:29:33.589322 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3508896, "process_in_blocks": "11200", "process_kernel_time": 0.222287, "process_mem_max_rss": "137964", "process_out_blocks": "9576", "process_user_time": 1.539723}
[0m10:29:33.589771 [debug] [MainThread]: Command `dbt run` succeeded at 10:29:33.589694 after 1.35 seconds
[0m10:29:33.590101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713c0a38fbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713c09734d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713c02baf460>]}
[0m10:29:33.590410 [debug] [MainThread]: Flushing usage events
[0m10:33:27.809261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f8e72fbbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f8e76ce410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f8e76ce470>]}


============================== 10:33:27.813450 | fd1fbda5-ed44-40a4-bf25-732b2f2b05ac ==============================
[0m10:33:27.813450 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:33:27.814302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:33:27.955819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd1fbda5-ed44-40a4-bf25-732b2f2b05ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f8e6d5e260>]}
[0m10:33:27.985454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd1fbda5-ed44-40a4-bf25-732b2f2b05ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f8e5b2fc10>]}
[0m10:33:27.988482 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m10:33:28.034327 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:33:28.164970 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:33:28.165725 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:33:28.175177 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m10:33:28.195311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd1fbda5-ed44-40a4-bf25-732b2f2b05ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f8e76701f0>]}
[0m10:33:28.268548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd1fbda5-ed44-40a4-bf25-732b2f2b05ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f8e03dffa0>]}
[0m10:33:28.268998 [info ] [MainThread]: Found 5 models, 4 data tests, 421 macros
[0m10:33:28.269508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd1fbda5-ed44-40a4-bf25-732b2f2b05ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f8e03dfb80>]}
[0m10:33:28.271158 [info ] [MainThread]: 
[0m10:33:28.271589 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:33:28.275287 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m10:33:28.677980 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m10:33:28.678723 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m10:33:28.679443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:33:28.699927 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m10:33:28.701187 [debug] [ThreadPool]: On list_dev: Close
[0m10:33:28.704112 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m10:33:28.704508 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m10:33:28.708527 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:33:28.708726 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m10:33:28.709183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:33:28.721029 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m10:33:28.721846 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:33:28.722074 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m10:33:28.722662 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:33:28.722993 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:33:28.723388 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m10:33:28.723847 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:33:28.724390 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:33:28.724570 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:33:28.724882 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:33:28.725274 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:33:28.725517 [debug] [ThreadPool]: On create_dev_main: Close
[0m10:33:28.727282 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m10:33:28.732623 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:33:28.733096 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m10:33:28.733547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:33:28.749233 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m10:33:28.750027 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:33:28.750758 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m10:33:28.778224 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m10:33:28.779021 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m10:33:28.779705 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m10:33:28.779889 [debug] [ThreadPool]: On list_dev_main: Close
[0m10:33:28.782444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd1fbda5-ed44-40a4-bf25-732b2f2b05ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f8e71e7580>]}
[0m10:33:28.782683 [debug] [MainThread]: Using duckdb connection "master"
[0m10:33:28.783126 [debug] [MainThread]: On master: BEGIN
[0m10:33:28.783444 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:33:28.798525 [debug] [MainThread]: SQL status: OK in 0.015 seconds
[0m10:33:28.799289 [debug] [MainThread]: On master: COMMIT
[0m10:33:28.799944 [debug] [MainThread]: Using duckdb connection "master"
[0m10:33:28.800476 [debug] [MainThread]: On master: COMMIT
[0m10:33:28.801233 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:33:28.801803 [debug] [MainThread]: On master: Close
[0m10:33:28.804359 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:33:28.804866 [info ] [MainThread]: 
[0m10:33:28.807132 [debug] [Thread-1 (]: Began running node model.transform.3_1
[0m10:33:28.808346 [info ] [Thread-1 (]: 1 of 5 START sql view model main.3_1 ........................................... [RUN]
[0m10:33:28.809392 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.3_1'
[0m10:33:28.810202 [debug] [Thread-1 (]: Began compiling node model.transform.3_1
[0m10:33:28.818062 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_1"
[0m10:33:28.820486 [debug] [Thread-1 (]: Began executing node model.transform.3_1
[0m10:33:28.843383 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_1"
[0m10:33:28.846088 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:33:28.846290 [debug] [Thread-1 (]: On model.transform.3_1: BEGIN
[0m10:33:28.846705 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:33:28.861203 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m10:33:28.861799 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:33:28.862532 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0))/2000 AS consommation_totale_en_GWH,
    SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,

    MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale

from clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m10:33:28.867392 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:33:28.873586 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:33:28.873902 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1" rename to "3_1__dbt_backup"
[0m10:33:28.874668 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:33:28.876334 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:33:28.876546 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1__dbt_tmp" rename to "3_1"
[0m10:33:28.877148 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:33:28.885286 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m10:33:28.885506 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:33:28.886107 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m10:33:28.887912 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:33:28.890311 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:33:28.890529 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
drop view if exists "dev"."main"."3_1__dbt_backup" cascade
[0m10:33:28.891486 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:33:28.892753 [debug] [Thread-1 (]: On model.transform.3_1: Close
[0m10:33:28.906450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd1fbda5-ed44-40a4-bf25-732b2f2b05ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f8e5752050>]}
[0m10:33:28.906870 [info ] [Thread-1 (]: 1 of 5 OK created sql view model main.3_1 ...................................... [[32mOK[0m in 0.10s]
[0m10:33:28.907246 [debug] [Thread-1 (]: Finished running node model.transform.3_1
[0m10:33:28.907496 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m10:33:28.907814 [info ] [Thread-1 (]: 2 of 5 START sql view model main.clean ......................................... [RUN]
[0m10:33:28.908090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_1, now model.transform.clean)
[0m10:33:28.908368 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m10:33:28.909488 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m10:33:28.910669 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m10:33:28.912435 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m10:33:28.913650 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:33:28.913852 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m10:33:28.914308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:33:28.925695 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:33:28.925932 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:33:28.926335 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT "Code INSEE région",	"Région"	,	"Date",	"Heure",	
"Consommation (MW)"	,"Thermique (MW)",	"Nucléaire (MW)",	"Eolien (MW)",	"Solaire (MW)",	"Hydraulique (MW)",	"Pompage (MW)",	"Bioénergies (MW)",	"Ech. physiques (MW)","production_totale"

     FROM clean
  );

[0m10:33:28.927058 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:33:28.929069 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:33:28.929278 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m10:33:28.929836 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:33:28.931426 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:33:28.931633 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m10:33:28.932128 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:33:28.932967 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m10:33:28.933163 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:33:28.933567 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m10:33:28.935383 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:33:28.936483 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:33:28.936674 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m10:33:28.937443 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:33:28.938080 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m10:33:28.950514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd1fbda5-ed44-40a4-bf25-732b2f2b05ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f8dd135060>]}
[0m10:33:28.950878 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main.clean .................................... [[32mOK[0m in 0.04s]
[0m10:33:28.951275 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m10:33:28.951540 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m10:33:28.952144 [info ] [Thread-1 (]: 3 of 5 START sql view model main.grain_jour .................................... [RUN]
[0m10:33:28.952441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m10:33:28.952708 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m10:33:28.953750 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m10:33:28.954935 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m10:33:28.956659 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m10:33:28.957707 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:33:28.957912 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m10:33:28.958328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:33:28.968903 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:33:28.969129 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:33:28.969667 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS thermique_total,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS nucleaire_total,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS eolien_total,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS solaire_total,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS hydraulique_total,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS bioenergies_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_total,
    SUM(COALESCE(production_totale, 0)) AS production_totale
FROM clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m10:33:28.970518 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:33:28.972277 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:33:28.972486 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour" rename to "grain_jour__dbt_backup"
[0m10:33:28.972961 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:33:28.974387 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:33:28.974581 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour__dbt_tmp" rename to "grain_jour"
[0m10:33:28.975129 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:33:28.975931 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m10:33:28.976122 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:33:28.976424 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m10:33:28.978373 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:33:28.979535 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:33:28.979732 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
drop view if exists "dev"."main"."grain_jour__dbt_backup" cascade
[0m10:33:28.980527 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:33:28.981681 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m10:33:28.994364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd1fbda5-ed44-40a4-bf25-732b2f2b05ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f8dc79bee0>]}
[0m10:33:28.994715 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.grain_jour ............................... [[32mOK[0m in 0.04s]
[0m10:33:28.995018 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m10:33:28.995274 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m10:33:28.995606 [info ] [Thread-1 (]: 4 of 5 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m10:33:28.995855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m10:33:28.996247 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m10:33:29.018649 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m10:33:29.019852 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m10:33:29.029613 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m10:33:29.030793 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:33:29.030990 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m10:33:29.031323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:33:29.042538 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:33:29.042776 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:33:29.043382 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m10:33:29.043993 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:33:29.045525 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:33:29.045732 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:33:29.046246 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:33:29.048073 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:33:29.048336 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:33:29.048882 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:33:29.051835 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m10:33:29.052063 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:33:29.052498 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m10:33:29.053988 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:33:29.055180 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:33:29.055382 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m10:33:29.056190 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:33:29.056903 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m10:33:29.070525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd1fbda5-ed44-40a4-bf25-732b2f2b05ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f8dc7b5030>]}
[0m10:33:29.070905 [info ] [Thread-1 (]: 4 of 5 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.07s]
[0m10:33:29.071259 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m10:33:29.071817 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m10:33:29.072057 [info ] [Thread-1 (]: 5 of 5 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m10:33:29.072464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m10:33:29.072781 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m10:33:29.074215 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m10:33:29.075443 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m10:33:29.077782 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m10:33:29.078969 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:33:29.079167 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m10:33:29.079489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:33:29.090476 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:33:29.090696 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:33:29.091273 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m10:33:29.091970 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:33:29.093544 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:33:29.093780 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m10:33:29.094268 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:33:29.095628 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:33:29.095835 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:33:29.096310 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:33:29.097114 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m10:33:29.097307 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:33:29.097598 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m10:33:29.099166 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:33:29.100308 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:33:29.100500 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m10:33:29.101264 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:33:29.101934 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m10:33:29.114556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd1fbda5-ed44-40a4-bf25-732b2f2b05ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f8e0377cd0>]}
[0m10:33:29.114958 [info ] [Thread-1 (]: 5 of 5 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m10:33:29.115268 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m10:33:29.116087 [debug] [MainThread]: Using duckdb connection "master"
[0m10:33:29.116293 [debug] [MainThread]: On master: BEGIN
[0m10:33:29.116629 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:33:29.127522 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m10:33:29.127726 [debug] [MainThread]: On master: COMMIT
[0m10:33:29.128286 [debug] [MainThread]: Using duckdb connection "master"
[0m10:33:29.128821 [debug] [MainThread]: On master: COMMIT
[0m10:33:29.129261 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:33:29.129507 [debug] [MainThread]: On master: Close
[0m10:33:29.131024 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:33:29.131224 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m10:33:29.131589 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m10:33:29.131936 [info ] [MainThread]: 
[0m10:33:29.132365 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m10:33:29.133329 [debug] [MainThread]: Command end result
[0m10:33:29.154821 [info ] [MainThread]: 
[0m10:33:29.155062 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:33:29.155306 [info ] [MainThread]: 
[0m10:33:29.155586 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m10:33:29.156097 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3807516, "process_in_blocks": "11488", "process_kernel_time": 0.174495, "process_mem_max_rss": "137544", "process_out_blocks": "9576", "process_user_time": 1.659239}
[0m10:33:29.156384 [debug] [MainThread]: Command `dbt run` succeeded at 10:33:29.156334 after 1.38 seconds
[0m10:33:29.156630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f8e72fbbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f8df910a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f8df910250>]}
[0m10:33:29.156840 [debug] [MainThread]: Flushing usage events
[0m10:38:02.580209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79766f997c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79766fdd28f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79766fdd31f0>]}


============================== 10:38:02.583468 | 3289a0c3-df5b-47a8-bbbb-93d7109d81e8 ==============================
[0m10:38:02.583468 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:38:02.584350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:38:02.734447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3289a0c3-df5b-47a8-bbbb-93d7109d81e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79766f8c57e0>]}
[0m10:38:02.763710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3289a0c3-df5b-47a8-bbbb-93d7109d81e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79766ed44e20>]}
[0m10:38:02.766615 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m10:38:02.808340 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:38:02.946550 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:38:02.947315 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:38:02.957966 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m10:38:02.977178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3289a0c3-df5b-47a8-bbbb-93d7109d81e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79766818d420>]}
[0m10:38:03.046600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3289a0c3-df5b-47a8-bbbb-93d7109d81e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79766818fd60>]}
[0m10:38:03.047000 [info ] [MainThread]: Found 5 models, 4 data tests, 421 macros
[0m10:38:03.047587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3289a0c3-df5b-47a8-bbbb-93d7109d81e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79766f800df0>]}
[0m10:38:03.049021 [info ] [MainThread]: 
[0m10:38:03.049435 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:38:03.052927 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m10:38:03.434251 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m10:38:03.435305 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m10:38:03.435958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:38:03.464439 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m10:38:03.465959 [debug] [ThreadPool]: On list_dev: Close
[0m10:38:03.469133 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m10:38:03.469598 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m10:38:03.474282 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:38:03.474475 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m10:38:03.474876 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:38:03.486624 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m10:38:03.487476 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:38:03.487712 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m10:38:03.488236 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:38:03.488453 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:38:03.488870 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m10:38:03.489368 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:38:03.489830 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:38:03.490014 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:38:03.490337 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:38:03.490729 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:38:03.490980 [debug] [ThreadPool]: On create_dev_main: Close
[0m10:38:03.492536 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m10:38:03.495719 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:38:03.495963 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m10:38:03.496315 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:38:03.509921 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m10:38:03.510355 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:38:03.511018 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m10:38:03.524731 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m10:38:03.525415 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m10:38:03.526006 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m10:38:03.526193 [debug] [ThreadPool]: On list_dev_main: Close
[0m10:38:03.528019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3289a0c3-df5b-47a8-bbbb-93d7109d81e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79766f7b4bb0>]}
[0m10:38:03.528260 [debug] [MainThread]: Using duckdb connection "master"
[0m10:38:03.528553 [debug] [MainThread]: On master: BEGIN
[0m10:38:03.528865 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:38:03.540639 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m10:38:03.540907 [debug] [MainThread]: On master: COMMIT
[0m10:38:03.541474 [debug] [MainThread]: Using duckdb connection "master"
[0m10:38:03.541807 [debug] [MainThread]: On master: COMMIT
[0m10:38:03.542216 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:38:03.542432 [debug] [MainThread]: On master: Close
[0m10:38:03.543712 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:38:03.543974 [info ] [MainThread]: 
[0m10:38:03.545612 [debug] [Thread-1 (]: Began running node model.transform.3_1
[0m10:38:03.546569 [info ] [Thread-1 (]: 1 of 5 START sql view model main.3_1 ........................................... [RUN]
[0m10:38:03.547369 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.3_1'
[0m10:38:03.547952 [debug] [Thread-1 (]: Began compiling node model.transform.3_1
[0m10:38:03.555805 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_1"
[0m10:38:03.558722 [debug] [Thread-1 (]: Began executing node model.transform.3_1
[0m10:38:03.587922 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_1"
[0m10:38:03.590747 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:38:03.590959 [debug] [Thread-1 (]: On model.transform.3_1: BEGIN
[0m10:38:03.591349 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:38:03.602903 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m10:38:03.603126 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:38:03.603757 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    TO_CHAR("Date", 'YYYY-MM') AS mois, 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0))/2000 AS consommation_totale_en_GWH,
    SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,

    MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale

from clean
TO_CHAR("Date", 'YYYY-MM'), "Région"
ORDER BY "mois", "Région"
  );

[0m10:38:03.615448 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    TO_CHAR("Date", 'YYYY-MM') AS mois, 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0))/2000 AS consommation_totale_en_GWH,
    SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,

    MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale

from clean
TO_CHAR("Date", 'YYYY-MM'), "Région"
ORDER BY "mois", "Région"
  );

[0m10:38:03.615697 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:38:03.616699 [debug] [Thread-1 (]: On model.transform.3_1: ROLLBACK
[0m10:38:03.621563 [debug] [Thread-1 (]: Failed to rollback 'model.transform.3_1'
[0m10:38:03.622042 [debug] [Thread-1 (]: On model.transform.3_1: Close
[0m10:38:03.625148 [debug] [Thread-1 (]: Runtime Error in model 3_1 (models/example/3_1.sql)
  Catalog Error: Table with name Région does not exist!
  Did you mean "pg_index"?
  LINE 22: TO_CHAR("Date", 'YYYY-MM'), "Région"
                                       ^
[0m10:38:03.626431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3289a0c3-df5b-47a8-bbbb-93d7109d81e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79766a9875e0>]}
[0m10:38:03.627067 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model main.3_1 .................................. [[31mERROR[0m in 0.08s]
[0m10:38:03.627646 [debug] [Thread-1 (]: Finished running node model.transform.3_1
[0m10:38:03.628075 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m10:38:03.628536 [info ] [Thread-1 (]: 2 of 5 START sql view model main.clean ......................................... [RUN]
[0m10:38:03.629013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_1, now model.transform.clean)
[0m10:38:03.629364 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m10:38:03.632200 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m10:38:03.633770 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m10:38:03.636590 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m10:38:03.637901 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:38:03.638136 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m10:38:03.638484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:03.650363 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m10:38:03.650695 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:38:03.651318 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT "Code INSEE région",	"Région"	,	"Date",	"Heure",	
"Consommation (MW)"	,"Thermique (MW)",	"Nucléaire (MW)",	"Eolien (MW)",	"Solaire (MW)",	"Hydraulique (MW)",	"Pompage (MW)",	"Bioénergies (MW)",	"Ech. physiques (MW)","production_totale"

     FROM clean
  );

[0m10:38:03.652230 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:03.655857 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:38:03.656075 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m10:38:03.656586 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:38:03.658045 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:38:03.658321 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m10:38:03.658783 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:38:03.667059 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m10:38:03.667276 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:38:03.667657 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m10:38:03.669582 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:38:03.672086 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:38:03.672296 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m10:38:03.673097 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:38:03.674369 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m10:38:03.687283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3289a0c3-df5b-47a8-bbbb-93d7109d81e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7976681c7e50>]}
[0m10:38:03.687907 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main.clean .................................... [[32mOK[0m in 0.06s]
[0m10:38:03.688478 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m10:38:03.688884 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m10:38:03.689299 [info ] [Thread-1 (]: 3 of 5 START sql view model main.grain_jour .................................... [RUN]
[0m10:38:03.689732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m10:38:03.690031 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m10:38:03.691585 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m10:38:03.692704 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m10:38:03.694469 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m10:38:03.695702 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:38:03.695893 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m10:38:03.696212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:03.707234 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:38:03.707467 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:38:03.708035 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS thermique_total,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS nucleaire_total,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS eolien_total,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS solaire_total,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS hydraulique_total,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS bioenergies_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_total,
    SUM(COALESCE(production_totale, 0)) AS production_totale
FROM clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m10:38:03.708978 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:03.710507 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:38:03.710750 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour" rename to "grain_jour__dbt_backup"
[0m10:38:03.711492 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:38:03.713936 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:38:03.714133 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour__dbt_tmp" rename to "grain_jour"
[0m10:38:03.714702 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:38:03.715577 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m10:38:03.715778 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:38:03.716248 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m10:38:03.718167 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:38:03.719427 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:38:03.719630 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
drop view if exists "dev"."main"."grain_jour__dbt_backup" cascade
[0m10:38:03.720466 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:38:03.721142 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m10:38:03.733371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3289a0c3-df5b-47a8-bbbb-93d7109d81e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7976681c5cf0>]}
[0m10:38:03.733724 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.grain_jour ............................... [[32mOK[0m in 0.04s]
[0m10:38:03.734062 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m10:38:03.734327 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m10:38:03.734677 [info ] [Thread-1 (]: 4 of 5 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m10:38:03.734928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m10:38:03.735223 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m10:38:03.736796 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m10:38:03.737862 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m10:38:03.747308 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m10:38:03.748654 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:38:03.748887 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m10:38:03.749196 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:03.759953 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:38:03.760166 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:38:03.760750 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m10:38:03.761455 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:38:03.763328 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:38:03.763531 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:38:03.764097 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:38:03.786040 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:38:03.786329 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:38:03.787442 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:38:03.790208 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m10:38:03.790432 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:38:03.790947 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m10:38:03.792615 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:03.793855 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:38:03.794059 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m10:38:03.794863 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:38:03.795547 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m10:38:03.810359 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3289a0c3-df5b-47a8-bbbb-93d7109d81e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7976645b6f50>]}
[0m10:38:03.810826 [info ] [Thread-1 (]: 4 of 5 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.08s]
[0m10:38:03.811142 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m10:38:03.811684 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m10:38:03.811927 [info ] [Thread-1 (]: 5 of 5 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m10:38:03.812242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m10:38:03.812517 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m10:38:03.814106 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m10:38:03.815266 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m10:38:03.817128 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m10:38:03.818325 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:38:03.818531 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m10:38:03.818846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:03.829485 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:38:03.829733 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:38:03.830277 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m10:38:03.830726 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:38:03.832278 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:38:03.832484 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m10:38:03.833025 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:38:03.834556 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:38:03.834777 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:38:03.835263 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:38:03.836076 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m10:38:03.836281 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:38:03.836569 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m10:38:03.838257 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:03.839387 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:38:03.839580 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m10:38:03.840433 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:03.841077 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m10:38:03.853202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3289a0c3-df5b-47a8-bbbb-93d7109d81e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79766815cf40>]}
[0m10:38:03.853587 [info ] [Thread-1 (]: 5 of 5 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m10:38:03.853956 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m10:38:03.854627 [debug] [MainThread]: Using duckdb connection "master"
[0m10:38:03.854838 [debug] [MainThread]: On master: BEGIN
[0m10:38:03.855150 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:38:03.866792 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m10:38:03.867149 [debug] [MainThread]: On master: COMMIT
[0m10:38:03.867809 [debug] [MainThread]: Using duckdb connection "master"
[0m10:38:03.868330 [debug] [MainThread]: On master: COMMIT
[0m10:38:03.868932 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:38:03.869283 [debug] [MainThread]: On master: Close
[0m10:38:03.871708 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:38:03.872238 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m10:38:03.872700 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m10:38:03.873323 [info ] [MainThread]: 
[0m10:38:03.873797 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m10:38:03.875285 [debug] [MainThread]: Command end result
[0m10:38:03.899737 [info ] [MainThread]: 
[0m10:38:03.900029 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:38:03.900465 [info ] [MainThread]: 
[0m10:38:03.900853 [error] [MainThread]:   Runtime Error in model 3_1 (models/example/3_1.sql)
  Catalog Error: Table with name Région does not exist!
  Did you mean "pg_index"?
  LINE 22: TO_CHAR("Date", 'YYYY-MM'), "Région"
                                       ^
[0m10:38:03.901131 [info ] [MainThread]: 
[0m10:38:03.901476 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m10:38:03.902056 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3496389, "process_in_blocks": "11584", "process_kernel_time": 0.212726, "process_mem_max_rss": "140988", "process_out_blocks": "8472", "process_user_time": 1.545681}
[0m10:38:03.902371 [debug] [MainThread]: Command `dbt run` failed at 10:38:03.902317 after 1.35 seconds
[0m10:38:03.902644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79766f997c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79766ed44e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797664551180>]}
[0m10:38:03.902860 [debug] [MainThread]: Flushing usage events
[0m10:39:16.012762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b581e87c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b5822c2890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b5822c30a0>]}


============================== 10:39:16.015674 | ef3d6965-64fe-4d85-900e-c10897abd69f ==============================
[0m10:39:16.015674 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:39:16.016149 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:39:16.151832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef3d6965-64fe-4d85-900e-c10897abd69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b580775ea0>]}
[0m10:39:16.183204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef3d6965-64fe-4d85-900e-c10897abd69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b5807df970>]}
[0m10:39:16.185993 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m10:39:16.228751 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:39:16.365818 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:39:16.366562 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:39:16.378235 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m10:39:16.398465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef3d6965-64fe-4d85-900e-c10897abd69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b579d713c0>]}
[0m10:39:16.467466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef3d6965-64fe-4d85-900e-c10897abd69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b579d71360>]}
[0m10:39:16.467848 [info ] [MainThread]: Found 5 models, 4 data tests, 421 macros
[0m10:39:16.468392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef3d6965-64fe-4d85-900e-c10897abd69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b579d71390>]}
[0m10:39:16.469778 [info ] [MainThread]: 
[0m10:39:16.470205 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:39:16.473735 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m10:39:16.865168 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m10:39:16.865907 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m10:39:16.866525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:39:16.884655 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m10:39:16.885962 [debug] [ThreadPool]: On list_dev: Close
[0m10:39:16.889582 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m10:39:16.890516 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m10:39:16.899876 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:39:16.900086 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m10:39:16.900541 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:39:16.919373 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m10:39:16.921004 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:39:16.921441 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m10:39:16.922215 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:39:16.922552 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:39:16.923021 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m10:39:16.923679 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:39:16.924434 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:39:16.924724 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:39:16.925224 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:39:16.925730 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:39:16.926067 [debug] [ThreadPool]: On create_dev_main: Close
[0m10:39:16.928442 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m10:39:16.935976 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:39:16.936220 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m10:39:16.936718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:39:16.958830 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m10:39:16.959743 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:39:16.960517 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m10:39:16.980308 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m10:39:16.981043 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m10:39:16.981626 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m10:39:16.981797 [debug] [ThreadPool]: On list_dev_main: Close
[0m10:39:16.984278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef3d6965-64fe-4d85-900e-c10897abd69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b580776020>]}
[0m10:39:16.984616 [debug] [MainThread]: Using duckdb connection "master"
[0m10:39:16.984994 [debug] [MainThread]: On master: BEGIN
[0m10:39:16.985377 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:39:17.002581 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m10:39:17.003355 [debug] [MainThread]: On master: COMMIT
[0m10:39:17.004063 [debug] [MainThread]: Using duckdb connection "master"
[0m10:39:17.004597 [debug] [MainThread]: On master: COMMIT
[0m10:39:17.005482 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:39:17.006049 [debug] [MainThread]: On master: Close
[0m10:39:17.008659 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:39:17.009163 [info ] [MainThread]: 
[0m10:39:17.011307 [debug] [Thread-1 (]: Began running node model.transform.3_1
[0m10:39:17.012505 [info ] [Thread-1 (]: 1 of 5 START sql view model main.3_1 ........................................... [RUN]
[0m10:39:17.013363 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.3_1'
[0m10:39:17.013841 [debug] [Thread-1 (]: Began compiling node model.transform.3_1
[0m10:39:17.021515 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_1"
[0m10:39:17.023746 [debug] [Thread-1 (]: Began executing node model.transform.3_1
[0m10:39:17.048083 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_1"
[0m10:39:17.050998 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:39:17.051210 [debug] [Thread-1 (]: On model.transform.3_1: BEGIN
[0m10:39:17.051737 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:39:17.063102 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:39:17.063328 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:39:17.063920 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    TO_CHAR("Date", 'YYYY-MM') AS mois, 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0))/2000 AS consommation_totale_en_GWH,
    SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,

    MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale

from clean
GROUP BY TO_CHAR("Date", 'YYYY-MM'), "Région"
ORDER BY "mois", "Région"
  );

[0m10:39:17.066828 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    TO_CHAR("Date", 'YYYY-MM') AS mois, 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0))/2000 AS consommation_totale_en_GWH,
    SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,

    MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale

from clean
GROUP BY TO_CHAR("Date", 'YYYY-MM'), "Région"
ORDER BY "mois", "Région"
  );

[0m10:39:17.067068 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:39:17.067539 [debug] [Thread-1 (]: On model.transform.3_1: ROLLBACK
[0m10:39:17.070702 [debug] [Thread-1 (]: Failed to rollback 'model.transform.3_1'
[0m10:39:17.070914 [debug] [Thread-1 (]: On model.transform.3_1: Close
[0m10:39:17.072980 [debug] [Thread-1 (]: Runtime Error in model 3_1 (models/example/3_1.sql)
  Catalog Error: Scalar Function with name to_char does not exist!
  Did you mean "to_hours"?
  LINE 22: GROUP BY TO_CHAR("Date", 'YYYY-MM'), "Région"
                    ^
[0m10:39:17.073803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef3d6965-64fe-4d85-900e-c10897abd69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b580776020>]}
[0m10:39:17.074163 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model main.3_1 .................................. [[31mERROR[0m in 0.06s]
[0m10:39:17.074479 [debug] [Thread-1 (]: Finished running node model.transform.3_1
[0m10:39:17.074737 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m10:39:17.075582 [info ] [Thread-1 (]: 2 of 5 START sql view model main.clean ......................................... [RUN]
[0m10:39:17.075937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_1, now model.transform.clean)
[0m10:39:17.076209 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m10:39:17.077519 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m10:39:17.078811 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m10:39:17.081529 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m10:39:17.083234 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:39:17.083624 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m10:39:17.084179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:39:17.101211 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m10:39:17.101916 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:39:17.102774 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT "Code INSEE région",	"Région"	,	"Date",	"Heure",	
"Consommation (MW)"	,"Thermique (MW)",	"Nucléaire (MW)",	"Eolien (MW)",	"Solaire (MW)",	"Hydraulique (MW)",	"Pompage (MW)",	"Bioénergies (MW)",	"Ech. physiques (MW)","production_totale"

     FROM clean
  );

[0m10:39:17.104916 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:17.112121 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:39:17.112466 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m10:39:17.113264 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:39:17.115162 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:39:17.115391 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m10:39:17.115928 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:39:17.123970 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m10:39:17.124188 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:39:17.124601 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m10:39:17.126109 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:17.129039 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:39:17.129359 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m10:39:17.130213 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:39:17.132080 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m10:39:17.144715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef3d6965-64fe-4d85-900e-c10897abd69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b579da89d0>]}
[0m10:39:17.145137 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main.clean .................................... [[32mOK[0m in 0.07s]
[0m10:39:17.145508 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m10:39:17.145775 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m10:39:17.146108 [info ] [Thread-1 (]: 3 of 5 START sql view model main.grain_jour .................................... [RUN]
[0m10:39:17.146398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m10:39:17.146666 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m10:39:17.148275 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m10:39:17.149656 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m10:39:17.151434 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m10:39:17.152597 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:39:17.152993 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m10:39:17.153423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:39:17.164369 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:39:17.164600 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:39:17.165248 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS thermique_total,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS nucleaire_total,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS eolien_total,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS solaire_total,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS hydraulique_total,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS bioenergies_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_total,
    SUM(COALESCE(production_totale, 0)) AS production_totale
FROM clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m10:39:17.166133 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:17.167864 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:39:17.168175 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour" rename to "grain_jour__dbt_backup"
[0m10:39:17.168804 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:39:17.170972 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:39:17.171235 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour__dbt_tmp" rename to "grain_jour"
[0m10:39:17.171791 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:39:17.172772 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m10:39:17.173007 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:39:17.173299 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m10:39:17.175196 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:39:17.176492 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:39:17.176715 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
drop view if exists "dev"."main"."grain_jour__dbt_backup" cascade
[0m10:39:17.177571 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:17.178232 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m10:39:17.190445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef3d6965-64fe-4d85-900e-c10897abd69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b579da9030>]}
[0m10:39:17.190809 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.grain_jour ............................... [[32mOK[0m in 0.04s]
[0m10:39:17.191169 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m10:39:17.191425 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m10:39:17.191756 [info ] [Thread-1 (]: 4 of 5 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m10:39:17.192044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m10:39:17.192316 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m10:39:17.193768 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m10:39:17.194989 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m10:39:17.204679 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m10:39:17.205855 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:39:17.206050 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m10:39:17.206350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:39:17.216993 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:39:17.217214 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:39:17.217780 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m10:39:17.218435 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:39:17.220358 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:39:17.220569 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:39:17.221040 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:39:17.243962 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:39:17.244256 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:39:17.245137 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:39:17.247813 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m10:39:17.248033 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:39:17.248375 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m10:39:17.249903 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:17.251132 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:39:17.251329 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m10:39:17.252123 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:39:17.252818 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m10:39:17.267583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef3d6965-64fe-4d85-900e-c10897abd69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b57619aef0>]}
[0m10:39:17.267996 [info ] [Thread-1 (]: 4 of 5 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.08s]
[0m10:39:17.268302 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m10:39:17.268967 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m10:39:17.269205 [info ] [Thread-1 (]: 5 of 5 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m10:39:17.269622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m10:39:17.269881 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m10:39:17.271409 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m10:39:17.272642 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m10:39:17.274532 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m10:39:17.275653 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:39:17.275850 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m10:39:17.276154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:39:17.287254 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:39:17.287472 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:39:17.287972 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m10:39:17.288453 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:39:17.290000 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:39:17.290215 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m10:39:17.290718 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:39:17.292167 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:39:17.292386 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:39:17.292847 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:39:17.293766 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m10:39:17.293985 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:39:17.294298 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m10:39:17.295715 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:17.296880 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:39:17.297075 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m10:39:17.297808 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:39:17.298453 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m10:39:17.310646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef3d6965-64fe-4d85-900e-c10897abd69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b579d831c0>]}
[0m10:39:17.311015 [info ] [Thread-1 (]: 5 of 5 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m10:39:17.311316 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m10:39:17.312313 [debug] [MainThread]: Using duckdb connection "master"
[0m10:39:17.312651 [debug] [MainThread]: On master: BEGIN
[0m10:39:17.313042 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:39:17.323834 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m10:39:17.324046 [debug] [MainThread]: On master: COMMIT
[0m10:39:17.324595 [debug] [MainThread]: Using duckdb connection "master"
[0m10:39:17.324902 [debug] [MainThread]: On master: COMMIT
[0m10:39:17.325318 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:39:17.325512 [debug] [MainThread]: On master: Close
[0m10:39:17.326976 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:39:17.327158 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m10:39:17.327483 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m10:39:17.327779 [info ] [MainThread]: 
[0m10:39:17.328031 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m10:39:17.328734 [debug] [MainThread]: Command end result
[0m10:39:17.349569 [info ] [MainThread]: 
[0m10:39:17.349818 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:39:17.350105 [info ] [MainThread]: 
[0m10:39:17.350457 [error] [MainThread]:   Runtime Error in model 3_1 (models/example/3_1.sql)
  Catalog Error: Scalar Function with name to_char does not exist!
  Did you mean "to_hours"?
  LINE 22: GROUP BY TO_CHAR("Date", 'YYYY-MM'), "Région"
                    ^
[0m10:39:17.350717 [info ] [MainThread]: 
[0m10:39:17.351043 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m10:39:17.351579 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3658072, "process_in_blocks": "11200", "process_kernel_time": 0.168114, "process_mem_max_rss": "140824", "process_out_blocks": "8472", "process_user_time": 1.36821}
[0m10:39:17.351867 [debug] [MainThread]: Command `dbt run` failed at 10:39:17.351817 after 1.37 seconds
[0m10:39:17.352132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b581e87c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b5761345e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b576135750>]}
[0m10:39:17.352423 [debug] [MainThread]: Flushing usage events
[0m10:40:00.163229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d8569f8fc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d856a3c6890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d856a3c70a0>]}


============================== 10:40:00.165652 | 3684da49-abd0-4392-bfe3-2bd6298a6f49 ==============================
[0m10:40:00.165652 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:40:00.166326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:40:00.289769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3684da49-abd0-4392-bfe3-2bd6298a6f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d85685edea0>]}
[0m10:40:00.317147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3684da49-abd0-4392-bfe3-2bd6298a6f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d85688e7970>]}
[0m10:40:00.319852 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m10:40:00.362222 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:40:00.497727 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:40:00.498493 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:40:00.507237 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m10:40:00.525762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3684da49-abd0-4392-bfe3-2bd6298a6f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d85627753c0>]}
[0m10:40:00.586255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3684da49-abd0-4392-bfe3-2bd6298a6f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d8562775360>]}
[0m10:40:00.586551 [info ] [MainThread]: Found 5 models, 4 data tests, 421 macros
[0m10:40:00.587052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3684da49-abd0-4392-bfe3-2bd6298a6f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d8562775390>]}
[0m10:40:00.588123 [info ] [MainThread]: 
[0m10:40:00.588433 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:40:00.591363 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m10:40:00.805665 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m10:40:00.806368 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m10:40:00.807095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:40:00.825360 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m10:40:00.826650 [debug] [ThreadPool]: On list_dev: Close
[0m10:40:00.829810 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m10:40:00.830293 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m10:40:00.834586 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:40:00.834798 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m10:40:00.835114 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:40:00.846339 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m10:40:00.847125 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:40:00.847335 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m10:40:00.847995 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:40:00.848182 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:40:00.848495 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m10:40:00.848907 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:40:00.849385 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:40:00.849570 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:40:00.849866 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:40:00.850284 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:40:00.850605 [debug] [ThreadPool]: On create_dev_main: Close
[0m10:40:00.852397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m10:40:00.856983 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:40:00.857217 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m10:40:00.857560 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:40:00.868901 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m10:40:00.869183 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:40:00.869742 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m10:40:00.884308 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m10:40:00.884968 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m10:40:00.885658 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m10:40:00.885833 [debug] [ThreadPool]: On list_dev_main: Close
[0m10:40:00.887834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3684da49-abd0-4392-bfe3-2bd6298a6f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d85685ee020>]}
[0m10:40:00.888076 [debug] [MainThread]: Using duckdb connection "master"
[0m10:40:00.888275 [debug] [MainThread]: On master: BEGIN
[0m10:40:00.888559 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:40:00.899452 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m10:40:00.899651 [debug] [MainThread]: On master: COMMIT
[0m10:40:00.900162 [debug] [MainThread]: Using duckdb connection "master"
[0m10:40:00.900520 [debug] [MainThread]: On master: COMMIT
[0m10:40:00.900959 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:40:00.901176 [debug] [MainThread]: On master: Close
[0m10:40:00.902450 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:40:00.902657 [info ] [MainThread]: 
[0m10:40:00.903873 [debug] [Thread-1 (]: Began running node model.transform.3_1
[0m10:40:00.904504 [info ] [Thread-1 (]: 1 of 5 START sql view model main.3_1 ........................................... [RUN]
[0m10:40:00.904996 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.3_1'
[0m10:40:00.905336 [debug] [Thread-1 (]: Began compiling node model.transform.3_1
[0m10:40:00.910561 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_1"
[0m10:40:00.911657 [debug] [Thread-1 (]: Began executing node model.transform.3_1
[0m10:40:00.927886 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_1"
[0m10:40:00.929143 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:40:00.929347 [debug] [Thread-1 (]: On model.transform.3_1: BEGIN
[0m10:40:00.929655 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:40:00.941402 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m10:40:00.941693 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:40:00.942292 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    TO_CHAR(Date, 'YYYY-MM') AS mois, 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0))/2000 AS consommation_totale_en_GWH,
    SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,

    MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale

from clean
GROUP BY TO_CHAR(Date, 'YYYY-MM'), "Région"
ORDER BY "mois", "Région"
  );

[0m10:40:00.945473 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    TO_CHAR(Date, 'YYYY-MM') AS mois, 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0))/2000 AS consommation_totale_en_GWH,
    SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,

    MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale

from clean
GROUP BY TO_CHAR(Date, 'YYYY-MM'), "Région"
ORDER BY "mois", "Région"
  );

[0m10:40:00.945711 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:40:00.946150 [debug] [Thread-1 (]: On model.transform.3_1: ROLLBACK
[0m10:40:00.949142 [debug] [Thread-1 (]: Failed to rollback 'model.transform.3_1'
[0m10:40:00.949343 [debug] [Thread-1 (]: On model.transform.3_1: Close
[0m10:40:00.951185 [debug] [Thread-1 (]: Runtime Error in model 3_1 (models/example/3_1.sql)
  Catalog Error: Scalar Function with name to_char does not exist!
  Did you mean "to_hours"?
  LINE 22: GROUP BY TO_CHAR(Date, 'YYYY-MM'), "Région"
                    ^
[0m10:40:00.952008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3684da49-abd0-4392-bfe3-2bd6298a6f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d85685ee020>]}
[0m10:40:00.952355 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model main.3_1 .................................. [[31mERROR[0m in 0.05s]
[0m10:40:00.952672 [debug] [Thread-1 (]: Finished running node model.transform.3_1
[0m10:40:00.952900 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m10:40:00.953661 [info ] [Thread-1 (]: 2 of 5 START sql view model main.clean ......................................... [RUN]
[0m10:40:00.953941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_1, now model.transform.clean)
[0m10:40:00.954218 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m10:40:00.955343 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m10:40:00.956513 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m10:40:00.958211 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m10:40:00.959243 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:40:00.959431 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m10:40:00.959731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:00.970610 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:40:00.970835 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:40:00.971405 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT "Code INSEE région",	"Région"	,	"Date",	"Heure",	
"Consommation (MW)"	,"Thermique (MW)",	"Nucléaire (MW)",	"Eolien (MW)",	"Solaire (MW)",	"Hydraulique (MW)",	"Pompage (MW)",	"Bioénergies (MW)",	"Ech. physiques (MW)","production_totale"

     FROM clean
  );

[0m10:40:00.972161 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:40:00.975436 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:40:00.975655 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m10:40:00.976147 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:40:00.977651 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:40:00.977863 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m10:40:00.978365 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:40:00.988529 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m10:40:00.988769 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:40:00.989274 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m10:40:00.990889 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:00.993353 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:40:00.993565 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m10:40:00.994406 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:40:00.995682 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m10:40:01.008252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3684da49-abd0-4392-bfe3-2bd6298a6f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d85627ac9d0>]}
[0m10:40:01.008652 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main.clean .................................... [[32mOK[0m in 0.05s]
[0m10:40:01.008961 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m10:40:01.009223 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m10:40:01.009553 [info ] [Thread-1 (]: 3 of 5 START sql view model main.grain_jour .................................... [RUN]
[0m10:40:01.009842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m10:40:01.010127 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m10:40:01.011775 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m10:40:01.013099 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m10:40:01.014895 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m10:40:01.016083 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:40:01.016272 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m10:40:01.016580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:01.027587 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:40:01.027829 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:40:01.028509 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS thermique_total,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS nucleaire_total,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS eolien_total,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS solaire_total,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS hydraulique_total,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS bioenergies_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_total,
    SUM(COALESCE(production_totale, 0)) AS production_totale
FROM clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m10:40:01.029374 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:01.030913 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:40:01.031163 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour" rename to "grain_jour__dbt_backup"
[0m10:40:01.031688 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:40:01.033042 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:40:01.033240 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour__dbt_tmp" rename to "grain_jour"
[0m10:40:01.033683 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:40:01.034494 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m10:40:01.034690 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:40:01.034989 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m10:40:01.037147 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:40:01.038713 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:40:01.038975 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
drop view if exists "dev"."main"."grain_jour__dbt_backup" cascade
[0m10:40:01.039794 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:40:01.040636 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m10:40:01.054269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3684da49-abd0-4392-bfe3-2bd6298a6f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d85627ad030>]}
[0m10:40:01.054646 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.grain_jour ............................... [[32mOK[0m in 0.04s]
[0m10:40:01.054955 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m10:40:01.055238 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m10:40:01.055567 [info ] [Thread-1 (]: 4 of 5 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m10:40:01.055851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m10:40:01.056121 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m10:40:01.057604 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m10:40:01.058757 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m10:40:01.069789 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m10:40:01.070903 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:40:01.071095 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m10:40:01.071390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:01.082189 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:40:01.082437 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:40:01.082975 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m10:40:01.083619 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:40:01.085586 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:40:01.085797 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:40:01.086308 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:40:01.110399 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:40:01.110691 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:40:01.111373 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:40:01.114119 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m10:40:01.114347 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:40:01.114556 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m10:40:01.115916 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:01.117218 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:40:01.117431 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m10:40:01.117992 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:40:01.118681 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m10:40:01.133215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3684da49-abd0-4392-bfe3-2bd6298a6f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d855eb9eef0>]}
[0m10:40:01.133634 [info ] [Thread-1 (]: 4 of 5 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.08s]
[0m10:40:01.133956 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m10:40:01.134458 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m10:40:01.134769 [info ] [Thread-1 (]: 5 of 5 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m10:40:01.135077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m10:40:01.135274 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m10:40:01.136738 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m10:40:01.137612 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m10:40:01.139485 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m10:40:01.140360 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:40:01.140552 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m10:40:01.140743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:01.150689 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:40:01.150912 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:40:01.151219 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m10:40:01.151661 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:40:01.153213 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:40:01.153442 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m10:40:01.153781 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:40:01.155309 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:40:01.155515 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:40:01.155836 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:40:01.156625 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m10:40:01.156834 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:40:01.157071 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m10:40:01.158181 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:01.159368 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:40:01.159573 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m10:40:01.160139 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:40:01.160780 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m10:40:01.172220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3684da49-abd0-4392-bfe3-2bd6298a6f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d855eb9eef0>]}
[0m10:40:01.172586 [info ] [Thread-1 (]: 5 of 5 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m10:40:01.172925 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m10:40:01.173668 [debug] [MainThread]: Using duckdb connection "master"
[0m10:40:01.173886 [debug] [MainThread]: On master: BEGIN
[0m10:40:01.174073 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:40:01.184634 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m10:40:01.184980 [debug] [MainThread]: On master: COMMIT
[0m10:40:01.185270 [debug] [MainThread]: Using duckdb connection "master"
[0m10:40:01.185554 [debug] [MainThread]: On master: COMMIT
[0m10:40:01.186001 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:40:01.186315 [debug] [MainThread]: On master: Close
[0m10:40:01.188025 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:40:01.188387 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m10:40:01.188669 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m10:40:01.189036 [info ] [MainThread]: 
[0m10:40:01.189364 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m10:40:01.190259 [debug] [MainThread]: Command end result
[0m10:40:01.211696 [info ] [MainThread]: 
[0m10:40:01.211956 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:40:01.212130 [info ] [MainThread]: 
[0m10:40:01.212402 [error] [MainThread]:   Runtime Error in model 3_1 (models/example/3_1.sql)
  Catalog Error: Scalar Function with name to_char does not exist!
  Did you mean "to_hours"?
  LINE 22: GROUP BY TO_CHAR(Date, 'YYYY-MM'), "Région"
                    ^
[0m10:40:01.212589 [info ] [MainThread]: 
[0m10:40:01.212838 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m10:40:01.213297 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0832236, "process_in_blocks": "11200", "process_kernel_time": 0.151178, "process_mem_max_rss": "140240", "process_out_blocks": "8472", "process_user_time": 1.394091}
[0m10:40:01.213573 [debug] [MainThread]: Command `dbt run` failed at 10:40:01.213523 after 1.08 seconds
[0m10:40:01.213760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d8569f8fc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d855eb35810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d855eb34160>]}
[0m10:40:01.213990 [debug] [MainThread]: Flushing usage events
[0m10:41:30.442263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36f8383c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36f87ba890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36f87bb0a0>]}


============================== 10:41:30.445645 | dc9f4e8e-becd-425f-8417-f3caf987ce9e ==============================
[0m10:41:30.445645 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:41:30.446431 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'debug': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:41:30.617138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc9f4e8e-becd-425f-8417-f3caf987ce9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36f7dcd120>]}
[0m10:41:30.653725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc9f4e8e-becd-425f-8417-f3caf987ce9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36f7730d90>]}
[0m10:41:30.657662 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m10:41:30.706756 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:41:30.834461 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:41:30.835209 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:41:30.844485 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m10:41:30.863353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc9f4e8e-becd-425f-8417-f3caf987ce9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36f0b69360>]}
[0m10:41:30.933359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc9f4e8e-becd-425f-8417-f3caf987ce9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36f0b6b550>]}
[0m10:41:30.933755 [info ] [MainThread]: Found 5 models, 4 data tests, 421 macros
[0m10:41:30.934265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc9f4e8e-becd-425f-8417-f3caf987ce9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36f2940b80>]}
[0m10:41:30.935837 [info ] [MainThread]: 
[0m10:41:30.936258 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:41:30.939821 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m10:41:31.330700 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m10:41:31.331441 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m10:41:31.332050 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:41:31.351029 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m10:41:31.352327 [debug] [ThreadPool]: On list_dev: Close
[0m10:41:31.355515 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m10:41:31.355946 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m10:41:31.360369 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:41:31.360577 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m10:41:31.360933 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:41:31.372050 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m10:41:31.372831 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:41:31.373043 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m10:41:31.373456 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:41:31.373676 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:41:31.373997 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m10:41:31.374367 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:41:31.374833 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:41:31.375019 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:41:31.375320 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:41:31.375706 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:41:31.375918 [debug] [ThreadPool]: On create_dev_main: Close
[0m10:41:31.377824 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m10:41:31.381870 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:41:31.382153 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m10:41:31.382564 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:41:31.397526 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m10:41:31.398262 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:41:31.398957 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m10:41:31.419457 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m10:41:31.420133 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m10:41:31.420703 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m10:41:31.420878 [debug] [ThreadPool]: On list_dev_main: Close
[0m10:41:31.423056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc9f4e8e-becd-425f-8417-f3caf987ce9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36f84c6680>]}
[0m10:41:31.423302 [debug] [MainThread]: Using duckdb connection "master"
[0m10:41:31.423612 [debug] [MainThread]: On master: BEGIN
[0m10:41:31.423904 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:41:31.435138 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m10:41:31.435471 [debug] [MainThread]: On master: COMMIT
[0m10:41:31.436028 [debug] [MainThread]: Using duckdb connection "master"
[0m10:41:31.436389 [debug] [MainThread]: On master: COMMIT
[0m10:41:31.436924 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:41:31.437241 [debug] [MainThread]: On master: Close
[0m10:41:31.439521 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:41:31.439993 [info ] [MainThread]: 
[0m10:41:31.442595 [debug] [Thread-1 (]: Began running node model.transform.3_1
[0m10:41:31.443383 [info ] [Thread-1 (]: 1 of 5 START sql view model main.3_1 ........................................... [RUN]
[0m10:41:31.444022 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.3_1'
[0m10:41:31.444450 [debug] [Thread-1 (]: Began compiling node model.transform.3_1
[0m10:41:31.450213 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_1"
[0m10:41:31.452147 [debug] [Thread-1 (]: Began executing node model.transform.3_1
[0m10:41:31.468227 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_1"
[0m10:41:31.470327 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:41:31.470544 [debug] [Thread-1 (]: On model.transform.3_1: BEGIN
[0m10:41:31.470865 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:41:31.481884 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:41:31.482110 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:41:31.482706 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    strftime('%Y-%m', Date) AS mois,  -- Utilisation de strftime pour extraire l'année et le mois
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0))/2000 AS consommation_totale_en_GWH,
    SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,

    MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
FROM clean
GROUP BY strftime('%Y-%m', Date), "Région"  -- Remplacer TO_CHAR par strftime
ORDER BY mois, "Région";  -- Tri par mois et région
  );

[0m10:41:31.490503 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    strftime('%Y-%m', Date) AS mois,  -- Utilisation de strftime pour extraire l'année et le mois
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0))/2000 AS consommation_totale_en_GWH,
    SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,

    MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
FROM clean
GROUP BY strftime('%Y-%m', Date), "Région"  -- Remplacer TO_CHAR par strftime
ORDER BY mois, "Région";  -- Tri par mois et région
  );

[0m10:41:31.490734 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:41:31.491232 [debug] [Thread-1 (]: On model.transform.3_1: ROLLBACK
[0m10:41:31.494405 [debug] [Thread-1 (]: Failed to rollback 'model.transform.3_1'
[0m10:41:31.494653 [debug] [Thread-1 (]: On model.transform.3_1: Close
[0m10:41:31.496354 [debug] [Thread-1 (]: Runtime Error in model 3_1 (models/example/3_1.sql)
  Parser Error: syntax error at or near ";"
[0m10:41:31.497298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc9f4e8e-becd-425f-8417-f3caf987ce9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36f84c6680>]}
[0m10:41:31.497683 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model main.3_1 .................................. [[31mERROR[0m in 0.05s]
[0m10:41:31.498051 [debug] [Thread-1 (]: Finished running node model.transform.3_1
[0m10:41:31.498331 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m10:41:31.499080 [info ] [Thread-1 (]: 2 of 5 START sql view model main.clean ......................................... [RUN]
[0m10:41:31.499442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_1, now model.transform.clean)
[0m10:41:31.499731 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m10:41:31.500874 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m10:41:31.502096 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m10:41:31.503836 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m10:41:31.505040 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:41:31.505230 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m10:41:31.505548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:41:31.516902 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:41:31.517174 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:41:31.517794 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT "Code INSEE région",	"Région"	,	"Date",	"Heure",	
"Consommation (MW)"	,"Thermique (MW)",	"Nucléaire (MW)",	"Eolien (MW)",	"Solaire (MW)",	"Hydraulique (MW)",	"Pompage (MW)",	"Bioénergies (MW)",	"Ech. physiques (MW)","production_totale"

     FROM clean
  );

[0m10:41:31.518640 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:31.521901 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:41:31.522123 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m10:41:31.522727 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:31.524178 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:41:31.524377 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m10:41:31.524912 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:31.532999 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m10:41:31.533215 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:41:31.533589 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m10:41:31.535511 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:41:31.537948 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:41:31.538158 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m10:41:31.538955 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:31.540205 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m10:41:31.552600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc9f4e8e-becd-425f-8417-f3caf987ce9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36f0b849d0>]}
[0m10:41:31.552969 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main.clean .................................... [[32mOK[0m in 0.05s]
[0m10:41:31.553279 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m10:41:31.553494 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m10:41:31.553830 [info ] [Thread-1 (]: 3 of 5 START sql view model main.grain_jour .................................... [RUN]
[0m10:41:31.554111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m10:41:31.554386 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m10:41:31.555943 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m10:41:31.557175 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m10:41:31.558948 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m10:41:31.560083 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:41:31.560277 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m10:41:31.560580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:41:31.571283 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:41:31.571522 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:41:31.572101 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS thermique_total,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS nucleaire_total,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS eolien_total,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS solaire_total,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS hydraulique_total,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS bioenergies_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_total,
    SUM(COALESCE(production_totale, 0)) AS production_totale
FROM clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m10:41:31.572950 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:31.574544 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:41:31.574795 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour" rename to "grain_jour__dbt_backup"
[0m10:41:31.575322 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:31.576765 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:41:31.576967 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour__dbt_tmp" rename to "grain_jour"
[0m10:41:31.577430 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:31.578224 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m10:41:31.578424 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:41:31.578729 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m10:41:31.580580 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:41:31.581829 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:41:31.582032 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
drop view if exists "dev"."main"."grain_jour__dbt_backup" cascade
[0m10:41:31.582723 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:31.583372 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m10:41:31.595171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc9f4e8e-becd-425f-8417-f3caf987ce9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36f0b86170>]}
[0m10:41:31.595535 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.grain_jour ............................... [[32mOK[0m in 0.04s]
[0m10:41:31.595845 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m10:41:31.596120 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m10:41:31.596434 [info ] [Thread-1 (]: 4 of 5 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m10:41:31.596711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m10:41:31.596978 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m10:41:31.598420 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m10:41:31.599517 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m10:41:31.608977 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m10:41:31.610168 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:41:31.610361 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m10:41:31.610667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:41:31.621214 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:41:31.621431 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:41:31.621999 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m10:41:31.622562 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:31.624468 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:41:31.624681 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:41:31.625261 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:31.646463 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:41:31.646736 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:41:31.647722 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:31.650372 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m10:41:31.650582 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:41:31.651105 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m10:41:31.652790 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:31.654040 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:41:31.654237 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m10:41:31.655019 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:31.655686 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m10:41:31.670483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc9f4e8e-becd-425f-8417-f3caf987ce9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36f0b698d0>]}
[0m10:41:31.670856 [info ] [Thread-1 (]: 4 of 5 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.07s]
[0m10:41:31.671172 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m10:41:31.671712 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m10:41:31.671962 [info ] [Thread-1 (]: 5 of 5 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m10:41:31.672244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m10:41:31.672523 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m10:41:31.673998 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m10:41:31.675205 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m10:41:31.677026 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m10:41:31.678271 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:41:31.678464 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m10:41:31.678753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:41:31.689042 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:41:31.689266 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:41:31.689789 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m10:41:31.690245 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:31.691713 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:41:31.691915 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m10:41:31.692372 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:31.693827 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:41:31.694029 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:41:31.694476 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:31.695280 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m10:41:31.695482 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:41:31.695807 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m10:41:31.697225 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:31.698375 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:41:31.698581 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m10:41:31.699342 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:31.699978 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m10:41:31.712059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc9f4e8e-becd-425f-8417-f3caf987ce9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36f0b7a680>]}
[0m10:41:31.712444 [info ] [Thread-1 (]: 5 of 5 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m10:41:31.712759 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m10:41:31.713396 [debug] [MainThread]: Using duckdb connection "master"
[0m10:41:31.713585 [debug] [MainThread]: On master: BEGIN
[0m10:41:31.713884 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:41:31.725266 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m10:41:31.725476 [debug] [MainThread]: On master: COMMIT
[0m10:41:31.726180 [debug] [MainThread]: Using duckdb connection "master"
[0m10:41:31.726492 [debug] [MainThread]: On master: COMMIT
[0m10:41:31.726925 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:41:31.727154 [debug] [MainThread]: On master: Close
[0m10:41:31.728829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:41:31.729022 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m10:41:31.729298 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m10:41:31.729652 [info ] [MainThread]: 
[0m10:41:31.729892 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m10:41:31.730592 [debug] [MainThread]: Command end result
[0m10:41:31.751756 [info ] [MainThread]: 
[0m10:41:31.751991 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:41:31.752254 [info ] [MainThread]: 
[0m10:41:31.752613 [error] [MainThread]:   Runtime Error in model 3_1 (models/example/3_1.sql)
  Parser Error: syntax error at or near ";"
[0m10:41:31.752872 [info ] [MainThread]: 
[0m10:41:31.753124 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m10:41:31.753637 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3395493, "process_in_blocks": "12176", "process_kernel_time": 0.200202, "process_mem_max_rss": "138352", "process_out_blocks": "8472", "process_user_time": 1.485337}
[0m10:41:31.753925 [debug] [MainThread]: Command `dbt run` failed at 10:41:31.753877 after 1.34 seconds
[0m10:41:31.754157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36f8383c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36f7730d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b36ecf24490>]}
[0m10:41:31.754440 [debug] [MainThread]: Flushing usage events
[0m10:41:41.138469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7642c2303ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7642c26db2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7642c26db250>]}


============================== 10:41:41.141345 | 65936f1e-c72a-40c5-9a1b-c0d3e0a3b96c ==============================
[0m10:41:41.141345 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:41:41.142076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:41:41.273137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65936f1e-c72a-40c5-9a1b-c0d3e0a3b96c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7642c2677730>]}
[0m10:41:41.310288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65936f1e-c72a-40c5-9a1b-c0d3e0a3b96c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7642c14e9ae0>]}
[0m10:41:41.313220 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m10:41:41.355150 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:41:41.481540 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:41:41.482301 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:41:41.491373 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m10:41:41.510480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65936f1e-c72a-40c5-9a1b-c0d3e0a3b96c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7642c07db2e0>]}
[0m10:41:41.573454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65936f1e-c72a-40c5-9a1b-c0d3e0a3b96c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7642bb3e34c0>]}
[0m10:41:41.573994 [info ] [MainThread]: Found 5 models, 4 data tests, 421 macros
[0m10:41:41.574599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65936f1e-c72a-40c5-9a1b-c0d3e0a3b96c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7642bb3e3430>]}
[0m10:41:41.576767 [info ] [MainThread]: 
[0m10:41:41.577541 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:41:41.583754 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m10:41:41.801966 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m10:41:41.802608 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m10:41:41.803292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:41:41.821143 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m10:41:41.822377 [debug] [ThreadPool]: On list_dev: Close
[0m10:41:41.825276 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m10:41:41.825687 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m10:41:41.829714 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:41:41.829916 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m10:41:41.830268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:41:41.841528 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m10:41:41.842349 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:41:41.842586 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m10:41:41.843229 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:41:41.843413 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:41:41.843711 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m10:41:41.844112 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:41:41.844595 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:41:41.844790 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:41:41.845091 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:41:41.845504 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:41:41.845709 [debug] [ThreadPool]: On create_dev_main: Close
[0m10:41:41.847309 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m10:41:41.850877 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:41:41.851130 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m10:41:41.851505 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:41:41.863894 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m10:41:41.864242 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:41:41.864627 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m10:41:41.879332 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m10:41:41.879987 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m10:41:41.880559 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m10:41:41.880733 [debug] [ThreadPool]: On list_dev_main: Close
[0m10:41:41.882584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65936f1e-c72a-40c5-9a1b-c0d3e0a3b96c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7642c0760820>]}
[0m10:41:41.882928 [debug] [MainThread]: Using duckdb connection "master"
[0m10:41:41.883189 [debug] [MainThread]: On master: BEGIN
[0m10:41:41.883483 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:41:41.894815 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m10:41:41.895013 [debug] [MainThread]: On master: COMMIT
[0m10:41:41.895417 [debug] [MainThread]: Using duckdb connection "master"
[0m10:41:41.895671 [debug] [MainThread]: On master: COMMIT
[0m10:41:41.896089 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:41:41.896296 [debug] [MainThread]: On master: Close
[0m10:41:41.897454 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:41:41.897661 [info ] [MainThread]: 
[0m10:41:41.898801 [debug] [Thread-1 (]: Began running node model.transform.3_1
[0m10:41:41.899428 [info ] [Thread-1 (]: 1 of 5 START sql view model main.3_1 ........................................... [RUN]
[0m10:41:41.899916 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.3_1'
[0m10:41:41.900256 [debug] [Thread-1 (]: Began compiling node model.transform.3_1
[0m10:41:41.905125 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_1"
[0m10:41:41.906317 [debug] [Thread-1 (]: Began executing node model.transform.3_1
[0m10:41:41.927829 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_1"
[0m10:41:41.929081 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:41:41.929293 [debug] [Thread-1 (]: On model.transform.3_1: BEGIN
[0m10:41:41.929719 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:41:41.941282 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m10:41:41.941550 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:41:41.942128 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    strftime('%Y-%m', Date) AS mois,  -- Utilisation de strftime pour extraire l'année et le mois
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0))/2000 AS consommation_totale_en_GWH,
    SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,

    MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
FROM clean
GROUP BY strftime('%Y-%m', Date), "Région"  -- Remplacer TO_CHAR par strftime
ORDER BY mois, "Région"  -- Tri par mois et région
  );

[0m10:41:41.956989 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m10:41:41.967497 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:41:41.968014 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1" rename to "3_1__dbt_backup"
[0m10:41:41.968792 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:41.971345 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:41:41.971656 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1__dbt_tmp" rename to "3_1"
[0m10:41:41.972216 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:41.980756 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m10:41:41.980984 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:41:41.981598 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m10:41:41.983299 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:41.985752 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:41:41.985968 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
drop view if exists "dev"."main"."3_1__dbt_backup" cascade
[0m10:41:41.986624 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:41.987890 [debug] [Thread-1 (]: On model.transform.3_1: Close
[0m10:41:42.000916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65936f1e-c72a-40c5-9a1b-c0d3e0a3b96c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7642c0760820>]}
[0m10:41:42.001316 [info ] [Thread-1 (]: 1 of 5 OK created sql view model main.3_1 ...................................... [[32mOK[0m in 0.10s]
[0m10:41:42.001628 [debug] [Thread-1 (]: Finished running node model.transform.3_1
[0m10:41:42.001857 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m10:41:42.002132 [info ] [Thread-1 (]: 2 of 5 START sql view model main.clean ......................................... [RUN]
[0m10:41:42.002451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_1, now model.transform.clean)
[0m10:41:42.002770 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m10:41:42.003856 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m10:41:42.005014 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m10:41:42.006809 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m10:41:42.007944 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:41:42.008129 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m10:41:42.008406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:41:42.019068 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:41:42.019284 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:41:42.019841 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT "Code INSEE région",	"Région"	,	"Date",	"Heure",	
"Consommation (MW)"	,"Thermique (MW)",	"Nucléaire (MW)",	"Eolien (MW)",	"Solaire (MW)",	"Hydraulique (MW)",	"Pompage (MW)",	"Bioénergies (MW)",	"Ech. physiques (MW)","production_totale"

     FROM clean
  );

[0m10:41:42.020612 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:42.022675 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:41:42.022899 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m10:41:42.023445 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:42.024813 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:41:42.025012 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m10:41:42.025463 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:42.026289 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m10:41:42.026485 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:41:42.026774 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m10:41:42.028219 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:42.029325 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:41:42.029518 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m10:41:42.030207 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:42.030829 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m10:41:42.043012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65936f1e-c72a-40c5-9a1b-c0d3e0a3b96c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7642b813d660>]}
[0m10:41:42.043372 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main.clean .................................... [[32mOK[0m in 0.04s]
[0m10:41:42.043667 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m10:41:42.043915 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m10:41:42.044260 [info ] [Thread-1 (]: 3 of 5 START sql view model main.grain_jour .................................... [RUN]
[0m10:41:42.044538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m10:41:42.044811 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m10:41:42.045843 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m10:41:42.046940 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m10:41:42.048652 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m10:41:42.049652 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:41:42.049837 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m10:41:42.050125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:41:42.060732 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:41:42.060966 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:41:42.061512 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS thermique_total,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS nucleaire_total,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS eolien_total,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS solaire_total,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS hydraulique_total,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS bioenergies_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_total,
    SUM(COALESCE(production_totale, 0)) AS production_totale
FROM clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m10:41:42.062294 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:42.063753 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:41:42.063956 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour" rename to "grain_jour__dbt_backup"
[0m10:41:42.064461 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:42.065880 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:41:42.066082 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour__dbt_tmp" rename to "grain_jour"
[0m10:41:42.066642 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:42.067422 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m10:41:42.067612 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:41:42.067911 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m10:41:42.069694 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:42.070834 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:41:42.071033 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
drop view if exists "dev"."main"."grain_jour__dbt_backup" cascade
[0m10:41:42.071776 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:42.072968 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m10:41:42.085043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65936f1e-c72a-40c5-9a1b-c0d3e0a3b96c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7642b7777fd0>]}
[0m10:41:42.085396 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.grain_jour ............................... [[32mOK[0m in 0.04s]
[0m10:41:42.085753 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m10:41:42.086008 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m10:41:42.086353 [info ] [Thread-1 (]: 4 of 5 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m10:41:42.086632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m10:41:42.086853 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m10:41:42.109807 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m10:41:42.111525 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m10:41:42.121089 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m10:41:42.122655 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:41:42.122876 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m10:41:42.123216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:41:42.134027 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:41:42.134252 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:41:42.134880 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m10:41:42.135759 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:42.137213 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:41:42.137422 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:41:42.137926 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:42.139487 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:41:42.139732 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:41:42.140374 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:42.142974 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m10:41:42.143197 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:41:42.143528 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m10:41:42.144932 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:42.146087 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:41:42.146289 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m10:41:42.146981 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:42.147687 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m10:41:42.162743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65936f1e-c72a-40c5-9a1b-c0d3e0a3b96c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7642b77c5240>]}
[0m10:41:42.163192 [info ] [Thread-1 (]: 4 of 5 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.08s]
[0m10:41:42.163524 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m10:41:42.164140 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m10:41:42.164389 [info ] [Thread-1 (]: 5 of 5 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m10:41:42.164760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m10:41:42.164986 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m10:41:42.166477 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m10:41:42.167631 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m10:41:42.170056 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m10:41:42.171218 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:41:42.171411 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m10:41:42.171718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:41:42.182319 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:41:42.182549 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:41:42.183112 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m10:41:42.183684 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:42.185271 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:41:42.185542 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m10:41:42.186003 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:42.187385 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:41:42.187591 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:41:42.188120 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:42.189015 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m10:41:42.189224 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:41:42.189530 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m10:41:42.191066 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:42.192328 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:41:42.192530 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m10:41:42.193223 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:41:42.193863 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m10:41:42.206349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65936f1e-c72a-40c5-9a1b-c0d3e0a3b96c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7642b8152500>]}
[0m10:41:42.206727 [info ] [Thread-1 (]: 5 of 5 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m10:41:42.207064 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m10:41:42.207802 [debug] [MainThread]: Using duckdb connection "master"
[0m10:41:42.207995 [debug] [MainThread]: On master: BEGIN
[0m10:41:42.208287 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:41:42.219629 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m10:41:42.219854 [debug] [MainThread]: On master: COMMIT
[0m10:41:42.220383 [debug] [MainThread]: Using duckdb connection "master"
[0m10:41:42.220744 [debug] [MainThread]: On master: COMMIT
[0m10:41:42.221191 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:41:42.221395 [debug] [MainThread]: On master: Close
[0m10:41:42.223338 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:41:42.223753 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m10:41:42.224230 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m10:41:42.224764 [info ] [MainThread]: 
[0m10:41:42.225250 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m10:41:42.226903 [debug] [MainThread]: Command end result
[0m10:41:42.255790 [info ] [MainThread]: 
[0m10:41:42.256166 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:41:42.256456 [info ] [MainThread]: 
[0m10:41:42.256743 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m10:41:42.257412 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1461918, "process_in_blocks": "11408", "process_kernel_time": 0.149759, "process_mem_max_rss": "137664", "process_out_blocks": "9584", "process_user_time": 1.336923}
[0m10:41:42.257865 [debug] [MainThread]: Command `dbt run` succeeded at 10:41:42.257790 after 1.15 seconds
[0m10:41:42.258158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7642c2303ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7642bb3ebbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7642bb3e8af0>]}
[0m10:41:42.258486 [debug] [MainThread]: Flushing usage events
[0m10:53:13.748996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcd5b18bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcd597673a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcd59767340>]}


============================== 10:53:13.751391 | be96bffc-0538-4819-948b-0a5feef70162 ==============================
[0m10:53:13.751391 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:53:13.752167 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:53:13.895950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be96bffc-0538-4819-948b-0a5feef70162', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcd560d5090>]}
[0m10:53:13.925079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be96bffc-0538-4819-948b-0a5feef70162', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcd59abff70>]}
[0m10:53:13.928265 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m10:53:13.970156 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:53:14.096038 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:53:14.097062 [debug] [MainThread]: Partial parsing: added file: transform://models/example/3_2.sql
[0m10:53:14.188903 [error] [MainThread]: Encountered an error:
Compilation Error in model 3_2 (models/example/3_2.sql)
  'None' has no attribute 'table'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:53:14.189362 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": false, "command_wall_clock_time": 0.46834016, "process_in_blocks": "0", "process_kernel_time": 0.128191, "process_mem_max_rss": "122760", "process_out_blocks": "88", "process_user_time": 1.082613}
[0m10:53:14.189962 [debug] [MainThread]: Command `dbt docs generate` failed at 10:53:14.189912 after 0.47 seconds
[0m10:53:14.190467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcd5b18bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcd52f97b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcd52f97ac0>]}
[0m10:53:14.190928 [debug] [MainThread]: Flushing usage events
[0m10:53:29.017473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727956603be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727956936b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727956937370>]}


============================== 10:53:29.020685 | 9816f4ae-e2ec-49a9-b2df-52f483d1ed47 ==============================
[0m10:53:29.020685 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:53:29.021406 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:53:29.156853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9816f4ae-e2ec-49a9-b2df-52f483d1ed47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727956534700>]}
[0m10:53:29.191184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9816f4ae-e2ec-49a9-b2df-52f483d1ed47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727954e376d0>]}
[0m10:53:50.970475 [error] [MainThread]: Encountered an error:

[0m10:53:50.988025 [error] [MainThread]: Traceback (most recent call last):
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/home/ETUDIANT/e24a518u/Bureau/tp sql/venv/lib/python3.10/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m10:53:50.990938 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 22.000967, "process_in_blocks": "6200", "process_kernel_time": 0.086397, "process_mem_max_rss": "118644", "process_out_blocks": "3016", "process_user_time": 0.943252}
[0m10:53:50.992594 [debug] [MainThread]: Command `dbt docs serve` failed at 10:53:50.992341 after 22.00 seconds
[0m10:53:50.993576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727956603be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72795014ed40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72795014ee90>]}
[0m10:53:50.994499 [debug] [MainThread]: Flushing usage events
[0m10:53:55.016812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdce8fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdd2ca890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdd2cb0a0>]}


============================== 10:53:55.019739 | a84df9f4-dc72-4199-af4f-a771ca1c2c1b ==============================
[0m10:53:55.019739 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:53:55.020600 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'debug': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:53:55.174010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a84df9f4-dc72-4199-af4f-a771ca1c2c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdc8d9120>]}
[0m10:53:55.207379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a84df9f4-dc72-4199-af4f-a771ca1c2c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdc238d90>]}
[0m10:53:55.210419 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m10:53:55.260067 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:53:55.405039 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:53:55.406098 [debug] [MainThread]: Partial parsing: added file: transform://models/example/3_2.sql
[0m10:53:55.499337 [error] [MainThread]: Encountered an error:
Compilation Error in model 3_2 (models/example/3_2.sql)
  'None' has no attribute 'table'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:53:55.499817 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.51064587, "process_in_blocks": "0", "process_kernel_time": 0.076062, "process_mem_max_rss": "122516", "process_out_blocks": "88", "process_user_time": 1.088901}
[0m10:53:55.500357 [debug] [MainThread]: Command `dbt run` failed at 10:53:55.500306 after 0.51 seconds
[0m10:53:55.500913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdce8fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd439fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd439fac0>]}
[0m10:53:55.501465 [debug] [MainThread]: Flushing usage events
[0m10:54:35.412150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa1128bc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa0faf7310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa0faf72b0>]}


============================== 10:54:35.415603 | 51a6a0a8-c971-4e1b-b37a-366e11865ad3 ==============================
[0m10:54:35.415603 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:54:35.416368 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:54:35.562262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51a6a0a8-c971-4e1b-b37a-366e11865ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa0b951f90>]}
[0m10:54:35.590187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51a6a0a8-c971-4e1b-b37a-366e11865ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa0b953f40>]}
[0m10:54:35.593473 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m10:54:35.635510 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:54:35.761514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:54:35.762545 [debug] [MainThread]: Partial parsing: added file: transform://models/example/3_2.sql
[0m10:54:35.853996 [error] [MainThread]: Encountered an error:
Compilation Error in model 3_2 (models/example/3_2.sql)
  'None' has no attribute 'table'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:54:35.854448 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": false, "command_wall_clock_time": 0.46987277, "process_in_blocks": "0", "process_kernel_time": 0.101623, "process_mem_max_rss": "122308", "process_out_blocks": "88", "process_user_time": 1.162132}
[0m10:54:35.855103 [debug] [MainThread]: Command `dbt docs generate` failed at 10:54:35.855053 after 0.47 seconds
[0m10:54:35.855559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa1128bc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa08797b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa08797ac0>]}
[0m10:54:35.856027 [debug] [MainThread]: Flushing usage events
[0m10:54:41.997588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74de5ba9fc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74de5beda8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74de5bedb1f0>]}


============================== 10:54:42.000507 | 9cab22cf-a38e-4abf-8da0-ac0a2c87f25b ==============================
[0m10:54:42.000507 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:54:42.001161 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'debug': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:54:42.130442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9cab22cf-a38e-4abf-8da0-ac0a2c87f25b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74de5b9c97e0>]}
[0m10:54:42.157614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9cab22cf-a38e-4abf-8da0-ac0a2c87f25b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74de5ae4ce20>]}
[0m10:54:42.160804 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m10:54:42.202438 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:54:42.328586 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:54:42.329608 [debug] [MainThread]: Partial parsing: added file: transform://models/example/3_2.sql
[0m10:54:42.421383 [error] [MainThread]: Encountered an error:
Compilation Error in model 3_2 (models/example/3_2.sql)
  'None' has no attribute 'table'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:54:42.421836 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.45224255, "process_in_blocks": "0", "process_kernel_time": 0.076902, "process_mem_max_rss": "122868", "process_out_blocks": "88", "process_user_time": 0.950148}
[0m10:54:42.422401 [debug] [MainThread]: Command `dbt run` failed at 10:54:42.422352 after 0.45 seconds
[0m10:54:42.422804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74de5ba9fc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74de52fafb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74de52fafac0>]}
[0m10:54:42.423270 [debug] [MainThread]: Flushing usage events
[0m10:55:28.916234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27bf387c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27bf7c31f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27bf7c3310>]}


============================== 10:55:28.917949 | 995706dc-f85b-4c46-9c1e-2f7390302fb6 ==============================
[0m10:55:28.917949 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:55:28.918545 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:55:29.043322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '995706dc-f85b-4c46-9c1e-2f7390302fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27ba2e3850>]}
[0m10:55:29.072542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '995706dc-f85b-4c46-9c1e-2f7390302fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27bdd6cac0>]}
[0m10:55:29.075644 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m10:55:29.117471 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:55:29.257618 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:55:29.258683 [debug] [MainThread]: Partial parsing: added file: transform://models/example/3_2.sql
[0m10:55:29.352912 [error] [MainThread]: Encountered an error:
Compilation Error in model 3_2 (models/example/3_2.sql)
  'None' has no attribute 'table'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:55:29.353373 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.46422797, "process_in_blocks": "0", "process_kernel_time": 0.087822, "process_mem_max_rss": "122784", "process_out_blocks": "80", "process_user_time": 0.931506}
[0m10:55:29.353959 [debug] [MainThread]: Command `dbt run` failed at 10:55:29.353902 after 0.46 seconds
[0m10:55:29.354546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27bf387c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27b7187b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27b7187ac0>]}
[0m10:55:29.354995 [debug] [MainThread]: Flushing usage events
[0m10:55:38.203908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a113ea3ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a11270f2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a11270f250>]}


============================== 10:55:38.207182 | fa665d76-08d5-4b78-acbc-3bc5e1fc6139 ==============================
[0m10:55:38.207182 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:55:38.207670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:55:38.353424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa665d76-08d5-4b78-acbc-3bc5e1fc6139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a1126af730>]}
[0m10:55:38.387953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa665d76-08d5-4b78-acbc-3bc5e1fc6139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a11324dae0>]}
[0m10:55:38.390937 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m10:55:38.433391 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:55:38.564214 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:55:38.564996 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:55:38.572879 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m10:55:38.591463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa665d76-08d5-4b78-acbc-3bc5e1fc6139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a10bd95900>]}
[0m10:55:38.661823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa665d76-08d5-4b78-acbc-3bc5e1fc6139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a10bd97a30>]}
[0m10:55:38.662214 [info ] [MainThread]: Found 6 models, 4 data tests, 421 macros
[0m10:55:38.662657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa665d76-08d5-4b78-acbc-3bc5e1fc6139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a10bd97ac0>]}
[0m10:55:38.663986 [info ] [MainThread]: 
[0m10:55:38.664405 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:55:38.667705 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m10:55:39.023329 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m10:55:39.023961 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m10:55:39.024425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:55:39.041367 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m10:55:39.042446 [debug] [ThreadPool]: On list_dev: Close
[0m10:55:39.045195 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m10:55:39.045593 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m10:55:39.051907 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:55:39.052411 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m10:55:39.052829 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:55:39.068548 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m10:55:39.070005 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:55:39.070373 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m10:55:39.070864 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:55:39.071186 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:55:39.071480 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m10:55:39.071955 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:55:39.072647 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:55:39.072922 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:55:39.073185 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:55:39.073549 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:55:39.073777 [debug] [ThreadPool]: On create_dev_main: Close
[0m10:55:39.075644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m10:55:39.080553 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:55:39.080904 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m10:55:39.081163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:55:39.096684 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m10:55:39.097396 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:55:39.097935 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m10:55:39.121910 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m10:55:39.122815 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m10:55:39.123585 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m10:55:39.123804 [debug] [ThreadPool]: On list_dev_main: Close
[0m10:55:39.125725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa665d76-08d5-4b78-acbc-3bc5e1fc6139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a10e505660>]}
[0m10:55:39.125978 [debug] [MainThread]: Using duckdb connection "master"
[0m10:55:39.126193 [debug] [MainThread]: On master: BEGIN
[0m10:55:39.126434 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:55:39.139153 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m10:55:39.139768 [debug] [MainThread]: On master: COMMIT
[0m10:55:39.140297 [debug] [MainThread]: Using duckdb connection "master"
[0m10:55:39.140800 [debug] [MainThread]: On master: COMMIT
[0m10:55:39.141568 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:55:39.142094 [debug] [MainThread]: On master: Close
[0m10:55:39.144553 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:55:39.145055 [info ] [MainThread]: 
[0m10:55:39.146997 [debug] [Thread-1 (]: Began running node model.transform.3_1
[0m10:55:39.147721 [info ] [Thread-1 (]: 1 of 5 START sql view model main.3_1 ........................................... [RUN]
[0m10:55:39.148264 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.3_1'
[0m10:55:39.148596 [debug] [Thread-1 (]: Began compiling node model.transform.3_1
[0m10:55:39.153296 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_1"
[0m10:55:39.154690 [debug] [Thread-1 (]: Began executing node model.transform.3_1
[0m10:55:39.170938 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_1"
[0m10:55:39.172646 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:55:39.172849 [debug] [Thread-1 (]: On model.transform.3_1: BEGIN
[0m10:55:39.173147 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:55:39.183386 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:55:39.183612 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:55:39.183907 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    strftime('%Y-%m', Date) AS mois,  -- Utilisation de strftime pour extraire l'année et le mois
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0))/2000 AS consommation_totale_en_GWH,
    SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,

    MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
FROM clean
GROUP BY strftime('%Y-%m', Date), "Région"  -- Remplacer TO_CHAR par strftime
ORDER BY mois, "Région"  -- Tri par mois et région
  );

[0m10:55:39.184772 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:55:39.188035 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:55:39.188252 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1" rename to "3_1__dbt_backup"
[0m10:55:39.188634 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:55:39.190037 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:55:39.190235 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1__dbt_tmp" rename to "3_1"
[0m10:55:39.190647 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:55:39.198712 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m10:55:39.198935 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:55:39.199249 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m10:55:39.200628 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:55:39.203213 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:55:39.203428 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
drop view if exists "dev"."main"."3_1__dbt_backup" cascade
[0m10:55:39.204126 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:55:39.205486 [debug] [Thread-1 (]: On model.transform.3_1: Close
[0m10:55:39.218153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa665d76-08d5-4b78-acbc-3bc5e1fc6139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a10e505660>]}
[0m10:55:39.218666 [info ] [Thread-1 (]: 1 of 5 OK created sql view model main.3_1 ...................................... [[32mOK[0m in 0.07s]
[0m10:55:39.219084 [debug] [Thread-1 (]: Finished running node model.transform.3_1
[0m10:55:39.219379 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m10:55:39.219780 [info ] [Thread-1 (]: 2 of 5 START sql view model main.clean ......................................... [RUN]
[0m10:55:39.220109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_1, now model.transform.clean)
[0m10:55:39.220379 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m10:55:39.221763 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m10:55:39.222781 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m10:55:39.224990 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m10:55:39.225901 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:55:39.226109 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m10:55:39.226339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:55:39.236482 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:55:39.236764 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:55:39.237135 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT "Code INSEE région",	"Région"	,	"Date",	"Heure",	
"Consommation (MW)"	,"Thermique (MW)",	"Nucléaire (MW)",	"Eolien (MW)",	"Solaire (MW)",	"Hydraulique (MW)",	"Pompage (MW)",	"Bioénergies (MW)",	"Ech. physiques (MW)","production_totale"

     FROM clean
  );

[0m10:55:39.237864 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:55:39.239990 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:55:39.240202 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m10:55:39.240549 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:55:39.241944 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:55:39.242147 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m10:55:39.242551 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:55:39.243408 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m10:55:39.243606 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:55:39.243861 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m10:55:39.245104 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:55:39.246218 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:55:39.246417 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m10:55:39.247008 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:55:39.247631 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m10:55:39.259308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa665d76-08d5-4b78-acbc-3bc5e1fc6139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a109541870>]}
[0m10:55:39.259689 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main.clean .................................... [[32mOK[0m in 0.04s]
[0m10:55:39.260002 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m10:55:39.260223 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m10:55:39.260459 [info ] [Thread-1 (]: 3 of 5 START sql view model main.grain_jour .................................... [RUN]
[0m10:55:39.260720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m10:55:39.260925 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m10:55:39.261950 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m10:55:39.262872 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m10:55:39.264574 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m10:55:39.265419 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:55:39.265608 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m10:55:39.265841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:55:39.275592 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:55:39.275835 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:55:39.276146 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS thermique_total,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS nucleaire_total,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS eolien_total,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS solaire_total,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS hydraulique_total,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS bioenergies_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_total,
    SUM(COALESCE(production_totale, 0)) AS production_totale
FROM clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m10:55:39.276932 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:55:39.278429 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:55:39.278632 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour" rename to "grain_jour__dbt_backup"
[0m10:55:39.279091 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:55:39.280585 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:55:39.280796 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour__dbt_tmp" rename to "grain_jour"
[0m10:55:39.281233 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:55:39.282060 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m10:55:39.282262 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:55:39.282468 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m10:55:39.283820 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:55:39.285001 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:55:39.285210 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
drop view if exists "dev"."main"."grain_jour__dbt_backup" cascade
[0m10:55:39.285790 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:55:39.287115 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m10:55:39.299726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa665d76-08d5-4b78-acbc-3bc5e1fc6139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a10814bdc0>]}
[0m10:55:39.300215 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.grain_jour ............................... [[32mOK[0m in 0.04s]
[0m10:55:39.300621 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m10:55:39.300922 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m10:55:39.301276 [info ] [Thread-1 (]: 4 of 5 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m10:55:39.301578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m10:55:39.301823 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m10:55:39.325179 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m10:55:39.326403 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m10:55:39.336257 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m10:55:39.337289 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:55:39.337504 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m10:55:39.337765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:55:39.347658 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:55:39.347907 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:55:39.348225 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m10:55:39.348806 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:55:39.350319 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:55:39.350531 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:55:39.350971 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:55:39.352430 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:55:39.352644 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:55:39.353028 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:55:39.355655 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m10:55:39.355890 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:55:39.356103 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m10:55:39.357249 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:55:39.358453 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:55:39.358659 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m10:55:39.359293 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:55:39.360006 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m10:55:39.373428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa665d76-08d5-4b78-acbc-3bc5e1fc6139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a108174a30>]}
[0m10:55:39.373808 [info ] [Thread-1 (]: 4 of 5 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.07s]
[0m10:55:39.374148 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m10:55:39.374698 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m10:55:39.374966 [info ] [Thread-1 (]: 5 of 5 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m10:55:39.375286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m10:55:39.375571 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m10:55:39.377319 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m10:55:39.378203 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m10:55:39.380721 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m10:55:39.381563 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:55:39.381756 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m10:55:39.382026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:55:39.392342 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:55:39.392570 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:55:39.392873 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m10:55:39.393385 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:55:39.394996 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:55:39.395214 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m10:55:39.395574 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:55:39.397069 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:55:39.397299 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:55:39.397666 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:55:39.398533 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m10:55:39.398747 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:55:39.398990 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m10:55:39.400118 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:55:39.401346 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:55:39.401556 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m10:55:39.402140 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:55:39.402811 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m10:55:39.414137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa665d76-08d5-4b78-acbc-3bc5e1fc6139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a10958c640>]}
[0m10:55:39.414530 [info ] [Thread-1 (]: 5 of 5 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m10:55:39.414849 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m10:55:39.415536 [debug] [MainThread]: Using duckdb connection "master"
[0m10:55:39.415721 [debug] [MainThread]: On master: BEGIN
[0m10:55:39.415983 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:55:39.426141 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m10:55:39.426355 [debug] [MainThread]: On master: COMMIT
[0m10:55:39.426696 [debug] [MainThread]: Using duckdb connection "master"
[0m10:55:39.426961 [debug] [MainThread]: On master: COMMIT
[0m10:55:39.427298 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:55:39.427488 [debug] [MainThread]: On master: Close
[0m10:55:39.428670 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:55:39.428857 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m10:55:39.429151 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m10:55:39.429467 [info ] [MainThread]: 
[0m10:55:39.429680 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m10:55:39.430340 [debug] [MainThread]: Command end result
[0m10:55:39.450564 [info ] [MainThread]: 
[0m10:55:39.450823 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:55:39.451060 [info ] [MainThread]: 
[0m10:55:39.451340 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m10:55:39.451823 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2756499, "process_in_blocks": "11232", "process_kernel_time": 0.177539, "process_mem_max_rss": "138220", "process_out_blocks": "9600", "process_user_time": 1.399371}
[0m10:55:39.452119 [debug] [MainThread]: Command `dbt run` succeeded at 10:55:39.452067 after 1.28 seconds
[0m10:55:39.452314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a113ea3ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a10bdb08b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a10bdb3f70>]}
[0m10:55:39.452526 [debug] [MainThread]: Flushing usage events
[0m10:55:46.602569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a47ae587c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a47ae9bf100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a47ae9be860>]}


============================== 10:55:46.605561 | 296d5c5a-ce0f-4acd-b9f4-a52e3c7e99c2 ==============================
[0m10:55:46.605561 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:55:46.606381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:55:46.738678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '296d5c5a-ce0f-4acd-b9f4-a52e3c7e99c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a47acbe67d0>]}
[0m10:55:46.766441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '296d5c5a-ce0f-4acd-b9f4-a52e3c7e99c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a47ad934d90>]}
[0m10:55:46.769643 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m10:55:46.812340 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:55:46.942651 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:55:46.943848 [debug] [MainThread]: Partial parsing: updated file: transform://models/example/3_2.sql
[0m10:55:47.036012 [error] [MainThread]: Encountered an error:
Compilation Error in model 3_2 (models/example/3_2.sql)
  'None' has no attribute 'table'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:55:47.036483 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.46741024, "process_in_blocks": "0", "process_kernel_time": 0.087072, "process_mem_max_rss": "122804", "process_out_blocks": "80", "process_user_time": 1.062889}
[0m10:55:47.036849 [debug] [MainThread]: Command `dbt run` failed at 10:55:47.036799 after 0.47 seconds
[0m10:55:47.037165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a47ae587c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a47a638bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a47a638bac0>]}
[0m10:55:47.037574 [debug] [MainThread]: Flushing usage events
[0m10:56:00.192889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798b52187c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798b525bff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798b525bf8e0>]}


============================== 10:56:00.195490 | d304e357-b1c9-482a-bf63-4a9470041996 ==============================
[0m10:56:00.195490 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:56:00.196344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m10:56:00.262491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd304e357-b1c9-482a-bf63-4a9470041996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798b520b17e0>]}
[0m10:56:00.299832 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:56:00.303189 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:56:00.304308 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.13836193, "process_in_blocks": "144", "process_kernel_time": 0.061227, "process_mem_max_rss": "87436", "process_out_blocks": "48", "process_user_time": 0.68338}
[0m10:56:00.305055 [debug] [MainThread]: Command `dbt deps` succeeded at 10:56:00.304934 after 0.14 seconds
[0m10:56:00.305486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798b52187c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798b50603310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798b50739ae0>]}
[0m10:56:00.305953 [debug] [MainThread]: Flushing usage events
[0m10:58:56.931484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a414409fc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a41444da8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a41444db1f0>]}


============================== 10:58:56.934846 | 2f8ac342-3cba-40cf-95cf-32af4c3023d6 ==============================
[0m10:58:56.934846 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:58:56.935508 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'fail_fast': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:58:57.074301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f8ac342-3cba-40cf-95cf-32af4c3023d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4143fc97e0>]}
[0m10:58:57.103281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f8ac342-3cba-40cf-95cf-32af4c3023d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4143448e20>]}
[0m10:58:57.106531 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m10:58:57.148686 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:58:57.273714 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:58:57.274466 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:58:57.283139 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m10:58:57.301702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f8ac342-3cba-40cf-95cf-32af4c3023d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a413bf91990>]}
[0m10:58:57.372529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f8ac342-3cba-40cf-95cf-32af4c3023d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a413bf90430>]}
[0m10:58:57.372937 [info ] [MainThread]: Found 6 models, 4 data tests, 421 macros
[0m10:58:57.373451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f8ac342-3cba-40cf-95cf-32af4c3023d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4143f08df0>]}
[0m10:58:57.374899 [info ] [MainThread]: 
[0m10:58:57.375328 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:58:57.378798 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m10:58:57.765999 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m10:58:57.766733 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m10:58:57.767333 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:57.785337 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m10:58:57.786595 [debug] [ThreadPool]: On list_dev: Close
[0m10:58:57.789653 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m10:58:57.790109 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m10:58:57.794343 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:58:57.794547 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m10:58:57.794915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:58:57.805758 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m10:58:57.806510 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:58:57.806713 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m10:58:57.807131 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:58:57.807337 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:58:57.807644 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m10:58:57.808032 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:58:57.808459 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:58:57.808636 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:58:57.808927 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:58:57.809323 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:58:57.809526 [debug] [ThreadPool]: On create_dev_main: Close
[0m10:58:57.811530 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m10:58:57.816508 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:58:57.816764 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m10:58:57.817206 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:58:57.832340 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m10:58:57.833073 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:58:57.833771 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m10:58:57.846471 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m10:58:57.847150 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m10:58:57.847733 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m10:58:57.847907 [debug] [ThreadPool]: On list_dev_main: Close
[0m10:58:57.849982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f8ac342-3cba-40cf-95cf-32af4c3023d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a413c984940>]}
[0m10:58:57.850224 [debug] [MainThread]: Using duckdb connection "master"
[0m10:58:57.850525 [debug] [MainThread]: On master: BEGIN
[0m10:58:57.850821 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:58:57.863003 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m10:58:57.863426 [debug] [MainThread]: On master: COMMIT
[0m10:58:57.863992 [debug] [MainThread]: Using duckdb connection "master"
[0m10:58:57.864348 [debug] [MainThread]: On master: COMMIT
[0m10:58:57.864880 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:58:57.865259 [debug] [MainThread]: On master: Close
[0m10:58:57.867626 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:58:57.868231 [info ] [MainThread]: 
[0m10:58:57.870814 [debug] [Thread-1 (]: Began running node model.transform.3_1
[0m10:58:57.871765 [info ] [Thread-1 (]: 1 of 6 START sql view model main.3_1 ........................................... [RUN]
[0m10:58:57.872466 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.3_1'
[0m10:58:57.872982 [debug] [Thread-1 (]: Began compiling node model.transform.3_1
[0m10:58:57.884586 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_1"
[0m10:58:57.887301 [debug] [Thread-1 (]: Began executing node model.transform.3_1
[0m10:58:57.906652 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_1"
[0m10:58:57.908810 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:58:57.909019 [debug] [Thread-1 (]: On model.transform.3_1: BEGIN
[0m10:58:57.909446 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:58:57.920900 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:58:57.921129 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:58:57.921511 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    strftime('%Y-%m', Date) AS mois,  -- Utilisation de strftime pour extraire l'année et le mois
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0))/2000 AS consommation_totale_en_GWH,
    SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,

    MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
FROM clean
GROUP BY strftime('%Y-%m', Date), "Région"  -- Remplacer TO_CHAR par strftime
ORDER BY mois, "Région"  -- Tri par mois et région
  );

[0m10:58:57.922392 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:57.925620 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:58:57.925838 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1" rename to "3_1__dbt_backup"
[0m10:58:57.926365 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:58:57.927754 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:58:57.927952 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1__dbt_tmp" rename to "3_1"
[0m10:58:57.928394 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:58:57.936520 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m10:58:57.936744 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:58:57.937116 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m10:58:57.938797 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:57.941237 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m10:58:57.941447 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
drop view if exists "dev"."main"."3_1__dbt_backup" cascade
[0m10:58:57.942224 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:58:57.943483 [debug] [Thread-1 (]: On model.transform.3_1: Close
[0m10:58:57.955962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f8ac342-3cba-40cf-95cf-32af4c3023d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a413c984940>]}
[0m10:58:57.956325 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.3_1 ...................................... [[32mOK[0m in 0.08s]
[0m10:58:57.956660 [debug] [Thread-1 (]: Finished running node model.transform.3_1
[0m10:58:57.956926 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m10:58:57.957262 [info ] [Thread-1 (]: 2 of 6 START sql view model main.clean ......................................... [RUN]
[0m10:58:57.957501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_1, now model.transform.clean)
[0m10:58:57.957774 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m10:58:57.958811 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m10:58:57.959937 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m10:58:57.961697 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m10:58:57.962823 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:58:57.963018 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m10:58:57.963322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:57.973706 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:58:57.973933 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:58:57.974489 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT "Code INSEE région",	"Région"	,	"Date",	"Heure",	
"Consommation (MW)"	,"Thermique (MW)",	"Nucléaire (MW)",	"Eolien (MW)",	"Solaire (MW)",	"Hydraulique (MW)",	"Pompage (MW)",	"Bioénergies (MW)",	"Ech. physiques (MW)","production_totale"

     FROM clean
  );

[0m10:58:57.975233 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:58:57.977163 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:58:57.977368 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m10:58:57.977837 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:58:57.979210 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:58:57.979402 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m10:58:57.979869 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:58:57.980699 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m10:58:57.980900 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:58:57.981205 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m10:58:57.982608 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:57.983716 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m10:58:57.983916 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m10:58:57.984615 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:58:57.985247 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m10:58:57.997161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f8ac342-3cba-40cf-95cf-32af4c3023d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4139779900>]}
[0m10:58:57.997532 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.clean .................................... [[32mOK[0m in 0.04s]
[0m10:58:57.997876 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m10:58:57.998207 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m10:58:57.998536 [info ] [Thread-1 (]: 3 of 6 START sql view model main.grain_jour .................................... [RUN]
[0m10:58:57.998938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m10:58:57.999342 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m10:58:58.000399 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m10:58:58.001606 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m10:58:58.003330 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m10:58:58.004587 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:58:58.004777 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m10:58:58.005094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:58.016127 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:58:58.016364 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:58:58.016925 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS thermique_total,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS nucleaire_total,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS eolien_total,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS solaire_total,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS hydraulique_total,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS bioenergies_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_total,
    SUM(COALESCE(production_totale, 0)) AS production_totale
FROM clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m10:58:58.017757 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:58.019269 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:58:58.019468 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour" rename to "grain_jour__dbt_backup"
[0m10:58:58.020010 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:58:58.021455 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:58:58.021661 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour__dbt_tmp" rename to "grain_jour"
[0m10:58:58.022120 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:58:58.022912 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m10:58:58.023109 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:58:58.023404 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m10:58:58.025246 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:58:58.026412 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m10:58:58.026612 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
drop view if exists "dev"."main"."grain_jour__dbt_backup" cascade
[0m10:58:58.027348 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:58:58.028534 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m10:58:58.040368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f8ac342-3cba-40cf-95cf-32af4c3023d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a413834ffa0>]}
[0m10:58:58.040722 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.grain_jour ............................... [[32mOK[0m in 0.04s]
[0m10:58:58.041040 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m10:58:58.041305 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m10:58:58.041629 [info ] [Thread-1 (]: 4 of 6 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m10:58:58.041917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m10:58:58.042193 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m10:58:58.063909 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m10:58:58.065265 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m10:58:58.074882 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m10:58:58.076082 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:58:58.076286 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m10:58:58.076575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:58.087495 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:58:58.087727 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:58:58.088263 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m10:58:58.088886 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:58:58.090398 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:58:58.090606 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:58:58.091136 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:58:58.092617 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:58:58.092822 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:58:58.093407 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:58:58.096050 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m10:58:58.096303 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:58:58.096637 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m10:58:58.098351 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:58.099551 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m10:58:58.099748 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m10:58:58.100472 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:58:58.101194 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m10:58:58.116207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f8ac342-3cba-40cf-95cf-32af4c3023d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4138370580>]}
[0m10:58:58.116619 [info ] [Thread-1 (]: 4 of 6 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.07s]
[0m10:58:58.116958 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m10:58:58.117228 [debug] [Thread-1 (]: Began running node model.transform.3_2
[0m10:58:58.117596 [info ] [Thread-1 (]: 5 of 6 START sql view model main.3_2 ........................................... [RUN]
[0m10:58:58.117894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.3_2)
[0m10:58:58.118173 [debug] [Thread-1 (]: Began compiling node model.transform.3_2
[0m10:58:58.125429 [debug] [Thread-1 (]: Compilation Error in model 3_2 (models/example/3_2.sql)
  'dict object' has no attribute 'ref'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:58:58.125676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f8ac342-3cba-40cf-95cf-32af4c3023d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a413e788cd0>]}
[0m10:58:58.126069 [error] [Thread-1 (]: 5 of 6 ERROR creating sql view model main.3_2 .................................. [[31mERROR[0m in 0.01s]
[0m10:58:58.126345 [debug] [Thread-1 (]: Finished running node model.transform.3_2
[0m10:58:58.126560 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m10:58:58.127392 [info ] [Thread-1 (]: 6 of 6 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m10:58:58.127764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_2, now model.transform.my_second_dbt_model)
[0m10:58:58.128038 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m10:58:58.130172 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m10:58:58.131393 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m10:58:58.133154 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m10:58:58.134270 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:58:58.134463 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m10:58:58.134778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:58.145626 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:58:58.145860 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:58:58.146435 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m10:58:58.147057 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:58:58.148596 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:58:58.148812 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m10:58:58.149371 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:58:58.150796 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:58:58.151002 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:58:58.151535 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:58:58.152330 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m10:58:58.152522 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:58:58.152839 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m10:58:58.154641 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:58.155761 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m10:58:58.155967 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m10:58:58.156831 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:58.157524 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m10:58:58.169562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f8ac342-3cba-40cf-95cf-32af4c3023d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a41397799f0>]}
[0m10:58:58.169922 [info ] [Thread-1 (]: 6 of 6 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m10:58:58.170234 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m10:58:58.170944 [debug] [MainThread]: Using duckdb connection "master"
[0m10:58:58.171159 [debug] [MainThread]: On master: BEGIN
[0m10:58:58.171458 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:58:58.182832 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m10:58:58.183105 [debug] [MainThread]: On master: COMMIT
[0m10:58:58.183637 [debug] [MainThread]: Using duckdb connection "master"
[0m10:58:58.184001 [debug] [MainThread]: On master: COMMIT
[0m10:58:58.184412 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:58:58.184632 [debug] [MainThread]: On master: Close
[0m10:58:58.186097 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:58:58.186318 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m10:58:58.186684 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m10:58:58.187083 [info ] [MainThread]: 
[0m10:58:58.187348 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m10:58:58.188222 [debug] [MainThread]: Command end result
[0m10:58:58.218751 [info ] [MainThread]: 
[0m10:58:58.219129 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:58:58.219426 [info ] [MainThread]: 
[0m10:58:58.219775 [error] [MainThread]:   Compilation Error in model 3_2 (models/example/3_2.sql)
  'dict object' has no attribute 'ref'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:58:58.219978 [info ] [MainThread]: 
[0m10:58:58.220236 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m10:58:58.220725 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3169605, "process_in_blocks": "11264", "process_kernel_time": 0.186273, "process_mem_max_rss": "138712", "process_out_blocks": "9688", "process_user_time": 1.411224}
[0m10:58:58.221073 [debug] [MainThread]: Command `dbt run` failed at 10:58:58.221015 after 1.32 seconds
[0m10:58:58.221300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a414409fc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4143448e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4138df8eb0>]}
[0m10:58:58.221517 [debug] [MainThread]: Flushing usage events
[0m11:01:26.956468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723cc687bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723cc6c0f1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723cc6c0f310>]}


============================== 11:01:26.959647 | d3f988ee-36e0-4e5e-bc58-7a82b8fe0151 ==============================
[0m11:01:26.959647 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:01:26.960305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'fail_fast': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:01:27.096813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3f988ee-36e0-4e5e-bc58-7a82b8fe0151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723cc502a950>]}
[0m11:01:27.124606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3f988ee-36e0-4e5e-bc58-7a82b8fe0151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723cc4fce0b0>]}
[0m11:01:27.127720 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m11:01:27.169402 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:01:27.295899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:01:27.297069 [debug] [MainThread]: Partial parsing: updated file: transform://models/example/3_2.sql
[0m11:01:27.387598 [error] [MainThread]: Encountered an error:
Compilation Error in model 3_2 (models/example/3_2.sql)
  'None' has no attribute 'table'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:01:27.388081 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.45990083, "process_in_blocks": "0", "process_kernel_time": 0.115177, "process_mem_max_rss": "122768", "process_out_blocks": "80", "process_user_time": 1.229893}
[0m11:01:27.388600 [debug] [MainThread]: Command `dbt run` failed at 11:01:27.388547 after 0.46 seconds
[0m11:01:27.389075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723cc687bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723cbdb07a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723cbdb07a60>]}
[0m11:01:27.389539 [debug] [MainThread]: Flushing usage events
[0m11:01:35.421229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d406588fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4065ccf190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4065cceef0>]}


============================== 11:01:35.423629 | 2324e6ee-7c97-4a49-9749-a138b0238118 ==============================
[0m11:01:35.423629 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:01:35.424242 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:01:35.546364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2324e6ee-7c97-4a49-9749-a138b0238118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d405ff72e90>]}
[0m11:01:35.573890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2324e6ee-7c97-4a49-9749-a138b0238118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4064224d00>]}
[0m11:01:35.576714 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m11:01:35.618947 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:01:35.744806 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:01:35.745935 [debug] [MainThread]: Partial parsing: updated file: transform://models/example/3_2.sql
[0m11:01:35.837900 [error] [MainThread]: Encountered an error:
Compilation Error in model 3_2 (models/example/3_2.sql)
  'None' has no attribute 'table'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:01:35.838424 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.44504827, "process_in_blocks": "0", "process_kernel_time": 0.071825, "process_mem_max_rss": "122648", "process_out_blocks": "80", "process_user_time": 1.000498}
[0m11:01:35.838749 [debug] [MainThread]: Command `dbt run` failed at 11:01:35.838697 after 0.45 seconds
[0m11:01:35.839145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d406588fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d405cd9fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d405cd9fa60>]}
[0m11:01:35.839506 [debug] [MainThread]: Flushing usage events
[0m12:02:24.746150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99bca8bca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99bb2fb2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99bb2fb250>]}


============================== 12:02:24.749447 | b87b13e8-9aa9-45c6-9d57-b82e8ece1c82 ==============================
[0m12:02:24.749447 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:02:24.750098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'debug': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:02:24.902414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b87b13e8-9aa9-45c6-9d57-b82e8ece1c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99bb293730>]}
[0m12:02:24.931704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b87b13e8-9aa9-45c6-9d57-b82e8ece1c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99bbe39ae0>]}
[0m12:02:24.935213 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m12:02:24.978275 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:02:25.106080 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:02:25.106881 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:02:25.115720 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m12:02:25.134566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b87b13e8-9aa9-45c6-9d57-b82e8ece1c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99b497d960>]}
[0m12:02:25.205727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b87b13e8-9aa9-45c6-9d57-b82e8ece1c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99b497db70>]}
[0m12:02:25.206127 [info ] [MainThread]: Found 6 models, 4 data tests, 421 macros
[0m12:02:25.206564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b87b13e8-9aa9-45c6-9d57-b82e8ece1c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99b497fbe0>]}
[0m12:02:25.207987 [info ] [MainThread]: 
[0m12:02:25.208399 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:02:25.211776 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:02:25.636092 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:02:25.636836 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:02:25.637457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:25.655731 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m12:02:25.657211 [debug] [ThreadPool]: On list_dev: Close
[0m12:02:25.660620 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:02:25.661331 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:02:25.668525 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:02:25.668720 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:02:25.669134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:25.683713 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m12:02:25.685107 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:02:25.685476 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:02:25.686169 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:02:25.686488 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:02:25.686870 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:02:25.687377 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:02:25.688047 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:02:25.688326 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:02:25.688689 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:02:25.689232 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:02:25.689446 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:02:25.691374 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:02:25.695238 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:02:25.695552 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:02:25.695927 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:25.712571 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m12:02:25.713213 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:02:25.713720 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:02:25.729881 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m12:02:25.730873 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:02:25.731911 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:02:25.732240 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:02:25.735949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b87b13e8-9aa9-45c6-9d57-b82e8ece1c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99bb378820>]}
[0m12:02:25.736415 [debug] [MainThread]: Using duckdb connection "master"
[0m12:02:25.736727 [debug] [MainThread]: On master: BEGIN
[0m12:02:25.737084 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:02:25.750667 [debug] [MainThread]: SQL status: OK in 0.014 seconds
[0m12:02:25.751026 [debug] [MainThread]: On master: COMMIT
[0m12:02:25.751573 [debug] [MainThread]: Using duckdb connection "master"
[0m12:02:25.751897 [debug] [MainThread]: On master: COMMIT
[0m12:02:25.752311 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:02:25.752585 [debug] [MainThread]: On master: Close
[0m12:02:25.754083 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:02:25.754353 [info ] [MainThread]: 
[0m12:02:25.755748 [debug] [Thread-1 (]: Began running node model.transform.3_1
[0m12:02:25.756528 [info ] [Thread-1 (]: 1 of 6 START sql view model main.3_1 ........................................... [RUN]
[0m12:02:25.757100 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.3_1'
[0m12:02:25.757379 [debug] [Thread-1 (]: Began compiling node model.transform.3_1
[0m12:02:25.766540 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_1"
[0m12:02:25.769371 [debug] [Thread-1 (]: Began executing node model.transform.3_1
[0m12:02:25.795139 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_1"
[0m12:02:25.798051 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:02:25.798258 [debug] [Thread-1 (]: On model.transform.3_1: BEGIN
[0m12:02:25.798664 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:02:25.810131 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:02:25.810350 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:02:25.810911 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    strftime('%Y-%m', Date) AS mois,  -- Utilisation de strftime pour extraire l'année et le mois
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0))/2000 AS consommation_totale_en_GWH,
    SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,

    MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
FROM clean
GROUP BY strftime('%Y-%m', Date), "Région"  -- Remplacer TO_CHAR par strftime
ORDER BY mois, "Région"  -- Tri par mois et région
  );

[0m12:02:25.811892 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:25.815092 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:02:25.815307 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1" rename to "3_1__dbt_backup"
[0m12:02:25.815904 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:25.817352 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:02:25.817550 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1__dbt_tmp" rename to "3_1"
[0m12:02:25.818022 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:25.826114 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m12:02:25.826333 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:02:25.826761 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m12:02:25.829358 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:02:25.831855 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:02:25.832069 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
drop view if exists "dev"."main"."3_1__dbt_backup" cascade
[0m12:02:25.833090 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:25.834377 [debug] [Thread-1 (]: On model.transform.3_1: Close
[0m12:02:25.847869 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b87b13e8-9aa9-45c6-9d57-b82e8ece1c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99bb378820>]}
[0m12:02:25.848245 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.3_1 ...................................... [[32mOK[0m in 0.09s]
[0m12:02:25.848570 [debug] [Thread-1 (]: Finished running node model.transform.3_1
[0m12:02:25.848797 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m12:02:25.849222 [info ] [Thread-1 (]: 2 of 6 START sql view model main.clean ......................................... [RUN]
[0m12:02:25.849519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_1, now model.transform.clean)
[0m12:02:25.849804 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m12:02:25.850907 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m12:02:25.852027 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m12:02:25.853816 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m12:02:25.854937 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:02:25.855120 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m12:02:25.855445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:25.868362 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m12:02:25.868766 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:02:25.869297 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT "Code INSEE région",	"Région"	,	"Date",	"Heure",	
"Consommation (MW)"	,"Thermique (MW)",	"Nucléaire (MW)",	"Eolien (MW)",	"Solaire (MW)",	"Hydraulique (MW)",	"Pompage (MW)",	"Bioénergies (MW)",	"Ech. physiques (MW)","production_totale"

     FROM clean
  );

[0m12:02:25.870107 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:25.872131 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:02:25.872338 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m12:02:25.872870 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:25.874288 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:02:25.874480 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m12:02:25.875018 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:25.875850 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:02:25.876046 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:02:25.876373 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:02:25.878812 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:02:25.879929 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:02:25.880121 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m12:02:25.880990 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:25.881615 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m12:02:25.893950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b87b13e8-9aa9-45c6-9d57-b82e8ece1c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99b217d8d0>]}
[0m12:02:25.894301 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.clean .................................... [[32mOK[0m in 0.04s]
[0m12:02:25.894641 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m12:02:25.894861 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m12:02:25.895213 [info ] [Thread-1 (]: 3 of 6 START sql view model main.grain_jour .................................... [RUN]
[0m12:02:25.895562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m12:02:25.895868 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m12:02:25.896962 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m12:02:25.898132 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m12:02:25.899846 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m12:02:25.901060 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:02:25.901256 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m12:02:25.901576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:25.914083 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m12:02:25.914485 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:02:25.915100 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS thermique_total,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS nucleaire_total,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS eolien_total,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS solaire_total,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS hydraulique_total,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS bioenergies_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_total,
    SUM(COALESCE(production_totale, 0)) AS production_totale
FROM clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m12:02:25.916582 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:25.919123 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:02:25.919484 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour" rename to "grain_jour__dbt_backup"
[0m12:02:25.920121 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:25.922518 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:02:25.922886 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour__dbt_tmp" rename to "grain_jour"
[0m12:02:25.923518 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:25.924940 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:02:25.925169 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:02:25.925562 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:02:25.928172 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:02:25.929316 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:02:25.929518 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
drop view if exists "dev"."main"."grain_jour__dbt_backup" cascade
[0m12:02:25.930290 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:25.931442 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m12:02:25.944586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b87b13e8-9aa9-45c6-9d57-b82e8ece1c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99b0d3ff70>]}
[0m12:02:25.944951 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.grain_jour ............................... [[32mOK[0m in 0.05s]
[0m12:02:25.945330 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m12:02:25.945610 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m12:02:25.945968 [info ] [Thread-1 (]: 4 of 6 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m12:02:25.946256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m12:02:25.946523 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m12:02:25.968443 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m12:02:25.969961 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m12:02:25.979933 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m12:02:25.981172 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:02:25.981371 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m12:02:25.981765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:25.993540 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m12:02:25.993938 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:02:25.994284 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m12:02:25.994999 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:25.996592 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:02:25.996808 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m12:02:25.997364 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:25.998892 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:02:25.999101 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m12:02:25.999660 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:26.002296 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:02:26.002511 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:02:26.002918 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:02:26.004997 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:02:26.006212 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:02:26.006414 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m12:02:26.007172 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:26.007887 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m12:02:26.022626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b87b13e8-9aa9-45c6-9d57-b82e8ece1c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99b0d61720>]}
[0m12:02:26.023250 [info ] [Thread-1 (]: 4 of 6 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.08s]
[0m12:02:26.023831 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m12:02:26.024231 [debug] [Thread-1 (]: Began running node model.transform.3_2
[0m12:02:26.024779 [info ] [Thread-1 (]: 5 of 6 START sql view model main.3_2 ........................................... [RUN]
[0m12:02:26.025191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.3_2)
[0m12:02:26.025548 [debug] [Thread-1 (]: Began compiling node model.transform.3_2
[0m12:02:26.029447 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_2"
[0m12:02:26.032184 [debug] [Thread-1 (]: Began executing node model.transform.3_2
[0m12:02:26.038027 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_2"
[0m12:02:26.039962 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:02:26.040333 [debug] [Thread-1 (]: On model.transform.3_2: BEGIN
[0m12:02:26.040694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:26.052642 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m12:02:26.052913 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:02:26.053554 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */

  
  create view "dev"."main"."3_2__dbt_tmp" as (
    -- Récupérer les régions distinctes dans un set Jinja


SELECT 
    Date,
    
    
        SUM(CASE WHEN "Région" = 'Bourgogne-Franche-Comté' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bourgogne-Franche-Comté"
        , 
    
        SUM(CASE WHEN "Région" = 'Centre-Val de Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Centre-Val de Loire"
        , 
    
        SUM(CASE WHEN "Région" = 'Nouvelle-Aquitaine' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Nouvelle-Aquitaine"
        , 
    
        SUM(CASE WHEN "Région" = 'Occitanie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Occitanie"
        , 
    
        SUM(CASE WHEN "Région" = 'Île-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Île-de-France"
        , 
    
        SUM(CASE WHEN "Région" = 'Normandie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Normandie"
        , 
    
        SUM(CASE WHEN "Région" = 'Grand Est' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Grand Est"
        , 
    
        SUM(CASE WHEN "Région" = 'Provence-Alpes-Côte d'Azur' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Provence-Alpes-Côte d'Azur"
        , 
    
        SUM(CASE WHEN "Région" = 'Bretagne' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bretagne"
        , 
    
        SUM(CASE WHEN "Région" = 'Hauts-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Hauts-de-France"
        , 
    
        SUM(CASE WHEN "Région" = 'Auvergne-Rhône-Alpes' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Auvergne-Rhône-Alpes"
        , 
    
        SUM(CASE WHEN "Région" = 'Pays de la Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Pays de la Loire"
        
    
    
FROM 
    "dev"."main"."clean"
GROUP BY 
    Date
ORDER BY 
    Date
  );

[0m12:02:26.054033 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */

  
  create view "dev"."main"."3_2__dbt_tmp" as (
    -- Récupérer les régions distinctes dans un set Jinja


SELECT 
    Date,
    
    
        SUM(CASE WHEN "Région" = 'Bourgogne-Franche-Comté' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bourgogne-Franche-Comté"
        , 
    
        SUM(CASE WHEN "Région" = 'Centre-Val de Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Centre-Val de Loire"
        , 
    
        SUM(CASE WHEN "Région" = 'Nouvelle-Aquitaine' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Nouvelle-Aquitaine"
        , 
    
        SUM(CASE WHEN "Région" = 'Occitanie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Occitanie"
        , 
    
        SUM(CASE WHEN "Région" = 'Île-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Île-de-France"
        , 
    
        SUM(CASE WHEN "Région" = 'Normandie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Normandie"
        , 
    
        SUM(CASE WHEN "Région" = 'Grand Est' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Grand Est"
        , 
    
        SUM(CASE WHEN "Région" = 'Provence-Alpes-Côte d'Azur' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Provence-Alpes-Côte d'Azur"
        , 
    
        SUM(CASE WHEN "Région" = 'Bretagne' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bretagne"
        , 
    
        SUM(CASE WHEN "Région" = 'Hauts-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Hauts-de-France"
        , 
    
        SUM(CASE WHEN "Région" = 'Auvergne-Rhône-Alpes' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Auvergne-Rhône-Alpes"
        , 
    
        SUM(CASE WHEN "Région" = 'Pays de la Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Pays de la Loire"
        
    
    
FROM 
    "dev"."main"."clean"
GROUP BY 
    Date
ORDER BY 
    Date
  );

[0m12:02:26.054267 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:02:26.054645 [debug] [Thread-1 (]: On model.transform.3_2: ROLLBACK
[0m12:02:26.057636 [debug] [Thread-1 (]: Failed to rollback 'model.transform.3_2'
[0m12:02:26.057841 [debug] [Thread-1 (]: On model.transform.3_2: Close
[0m12:02:26.059567 [debug] [Thread-1 (]: Runtime Error in model 3_2 (models/example/3_2.sql)
  Parser Error: syntax error at or near "Azur"
[0m12:02:26.059842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b87b13e8-9aa9-45c6-9d57-b82e8ece1c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99b497d720>]}
[0m12:02:26.060362 [error] [Thread-1 (]: 5 of 6 ERROR creating sql view model main.3_2 .................................. [[31mERROR[0m in 0.03s]
[0m12:02:26.060656 [debug] [Thread-1 (]: Finished running node model.transform.3_2
[0m12:02:26.060867 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m12:02:26.061091 [info ] [Thread-1 (]: 6 of 6 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m12:02:26.061831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_2, now model.transform.my_second_dbt_model)
[0m12:02:26.062107 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m12:02:26.063645 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m12:02:26.064877 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m12:02:26.066739 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m12:02:26.067965 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:02:26.068160 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m12:02:26.068475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:26.078814 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m12:02:26.079033 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:02:26.079546 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m12:02:26.080096 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:26.081659 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:02:26.081892 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m12:02:26.082437 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:26.084191 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:02:26.084469 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m12:02:26.084976 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:26.086076 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:02:26.086342 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:02:26.086730 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:02:26.089075 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:02:26.090225 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:02:26.090429 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m12:02:26.091239 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:26.091875 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m12:02:26.104147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b87b13e8-9aa9-45c6-9d57-b82e8ece1c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99b0d229e0>]}
[0m12:02:26.104566 [info ] [Thread-1 (]: 6 of 6 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m12:02:26.104891 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m12:02:26.105708 [debug] [MainThread]: Using duckdb connection "master"
[0m12:02:26.105915 [debug] [MainThread]: On master: BEGIN
[0m12:02:26.106239 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:02:26.116926 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m12:02:26.117150 [debug] [MainThread]: On master: COMMIT
[0m12:02:26.117673 [debug] [MainThread]: Using duckdb connection "master"
[0m12:02:26.118006 [debug] [MainThread]: On master: COMMIT
[0m12:02:26.118431 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:02:26.118655 [debug] [MainThread]: On master: Close
[0m12:02:26.119826 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:02:26.120022 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m12:02:26.120336 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m12:02:26.120712 [info ] [MainThread]: 
[0m12:02:26.120964 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m12:02:26.121714 [debug] [MainThread]: Command end result
[0m12:02:26.143228 [info ] [MainThread]: 
[0m12:02:26.143467 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:02:26.143951 [info ] [MainThread]: 
[0m12:02:26.144280 [error] [MainThread]:   Runtime Error in model 3_2 (models/example/3_2.sql)
  Parser Error: syntax error at or near "Azur"
[0m12:02:26.144534 [info ] [MainThread]: 
[0m12:02:26.144840 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m12:02:26.145441 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4276468, "process_in_blocks": "12320", "process_kernel_time": 0.204833, "process_mem_max_rss": "139132", "process_out_blocks": "9840", "process_user_time": 1.492074}
[0m12:02:26.145717 [debug] [MainThread]: Command `dbt run` failed at 12:02:26.145667 after 1.43 seconds
[0m12:02:26.145935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99bca8bca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99b17e2d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d99b17e25c0>]}
[0m12:02:26.146229 [debug] [MainThread]: Flushing usage events
[0m12:05:59.831365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7522482ffc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75224862f1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75224862f310>]}


============================== 12:05:59.833950 | 8755dc85-a108-40bc-a7d5-148fe59459ec ==============================
[0m12:05:59.833950 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:05:59.834650 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:05:59.972748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8755dc85-a108-40bc-a7d5-148fe59459ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7522467ba950>]}
[0m12:06:00.001094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8755dc85-a108-40bc-a7d5-148fe59459ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7522467560b0>]}
[0m12:06:00.004557 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m12:06:00.046945 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:06:00.170492 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:06:00.171251 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:06:00.180187 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m12:06:00.198821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8755dc85-a108-40bc-a7d5-148fe59459ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7522413e5900>]}
[0m12:06:00.269429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8755dc85-a108-40bc-a7d5-148fe59459ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75224136fa00>]}
[0m12:06:00.269847 [info ] [MainThread]: Found 6 models, 4 data tests, 421 macros
[0m12:06:00.270492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8755dc85-a108-40bc-a7d5-148fe59459ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75224136de40>]}
[0m12:06:00.272069 [info ] [MainThread]: 
[0m12:06:00.272531 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:06:00.276393 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:06:00.660588 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:06:00.661343 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:06:00.661994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:06:00.681710 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m12:06:00.684211 [debug] [ThreadPool]: On list_dev: Close
[0m12:06:00.687650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:06:00.688724 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:06:00.697869 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:06:00.698206 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:06:00.698663 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:06:00.711534 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m12:06:00.712534 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:06:00.712808 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:06:00.713399 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:06:00.713613 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:06:00.713942 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:06:00.714401 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:06:00.714943 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:06:00.715137 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:06:00.715454 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:06:00.715912 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:06:00.716109 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:06:00.717964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:06:00.724256 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:06:00.724611 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:06:00.724990 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:06:00.740465 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m12:06:00.741257 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:06:00.741989 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:06:00.754101 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m12:06:00.754770 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:06:00.755368 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:06:00.755533 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:06:00.757704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8755dc85-a108-40bc-a7d5-148fe59459ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752246756020>]}
[0m12:06:00.757947 [debug] [MainThread]: Using duckdb connection "master"
[0m12:06:00.758230 [debug] [MainThread]: On master: BEGIN
[0m12:06:00.758535 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:06:00.770682 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m12:06:00.771110 [debug] [MainThread]: On master: COMMIT
[0m12:06:00.771750 [debug] [MainThread]: Using duckdb connection "master"
[0m12:06:00.772097 [debug] [MainThread]: On master: COMMIT
[0m12:06:00.772648 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:06:00.773063 [debug] [MainThread]: On master: Close
[0m12:06:00.775397 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:06:00.775935 [info ] [MainThread]: 
[0m12:06:00.778294 [debug] [Thread-1 (]: Began running node model.transform.3_1
[0m12:06:00.779422 [info ] [Thread-1 (]: 1 of 6 START sql view model main.3_1 ........................................... [RUN]
[0m12:06:00.780077 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.3_1'
[0m12:06:00.780515 [debug] [Thread-1 (]: Began compiling node model.transform.3_1
[0m12:06:00.788693 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_1"
[0m12:06:00.791275 [debug] [Thread-1 (]: Began executing node model.transform.3_1
[0m12:06:00.821101 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_1"
[0m12:06:00.824032 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:06:00.824242 [debug] [Thread-1 (]: On model.transform.3_1: BEGIN
[0m12:06:00.824631 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:06:00.836170 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:06:00.836443 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:06:00.837080 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    strftime('%Y-%m', Date) AS mois,  -- Utilisation de strftime pour extraire l'année et le mois
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0))/2000 AS consommation_totale_en_GWH,
    SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,

    MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
FROM clean
GROUP BY strftime('%Y-%m', Date), "Région"  -- Remplacer TO_CHAR par strftime
ORDER BY mois, "Région"  -- Tri par mois et région
  );

[0m12:06:00.838064 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:06:00.841320 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:06:00.841541 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1" rename to "3_1__dbt_backup"
[0m12:06:00.842123 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:06:00.843517 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:06:00.843717 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1__dbt_tmp" rename to "3_1"
[0m12:06:00.844288 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:06:00.852246 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m12:06:00.852465 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:06:00.852852 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m12:06:00.855456 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:06:00.857896 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:06:00.858108 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
drop view if exists "dev"."main"."3_1__dbt_backup" cascade
[0m12:06:00.859073 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:06:00.860350 [debug] [Thread-1 (]: On model.transform.3_1: Close
[0m12:06:00.873468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8755dc85-a108-40bc-a7d5-148fe59459ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752246756020>]}
[0m12:06:00.873838 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.3_1 ...................................... [[32mOK[0m in 0.09s]
[0m12:06:00.874167 [debug] [Thread-1 (]: Finished running node model.transform.3_1
[0m12:06:00.874444 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m12:06:00.874802 [info ] [Thread-1 (]: 2 of 6 START sql view model main.clean ......................................... [RUN]
[0m12:06:00.875160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_1, now model.transform.clean)
[0m12:06:00.875455 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m12:06:00.876603 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m12:06:00.877740 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m12:06:00.879546 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m12:06:00.880699 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:06:00.880892 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m12:06:00.881214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:06:00.892033 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:06:00.892259 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:06:00.892820 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT "Code INSEE région",	"Région"	,	"Date",	"Heure",	
"Consommation (MW)"	,"Thermique (MW)",	"Nucléaire (MW)",	"Eolien (MW)",	"Solaire (MW)",	"Hydraulique (MW)",	"Pompage (MW)",	"Bioénergies (MW)",	"Ech. physiques (MW)","production_totale"

     FROM clean
  );

[0m12:06:00.893608 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:06:00.895676 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:06:00.895897 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m12:06:00.896423 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:06:00.897876 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:06:00.898079 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m12:06:00.898541 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:06:00.899394 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:06:00.899588 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:06:00.899892 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:06:00.902149 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:06:00.903263 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:06:00.903464 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m12:06:00.904354 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:06:00.904993 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m12:06:00.916957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8755dc85-a108-40bc-a7d5-148fe59459ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75223e139870>]}
[0m12:06:00.917325 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.clean .................................... [[32mOK[0m in 0.04s]
[0m12:06:00.917620 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m12:06:00.917881 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m12:06:00.918299 [info ] [Thread-1 (]: 3 of 6 START sql view model main.grain_jour .................................... [RUN]
[0m12:06:00.918575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m12:06:00.918854 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m12:06:00.919930 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m12:06:00.921179 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m12:06:00.922928 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m12:06:00.924042 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:06:00.924235 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m12:06:00.924518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:06:00.934940 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m12:06:00.935163 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:06:00.935728 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS thermique_total,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS nucleaire_total,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS eolien_total,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS solaire_total,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS hydraulique_total,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS bioenergies_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_total,
    SUM(COALESCE(production_totale, 0)) AS production_totale
FROM clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m12:06:00.936589 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:06:00.938089 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:06:00.938294 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour" rename to "grain_jour__dbt_backup"
[0m12:06:00.938852 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:06:00.940296 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:06:00.940502 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour__dbt_tmp" rename to "grain_jour"
[0m12:06:00.941108 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:06:00.941898 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:06:00.942098 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:06:00.942409 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:06:00.944931 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:06:00.946094 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:06:00.946295 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
drop view if exists "dev"."main"."grain_jour__dbt_backup" cascade
[0m12:06:00.947182 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:06:00.948329 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m12:06:00.960619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8755dc85-a108-40bc-a7d5-148fe59459ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75223d79ff10>]}
[0m12:06:00.960970 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.grain_jour ............................... [[32mOK[0m in 0.04s]
[0m12:06:00.961262 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m12:06:00.961475 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m12:06:00.961748 [info ] [Thread-1 (]: 4 of 6 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m12:06:00.961975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m12:06:00.962249 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m12:06:00.984267 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m12:06:00.985759 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m12:06:00.995572 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m12:06:00.997218 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:06:00.997431 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m12:06:00.997721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:06:01.009126 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:06:01.009353 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:06:01.009925 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m12:06:01.010585 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:06:01.012187 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:06:01.012410 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m12:06:01.012950 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:06:01.014432 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:06:01.014640 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m12:06:01.015236 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:06:01.017976 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:06:01.018199 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:06:01.018521 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:06:01.020888 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:06:01.022073 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:06:01.022271 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m12:06:01.023234 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:06:01.023932 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m12:06:01.039534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8755dc85-a108-40bc-a7d5-148fe59459ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75223d7c9780>]}
[0m12:06:01.040003 [info ] [Thread-1 (]: 4 of 6 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.08s]
[0m12:06:01.040336 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m12:06:01.040599 [debug] [Thread-1 (]: Began running node model.transform.3_2
[0m12:06:01.041125 [info ] [Thread-1 (]: 5 of 6 START sql view model main.3_2 ........................................... [RUN]
[0m12:06:01.041509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.3_2)
[0m12:06:01.041828 [debug] [Thread-1 (]: Began compiling node model.transform.3_2
[0m12:06:01.045678 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_2"
[0m12:06:01.047487 [debug] [Thread-1 (]: Began executing node model.transform.3_2
[0m12:06:01.051030 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_2"
[0m12:06:01.052626 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:06:01.052858 [debug] [Thread-1 (]: On model.transform.3_2: BEGIN
[0m12:06:01.053164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:06:01.065184 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m12:06:01.065528 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:06:01.066216 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */

  
  create view "dev"."main"."3_2__dbt_tmp" as (
    -- Récupérer les régions distinctes dans un set Jinja


SELECT 
    Date,
    
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bourgogne-Franche-Comté' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bourgogne-Franche-Comté"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Centre-Val de Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Centre-Val de Loire"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Nouvelle-Aquitaine' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Nouvelle-Aquitaine"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Occitanie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Occitanie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Île-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Île-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Normandie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Normandie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Grand Est' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Grand Est"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Provence-Alpes-Côte d''Azur' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Provence-Alpes-Côte d''Azur"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bretagne' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bretagne"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Hauts-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Hauts-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Auvergne-Rhône-Alpes' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Auvergne-Rhône-Alpes"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Pays de la Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Pays de la Loire"
        
    
    
FROM 
    "dev"."main"."clean"
GROUP BY 
    Date
ORDER BY 
    Date
  );

[0m12:06:01.067603 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:06:01.069439 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:06:01.069659 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
alter view "dev"."main"."3_2__dbt_tmp" rename to "3_2"
[0m12:06:01.070165 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:06:01.070961 [debug] [Thread-1 (]: On model.transform.3_2: COMMIT
[0m12:06:01.071162 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:06:01.071456 [debug] [Thread-1 (]: On model.transform.3_2: COMMIT
[0m12:06:01.074200 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:06:01.075359 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:06:01.075549 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
drop view if exists "dev"."main"."3_2__dbt_backup" cascade
[0m12:06:01.076018 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:06:01.076655 [debug] [Thread-1 (]: On model.transform.3_2: Close
[0m12:06:01.089021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8755dc85-a108-40bc-a7d5-148fe59459ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75223e1455d0>]}
[0m12:06:01.089393 [info ] [Thread-1 (]: 5 of 6 OK created sql view model main.3_2 ...................................... [[32mOK[0m in 0.05s]
[0m12:06:01.089731 [debug] [Thread-1 (]: Finished running node model.transform.3_2
[0m12:06:01.090070 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m12:06:01.090373 [info ] [Thread-1 (]: 6 of 6 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m12:06:01.090651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_2, now model.transform.my_second_dbt_model)
[0m12:06:01.090932 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m12:06:01.092459 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m12:06:01.093651 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m12:06:01.095449 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m12:06:01.096628 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:06:01.096832 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m12:06:01.097129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:06:01.108280 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:06:01.108530 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:06:01.109066 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m12:06:01.109527 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:06:01.111037 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:06:01.111240 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m12:06:01.111719 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:06:01.113269 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:06:01.113486 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m12:06:01.113931 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:06:01.114733 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:06:01.114946 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:06:01.115246 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:06:01.116650 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:06:01.117829 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:06:01.118034 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m12:06:01.118714 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:06:01.119908 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m12:06:01.131636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8755dc85-a108-40bc-a7d5-148fe59459ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75223d78a950>]}
[0m12:06:01.132009 [info ] [Thread-1 (]: 6 of 6 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m12:06:01.132311 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m12:06:01.132910 [debug] [MainThread]: Using duckdb connection "master"
[0m12:06:01.133096 [debug] [MainThread]: On master: BEGIN
[0m12:06:01.133396 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:06:01.144336 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m12:06:01.144577 [debug] [MainThread]: On master: COMMIT
[0m12:06:01.144884 [debug] [MainThread]: Using duckdb connection "master"
[0m12:06:01.145140 [debug] [MainThread]: On master: COMMIT
[0m12:06:01.145511 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:06:01.145677 [debug] [MainThread]: On master: Close
[0m12:06:01.146889 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:06:01.147085 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m12:06:01.147266 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m12:06:01.147510 [info ] [MainThread]: 
[0m12:06:01.147681 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m12:06:01.148311 [debug] [MainThread]: Command end result
[0m12:06:01.168524 [info ] [MainThread]: 
[0m12:06:01.168781 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:06:01.169211 [info ] [MainThread]: 
[0m12:06:01.169447 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m12:06:01.169872 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3665488, "process_in_blocks": "12320", "process_kernel_time": 0.206924, "process_mem_max_rss": "137928", "process_out_blocks": "10952", "process_user_time": 1.582004}
[0m12:06:01.170164 [debug] [MainThread]: Command `dbt run` succeeded at 12:06:01.170113 after 1.37 seconds
[0m12:06:01.170361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7522482ffc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7522474c9300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75223d70ac50>]}
[0m12:06:01.170554 [debug] [MainThread]: Flushing usage events
[0m12:14:38.414223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b4a0d87c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b4a11c28f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b4a11c31f0>]}


============================== 12:14:38.416460 | 87a5fe6f-3a08-4846-b09b-9a013041c916 ==============================
[0m12:14:38.416460 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:14:38.417257 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:14:38.553883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87a5fe6f-3a08-4846-b09b-9a013041c916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b4a0cb17e0>]}
[0m12:14:38.583043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87a5fe6f-3a08-4846-b09b-9a013041c916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b4a0134e20>]}
[0m12:14:38.586331 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m12:14:38.629819 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:14:38.799529 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:14:38.800300 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:14:38.809937 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m12:14:38.828794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87a5fe6f-3a08-4846-b09b-9a013041c916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b499575930>]}
[0m12:14:38.900852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87a5fe6f-3a08-4846-b09b-9a013041c916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b499575b40>]}
[0m12:14:38.901292 [info ] [MainThread]: Found 6 models, 4 data tests, 421 macros
[0m12:14:38.901836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87a5fe6f-3a08-4846-b09b-9a013041c916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b499577be0>]}
[0m12:14:38.903340 [info ] [MainThread]: 
[0m12:14:38.903806 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:14:38.907517 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:14:39.298138 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:14:39.299162 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:14:39.300011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:39.323941 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m12:14:39.325191 [debug] [ThreadPool]: On list_dev: Close
[0m12:14:39.328096 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:14:39.328502 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:14:39.332925 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:14:39.333158 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:14:39.333517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:14:39.345680 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m12:14:39.346623 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:14:39.346890 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:14:39.347371 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:14:39.347613 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:14:39.348006 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:14:39.348445 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:14:39.348976 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:14:39.349197 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:14:39.349515 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:14:39.349926 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:14:39.350158 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:14:39.351965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:14:39.357315 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:14:39.357761 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:14:39.358303 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:14:39.376194 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m12:14:39.376572 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:14:39.377261 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:14:39.410009 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m12:14:39.410856 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:14:39.411557 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:14:39.411773 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:14:39.413986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87a5fe6f-3a08-4846-b09b-9a013041c916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b49f3e44f0>]}
[0m12:14:39.414241 [debug] [MainThread]: Using duckdb connection "master"
[0m12:14:39.414589 [debug] [MainThread]: On master: BEGIN
[0m12:14:39.414943 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:14:39.427147 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m12:14:39.427605 [debug] [MainThread]: On master: COMMIT
[0m12:14:39.428241 [debug] [MainThread]: Using duckdb connection "master"
[0m12:14:39.428816 [debug] [MainThread]: On master: COMMIT
[0m12:14:39.429463 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:14:39.429968 [debug] [MainThread]: On master: Close
[0m12:14:39.432676 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:14:39.433241 [info ] [MainThread]: 
[0m12:14:39.436050 [debug] [Thread-1 (]: Began running node model.transform.3_1
[0m12:14:39.437390 [info ] [Thread-1 (]: 1 of 6 START sql view model main.3_1 ........................................... [RUN]
[0m12:14:39.438845 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.3_1'
[0m12:14:39.439986 [debug] [Thread-1 (]: Began compiling node model.transform.3_1
[0m12:14:39.449079 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_1"
[0m12:14:39.452329 [debug] [Thread-1 (]: Began executing node model.transform.3_1
[0m12:14:39.480358 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_1"
[0m12:14:39.483338 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:14:39.483550 [debug] [Thread-1 (]: On model.transform.3_1: BEGIN
[0m12:14:39.484055 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:14:39.495343 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:14:39.495584 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:14:39.496199 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    strftime('%Y-%m', Date) AS mois,  -- Utilisation de strftime pour extraire l'année et le mois
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0))/2000 AS consommation_totale_en_GWH,
    SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,

    MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
FROM clean
GROUP BY strftime('%Y-%m', Date), "Région"  -- Remplacer TO_CHAR par strftime
ORDER BY mois, "Région"  -- Tri par mois et région
  );

[0m12:14:39.497274 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:14:39.500521 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:14:39.500740 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1" rename to "3_1__dbt_backup"
[0m12:14:39.501231 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:14:39.502620 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:14:39.502832 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1__dbt_tmp" rename to "3_1"
[0m12:14:39.503351 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:14:39.511568 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m12:14:39.511798 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:14:39.512291 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m12:14:39.517455 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:14:39.520253 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:14:39.520485 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
drop view if exists "dev"."main"."3_1__dbt_backup" cascade
[0m12:14:39.521465 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:14:39.522975 [debug] [Thread-1 (]: On model.transform.3_1: Close
[0m12:14:39.536568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a5fe6f-3a08-4846-b09b-9a013041c916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b499575750>]}
[0m12:14:39.536964 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.3_1 ...................................... [[32mOK[0m in 0.10s]
[0m12:14:39.537314 [debug] [Thread-1 (]: Finished running node model.transform.3_1
[0m12:14:39.537563 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m12:14:39.537903 [info ] [Thread-1 (]: 2 of 6 START sql view model main.clean ......................................... [RUN]
[0m12:14:39.538181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_1, now model.transform.clean)
[0m12:14:39.538454 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m12:14:39.539517 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m12:14:39.540646 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m12:14:39.542452 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m12:14:39.543710 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:14:39.543918 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m12:14:39.544243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:14:39.554975 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:14:39.555205 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:14:39.555766 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT "Code INSEE région",	"Région"	,	"Date",	"Heure",	
"Consommation (MW)"	,"Thermique (MW)",	"Nucléaire (MW)",	"Eolien (MW)",	"Solaire (MW)",	"Hydraulique (MW)",	"Pompage (MW)",	"Bioénergies (MW)",	"Ech. physiques (MW)","production_totale"

     FROM clean
  );

[0m12:14:39.556496 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:14:39.558542 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:14:39.558750 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m12:14:39.559292 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:14:39.560754 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:14:39.560969 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m12:14:39.561396 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:14:39.562252 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:14:39.562453 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:14:39.562767 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:14:39.567289 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:14:39.568491 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:14:39.568685 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m12:14:39.569557 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:14:39.570202 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m12:14:39.582474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a5fe6f-3a08-4846-b09b-9a013041c916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b495919510>]}
[0m12:14:39.582844 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.clean .................................... [[32mOK[0m in 0.04s]
[0m12:14:39.583243 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m12:14:39.583499 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m12:14:39.583878 [info ] [Thread-1 (]: 3 of 6 START sql view model main.grain_jour .................................... [RUN]
[0m12:14:39.584158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m12:14:39.584433 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m12:14:39.585480 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m12:14:39.586732 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m12:14:39.588482 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m12:14:39.589790 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:14:39.589975 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m12:14:39.590292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:14:39.601329 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:14:39.601551 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:14:39.602128 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS thermique_total,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS nucleaire_total,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS eolien_total,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS solaire_total,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS hydraulique_total,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS bioenergies_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_total,
    SUM(COALESCE(production_totale, 0)) AS production_totale
FROM clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m12:14:39.603101 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:14:39.604591 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:14:39.604799 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour" rename to "grain_jour__dbt_backup"
[0m12:14:39.605420 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:14:39.606850 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:14:39.607057 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour__dbt_tmp" rename to "grain_jour"
[0m12:14:39.607604 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:14:39.608406 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:14:39.608601 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:14:39.608902 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:14:39.614124 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:14:39.615258 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:14:39.615458 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
drop view if exists "dev"."main"."grain_jour__dbt_backup" cascade
[0m12:14:39.616281 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:14:39.617437 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m12:14:39.629912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a5fe6f-3a08-4846-b09b-9a013041c916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b49595bdc0>]}
[0m12:14:39.630269 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.grain_jour ............................... [[32mOK[0m in 0.05s]
[0m12:14:39.630571 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m12:14:39.630796 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m12:14:39.631133 [info ] [Thread-1 (]: 4 of 6 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m12:14:39.631423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m12:14:39.631710 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m12:14:39.654166 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m12:14:39.655975 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m12:14:39.667714 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m12:14:39.669276 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:14:39.669532 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m12:14:39.669952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:14:39.681420 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:14:39.681687 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:14:39.682230 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m12:14:39.683048 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:14:39.684822 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:14:39.685078 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m12:14:39.685669 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:14:39.687455 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:14:39.687708 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m12:14:39.688252 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:14:39.691229 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:14:39.691478 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:14:39.691860 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:14:39.696597 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:14:39.698082 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:14:39.698363 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m12:14:39.699217 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:14:39.700071 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m12:14:39.715592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a5fe6f-3a08-4846-b09b-9a013041c916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b495959810>]}
[0m12:14:39.716035 [info ] [Thread-1 (]: 4 of 6 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.08s]
[0m12:14:39.716409 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m12:14:39.716680 [debug] [Thread-1 (]: Began running node model.transform.3_2
[0m12:14:39.717124 [info ] [Thread-1 (]: 5 of 6 START sql view model main.3_2 ........................................... [RUN]
[0m12:14:39.717416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.3_2)
[0m12:14:39.717694 [debug] [Thread-1 (]: Began compiling node model.transform.3_2
[0m12:14:39.720408 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_2"
[0m12:14:39.721780 [debug] [Thread-1 (]: Began executing node model.transform.3_2
[0m12:14:39.724571 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_2"
[0m12:14:39.725923 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:14:39.726149 [debug] [Thread-1 (]: On model.transform.3_2: BEGIN
[0m12:14:39.726455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:14:39.737900 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:14:39.738158 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:14:39.738826 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */

  
  create view "dev"."main"."3_2__dbt_tmp" as (
    -- Récupérer les régions distinctes dans un set Jinja


SELECT 
    Date,
    
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bourgogne-Franche-Comté' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bourgogne-Franche-Comté"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Centre-Val de Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Centre-Val de Loire"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Nouvelle-Aquitaine' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Nouvelle-Aquitaine"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Occitanie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Occitanie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Île-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Île-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Normandie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Normandie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Grand Est' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Grand Est"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Provence-Alpes-Côte d''Azur' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Provence-Alpes-Côte d''Azur"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bretagne' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bretagne"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Hauts-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Hauts-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Auvergne-Rhône-Alpes' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Auvergne-Rhône-Alpes"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Pays de la Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Pays de la Loire"
        
    
    
FROM 
    "dev"."main"."clean"
GROUP BY 
    Date
ORDER BY 
    Date
  );

[0m12:14:39.740035 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:14:39.741845 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:14:39.742092 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
alter view "dev"."main"."3_2" rename to "3_2__dbt_backup"
[0m12:14:39.742616 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:14:39.744307 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:14:39.744545 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
alter view "dev"."main"."3_2__dbt_tmp" rename to "3_2"
[0m12:14:39.744974 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:14:39.745940 [debug] [Thread-1 (]: On model.transform.3_2: COMMIT
[0m12:14:39.746180 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:14:39.746488 [debug] [Thread-1 (]: On model.transform.3_2: COMMIT
[0m12:14:39.751430 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:14:39.752933 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:14:39.753177 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
drop view if exists "dev"."main"."3_2__dbt_backup" cascade
[0m12:14:39.754054 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:14:39.754825 [debug] [Thread-1 (]: On model.transform.3_2: Close
[0m12:14:39.767737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a5fe6f-3a08-4846-b09b-9a013041c916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b496dd9930>]}
[0m12:14:39.768242 [info ] [Thread-1 (]: 5 of 6 OK created sql view model main.3_2 ...................................... [[32mOK[0m in 0.05s]
[0m12:14:39.768605 [debug] [Thread-1 (]: Finished running node model.transform.3_2
[0m12:14:39.768873 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m12:14:39.769225 [info ] [Thread-1 (]: 6 of 6 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m12:14:39.769500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_2, now model.transform.my_second_dbt_model)
[0m12:14:39.769747 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m12:14:39.771398 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m12:14:39.772303 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m12:14:39.774418 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m12:14:39.775306 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:14:39.775530 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m12:14:39.775789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:14:39.786355 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:14:39.786629 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:14:39.786967 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m12:14:39.787423 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:14:39.789297 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:14:39.789548 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m12:14:39.789973 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:14:39.791687 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:14:39.791938 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m12:14:39.792358 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:14:39.793320 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:14:39.793561 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:14:39.794579 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:14:39.795685 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:14:39.797095 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:14:39.797337 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m12:14:39.798052 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:14:39.799192 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m12:14:39.811131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a5fe6f-3a08-4846-b09b-9a013041c916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b495908280>]}
[0m12:14:39.811532 [info ] [Thread-1 (]: 6 of 6 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m12:14:39.811853 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m12:14:39.812674 [debug] [MainThread]: Using duckdb connection "master"
[0m12:14:39.812889 [debug] [MainThread]: On master: BEGIN
[0m12:14:39.813137 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:14:39.824124 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m12:14:39.824392 [debug] [MainThread]: On master: COMMIT
[0m12:14:39.824725 [debug] [MainThread]: Using duckdb connection "master"
[0m12:14:39.824990 [debug] [MainThread]: On master: COMMIT
[0m12:14:39.825346 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:14:39.825556 [debug] [MainThread]: On master: Close
[0m12:14:39.826809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:14:39.827038 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m12:14:39.827307 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m12:14:39.827642 [info ] [MainThread]: 
[0m12:14:39.827859 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m12:14:39.828660 [debug] [MainThread]: Command end result
[0m12:14:39.851385 [info ] [MainThread]: 
[0m12:14:39.851679 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:14:39.851944 [info ] [MainThread]: 
[0m12:14:39.852205 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m12:14:39.852731 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4670988, "process_in_blocks": "12320", "process_kernel_time": 0.2329, "process_mem_max_rss": "139128", "process_out_blocks": "10984", "process_user_time": 1.621271}
[0m12:14:39.853073 [debug] [MainThread]: Command `dbt run` succeeded at 12:14:39.853014 after 1.47 seconds
[0m12:14:39.853307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b4a0d87c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b4a0137d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b49ff67820>]}
[0m12:14:39.853530 [debug] [MainThread]: Flushing usage events
[0m12:21:22.013427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce402387c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce4027ba8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce4027bb1f0>]}


============================== 12:21:22.016825 | f3849d6f-d030-4dcf-95fd-56acf21615a9 ==============================
[0m12:21:22.016825 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:21:22.017551 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:21:22.158929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3849d6f-d030-4dcf-95fd-56acf21615a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce4022b17e0>]}
[0m12:21:22.188105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3849d6f-d030-4dcf-95fd-56acf21615a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce401734e20>]}
[0m12:21:22.190926 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m12:21:22.234106 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:21:22.372547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:21:22.373329 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:21:22.382964 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m12:21:22.401929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3849d6f-d030-4dcf-95fd-56acf21615a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce3fab79930>]}
[0m12:21:22.472607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3849d6f-d030-4dcf-95fd-56acf21615a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce3fab7bac0>]}
[0m12:21:22.472996 [info ] [MainThread]: Found 6 models, 4 data tests, 421 macros
[0m12:21:22.473517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3849d6f-d030-4dcf-95fd-56acf21615a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce3fab7bbe0>]}
[0m12:21:22.475105 [info ] [MainThread]: 
[0m12:21:22.475524 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:21:22.479126 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:21:22.836637 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:21:22.837432 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:21:22.838138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:22.857326 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m12:21:22.858684 [debug] [ThreadPool]: On list_dev: Close
[0m12:21:22.861720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:21:22.862150 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:21:22.866422 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:21:22.866629 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:21:22.866980 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:22.878779 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m12:21:22.879557 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:21:22.879757 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:21:22.880203 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:21:22.880553 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:21:22.880980 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:21:22.881394 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:21:22.881890 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:21:22.882071 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:21:22.882385 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:21:22.882903 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:21:22.883133 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:21:22.884832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:21:22.890179 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:21:22.890635 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:21:22.891050 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:22.910083 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m12:21:22.910596 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:21:22.911228 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:21:22.926461 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m12:21:22.927176 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:21:22.927721 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:21:22.927896 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:21:22.930055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3849d6f-d030-4dcf-95fd-56acf21615a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce4009f0e50>]}
[0m12:21:22.930305 [debug] [MainThread]: Using duckdb connection "master"
[0m12:21:22.930613 [debug] [MainThread]: On master: BEGIN
[0m12:21:22.930906 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:21:22.944657 [debug] [MainThread]: SQL status: OK in 0.014 seconds
[0m12:21:22.945300 [debug] [MainThread]: On master: COMMIT
[0m12:21:22.945892 [debug] [MainThread]: Using duckdb connection "master"
[0m12:21:22.946380 [debug] [MainThread]: On master: COMMIT
[0m12:21:22.947141 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:21:22.947719 [debug] [MainThread]: On master: Close
[0m12:21:22.951094 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:21:22.951710 [info ] [MainThread]: 
[0m12:21:22.954312 [debug] [Thread-1 (]: Began running node model.transform.3_1
[0m12:21:22.955043 [info ] [Thread-1 (]: 1 of 6 START sql view model main.3_1 ........................................... [RUN]
[0m12:21:22.955757 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.3_1'
[0m12:21:22.956503 [debug] [Thread-1 (]: Began compiling node model.transform.3_1
[0m12:21:22.963346 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_1"
[0m12:21:22.965630 [debug] [Thread-1 (]: Began executing node model.transform.3_1
[0m12:21:22.982290 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_1"
[0m12:21:22.985025 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:21:22.985227 [debug] [Thread-1 (]: On model.transform.3_1: BEGIN
[0m12:21:22.985678 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:21:22.997141 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:21:22.997363 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:21:22.998012 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    strftime('%Y-%m', Date) AS mois,  -- Utilisation de strftime pour extraire l'année et le mois
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0))/2000 AS consommation_totale_en_GWH,
    SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,

    MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
FROM clean
GROUP BY strftime('%Y-%m', Date), "Région"  -- Remplacer TO_CHAR par strftime
ORDER BY mois, "Région"  -- Tri par mois et région
  );

[0m12:21:22.999132 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:21:23.002315 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:21:23.002535 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1" rename to "3_1__dbt_backup"
[0m12:21:23.003134 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:21:23.004648 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:21:23.004853 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1__dbt_tmp" rename to "3_1"
[0m12:21:23.005337 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:21:23.013527 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m12:21:23.013748 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:21:23.014100 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m12:21:23.018879 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:21:23.021354 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:21:23.021569 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
drop view if exists "dev"."main"."3_1__dbt_backup" cascade
[0m12:21:23.022417 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:21:23.023678 [debug] [Thread-1 (]: On model.transform.3_1: Close
[0m12:21:23.036876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3849d6f-d030-4dcf-95fd-56acf21615a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce3fab79750>]}
[0m12:21:23.037282 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.3_1 ...................................... [[32mOK[0m in 0.08s]
[0m12:21:23.037639 [debug] [Thread-1 (]: Finished running node model.transform.3_1
[0m12:21:23.037906 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m12:21:23.038249 [info ] [Thread-1 (]: 2 of 6 START sql view model main.clean ......................................... [RUN]
[0m12:21:23.038495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_1, now model.transform.clean)
[0m12:21:23.038745 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m12:21:23.039855 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m12:21:23.041064 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m12:21:23.042855 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m12:21:23.044050 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:21:23.044236 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m12:21:23.044524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:21:23.055558 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:21:23.055793 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:21:23.056399 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
            CASE
               WHEN "Consommation (MW)" = '' OR "Consommation (MW)" IS NULL THEN 0
               ELSE "Consommation (MW)"
           END AS "Consommation (MW)",

    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT "Code INSEE région",	"Région"	,	"Date",	"Heure",	
"Consommation (MW)"	,"Thermique (MW)",	"Nucléaire (MW)",	"Eolien (MW)",	"Solaire (MW)",	"Hydraulique (MW)",	"Pompage (MW)",	"Bioénergies (MW)",	"Ech. physiques (MW)","production_totale"

     FROM clean
  );

[0m12:21:23.056911 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
            CASE
               WHEN "Consommation (MW)" = '' OR "Consommation (MW)" IS NULL THEN 0
               ELSE "Consommation (MW)"
           END AS "Consommation (MW)",

    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT "Code INSEE région",	"Région"	,	"Date",	"Heure",	
"Consommation (MW)"	,"Thermique (MW)",	"Nucléaire (MW)",	"Eolien (MW)",	"Solaire (MW)",	"Hydraulique (MW)",	"Pompage (MW)",	"Bioénergies (MW)",	"Ech. physiques (MW)","production_totale"

     FROM clean
  );

[0m12:21:23.057128 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:21:23.057539 [debug] [Thread-1 (]: On model.transform.clean: ROLLBACK
[0m12:21:23.060502 [debug] [Thread-1 (]: Failed to rollback 'model.transform.clean'
[0m12:21:23.060707 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m12:21:23.062336 [debug] [Thread-1 (]: Runtime Error in model clean (models/example/clean.sql)
  Parser Error: syntax error at or near "CASE"
[0m12:21:23.062571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3849d6f-d030-4dcf-95fd-56acf21615a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce3f837da50>]}
[0m12:21:23.063012 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model main.clean ................................ [[31mERROR[0m in 0.02s]
[0m12:21:23.063306 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m12:21:23.063545 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m12:21:23.064320 [info ] [Thread-1 (]: 3 of 6 START sql view model main.grain_jour .................................... [RUN]
[0m12:21:23.064560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m12:21:23.064829 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m12:21:23.066371 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m12:21:23.067590 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m12:21:23.069308 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m12:21:23.070429 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:21:23.070616 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m12:21:23.070913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:21:23.081560 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:21:23.081777 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:21:23.082376 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS thermique_total,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS nucleaire_total,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS eolien_total,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS solaire_total,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS hydraulique_total,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS bioenergies_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_total,
    SUM(COALESCE(production_totale, 0)) AS production_totale
FROM clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m12:21:23.083287 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:21:23.084857 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:21:23.085058 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour" rename to "grain_jour__dbt_backup"
[0m12:21:23.085539 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:21:23.086938 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:21:23.087139 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour__dbt_tmp" rename to "grain_jour"
[0m12:21:23.087599 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:21:23.088396 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:21:23.088597 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:21:23.088881 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:21:23.093851 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:21:23.095059 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:21:23.095271 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
drop view if exists "dev"."main"."grain_jour__dbt_backup" cascade
[0m12:21:23.096026 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:21:23.096674 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m12:21:23.108744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3849d6f-d030-4dcf-95fd-56acf21615a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce3f837e3e0>]}
[0m12:21:23.109139 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.grain_jour ............................... [[32mOK[0m in 0.04s]
[0m12:21:23.109464 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m12:21:23.109725 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m12:21:23.110084 [info ] [Thread-1 (]: 4 of 6 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m12:21:23.110385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m12:21:23.110635 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m12:21:23.112162 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m12:21:23.113525 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m12:21:23.125224 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m12:21:23.126392 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:21:23.126614 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m12:21:23.126951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:21:23.137875 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:21:23.138164 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:21:23.138741 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m12:21:23.139316 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:21:23.141336 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:21:23.141565 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m12:21:23.142112 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:21:23.165278 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:21:23.165588 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m12:21:23.166441 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:21:23.169135 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:21:23.169367 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:21:23.169851 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:21:23.174503 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:21:23.175883 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:21:23.176115 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m12:21:23.176691 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:21:23.177407 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m12:21:23.192429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3849d6f-d030-4dcf-95fd-56acf21615a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce3f6fd07f0>]}
[0m12:21:23.192894 [info ] [Thread-1 (]: 4 of 6 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.08s]
[0m12:21:23.193233 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m12:21:23.193476 [debug] [Thread-1 (]: Began running node model.transform.3_2
[0m12:21:23.193792 [info ] [Thread-1 (]: 5 of 6 SKIP relation main.3_2 .................................................. [[33mSKIP[0m]
[0m12:21:23.194032 [debug] [Thread-1 (]: Finished running node model.transform.3_2
[0m12:21:23.194367 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m12:21:23.194628 [info ] [Thread-1 (]: 6 of 6 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m12:21:23.194903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.my_second_dbt_model)
[0m12:21:23.195126 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m12:21:23.196981 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m12:21:23.197979 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m12:21:23.200367 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m12:21:23.201425 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:21:23.201712 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m12:21:23.201961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:21:23.213277 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:21:23.213711 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:21:23.214082 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m12:21:23.214888 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:21:23.218226 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:21:23.218507 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m12:21:23.218995 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:21:23.220479 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:21:23.220688 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m12:21:23.221027 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:21:23.221831 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:21:23.222029 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:21:23.222273 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:21:23.226691 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:21:23.229083 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:21:23.229438 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m12:21:23.230319 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:21:23.231373 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m12:21:23.243686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3849d6f-d030-4dcf-95fd-56acf21615a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce3fb56c910>]}
[0m12:21:23.244133 [info ] [Thread-1 (]: 6 of 6 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m12:21:23.244506 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m12:21:23.245495 [debug] [MainThread]: Using duckdb connection "master"
[0m12:21:23.245704 [debug] [MainThread]: On master: BEGIN
[0m12:21:23.246004 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:21:23.256675 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m12:21:23.256990 [debug] [MainThread]: On master: COMMIT
[0m12:21:23.257305 [debug] [MainThread]: Using duckdb connection "master"
[0m12:21:23.257575 [debug] [MainThread]: On master: COMMIT
[0m12:21:23.257988 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:21:23.258266 [debug] [MainThread]: On master: Close
[0m12:21:23.259801 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:21:23.260165 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m12:21:23.260432 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m12:21:23.260827 [info ] [MainThread]: 
[0m12:21:23.261173 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m12:21:23.262359 [debug] [MainThread]: Command end result
[0m12:21:23.285595 [info ] [MainThread]: 
[0m12:21:23.285894 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:21:23.286070 [info ] [MainThread]: 
[0m12:21:23.286313 [error] [MainThread]:   Runtime Error in model clean (models/example/clean.sql)
  Parser Error: syntax error at or near "CASE"
[0m12:21:23.286481 [info ] [MainThread]: 
[0m12:21:23.286692 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
[0m12:21:23.287134 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3011719, "process_in_blocks": "11200", "process_kernel_time": 0.158567, "process_mem_max_rss": "139460", "process_out_blocks": "8528", "process_user_time": 1.454372}
[0m12:21:23.287432 [debug] [MainThread]: Command `dbt run` failed at 12:21:23.287382 after 1.30 seconds
[0m12:21:23.287641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce402387c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce401734e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce3f7997af0>]}
[0m12:21:23.287869 [debug] [MainThread]: Flushing usage events
[0m12:22:27.522162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f327708fc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32774c71f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32774c7310>]}


============================== 12:22:27.525313 | 191602fa-be94-4447-849c-451ed9a8aff3 ==============================
[0m12:22:27.525313 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:22:27.526037 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:22:27.665849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '191602fa-be94-4447-849c-451ed9a8aff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3271756950>]}
[0m12:22:27.694972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '191602fa-be94-4447-849c-451ed9a8aff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32759820b0>]}
[0m12:22:27.697873 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m12:22:27.739132 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:22:27.875450 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:22:27.876210 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:22:27.886290 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m12:22:27.905189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '191602fa-be94-4447-849c-451ed9a8aff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f326ef7dd80>]}
[0m12:22:27.977392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '191602fa-be94-4447-849c-451ed9a8aff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f326ef0acb0>]}
[0m12:22:27.978214 [info ] [MainThread]: Found 7 models, 4 data tests, 421 macros
[0m12:22:27.978843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '191602fa-be94-4447-849c-451ed9a8aff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f326ef0a890>]}
[0m12:22:27.982043 [info ] [MainThread]: 
[0m12:22:27.983082 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:22:27.992715 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:22:28.388864 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:22:28.389631 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:22:28.390231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:28.407998 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m12:22:28.409200 [debug] [ThreadPool]: On list_dev: Close
[0m12:22:28.412133 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:22:28.412532 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:22:28.416617 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:22:28.416834 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:22:28.417250 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:22:28.428983 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m12:22:28.429823 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:22:28.430067 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:22:28.430528 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:22:28.430706 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:22:28.431038 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:22:28.431510 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:22:28.431946 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:22:28.432106 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:22:28.432418 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:22:28.432812 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:22:28.433056 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:22:28.434686 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:22:28.437566 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:22:28.437757 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:22:28.438169 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:22:28.449030 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m12:22:28.449265 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:22:28.449803 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:22:28.463454 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m12:22:28.464119 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:22:28.464669 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:22:28.464839 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:22:28.466970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '191602fa-be94-4447-849c-451ed9a8aff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f326efaca60>]}
[0m12:22:28.467219 [debug] [MainThread]: Using duckdb connection "master"
[0m12:22:28.467481 [debug] [MainThread]: On master: BEGIN
[0m12:22:28.467767 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:22:28.478680 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m12:22:28.478943 [debug] [MainThread]: On master: COMMIT
[0m12:22:28.479466 [debug] [MainThread]: Using duckdb connection "master"
[0m12:22:28.479833 [debug] [MainThread]: On master: COMMIT
[0m12:22:28.480273 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:22:28.480518 [debug] [MainThread]: On master: Close
[0m12:22:28.481992 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:22:28.482320 [info ] [MainThread]: 
[0m12:22:28.484285 [debug] [Thread-1 (]: Began running node model.transform.3_1
[0m12:22:28.485279 [info ] [Thread-1 (]: 1 of 7 START sql view model main.3_1 ........................................... [RUN]
[0m12:22:28.486276 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.3_1'
[0m12:22:28.487024 [debug] [Thread-1 (]: Began compiling node model.transform.3_1
[0m12:22:28.494479 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_1"
[0m12:22:28.496527 [debug] [Thread-1 (]: Began executing node model.transform.3_1
[0m12:22:28.513710 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_1"
[0m12:22:28.515663 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:22:28.515877 [debug] [Thread-1 (]: On model.transform.3_1: BEGIN
[0m12:22:28.516182 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:22:28.527499 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:22:28.527720 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:22:28.528082 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    strftime('%Y-%m', Date) AS mois,  -- Utilisation de strftime pour extraire l'année et le mois
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0))/2000 AS consommation_totale_en_GWH,
    SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,

    MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
FROM clean
GROUP BY strftime('%Y-%m', Date), "Région"  -- Remplacer TO_CHAR par strftime
ORDER BY mois, "Région"  -- Tri par mois et région
  );

[0m12:22:28.528956 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:22:28.532082 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:22:28.532302 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1" rename to "3_1__dbt_backup"
[0m12:22:28.532814 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:28.534195 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:22:28.534390 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1__dbt_tmp" rename to "3_1"
[0m12:22:28.534809 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:28.542762 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m12:22:28.542987 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:22:28.543348 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m12:22:28.545215 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:22:28.547602 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:22:28.547816 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
drop view if exists "dev"."main"."3_1__dbt_backup" cascade
[0m12:22:28.548621 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:28.549881 [debug] [Thread-1 (]: On model.transform.3_1: Close
[0m12:22:28.563026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '191602fa-be94-4447-849c-451ed9a8aff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f326efa5960>]}
[0m12:22:28.563442 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.3_1 ...................................... [[32mOK[0m in 0.08s]
[0m12:22:28.563762 [debug] [Thread-1 (]: Finished running node model.transform.3_1
[0m12:22:28.564019 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m12:22:28.564335 [info ] [Thread-1 (]: 2 of 7 START sql view model main.clean ......................................... [RUN]
[0m12:22:28.564574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_1, now model.transform.clean)
[0m12:22:28.564857 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m12:22:28.565965 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m12:22:28.567121 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m12:22:28.568972 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m12:22:28.570196 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:22:28.570383 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m12:22:28.570687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:28.581683 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:22:28.581911 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:22:28.582565 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT "Code INSEE région",	"Région"	,	"Date",	"Heure",	
"Consommation (MW)"	,"Thermique (MW)",	"Nucléaire (MW)",	"Eolien (MW)",	"Solaire (MW)",	"Hydraulique (MW)",	"Pompage (MW)",	"Bioénergies (MW)",	"Ech. physiques (MW)","production_totale"

     FROM clean
  );

[0m12:22:28.583352 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:28.585321 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:22:28.585529 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m12:22:28.585999 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:28.587373 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:22:28.587574 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m12:22:28.588174 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:28.589008 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:22:28.589212 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:22:28.589503 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:22:28.591337 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:22:28.592444 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:22:28.592641 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m12:22:28.593415 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:28.594052 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m12:22:28.606311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '191602fa-be94-4447-849c-451ed9a8aff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f326b321990>]}
[0m12:22:28.606662 [info ] [Thread-1 (]: 2 of 7 OK created sql view model main.clean .................................... [[32mOK[0m in 0.04s]
[0m12:22:28.606976 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m12:22:28.607233 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m12:22:28.607693 [info ] [Thread-1 (]: 3 of 7 START sql view model main.grain_jour .................................... [RUN]
[0m12:22:28.607964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m12:22:28.608237 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m12:22:28.609295 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m12:22:28.610814 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m12:22:28.612589 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m12:22:28.613837 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:22:28.614045 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m12:22:28.614349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:28.627215 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m12:22:28.627592 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:22:28.628117 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS thermique_total,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS nucleaire_total,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS eolien_total,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS solaire_total,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS hydraulique_total,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS bioenergies_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_total,
    SUM(COALESCE(production_totale, 0)) AS production_totale
FROM clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m12:22:28.629328 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:22:28.631277 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:22:28.631503 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour" rename to "grain_jour__dbt_backup"
[0m12:22:28.632077 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:28.633592 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:22:28.633800 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour__dbt_tmp" rename to "grain_jour"
[0m12:22:28.634392 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:28.635203 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:22:28.635402 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:22:28.635703 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:22:28.637971 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:22:28.639178 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:22:28.639392 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
drop view if exists "dev"."main"."grain_jour__dbt_backup" cascade
[0m12:22:28.640281 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:22:28.641583 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m12:22:28.654205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '191602fa-be94-4447-849c-451ed9a8aff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f326b378250>]}
[0m12:22:28.654599 [info ] [Thread-1 (]: 3 of 7 OK created sql view model main.grain_jour ............................... [[32mOK[0m in 0.05s]
[0m12:22:28.654918 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m12:22:28.655145 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m12:22:28.655480 [info ] [Thread-1 (]: 4 of 7 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m12:22:28.655733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m12:22:28.656094 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m12:22:28.678446 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m12:22:28.679867 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m12:22:28.689528 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m12:22:28.690874 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:22:28.691090 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m12:22:28.691405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:28.702068 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:22:28.702291 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:22:28.702822 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m12:22:28.703480 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:28.704948 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:22:28.705155 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m12:22:28.705652 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:28.707113 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:22:28.707321 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m12:22:28.707875 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:28.710421 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:22:28.710636 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:22:28.710907 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:22:28.712489 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:22:28.713720 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:22:28.713923 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m12:22:28.714723 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:28.715431 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m12:22:28.730137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '191602fa-be94-4447-849c-451ed9a8aff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f326b3693c0>]}
[0m12:22:28.730522 [info ] [Thread-1 (]: 4 of 7 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.07s]
[0m12:22:28.730830 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m12:22:28.731117 [debug] [Thread-1 (]: Began running node model.transform.test
[0m12:22:28.731517 [info ] [Thread-1 (]: 5 of 7 START sql view model main.test .......................................... [RUN]
[0m12:22:28.731764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.test)
[0m12:22:28.731955 [debug] [Thread-1 (]: Began compiling node model.transform.test
[0m12:22:28.732935 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.test"
[0m12:22:28.734343 [debug] [Thread-1 (]: Began executing node model.transform.test
[0m12:22:28.736667 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.test"
[0m12:22:28.739440 [debug] [Thread-1 (]: Using duckdb connection "model.transform.test"
[0m12:22:28.739630 [debug] [Thread-1 (]: On model.transform.test: BEGIN
[0m12:22:28.739936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:28.750974 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:22:28.751268 [debug] [Thread-1 (]: Using duckdb connection "model.transform.test"
[0m12:22:28.751852 [debug] [Thread-1 (]: On model.transform.test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.test"} */

  
  create view "dev"."main"."test__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           -- Traitement de la colonne "Consommation (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Consommation (MW)" = '' OR "Consommation (MW)" IS NULL THEN 0
               ELSE "Consommation (MW)"
           END AS "Consommation (MW)",
           
           -- Traitement de la colonne "Eolien (MW)" : remplacer 'ND' par 0
           CASE
               WHEN "Eolien (MW)" = 'ND' OR "Eolien (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Eolien (MW)" AS INT)
           END AS "Eolien (MW)",
           
           -- Traitement de la colonne "Thermique (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Thermique (MW)" = '' OR "Thermique (MW)" IS NULL THEN 0
               ELSE "Thermique (MW)"
           END AS "Thermique (MW)",

           -- Traitement de la colonne "Bioénergies (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Bioénergies (MW)" = '' OR "Bioénergies (MW)" IS NULL THEN 0
               ELSE "Bioénergies (MW)"
           END AS "Bioénergies (MW)",

           -- Traitement des autres colonnes : remplacer les vides par 0
           COALESCE("Nucléaire (MW)", 0) AS "Nucléaire (MW)",
           COALESCE("Solaire (MW)", 0) AS "Solaire (MW)",
           COALESCE("Hydraulique (MW)", 0) AS "Hydraulique (MW)",
           COALESCE("Pompage (MW)", 0) AS "Pompage (MW)",
           COALESCE("Ech. physiques (MW)", 0) AS "Ech. physiques (MW)"
    FROM eco2
    WHERE "Région" IS NOT NULL AND "Date" IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE("Nucléaire (MW)", 0) + 
           COALESCE("Eolien (MW)", 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Code INSEE région",
    "Région", 
    "Date", 
    "Heure", 
    "Consommation (MW)",
    "Thermique (MW)",
    "Nucléaire (MW)",
    "Eolien (MW)",
    "Solaire (MW)",
    "Hydraulique (MW)",
    "Pompage (MW)",
    "Bioénergies (MW)",
    "Ech. physiques (MW)",
    production_totale
FROM clean;
  );

[0m12:22:28.752418 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.test"} */

  
  create view "dev"."main"."test__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           -- Traitement de la colonne "Consommation (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Consommation (MW)" = '' OR "Consommation (MW)" IS NULL THEN 0
               ELSE "Consommation (MW)"
           END AS "Consommation (MW)",
           
           -- Traitement de la colonne "Eolien (MW)" : remplacer 'ND' par 0
           CASE
               WHEN "Eolien (MW)" = 'ND' OR "Eolien (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Eolien (MW)" AS INT)
           END AS "Eolien (MW)",
           
           -- Traitement de la colonne "Thermique (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Thermique (MW)" = '' OR "Thermique (MW)" IS NULL THEN 0
               ELSE "Thermique (MW)"
           END AS "Thermique (MW)",

           -- Traitement de la colonne "Bioénergies (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Bioénergies (MW)" = '' OR "Bioénergies (MW)" IS NULL THEN 0
               ELSE "Bioénergies (MW)"
           END AS "Bioénergies (MW)",

           -- Traitement des autres colonnes : remplacer les vides par 0
           COALESCE("Nucléaire (MW)", 0) AS "Nucléaire (MW)",
           COALESCE("Solaire (MW)", 0) AS "Solaire (MW)",
           COALESCE("Hydraulique (MW)", 0) AS "Hydraulique (MW)",
           COALESCE("Pompage (MW)", 0) AS "Pompage (MW)",
           COALESCE("Ech. physiques (MW)", 0) AS "Ech. physiques (MW)"
    FROM eco2
    WHERE "Région" IS NOT NULL AND "Date" IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE("Nucléaire (MW)", 0) + 
           COALESCE("Eolien (MW)", 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Code INSEE région",
    "Région", 
    "Date", 
    "Heure", 
    "Consommation (MW)",
    "Thermique (MW)",
    "Nucléaire (MW)",
    "Eolien (MW)",
    "Solaire (MW)",
    "Hydraulique (MW)",
    "Pompage (MW)",
    "Bioénergies (MW)",
    "Ech. physiques (MW)",
    production_totale
FROM clean;
  );

[0m12:22:28.752711 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:22:28.753215 [debug] [Thread-1 (]: On model.transform.test: ROLLBACK
[0m12:22:28.756224 [debug] [Thread-1 (]: Failed to rollback 'model.transform.test'
[0m12:22:28.756456 [debug] [Thread-1 (]: On model.transform.test: Close
[0m12:22:28.758468 [debug] [Thread-1 (]: Runtime Error in model test (models/test.sql)
  Parser Error: syntax error at or near ";"
[0m12:22:28.758829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '191602fa-be94-4447-849c-451ed9a8aff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f326c79f610>]}
[0m12:22:28.759319 [error] [Thread-1 (]: 5 of 7 ERROR creating sql view model main.test ................................. [[31mERROR[0m in 0.03s]
[0m12:22:28.759626 [debug] [Thread-1 (]: Finished running node model.transform.test
[0m12:22:28.759900 [debug] [Thread-1 (]: Began running node model.transform.3_2
[0m12:22:28.760627 [info ] [Thread-1 (]: 6 of 7 START sql view model main.3_2 ........................................... [RUN]
[0m12:22:28.760936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.test, now model.transform.3_2)
[0m12:22:28.761216 [debug] [Thread-1 (]: Began compiling node model.transform.3_2
[0m12:22:28.763732 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_2"
[0m12:22:28.765054 [debug] [Thread-1 (]: Began executing node model.transform.3_2
[0m12:22:28.766896 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_2"
[0m12:22:28.768167 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:22:28.768364 [debug] [Thread-1 (]: On model.transform.3_2: BEGIN
[0m12:22:28.768674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:28.779505 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:22:28.779728 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:22:28.780400 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */

  
  create view "dev"."main"."3_2__dbt_tmp" as (
    -- Récupérer les régions distinctes dans un set Jinja


SELECT 
    Date,
    
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bourgogne-Franche-Comté' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bourgogne-Franche-Comté"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Centre-Val de Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Centre-Val de Loire"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Nouvelle-Aquitaine' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Nouvelle-Aquitaine"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Occitanie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Occitanie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Île-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Île-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Normandie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Normandie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Grand Est' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Grand Est"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Provence-Alpes-Côte d''Azur' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Provence-Alpes-Côte d''Azur"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bretagne' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bretagne"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Hauts-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Hauts-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Auvergne-Rhône-Alpes' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Auvergne-Rhône-Alpes"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Pays de la Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Pays de la Loire"
        
    
    
FROM 
    "dev"."main"."clean"
GROUP BY 
    Date
ORDER BY 
    Date
  );

[0m12:22:28.781541 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:22:28.783109 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:22:28.783313 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
alter view "dev"."main"."3_2" rename to "3_2__dbt_backup"
[0m12:22:28.783800 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:28.785256 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:22:28.785462 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
alter view "dev"."main"."3_2__dbt_tmp" rename to "3_2"
[0m12:22:28.786085 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:28.786921 [debug] [Thread-1 (]: On model.transform.3_2: COMMIT
[0m12:22:28.787118 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:22:28.787504 [debug] [Thread-1 (]: On model.transform.3_2: COMMIT
[0m12:22:28.789694 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:22:28.790865 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:22:28.791068 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
drop view if exists "dev"."main"."3_2__dbt_backup" cascade
[0m12:22:28.791831 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:28.792468 [debug] [Thread-1 (]: On model.transform.3_2: Close
[0m12:22:28.804518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '191602fa-be94-4447-849c-451ed9a8aff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f326c78a710>]}
[0m12:22:28.804887 [info ] [Thread-1 (]: 6 of 7 OK created sql view model main.3_2 ...................................... [[32mOK[0m in 0.04s]
[0m12:22:28.805188 [debug] [Thread-1 (]: Finished running node model.transform.3_2
[0m12:22:28.805434 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m12:22:28.805757 [info ] [Thread-1 (]: 7 of 7 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m12:22:28.806030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_2, now model.transform.my_second_dbt_model)
[0m12:22:28.806293 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m12:22:28.807794 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m12:22:28.809009 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m12:22:28.812185 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m12:22:28.813402 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:22:28.813595 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m12:22:28.813887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:28.824719 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:22:28.824969 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:22:28.825590 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m12:22:28.826153 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:28.827736 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:22:28.827947 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m12:22:28.828413 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:28.829882 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:22:28.830088 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m12:22:28.830617 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:28.831411 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:22:28.831612 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:22:28.831914 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:22:28.833559 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:22:28.834761 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:22:28.834968 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m12:22:28.835731 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:28.836379 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m12:22:28.848505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '191602fa-be94-4447-849c-451ed9a8aff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f326c789d20>]}
[0m12:22:28.848881 [info ] [Thread-1 (]: 7 of 7 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m12:22:28.849230 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m12:22:28.850055 [debug] [MainThread]: Using duckdb connection "master"
[0m12:22:28.850269 [debug] [MainThread]: On master: BEGIN
[0m12:22:28.850580 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:22:28.861300 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m12:22:28.861511 [debug] [MainThread]: On master: COMMIT
[0m12:22:28.862036 [debug] [MainThread]: Using duckdb connection "master"
[0m12:22:28.862394 [debug] [MainThread]: On master: COMMIT
[0m12:22:28.862799 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:22:28.862984 [debug] [MainThread]: On master: Close
[0m12:22:28.864147 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:22:28.864339 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m12:22:28.864637 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m12:22:28.865009 [info ] [MainThread]: 
[0m12:22:28.865259 [info ] [MainThread]: Finished running 6 view models, 1 table model in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m12:22:28.866073 [debug] [MainThread]: Command end result
[0m12:22:28.887477 [info ] [MainThread]: 
[0m12:22:28.887756 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:22:28.888240 [info ] [MainThread]: 
[0m12:22:28.888585 [error] [MainThread]:   Runtime Error in model test (models/test.sql)
  Parser Error: syntax error at or near ";"
[0m12:22:28.888854 [info ] [MainThread]: 
[0m12:22:28.889228 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m12:22:28.889738 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3954201, "process_in_blocks": "13440", "process_kernel_time": 0.17221, "process_mem_max_rss": "139524", "process_out_blocks": "11232", "process_user_time": 1.38465}
[0m12:22:28.890087 [debug] [MainThread]: Command `dbt run` failed at 12:22:28.890025 after 1.40 seconds
[0m12:22:28.890305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f327708fc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3276438df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f326ef8ce80>]}
[0m12:22:28.890671 [debug] [MainThread]: Flushing usage events
[0m12:22:44.813132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70986989bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709869cd71f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709869cd7310>]}


============================== 12:22:44.814746 | c9989c4f-5c13-49a2-88d8-030644c6d801 ==============================
[0m12:22:44.814746 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:22:44.815135 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:22:44.928144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9989c4f-5c13-49a2-88d8-030644c6d801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709863f62950>]}
[0m12:22:44.955589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9989c4f-5c13-49a2-88d8-030644c6d801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70986818a0b0>]}
[0m12:22:44.957720 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m12:22:44.997615 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:22:45.119403 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:22:45.120554 [debug] [MainThread]: Partial parsing: updated file: transform://models/test.sql
[0m12:22:45.248043 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m12:22:45.250696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9989c4f-5c13-49a2-88d8-030644c6d801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709860dd4580>]}
[0m12:22:45.310838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9989c4f-5c13-49a2-88d8-030644c6d801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709860dc38e0>]}
[0m12:22:45.311231 [info ] [MainThread]: Found 7 models, 4 data tests, 421 macros
[0m12:22:45.311841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9989c4f-5c13-49a2-88d8-030644c6d801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709860dc2f80>]}
[0m12:22:45.313461 [info ] [MainThread]: 
[0m12:22:45.313993 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:22:45.319603 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:22:45.546077 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:22:45.547089 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:22:45.547934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:45.572661 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m12:22:45.575055 [debug] [ThreadPool]: On list_dev: Close
[0m12:22:45.579594 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:22:45.580363 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:22:45.586170 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:22:45.586425 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:22:45.586824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:22:45.599069 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m12:22:45.600025 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:22:45.600298 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:22:45.600767 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:22:45.601027 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:22:45.601403 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:22:45.601883 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:22:45.602393 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:22:45.602604 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:22:45.602918 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:22:45.603399 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:22:45.603602 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:22:45.605466 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:22:45.608464 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:22:45.608670 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:22:45.609024 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:22:45.619959 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m12:22:45.620187 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:22:45.620719 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:22:45.635001 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m12:22:45.635684 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:22:45.636335 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:22:45.636525 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:22:45.638463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9989c4f-5c13-49a2-88d8-030644c6d801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7098699deda0>]}
[0m12:22:45.638705 [debug] [MainThread]: Using duckdb connection "master"
[0m12:22:45.638943 [debug] [MainThread]: On master: BEGIN
[0m12:22:45.639238 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:22:45.650448 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m12:22:45.650694 [debug] [MainThread]: On master: COMMIT
[0m12:22:45.651279 [debug] [MainThread]: Using duckdb connection "master"
[0m12:22:45.651638 [debug] [MainThread]: On master: COMMIT
[0m12:22:45.652194 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:22:45.652444 [debug] [MainThread]: On master: Close
[0m12:22:45.654011 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:22:45.654340 [info ] [MainThread]: 
[0m12:22:45.656326 [debug] [Thread-1 (]: Began running node model.transform.3_1
[0m12:22:45.657292 [info ] [Thread-1 (]: 1 of 7 START sql view model main.3_1 ........................................... [RUN]
[0m12:22:45.658291 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.3_1'
[0m12:22:45.659022 [debug] [Thread-1 (]: Began compiling node model.transform.3_1
[0m12:22:45.668841 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_1"
[0m12:22:45.670709 [debug] [Thread-1 (]: Began executing node model.transform.3_1
[0m12:22:45.688667 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_1"
[0m12:22:45.690132 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:22:45.690343 [debug] [Thread-1 (]: On model.transform.3_1: BEGIN
[0m12:22:45.690683 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:22:45.702304 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m12:22:45.702536 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:22:45.703101 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    strftime('%Y-%m', Date) AS mois,  -- Utilisation de strftime pour extraire l'année et le mois
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0))/2000 AS consommation_totale_en_GWH,
    SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,

    MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
FROM clean
GROUP BY strftime('%Y-%m', Date), "Région"  -- Remplacer TO_CHAR par strftime
ORDER BY mois, "Région"  -- Tri par mois et région
  );

[0m12:22:45.704001 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:22:45.707680 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:22:45.707906 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1" rename to "3_1__dbt_backup"
[0m12:22:45.708388 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:45.731171 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:22:45.731458 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1__dbt_tmp" rename to "3_1"
[0m12:22:45.732264 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:45.740634 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m12:22:45.740865 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:22:45.741482 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m12:22:45.743424 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:22:45.745979 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:22:45.746199 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
drop view if exists "dev"."main"."3_1__dbt_backup" cascade
[0m12:22:45.746995 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:45.748295 [debug] [Thread-1 (]: On model.transform.3_1: Close
[0m12:22:45.761074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9989c4f-5c13-49a2-88d8-030644c6d801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7098699deda0>]}
[0m12:22:45.761478 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.3_1 ...................................... [[32mOK[0m in 0.10s]
[0m12:22:45.761801 [debug] [Thread-1 (]: Finished running node model.transform.3_1
[0m12:22:45.762053 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m12:22:45.762412 [info ] [Thread-1 (]: 2 of 7 START sql view model main.clean ......................................... [RUN]
[0m12:22:45.762688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_1, now model.transform.clean)
[0m12:22:45.762956 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m12:22:45.764034 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m12:22:45.765199 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m12:22:45.767148 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m12:22:45.768360 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:22:45.768556 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m12:22:45.768835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:45.779756 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:22:45.779993 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:22:45.780522 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT "Code INSEE région",	"Région"	,	"Date",	"Heure",	
"Consommation (MW)"	,"Thermique (MW)",	"Nucléaire (MW)",	"Eolien (MW)",	"Solaire (MW)",	"Hydraulique (MW)",	"Pompage (MW)",	"Bioénergies (MW)",	"Ech. physiques (MW)","production_totale"

     FROM clean
  );

[0m12:22:45.781457 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:45.783113 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:22:45.783318 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m12:22:45.783810 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:45.785229 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:22:45.785433 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m12:22:45.785925 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:45.786724 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:22:45.786921 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:22:45.787232 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:22:45.789299 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:22:45.791400 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:22:45.791649 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m12:22:45.792434 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:45.793111 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m12:22:45.805362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9989c4f-5c13-49a2-88d8-030644c6d801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709863f504f0>]}
[0m12:22:45.805766 [info ] [Thread-1 (]: 2 of 7 OK created sql view model main.clean .................................... [[32mOK[0m in 0.04s]
[0m12:22:45.806115 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m12:22:45.806370 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m12:22:45.806787 [info ] [Thread-1 (]: 3 of 7 START sql view model main.grain_jour .................................... [RUN]
[0m12:22:45.807060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m12:22:45.807338 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m12:22:45.808396 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m12:22:45.809683 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m12:22:45.811979 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m12:22:45.813326 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:22:45.813668 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m12:22:45.813937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:45.825863 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m12:22:45.826210 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:22:45.826807 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS thermique_total,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS nucleaire_total,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS eolien_total,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS solaire_total,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS hydraulique_total,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS bioenergies_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_total,
    SUM(COALESCE(production_totale, 0)) AS production_totale
FROM clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m12:22:45.827880 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:22:45.829934 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:22:45.830184 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour" rename to "grain_jour__dbt_backup"
[0m12:22:45.830706 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:45.832189 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:22:45.832403 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour__dbt_tmp" rename to "grain_jour"
[0m12:22:45.832944 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:45.833836 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:22:45.834040 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:22:45.834348 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:22:45.836639 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:22:45.837807 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:22:45.838001 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
drop view if exists "dev"."main"."grain_jour__dbt_backup" cascade
[0m12:22:45.838725 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:45.839386 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m12:22:45.851089 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9989c4f-5c13-49a2-88d8-030644c6d801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70985db521a0>]}
[0m12:22:45.851454 [info ] [Thread-1 (]: 3 of 7 OK created sql view model main.grain_jour ............................... [[32mOK[0m in 0.04s]
[0m12:22:45.851872 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m12:22:45.852127 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m12:22:45.852468 [info ] [Thread-1 (]: 4 of 7 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m12:22:45.852712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m12:22:45.852972 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m12:22:45.854572 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m12:22:45.855690 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m12:22:45.866181 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m12:22:45.867459 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:22:45.867667 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m12:22:45.867981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:45.878558 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:22:45.878811 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:22:45.879312 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m12:22:45.879997 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:45.881519 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:22:45.881729 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m12:22:45.882199 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:45.883703 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:22:45.883926 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m12:22:45.884430 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:45.887031 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:22:45.887248 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:22:45.887594 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:22:45.889253 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:22:45.890436 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:22:45.890645 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m12:22:45.891452 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:45.892166 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m12:22:45.907722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9989c4f-5c13-49a2-88d8-030644c6d801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709862b90970>]}
[0m12:22:45.908131 [info ] [Thread-1 (]: 4 of 7 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m12:22:45.908446 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m12:22:45.908817 [debug] [Thread-1 (]: Began running node model.transform.test
[0m12:22:45.909186 [info ] [Thread-1 (]: 5 of 7 START sql view model main.test .......................................... [RUN]
[0m12:22:45.909441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.test)
[0m12:22:45.909719 [debug] [Thread-1 (]: Began compiling node model.transform.test
[0m12:22:45.910808 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.test"
[0m12:22:45.912013 [debug] [Thread-1 (]: Began executing node model.transform.test
[0m12:22:45.913868 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.test"
[0m12:22:45.915217 [debug] [Thread-1 (]: Using duckdb connection "model.transform.test"
[0m12:22:45.915416 [debug] [Thread-1 (]: On model.transform.test: BEGIN
[0m12:22:45.915711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:45.926412 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:22:45.926653 [debug] [Thread-1 (]: Using duckdb connection "model.transform.test"
[0m12:22:45.927229 [debug] [Thread-1 (]: On model.transform.test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.test"} */

  
  create view "dev"."main"."test__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           -- Traitement de la colonne "Consommation (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Consommation (MW)" = '' OR "Consommation (MW)" IS NULL THEN 0
               ELSE "Consommation (MW)"
           END AS "Consommation (MW)",
           
           -- Traitement de la colonne "Eolien (MW)" : remplacer 'ND' par 0
           CASE
               WHEN "Eolien (MW)" = 'ND' OR "Eolien (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Eolien (MW)" AS INT)
           END AS "Eolien (MW)",
           
           -- Traitement de la colonne "Thermique (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Thermique (MW)" = '' OR "Thermique (MW)" IS NULL THEN 0
               ELSE "Thermique (MW)"
           END AS "Thermique (MW)",

           -- Traitement de la colonne "Bioénergies (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Bioénergies (MW)" = '' OR "Bioénergies (MW)" IS NULL THEN 0
               ELSE "Bioénergies (MW)"
           END AS "Bioénergies (MW)",

           -- Traitement des autres colonnes : remplacer les vides par 0
           COALESCE("Nucléaire (MW)", 0) AS "Nucléaire (MW)",
           COALESCE("Solaire (MW)", 0) AS "Solaire (MW)",
           COALESCE("Hydraulique (MW)", 0) AS "Hydraulique (MW)",
           COALESCE("Pompage (MW)", 0) AS "Pompage (MW)",
           COALESCE("Ech. physiques (MW)", 0) AS "Ech. physiques (MW)"
    FROM eco2
    WHERE "Région" IS NOT NULL AND "Date" IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE("Nucléaire (MW)", 0) + 
           COALESCE("Eolien (MW)", 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Code INSEE région",
    "Région", 
    "Date", 
    "Heure", 
    "Consommation (MW)",
    "Thermique (MW)",
    "Nucléaire (MW)",
    "Eolien (MW)",
    "Solaire (MW)",
    "Hydraulique (MW)",
    "Pompage (MW)",
    "Bioénergies (MW)",
    "Ech. physiques (MW)",
    production_totale
FROM clean
  );

[0m12:22:45.928195 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.test"} */

  
  create view "dev"."main"."test__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           -- Traitement de la colonne "Consommation (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Consommation (MW)" = '' OR "Consommation (MW)" IS NULL THEN 0
               ELSE "Consommation (MW)"
           END AS "Consommation (MW)",
           
           -- Traitement de la colonne "Eolien (MW)" : remplacer 'ND' par 0
           CASE
               WHEN "Eolien (MW)" = 'ND' OR "Eolien (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Eolien (MW)" AS INT)
           END AS "Eolien (MW)",
           
           -- Traitement de la colonne "Thermique (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Thermique (MW)" = '' OR "Thermique (MW)" IS NULL THEN 0
               ELSE "Thermique (MW)"
           END AS "Thermique (MW)",

           -- Traitement de la colonne "Bioénergies (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Bioénergies (MW)" = '' OR "Bioénergies (MW)" IS NULL THEN 0
               ELSE "Bioénergies (MW)"
           END AS "Bioénergies (MW)",

           -- Traitement des autres colonnes : remplacer les vides par 0
           COALESCE("Nucléaire (MW)", 0) AS "Nucléaire (MW)",
           COALESCE("Solaire (MW)", 0) AS "Solaire (MW)",
           COALESCE("Hydraulique (MW)", 0) AS "Hydraulique (MW)",
           COALESCE("Pompage (MW)", 0) AS "Pompage (MW)",
           COALESCE("Ech. physiques (MW)", 0) AS "Ech. physiques (MW)"
    FROM eco2
    WHERE "Région" IS NOT NULL AND "Date" IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE("Nucléaire (MW)", 0) + 
           COALESCE("Eolien (MW)", 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Code INSEE région",
    "Région", 
    "Date", 
    "Heure", 
    "Consommation (MW)",
    "Thermique (MW)",
    "Nucléaire (MW)",
    "Eolien (MW)",
    "Solaire (MW)",
    "Hydraulique (MW)",
    "Pompage (MW)",
    "Bioénergies (MW)",
    "Ech. physiques (MW)",
    production_totale
FROM clean
  );

[0m12:22:45.928474 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:22:45.928857 [debug] [Thread-1 (]: On model.transform.test: ROLLBACK
[0m12:22:45.931869 [debug] [Thread-1 (]: Failed to rollback 'model.transform.test'
[0m12:22:45.932076 [debug] [Thread-1 (]: On model.transform.test: Close
[0m12:22:45.933665 [debug] [Thread-1 (]: Runtime Error in model test (models/test.sql)
  Binder Error: Cannot mix values of type VARCHAR and INTEGER_LITERAL in COALESCE operator - an explicit cast is required
[0m12:22:45.933933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9989c4f-5c13-49a2-88d8-030644c6d801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709863f504f0>]}
[0m12:22:45.934397 [error] [Thread-1 (]: 5 of 7 ERROR creating sql view model main.test ................................. [[31mERROR[0m in 0.02s]
[0m12:22:45.934719 [debug] [Thread-1 (]: Finished running node model.transform.test
[0m12:22:45.934967 [debug] [Thread-1 (]: Began running node model.transform.3_2
[0m12:22:45.935764 [info ] [Thread-1 (]: 6 of 7 START sql view model main.3_2 ........................................... [RUN]
[0m12:22:45.936049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.test, now model.transform.3_2)
[0m12:22:45.936298 [debug] [Thread-1 (]: Began compiling node model.transform.3_2
[0m12:22:45.939568 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_2"
[0m12:22:45.941019 [debug] [Thread-1 (]: Began executing node model.transform.3_2
[0m12:22:45.944102 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_2"
[0m12:22:45.945399 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:22:45.945599 [debug] [Thread-1 (]: On model.transform.3_2: BEGIN
[0m12:22:45.945896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:45.956875 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:22:45.957134 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:22:45.957963 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */

  
  create view "dev"."main"."3_2__dbt_tmp" as (
    -- Récupérer les régions distinctes dans un set Jinja


SELECT 
    Date,
    
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bourgogne-Franche-Comté' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bourgogne-Franche-Comté"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Centre-Val de Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Centre-Val de Loire"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Nouvelle-Aquitaine' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Nouvelle-Aquitaine"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Occitanie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Occitanie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Île-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Île-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Normandie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Normandie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Grand Est' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Grand Est"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Provence-Alpes-Côte d''Azur' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Provence-Alpes-Côte d''Azur"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bretagne' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bretagne"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Hauts-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Hauts-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Auvergne-Rhône-Alpes' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Auvergne-Rhône-Alpes"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Pays de la Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Pays de la Loire"
        
    
    
FROM 
    "dev"."main"."clean"
GROUP BY 
    Date
ORDER BY 
    Date
  );

[0m12:22:45.960196 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:22:45.962244 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:22:45.962480 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
alter view "dev"."main"."3_2" rename to "3_2__dbt_backup"
[0m12:22:45.963123 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:45.964696 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:22:45.964903 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
alter view "dev"."main"."3_2__dbt_tmp" rename to "3_2"
[0m12:22:45.965509 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:45.966347 [debug] [Thread-1 (]: On model.transform.3_2: COMMIT
[0m12:22:45.966546 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:22:45.966877 [debug] [Thread-1 (]: On model.transform.3_2: COMMIT
[0m12:22:45.972655 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:22:45.973952 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:22:45.974165 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
drop view if exists "dev"."main"."3_2__dbt_backup" cascade
[0m12:22:45.974921 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:45.975593 [debug] [Thread-1 (]: On model.transform.3_2: Close
[0m12:22:45.987935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9989c4f-5c13-49a2-88d8-030644c6d801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709868231690>]}
[0m12:22:45.988416 [info ] [Thread-1 (]: 6 of 7 OK created sql view model main.3_2 ...................................... [[32mOK[0m in 0.05s]
[0m12:22:45.988803 [debug] [Thread-1 (]: Finished running node model.transform.3_2
[0m12:22:45.989065 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m12:22:45.989540 [info ] [Thread-1 (]: 7 of 7 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m12:22:45.989954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_2, now model.transform.my_second_dbt_model)
[0m12:22:45.990251 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m12:22:45.991954 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m12:22:45.992984 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m12:22:45.994851 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m12:22:45.995952 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:22:45.996146 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m12:22:45.996458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:46.007353 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:22:46.007601 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:22:46.007948 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m12:22:46.008470 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:46.010127 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:22:46.010337 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m12:22:46.010898 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:46.013083 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:22:46.013298 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m12:22:46.013725 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:46.014561 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:22:46.014766 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:22:46.015109 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:22:46.016870 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:22:46.018039 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:22:46.018246 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m12:22:46.019050 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:22:46.019713 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m12:22:46.032175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9989c4f-5c13-49a2-88d8-030644c6d801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709863f504f0>]}
[0m12:22:46.032562 [info ] [Thread-1 (]: 7 of 7 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m12:22:46.032951 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m12:22:46.033832 [debug] [MainThread]: Using duckdb connection "master"
[0m12:22:46.034181 [debug] [MainThread]: On master: BEGIN
[0m12:22:46.034573 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:22:46.045512 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m12:22:46.045740 [debug] [MainThread]: On master: COMMIT
[0m12:22:46.046015 [debug] [MainThread]: Using duckdb connection "master"
[0m12:22:46.046248 [debug] [MainThread]: On master: COMMIT
[0m12:22:46.046697 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:22:46.046881 [debug] [MainThread]: On master: Close
[0m12:22:46.048177 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:22:46.048372 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m12:22:46.048689 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m12:22:46.049055 [info ] [MainThread]: 
[0m12:22:46.049289 [info ] [MainThread]: Finished running 6 view models, 1 table model in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m12:22:46.050070 [debug] [MainThread]: Command end result
[0m12:22:46.070727 [info ] [MainThread]: 
[0m12:22:46.071000 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:22:46.071321 [info ] [MainThread]: 
[0m12:22:46.071631 [error] [MainThread]:   Runtime Error in model test (models/test.sql)
  Binder Error: Cannot mix values of type VARCHAR and INTEGER_LITERAL in COALESCE operator - an explicit cast is required
[0m12:22:46.071851 [info ] [MainThread]: 
[0m12:22:46.072099 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m12:22:46.072614 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2862555, "process_in_blocks": "13440", "process_kernel_time": 0.160297, "process_mem_max_rss": "143060", "process_out_blocks": "12096", "process_user_time": 1.392217}
[0m12:22:46.072928 [debug] [MainThread]: Command `dbt run` failed at 12:22:46.072875 after 1.29 seconds
[0m12:22:46.073138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70986989bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709861723d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709861721450>]}
[0m12:22:46.073353 [debug] [MainThread]: Flushing usage events
[0m12:23:28.181906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72593d67fc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72593da131f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72593da13310>]}


============================== 12:23:28.185273 | 72f01538-a1ad-43f0-a9bc-31ea3b51bc61 ==============================
[0m12:23:28.185273 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:23:28.185902 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:23:28.320190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72f01538-a1ad-43f0-a9bc-31ea3b51bc61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72593be2e950>]}
[0m12:23:28.348345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72f01538-a1ad-43f0-a9bc-31ea3b51bc61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72593bdd20b0>]}
[0m12:23:28.351279 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m12:23:28.393576 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:23:28.519411 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:23:28.520170 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:23:28.528957 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m12:23:28.547832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72f01538-a1ad-43f0-a9bc-31ea3b51bc61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725935de9d80>]}
[0m12:23:28.616176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72f01538-a1ad-43f0-a9bc-31ea3b51bc61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725935d76cb0>]}
[0m12:23:28.616519 [info ] [MainThread]: Found 7 models, 4 data tests, 421 macros
[0m12:23:28.617059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72f01538-a1ad-43f0-a9bc-31ea3b51bc61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725935d76890>]}
[0m12:23:28.618427 [info ] [MainThread]: 
[0m12:23:28.618806 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:23:28.622168 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:23:28.842037 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:23:28.842300 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:23:28.842715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:23:28.864410 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m12:23:28.865905 [debug] [ThreadPool]: On list_dev: Close
[0m12:23:28.869131 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:23:28.869616 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:23:28.874254 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:23:28.874465 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:23:28.874818 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:23:28.886219 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m12:23:28.887118 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:23:28.887371 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:23:28.887833 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:23:28.888044 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:23:28.888369 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:23:28.888832 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:23:28.889284 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:23:28.889474 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:23:28.889776 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:23:28.890118 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:23:28.890322 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:23:28.892158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:23:28.897695 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:23:28.898217 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:23:28.898669 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:23:28.917753 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m12:23:28.918293 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:23:28.918923 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:23:28.934115 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m12:23:28.934816 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:23:28.935481 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:23:28.935672 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:23:28.937812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72f01538-a1ad-43f0-a9bc-31ea3b51bc61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725935318a60>]}
[0m12:23:28.938070 [debug] [MainThread]: Using duckdb connection "master"
[0m12:23:28.938352 [debug] [MainThread]: On master: BEGIN
[0m12:23:28.938643 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:23:28.952761 [debug] [MainThread]: SQL status: OK in 0.014 seconds
[0m12:23:28.953383 [debug] [MainThread]: On master: COMMIT
[0m12:23:28.954016 [debug] [MainThread]: Using duckdb connection "master"
[0m12:23:28.954577 [debug] [MainThread]: On master: COMMIT
[0m12:23:28.955383 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:23:28.955951 [debug] [MainThread]: On master: Close
[0m12:23:28.958638 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:23:28.959183 [info ] [MainThread]: 
[0m12:23:28.961803 [debug] [Thread-1 (]: Began running node model.transform.3_1
[0m12:23:28.962909 [info ] [Thread-1 (]: 1 of 7 START sql view model main.3_1 ........................................... [RUN]
[0m12:23:28.964050 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.3_1'
[0m12:23:28.964968 [debug] [Thread-1 (]: Began compiling node model.transform.3_1
[0m12:23:28.973227 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_1"
[0m12:23:28.975151 [debug] [Thread-1 (]: Began executing node model.transform.3_1
[0m12:23:29.003500 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_1"
[0m12:23:29.006237 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:23:29.006437 [debug] [Thread-1 (]: On model.transform.3_1: BEGIN
[0m12:23:29.006988 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:23:29.020323 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m12:23:29.020943 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:23:29.021894 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    strftime('%Y-%m', Date) AS mois,  -- Utilisation de strftime pour extraire l'année et le mois
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0))/2000 AS consommation_totale_en_GWH,
    SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,

    MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
FROM clean
GROUP BY strftime('%Y-%m', Date), "Région"  -- Remplacer TO_CHAR par strftime
ORDER BY mois, "Région"  -- Tri par mois et région
  );

[0m12:23:29.024347 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:23:29.031329 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:23:29.031671 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1" rename to "3_1__dbt_backup"
[0m12:23:29.032445 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:23:29.034264 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:23:29.034505 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1__dbt_tmp" rename to "3_1"
[0m12:23:29.035232 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:23:29.043454 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m12:23:29.043674 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:23:29.044206 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m12:23:29.046474 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:23:29.048917 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:23:29.049138 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
drop view if exists "dev"."main"."3_1__dbt_backup" cascade
[0m12:23:29.050094 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:23:29.051369 [debug] [Thread-1 (]: On model.transform.3_1: Close
[0m12:23:29.064498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72f01538-a1ad-43f0-a9bc-31ea3b51bc61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725935dec040>]}
[0m12:23:29.064884 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.3_1 ...................................... [[32mOK[0m in 0.10s]
[0m12:23:29.065238 [debug] [Thread-1 (]: Finished running node model.transform.3_1
[0m12:23:29.065459 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m12:23:29.065800 [info ] [Thread-1 (]: 2 of 7 START sql view model main.clean ......................................... [RUN]
[0m12:23:29.066095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_1, now model.transform.clean)
[0m12:23:29.066357 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m12:23:29.067415 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m12:23:29.068662 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m12:23:29.070496 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m12:23:29.071654 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:23:29.071851 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m12:23:29.072156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:29.083140 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:23:29.083360 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:23:29.083950 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT "Code INSEE région",	"Région"	,	"Date",	"Heure",	
"Consommation (MW)"	,"Thermique (MW)",	"Nucléaire (MW)",	"Eolien (MW)",	"Solaire (MW)",	"Hydraulique (MW)",	"Pompage (MW)",	"Bioénergies (MW)",	"Ech. physiques (MW)","production_totale"

     FROM clean
  );

[0m12:23:29.084701 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:23:29.086700 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:23:29.086913 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m12:23:29.087407 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:23:29.088866 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:23:29.089079 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m12:23:29.089523 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:23:29.090363 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:23:29.090562 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:23:29.090860 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:23:29.092593 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:23:29.093709 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:23:29.093913 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m12:23:29.094646 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:23:29.095275 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m12:23:29.108289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72f01538-a1ad-43f0-a9bc-31ea3b51bc61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725932191990>]}
[0m12:23:29.108666 [info ] [Thread-1 (]: 2 of 7 OK created sql view model main.clean .................................... [[32mOK[0m in 0.04s]
[0m12:23:29.109024 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m12:23:29.109281 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m12:23:29.109708 [info ] [Thread-1 (]: 3 of 7 START sql view model main.grain_jour .................................... [RUN]
[0m12:23:29.109986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m12:23:29.110258 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m12:23:29.111355 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m12:23:29.112439 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m12:23:29.114191 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m12:23:29.115491 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:23:29.115682 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m12:23:29.115986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:29.127829 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m12:23:29.128166 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:23:29.128794 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS thermique_total,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS nucleaire_total,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS eolien_total,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS solaire_total,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS hydraulique_total,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS bioenergies_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_total,
    SUM(COALESCE(production_totale, 0)) AS production_totale
FROM clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m12:23:29.129772 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:23:29.131559 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:23:29.131775 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour" rename to "grain_jour__dbt_backup"
[0m12:23:29.132379 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:23:29.133829 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:23:29.134032 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour__dbt_tmp" rename to "grain_jour"
[0m12:23:29.134491 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:23:29.135285 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:23:29.135482 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:23:29.135801 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:23:29.138176 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:23:29.139301 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:23:29.139491 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
drop view if exists "dev"."main"."grain_jour__dbt_backup" cascade
[0m12:23:29.140284 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:23:29.141441 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m12:23:29.153525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72f01538-a1ad-43f0-a9bc-31ea3b51bc61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7259321dc250>]}
[0m12:23:29.153879 [info ] [Thread-1 (]: 3 of 7 OK created sql view model main.grain_jour ............................... [[32mOK[0m in 0.04s]
[0m12:23:29.154286 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m12:23:29.154577 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m12:23:29.154968 [info ] [Thread-1 (]: 4 of 7 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m12:23:29.155193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m12:23:29.155447 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m12:23:29.176981 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m12:23:29.178492 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m12:23:29.188138 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m12:23:29.189554 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:23:29.189770 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m12:23:29.190096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:29.201300 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:23:29.201532 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:23:29.202085 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m12:23:29.202752 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:23:29.204234 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:23:29.204446 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m12:23:29.204905 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:23:29.206398 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:23:29.206605 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m12:23:29.207056 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:23:29.209607 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:23:29.209825 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:23:29.210213 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:23:29.211996 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:23:29.213202 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:23:29.213420 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m12:23:29.214194 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:23:29.214922 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m12:23:29.229387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72f01538-a1ad-43f0-a9bc-31ea3b51bc61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7259321d0fa0>]}
[0m12:23:29.229759 [info ] [Thread-1 (]: 4 of 7 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.07s]
[0m12:23:29.230080 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m12:23:29.230330 [debug] [Thread-1 (]: Began running node model.transform.test
[0m12:23:29.230676 [info ] [Thread-1 (]: 5 of 7 START sql view model main.test .......................................... [RUN]
[0m12:23:29.230975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.test)
[0m12:23:29.231246 [debug] [Thread-1 (]: Began compiling node model.transform.test
[0m12:23:29.232251 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.test"
[0m12:23:29.233460 [debug] [Thread-1 (]: Began executing node model.transform.test
[0m12:23:29.235767 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.test"
[0m12:23:29.236955 [debug] [Thread-1 (]: Using duckdb connection "model.transform.test"
[0m12:23:29.237156 [debug] [Thread-1 (]: On model.transform.test: BEGIN
[0m12:23:29.237450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:29.248002 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:23:29.248238 [debug] [Thread-1 (]: Using duckdb connection "model.transform.test"
[0m12:23:29.248812 [debug] [Thread-1 (]: On model.transform.test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.test"} */

  
  create view "dev"."main"."test__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           -- Traitement de la colonne "Consommation (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Consommation (MW)" = '' OR "Consommation (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Consommation (MW)" AS INT)
           END AS "Consommation (MW)",
           
           -- Traitement de la colonne "Eolien (MW)" : remplacer 'ND' par 0
           CASE
               WHEN "Eolien (MW)" = 'ND' OR "Eolien (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Eolien (MW)" AS INT)
           END AS "Eolien (MW)",
           
           -- Traitement de la colonne "Thermique (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Thermique (MW)" = '' OR "Thermique (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Thermique (MW)" AS INT)
           END AS "Thermique (MW)",

           -- Traitement de la colonne "Bioénergies (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Bioénergies (MW)" = '' OR "Bioénergies (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Bioénergies (MW)" AS INT)
           END AS "Bioénergies (MW)",

           -- Traitement des autres colonnes : remplacer les vides par 0
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) AS "Nucléaire (MW)",
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) AS "Solaire (MW)",
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) AS "Hydraulique (MW)",
           COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0) AS "Pompage (MW)",
           COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0) AS "Ech. physiques (MW)"
    FROM eco2
    WHERE "Région" IS NOT NULL AND "Date" IS NOT NULL
),
clean AS (
    SELECT *, 
           -- Calcul de la production totale en sommant les valeurs traitées (assurant que toutes les valeurs sont numériques)
           COALESCE("Nucléaire (MW)", 0) + 
           COALESCE("Eolien (MW)", 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Code INSEE région",
    "Région", 
    "Date", 
    "Heure", 
    "Consommation (MW)",
    "Thermique (MW)",
    "Nucléaire (MW)",
    "Eolien (MW)",
    "Solaire (MW)",
    "Hydraulique (MW)",
    "Pompage (MW)",
    "Bioénergies (MW)",
    "Ech. physiques (MW)",
    production_totale
FROM clean;
  );

[0m12:23:29.249364 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.test"} */

  
  create view "dev"."main"."test__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           -- Traitement de la colonne "Consommation (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Consommation (MW)" = '' OR "Consommation (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Consommation (MW)" AS INT)
           END AS "Consommation (MW)",
           
           -- Traitement de la colonne "Eolien (MW)" : remplacer 'ND' par 0
           CASE
               WHEN "Eolien (MW)" = 'ND' OR "Eolien (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Eolien (MW)" AS INT)
           END AS "Eolien (MW)",
           
           -- Traitement de la colonne "Thermique (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Thermique (MW)" = '' OR "Thermique (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Thermique (MW)" AS INT)
           END AS "Thermique (MW)",

           -- Traitement de la colonne "Bioénergies (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Bioénergies (MW)" = '' OR "Bioénergies (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Bioénergies (MW)" AS INT)
           END AS "Bioénergies (MW)",

           -- Traitement des autres colonnes : remplacer les vides par 0
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) AS "Nucléaire (MW)",
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) AS "Solaire (MW)",
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) AS "Hydraulique (MW)",
           COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0) AS "Pompage (MW)",
           COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0) AS "Ech. physiques (MW)"
    FROM eco2
    WHERE "Région" IS NOT NULL AND "Date" IS NOT NULL
),
clean AS (
    SELECT *, 
           -- Calcul de la production totale en sommant les valeurs traitées (assurant que toutes les valeurs sont numériques)
           COALESCE("Nucléaire (MW)", 0) + 
           COALESCE("Eolien (MW)", 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Code INSEE région",
    "Région", 
    "Date", 
    "Heure", 
    "Consommation (MW)",
    "Thermique (MW)",
    "Nucléaire (MW)",
    "Eolien (MW)",
    "Solaire (MW)",
    "Hydraulique (MW)",
    "Pompage (MW)",
    "Bioénergies (MW)",
    "Ech. physiques (MW)",
    production_totale
FROM clean;
  );

[0m12:23:29.249612 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:23:29.249970 [debug] [Thread-1 (]: On model.transform.test: ROLLBACK
[0m12:23:29.252856 [debug] [Thread-1 (]: Failed to rollback 'model.transform.test'
[0m12:23:29.253068 [debug] [Thread-1 (]: On model.transform.test: Close
[0m12:23:29.254753 [debug] [Thread-1 (]: Runtime Error in model test (models/test.sql)
  Parser Error: syntax error at or near ";"
[0m12:23:29.255032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72f01538-a1ad-43f0-a9bc-31ea3b51bc61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725932b57940>]}
[0m12:23:29.255484 [error] [Thread-1 (]: 5 of 7 ERROR creating sql view model main.test ................................. [[31mERROR[0m in 0.02s]
[0m12:23:29.255791 [debug] [Thread-1 (]: Finished running node model.transform.test
[0m12:23:29.256054 [debug] [Thread-1 (]: Began running node model.transform.3_2
[0m12:23:29.256893 [info ] [Thread-1 (]: 6 of 7 START sql view model main.3_2 ........................................... [RUN]
[0m12:23:29.257403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.test, now model.transform.3_2)
[0m12:23:29.257703 [debug] [Thread-1 (]: Began compiling node model.transform.3_2
[0m12:23:29.261067 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_2"
[0m12:23:29.262582 [debug] [Thread-1 (]: Began executing node model.transform.3_2
[0m12:23:29.264624 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_2"
[0m12:23:29.265965 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:23:29.266164 [debug] [Thread-1 (]: On model.transform.3_2: BEGIN
[0m12:23:29.266510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:29.278063 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m12:23:29.278290 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:23:29.278924 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */

  
  create view "dev"."main"."3_2__dbt_tmp" as (
    -- Récupérer les régions distinctes dans un set Jinja


SELECT 
    Date,
    
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bourgogne-Franche-Comté' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bourgogne-Franche-Comté"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Centre-Val de Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Centre-Val de Loire"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Nouvelle-Aquitaine' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Nouvelle-Aquitaine"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Occitanie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Occitanie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Île-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Île-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Normandie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Normandie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Grand Est' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Grand Est"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Provence-Alpes-Côte d''Azur' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Provence-Alpes-Côte d''Azur"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bretagne' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bretagne"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Hauts-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Hauts-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Auvergne-Rhône-Alpes' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Auvergne-Rhône-Alpes"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Pays de la Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Pays de la Loire"
        
    
    
FROM 
    "dev"."main"."clean"
GROUP BY 
    Date
ORDER BY 
    Date
  );

[0m12:23:29.279969 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:23:29.281545 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:23:29.281753 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
alter view "dev"."main"."3_2" rename to "3_2__dbt_backup"
[0m12:23:29.282312 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:23:29.283811 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:23:29.284018 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
alter view "dev"."main"."3_2__dbt_tmp" rename to "3_2"
[0m12:23:29.284618 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:23:29.285430 [debug] [Thread-1 (]: On model.transform.3_2: COMMIT
[0m12:23:29.285636 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:23:29.285941 [debug] [Thread-1 (]: On model.transform.3_2: COMMIT
[0m12:23:29.288099 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:23:29.289310 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:23:29.289511 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
drop view if exists "dev"."main"."3_2__dbt_backup" cascade
[0m12:23:29.290196 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:23:29.290843 [debug] [Thread-1 (]: On model.transform.3_2: Close
[0m12:23:29.302703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72f01538-a1ad-43f0-a9bc-31ea3b51bc61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725932b4a710>]}
[0m12:23:29.303076 [info ] [Thread-1 (]: 6 of 7 OK created sql view model main.3_2 ...................................... [[32mOK[0m in 0.05s]
[0m12:23:29.303411 [debug] [Thread-1 (]: Finished running node model.transform.3_2
[0m12:23:29.303634 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m12:23:29.303955 [info ] [Thread-1 (]: 7 of 7 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m12:23:29.304256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_2, now model.transform.my_second_dbt_model)
[0m12:23:29.304539 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m12:23:29.306070 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m12:23:29.307312 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m12:23:29.309764 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m12:23:29.310927 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:23:29.311114 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m12:23:29.311443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:29.322316 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:23:29.322555 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:23:29.323112 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m12:23:29.323736 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:23:29.325270 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:23:29.325475 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m12:23:29.325955 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:23:29.327419 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:23:29.327626 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m12:23:29.328156 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:23:29.328967 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:23:29.329170 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:23:29.329477 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:23:29.331495 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:23:29.332704 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:23:29.332922 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m12:23:29.333647 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:23:29.334292 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m12:23:29.346438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72f01538-a1ad-43f0-a9bc-31ea3b51bc61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725932b49e70>]}
[0m12:23:29.346812 [info ] [Thread-1 (]: 7 of 7 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m12:23:29.347120 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m12:23:29.347740 [debug] [MainThread]: Using duckdb connection "master"
[0m12:23:29.347925 [debug] [MainThread]: On master: BEGIN
[0m12:23:29.348242 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:23:29.359382 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m12:23:29.359587 [debug] [MainThread]: On master: COMMIT
[0m12:23:29.360195 [debug] [MainThread]: Using duckdb connection "master"
[0m12:23:29.360551 [debug] [MainThread]: On master: COMMIT
[0m12:23:29.360946 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:23:29.361183 [debug] [MainThread]: On master: Close
[0m12:23:29.362331 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:23:29.362526 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m12:23:29.362845 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m12:23:29.363234 [info ] [MainThread]: 
[0m12:23:29.363485 [info ] [MainThread]: Finished running 6 view models, 1 table model in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m12:23:29.364308 [debug] [MainThread]: Command end result
[0m12:23:29.385643 [info ] [MainThread]: 
[0m12:23:29.385883 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:23:29.386381 [info ] [MainThread]: 
[0m12:23:29.386672 [error] [MainThread]:   Runtime Error in model test (models/test.sql)
  Parser Error: syntax error at or near ";"
[0m12:23:29.386936 [info ] [MainThread]: 
[0m12:23:29.387255 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m12:23:29.387778 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.238589, "process_in_blocks": "13440", "process_kernel_time": 0.195764, "process_mem_max_rss": "139028", "process_out_blocks": "11240", "process_user_time": 1.607491}
[0m12:23:29.388059 [debug] [MainThread]: Command `dbt run` failed at 12:23:29.388012 after 1.24 seconds
[0m12:23:29.388248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72593d67fc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72593c864df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725935dfb640>]}
[0m12:23:29.388506 [debug] [MainThread]: Flushing usage events
[0m12:23:59.872829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723601c7fc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7236020131f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723602013310>]}


============================== 12:23:59.874917 | 63cd545e-dbe8-4468-8ae3-bac6c9dbe18e ==============================
[0m12:23:59.874917 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:23:59.875554 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:23:59.997132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63cd545e-dbe8-4468-8ae3-bac6c9dbe18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72360042e950>]}
[0m12:24:00.024583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63cd545e-dbe8-4468-8ae3-bac6c9dbe18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7236003d20b0>]}
[0m12:24:00.027969 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m12:24:00.072266 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:24:00.213899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:24:00.214655 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:24:00.224197 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m12:24:00.243143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63cd545e-dbe8-4468-8ae3-bac6c9dbe18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235fa3e9d80>]}
[0m12:24:00.308858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63cd545e-dbe8-4468-8ae3-bac6c9dbe18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235fa376cb0>]}
[0m12:24:00.309200 [info ] [MainThread]: Found 7 models, 4 data tests, 421 macros
[0m12:24:00.309781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63cd545e-dbe8-4468-8ae3-bac6c9dbe18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235fa376890>]}
[0m12:24:00.311432 [info ] [MainThread]: 
[0m12:24:00.311837 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:24:00.315956 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:24:00.518311 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:24:00.519084 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:24:00.519819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:00.541924 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m12:24:00.543379 [debug] [ThreadPool]: On list_dev: Close
[0m12:24:00.546934 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:24:00.547975 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:24:00.555351 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:24:00.555664 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:24:00.556022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:24:00.570601 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m12:24:00.571576 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:24:00.571872 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:24:00.572556 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:24:00.572856 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:24:00.573227 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:24:00.573821 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:24:00.574622 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:24:00.574948 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:24:00.575392 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:24:00.576068 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:24:00.576457 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:24:00.580662 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:24:00.591431 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:24:00.592211 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:24:00.592806 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:24:00.609388 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m12:24:00.609894 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:24:00.610528 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:24:00.624511 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m12:24:00.625212 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:24:00.625753 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:24:00.625923 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:24:00.628469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63cd545e-dbe8-4468-8ae3-bac6c9dbe18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235f9918a60>]}
[0m12:24:00.628709 [debug] [MainThread]: Using duckdb connection "master"
[0m12:24:00.629018 [debug] [MainThread]: On master: BEGIN
[0m12:24:00.629352 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:24:00.641390 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m12:24:00.641713 [debug] [MainThread]: On master: COMMIT
[0m12:24:00.642278 [debug] [MainThread]: Using duckdb connection "master"
[0m12:24:00.642641 [debug] [MainThread]: On master: COMMIT
[0m12:24:00.643167 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:24:00.643505 [debug] [MainThread]: On master: Close
[0m12:24:00.646563 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:24:00.647568 [info ] [MainThread]: 
[0m12:24:00.651622 [debug] [Thread-1 (]: Began running node model.transform.3_1
[0m12:24:00.653088 [info ] [Thread-1 (]: 1 of 7 START sql view model main.3_1 ........................................... [RUN]
[0m12:24:00.654434 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.3_1'
[0m12:24:00.655360 [debug] [Thread-1 (]: Began compiling node model.transform.3_1
[0m12:24:00.663087 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_1"
[0m12:24:00.664995 [debug] [Thread-1 (]: Began executing node model.transform.3_1
[0m12:24:00.700057 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_1"
[0m12:24:00.701761 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:24:00.701978 [debug] [Thread-1 (]: On model.transform.3_1: BEGIN
[0m12:24:00.702436 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:24:00.713940 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:24:00.714207 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:24:00.714604 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    strftime('%Y-%m', Date) AS mois,  -- Utilisation de strftime pour extraire l'année et le mois
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0))/2000 AS consommation_totale_en_GWH,
    SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,

    MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
FROM clean
GROUP BY strftime('%Y-%m', Date), "Région"  -- Remplacer TO_CHAR par strftime
ORDER BY mois, "Région"  -- Tri par mois et région
  );

[0m12:24:00.715563 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:24:00.718869 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:24:00.719080 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1" rename to "3_1__dbt_backup"
[0m12:24:00.719646 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:00.721060 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:24:00.721260 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1__dbt_tmp" rename to "3_1"
[0m12:24:00.721836 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:00.730609 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m12:24:00.730914 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:24:00.731401 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m12:24:00.735841 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:24:00.743999 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:24:00.744742 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
drop view if exists "dev"."main"."3_1__dbt_backup" cascade
[0m12:24:00.745977 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:24:00.749040 [debug] [Thread-1 (]: On model.transform.3_1: Close
[0m12:24:00.764292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cd545e-dbe8-4468-8ae3-bac6c9dbe18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235fa3ec040>]}
[0m12:24:00.764696 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.3_1 ...................................... [[32mOK[0m in 0.11s]
[0m12:24:00.765035 [debug] [Thread-1 (]: Finished running node model.transform.3_1
[0m12:24:00.765262 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m12:24:00.765571 [info ] [Thread-1 (]: 2 of 7 START sql view model main.clean ......................................... [RUN]
[0m12:24:00.765843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_1, now model.transform.clean)
[0m12:24:00.766099 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m12:24:00.767190 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m12:24:00.768308 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m12:24:00.770173 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m12:24:00.771375 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:24:00.771563 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m12:24:00.771858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:00.783282 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:24:00.783604 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:24:00.784184 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT "Code INSEE région",	"Région"	,	"Date",	"Heure",	
"Consommation (MW)"	,"Thermique (MW)",	"Nucléaire (MW)",	"Eolien (MW)",	"Solaire (MW)",	"Hydraulique (MW)",	"Pompage (MW)",	"Bioénergies (MW)",	"Ech. physiques (MW)","production_totale"

     FROM clean
  );

[0m12:24:00.785200 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:24:00.788229 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:24:00.788511 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m12:24:00.789099 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:00.790722 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:24:00.790943 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m12:24:00.791518 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:00.792370 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:24:00.792565 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:24:00.792887 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:24:00.796552 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:24:00.797708 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:24:00.797909 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m12:24:00.798734 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:00.799368 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m12:24:00.811259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cd545e-dbe8-4468-8ae3-bac6c9dbe18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235f6795990>]}
[0m12:24:00.811609 [info ] [Thread-1 (]: 2 of 7 OK created sql view model main.clean .................................... [[32mOK[0m in 0.05s]
[0m12:24:00.811901 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m12:24:00.812169 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m12:24:00.812534 [info ] [Thread-1 (]: 3 of 7 START sql view model main.grain_jour .................................... [RUN]
[0m12:24:00.812805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m12:24:00.813055 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m12:24:00.814118 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m12:24:00.815396 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m12:24:00.817126 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m12:24:00.818265 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:24:00.818462 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m12:24:00.818755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:00.829566 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:24:00.829798 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:24:00.830162 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS thermique_total,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS nucleaire_total,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS eolien_total,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS solaire_total,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS hydraulique_total,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS bioenergies_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_total,
    SUM(COALESCE(production_totale, 0)) AS production_totale
FROM clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m12:24:00.830918 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:00.832430 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:24:00.832633 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour" rename to "grain_jour__dbt_backup"
[0m12:24:00.833161 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:00.834612 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:24:00.834812 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour__dbt_tmp" rename to "grain_jour"
[0m12:24:00.835305 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:00.836101 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:24:00.836293 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:24:00.836577 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:24:00.840154 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:24:00.841308 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:24:00.841500 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
drop view if exists "dev"."main"."grain_jour__dbt_backup" cascade
[0m12:24:00.842230 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:00.843390 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m12:24:00.855071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cd545e-dbe8-4468-8ae3-bac6c9dbe18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235f67e4250>]}
[0m12:24:00.855424 [info ] [Thread-1 (]: 3 of 7 OK created sql view model main.grain_jour ............................... [[32mOK[0m in 0.04s]
[0m12:24:00.855768 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m12:24:00.856015 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m12:24:00.856352 [info ] [Thread-1 (]: 4 of 7 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m12:24:00.856647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m12:24:00.856921 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m12:24:00.878227 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m12:24:00.879628 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m12:24:00.889347 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m12:24:00.890579 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:24:00.890775 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m12:24:00.891076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:00.902083 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:24:00.902306 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:24:00.902645 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m12:24:00.903336 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:00.904838 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:24:00.905043 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m12:24:00.905526 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:00.907026 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:24:00.907229 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m12:24:00.907732 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:00.910272 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:24:00.910484 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:24:00.910811 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:24:00.914179 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:24:00.915519 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:24:00.915741 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m12:24:00.916337 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:00.917045 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m12:24:00.931223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cd545e-dbe8-4468-8ae3-bac6c9dbe18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235f67d4f10>]}
[0m12:24:00.931599 [info ] [Thread-1 (]: 4 of 7 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.07s]
[0m12:24:00.931915 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m12:24:00.932138 [debug] [Thread-1 (]: Began running node model.transform.test
[0m12:24:00.932396 [info ] [Thread-1 (]: 5 of 7 START sql view model main.test .......................................... [RUN]
[0m12:24:00.932740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.test)
[0m12:24:00.932938 [debug] [Thread-1 (]: Began compiling node model.transform.test
[0m12:24:00.933964 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.test"
[0m12:24:00.934865 [debug] [Thread-1 (]: Began executing node model.transform.test
[0m12:24:00.937951 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.test"
[0m12:24:00.939023 [debug] [Thread-1 (]: Using duckdb connection "model.transform.test"
[0m12:24:00.939345 [debug] [Thread-1 (]: On model.transform.test: BEGIN
[0m12:24:00.939624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:00.954231 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m12:24:00.954927 [debug] [Thread-1 (]: Using duckdb connection "model.transform.test"
[0m12:24:00.955612 [debug] [Thread-1 (]: On model.transform.test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.test"} */

  
  create view "dev"."main"."test__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           -- Traitement de la colonne "Consommation (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Consommation (MW)" = '' OR "Consommation (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Consommation (MW)" AS INT)
           END AS "Consommation (MW)",
           
           -- Traitement de la colonne "Eolien (MW)" : remplacer 'ND' par 0
           CASE
               WHEN "Eolien (MW)" = 'ND' OR "Eolien (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Eolien (MW)" AS INT)
           END AS "Eolien (MW)",
           
           -- Traitement de la colonne "Thermique (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Thermique (MW)" = '' OR "Thermique (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Thermique (MW)" AS INT)
           END AS "Thermique (MW)",

           -- Traitement de la colonne "Bioénergies (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Bioénergies (MW)" = '' OR "Bioénergies (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Bioénergies (MW)" AS INT)
           END AS "Bioénergies (MW)",

           -- Traitement des autres colonnes : remplacer les vides par 0
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) AS "Nucléaire (MW)",
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) AS "Solaire (MW)",
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) AS "Hydraulique (MW)",
           COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0) AS "Pompage (MW)",
           COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0) AS "Ech. physiques (MW)"
    FROM eco2
    WHERE "Région" IS NOT NULL AND "Date" IS NOT NULL
),
clean AS (
    SELECT *, 
           -- Calcul de la production totale en sommant les valeurs traitées (assurant que toutes les valeurs sont numériques)
           COALESCE("Nucléaire (MW)", 0) + 
           COALESCE("Eolien (MW)", 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Code INSEE région",
    "Région", 
    "Date", 
    "Heure", 
    "Consommation (MW)",
    "Thermique (MW)",
    "Nucléaire (MW)",
    "Eolien (MW)",
    "Solaire (MW)",
    "Hydraulique (MW)",
    "Pompage (MW)",
    "Bioénergies (MW)",
    "Ech. physiques (MW)",
    production_totale
FROM clean
  );

[0m12:24:00.957791 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.test"} */

  
  create view "dev"."main"."test__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           -- Traitement de la colonne "Consommation (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Consommation (MW)" = '' OR "Consommation (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Consommation (MW)" AS INT)
           END AS "Consommation (MW)",
           
           -- Traitement de la colonne "Eolien (MW)" : remplacer 'ND' par 0
           CASE
               WHEN "Eolien (MW)" = 'ND' OR "Eolien (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Eolien (MW)" AS INT)
           END AS "Eolien (MW)",
           
           -- Traitement de la colonne "Thermique (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Thermique (MW)" = '' OR "Thermique (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Thermique (MW)" AS INT)
           END AS "Thermique (MW)",

           -- Traitement de la colonne "Bioénergies (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Bioénergies (MW)" = '' OR "Bioénergies (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Bioénergies (MW)" AS INT)
           END AS "Bioénergies (MW)",

           -- Traitement des autres colonnes : remplacer les vides par 0
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) AS "Nucléaire (MW)",
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) AS "Solaire (MW)",
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) AS "Hydraulique (MW)",
           COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0) AS "Pompage (MW)",
           COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0) AS "Ech. physiques (MW)"
    FROM eco2
    WHERE "Région" IS NOT NULL AND "Date" IS NOT NULL
),
clean AS (
    SELECT *, 
           -- Calcul de la production totale en sommant les valeurs traitées (assurant que toutes les valeurs sont numériques)
           COALESCE("Nucléaire (MW)", 0) + 
           COALESCE("Eolien (MW)", 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Code INSEE région",
    "Région", 
    "Date", 
    "Heure", 
    "Consommation (MW)",
    "Thermique (MW)",
    "Nucléaire (MW)",
    "Eolien (MW)",
    "Solaire (MW)",
    "Hydraulique (MW)",
    "Pompage (MW)",
    "Bioénergies (MW)",
    "Ech. physiques (MW)",
    production_totale
FROM clean
  );

[0m12:24:00.958406 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:24:00.958940 [debug] [Thread-1 (]: On model.transform.test: ROLLBACK
[0m12:24:00.961641 [debug] [Thread-1 (]: Failed to rollback 'model.transform.test'
[0m12:24:00.962022 [debug] [Thread-1 (]: On model.transform.test: Close
[0m12:24:00.964288 [debug] [Thread-1 (]: Runtime Error in model test (models/test.sql)
  Binder Error: Cannot mix values of type VARCHAR and INTEGER_LITERAL in COALESCE operator - an explicit cast is required
[0m12:24:00.964712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cd545e-dbe8-4468-8ae3-bac6c9dbe18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235f71556f0>]}
[0m12:24:00.965299 [error] [Thread-1 (]: 5 of 7 ERROR creating sql view model main.test ................................. [[31mERROR[0m in 0.03s]
[0m12:24:00.965837 [debug] [Thread-1 (]: Finished running node model.transform.test
[0m12:24:00.966231 [debug] [Thread-1 (]: Began running node model.transform.3_2
[0m12:24:00.967617 [info ] [Thread-1 (]: 6 of 7 START sql view model main.3_2 ........................................... [RUN]
[0m12:24:00.968264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.test, now model.transform.3_2)
[0m12:24:00.968729 [debug] [Thread-1 (]: Began compiling node model.transform.3_2
[0m12:24:00.973244 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_2"
[0m12:24:00.974346 [debug] [Thread-1 (]: Began executing node model.transform.3_2
[0m12:24:00.976715 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_2"
[0m12:24:00.977611 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:24:00.977821 [debug] [Thread-1 (]: On model.transform.3_2: BEGIN
[0m12:24:00.978058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:00.988145 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m12:24:00.988437 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:24:00.988847 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */

  
  create view "dev"."main"."3_2__dbt_tmp" as (
    -- Récupérer les régions distinctes dans un set Jinja


SELECT 
    Date,
    
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bourgogne-Franche-Comté' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bourgogne-Franche-Comté"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Centre-Val de Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Centre-Val de Loire"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Nouvelle-Aquitaine' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Nouvelle-Aquitaine"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Occitanie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Occitanie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Île-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Île-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Normandie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Normandie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Grand Est' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Grand Est"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Provence-Alpes-Côte d''Azur' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Provence-Alpes-Côte d''Azur"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bretagne' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bretagne"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Hauts-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Hauts-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Auvergne-Rhône-Alpes' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Auvergne-Rhône-Alpes"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Pays de la Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Pays de la Loire"
        
    
    
FROM 
    "dev"."main"."clean"
GROUP BY 
    Date
ORDER BY 
    Date
  );

[0m12:24:00.989964 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:24:00.991595 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:24:00.991800 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
alter view "dev"."main"."3_2" rename to "3_2__dbt_backup"
[0m12:24:00.992164 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:00.993651 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:24:00.993854 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
alter view "dev"."main"."3_2__dbt_tmp" rename to "3_2"
[0m12:24:00.994325 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:00.995122 [debug] [Thread-1 (]: On model.transform.3_2: COMMIT
[0m12:24:00.995318 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:24:00.995487 [debug] [Thread-1 (]: On model.transform.3_2: COMMIT
[0m12:24:00.998719 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:24:00.999908 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:24:01.000107 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
drop view if exists "dev"."main"."3_2__dbt_backup" cascade
[0m12:24:01.000667 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:01.001357 [debug] [Thread-1 (]: On model.transform.3_2: Close
[0m12:24:01.013616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cd545e-dbe8-4468-8ae3-bac6c9dbe18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235f714a6b0>]}
[0m12:24:01.014116 [info ] [Thread-1 (]: 6 of 7 OK created sql view model main.3_2 ...................................... [[32mOK[0m in 0.05s]
[0m12:24:01.014520 [debug] [Thread-1 (]: Finished running node model.transform.3_2
[0m12:24:01.014815 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m12:24:01.015206 [info ] [Thread-1 (]: 7 of 7 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m12:24:01.015530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_2, now model.transform.my_second_dbt_model)
[0m12:24:01.015814 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m12:24:01.018170 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m12:24:01.019281 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m12:24:01.023860 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m12:24:01.024900 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:24:01.025177 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m12:24:01.025437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:01.036626 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:24:01.036955 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:24:01.037230 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m12:24:01.037737 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:01.039624 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:24:01.039856 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m12:24:01.040265 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:01.041731 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:24:01.041941 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m12:24:01.042324 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:01.043139 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:24:01.043342 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:24:01.043517 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:24:01.046415 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:24:01.047639 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:24:01.047846 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m12:24:01.048444 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:01.049114 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m12:24:01.060319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cd545e-dbe8-4468-8ae3-bac6c9dbe18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235f676da20>]}
[0m12:24:01.060681 [info ] [Thread-1 (]: 7 of 7 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m12:24:01.060992 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m12:24:01.061564 [debug] [MainThread]: Using duckdb connection "master"
[0m12:24:01.061766 [debug] [MainThread]: On master: BEGIN
[0m12:24:01.062008 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:24:01.072343 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m12:24:01.072566 [debug] [MainThread]: On master: COMMIT
[0m12:24:01.072850 [debug] [MainThread]: Using duckdb connection "master"
[0m12:24:01.073104 [debug] [MainThread]: On master: COMMIT
[0m12:24:01.073427 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:24:01.073595 [debug] [MainThread]: On master: Close
[0m12:24:01.074815 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:24:01.075004 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m12:24:01.075256 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m12:24:01.075562 [info ] [MainThread]: 
[0m12:24:01.075754 [info ] [MainThread]: Finished running 6 view models, 1 table model in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m12:24:01.076502 [debug] [MainThread]: Command end result
[0m12:24:01.097108 [info ] [MainThread]: 
[0m12:24:01.097347 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:24:01.097710 [info ] [MainThread]: 
[0m12:24:01.098030 [error] [MainThread]:   Runtime Error in model test (models/test.sql)
  Binder Error: Cannot mix values of type VARCHAR and INTEGER_LITERAL in COALESCE operator - an explicit cast is required
[0m12:24:01.098253 [info ] [MainThread]: 
[0m12:24:01.098512 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m12:24:01.098984 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.254415, "process_in_blocks": "13440", "process_kernel_time": 0.146687, "process_mem_max_rss": "139496", "process_out_blocks": "11232", "process_user_time": 1.397071}
[0m12:24:01.099288 [debug] [MainThread]: Command `dbt run` failed at 12:24:01.099237 after 1.25 seconds
[0m12:24:01.099487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723601c7fc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723601afdab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235f991d900>]}
[0m12:24:01.099728 [debug] [MainThread]: Flushing usage events
[0m12:24:55.685823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b05cefbc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b05d22f1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b05d22f310>]}


============================== 12:24:55.689366 | 3e5af614-fe5a-4d5f-8601-a9ddc9d624de ==============================
[0m12:24:55.689366 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:24:55.690095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:24:55.828850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e5af614-fe5a-4d5f-8601-a9ddc9d624de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b05b3b6950>]}
[0m12:24:55.856858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e5af614-fe5a-4d5f-8601-a9ddc9d624de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b05b3520b0>]}
[0m12:24:55.860375 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m12:24:55.902745 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:24:56.030156 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:24:56.030940 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:24:56.040775 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m12:24:56.059958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e5af614-fe5a-4d5f-8601-a9ddc9d624de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b055fddd80>]}
[0m12:24:56.128313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e5af614-fe5a-4d5f-8601-a9ddc9d624de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b055f6acb0>]}
[0m12:24:56.128669 [info ] [MainThread]: Found 7 models, 4 data tests, 421 macros
[0m12:24:56.129268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e5af614-fe5a-4d5f-8601-a9ddc9d624de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b055f6a890>]}
[0m12:24:56.130720 [info ] [MainThread]: 
[0m12:24:56.131105 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:24:56.134575 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:24:56.313856 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:24:56.314125 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:24:56.314705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:56.327144 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m12:24:56.327844 [debug] [ThreadPool]: On list_dev: Close
[0m12:24:56.329390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:24:56.329701 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:24:56.333375 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:24:56.333574 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:24:56.333920 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:24:56.345014 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m12:24:56.345660 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:24:56.345843 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:24:56.346281 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:24:56.346538 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:24:56.346880 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:24:56.347292 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:24:56.347754 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:24:56.347944 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:24:56.348240 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:24:56.348610 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:24:56.348858 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:24:56.350757 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:24:56.354986 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:24:56.355190 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:24:56.355605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:24:56.365991 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m12:24:56.366186 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:24:56.366766 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:24:56.379919 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m12:24:56.380592 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:24:56.381139 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:24:56.381305 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:24:56.383465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e5af614-fe5a-4d5f-8601-a9ddc9d624de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b05550ca60>]}
[0m12:24:56.383708 [debug] [MainThread]: Using duckdb connection "master"
[0m12:24:56.383953 [debug] [MainThread]: On master: BEGIN
[0m12:24:56.384218 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:24:56.394322 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m12:24:56.394523 [debug] [MainThread]: On master: COMMIT
[0m12:24:56.394838 [debug] [MainThread]: Using duckdb connection "master"
[0m12:24:56.395097 [debug] [MainThread]: On master: COMMIT
[0m12:24:56.395483 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:24:56.395660 [debug] [MainThread]: On master: Close
[0m12:24:56.396768 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:24:56.397001 [info ] [MainThread]: 
[0m12:24:56.398266 [debug] [Thread-1 (]: Began running node model.transform.3_1
[0m12:24:56.398776 [info ] [Thread-1 (]: 1 of 7 START sql view model main.3_1 ........................................... [RUN]
[0m12:24:56.399277 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.3_1'
[0m12:24:56.399616 [debug] [Thread-1 (]: Began compiling node model.transform.3_1
[0m12:24:56.403361 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_1"
[0m12:24:56.404795 [debug] [Thread-1 (]: Began executing node model.transform.3_1
[0m12:24:56.421021 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_1"
[0m12:24:56.422636 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:24:56.422844 [debug] [Thread-1 (]: On model.transform.3_1: BEGIN
[0m12:24:56.423094 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:24:56.433426 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m12:24:56.433652 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:24:56.433965 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    strftime('%Y-%m', Date) AS mois,  -- Utilisation de strftime pour extraire l'année et le mois
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0))/2000 AS consommation_totale_en_GWH,
    SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,

    MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
FROM clean
GROUP BY strftime('%Y-%m', Date), "Région"  -- Remplacer TO_CHAR par strftime
ORDER BY mois, "Région"  -- Tri par mois et région
  );

[0m12:24:56.434877 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:24:56.438072 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:24:56.438288 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1" rename to "3_1__dbt_backup"
[0m12:24:56.438703 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:56.440159 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:24:56.440362 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1__dbt_tmp" rename to "3_1"
[0m12:24:56.440811 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:56.448906 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m12:24:56.449133 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:24:56.449375 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m12:24:56.454017 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:24:56.456460 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:24:56.456682 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
drop view if exists "dev"."main"."3_1__dbt_backup" cascade
[0m12:24:56.457421 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:56.458834 [debug] [Thread-1 (]: On model.transform.3_1: Close
[0m12:24:56.471145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e5af614-fe5a-4d5f-8601-a9ddc9d624de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b05550ca60>]}
[0m12:24:56.471545 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.3_1 ...................................... [[32mOK[0m in 0.07s]
[0m12:24:56.471863 [debug] [Thread-1 (]: Finished running node model.transform.3_1
[0m12:24:56.472090 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m12:24:56.472372 [info ] [Thread-1 (]: 2 of 7 START sql view model main.clean ......................................... [RUN]
[0m12:24:56.472618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_1, now model.transform.clean)
[0m12:24:56.472804 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m12:24:56.473826 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m12:24:56.474663 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m12:24:56.476494 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m12:24:56.477303 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:24:56.477499 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m12:24:56.477743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:56.488904 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:24:56.489260 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:24:56.489549 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT "Code INSEE région",	"Région"	,	"Date",	"Heure",	
"Consommation (MW)"	,"Thermique (MW)",	"Nucléaire (MW)",	"Eolien (MW)",	"Solaire (MW)",	"Hydraulique (MW)",	"Pompage (MW)",	"Bioénergies (MW)",	"Ech. physiques (MW)","production_totale"

     FROM clean
  );

[0m12:24:56.490504 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:24:56.493033 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:24:56.493254 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m12:24:56.493638 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:56.495187 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:24:56.495405 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m12:24:56.495852 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:56.496675 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:24:56.496873 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:24:56.497129 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:24:56.501586 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:24:56.502726 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:24:56.502913 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m12:24:56.503575 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:56.504219 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m12:24:56.516080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e5af614-fe5a-4d5f-8601-a9ddc9d624de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b05550ca60>]}
[0m12:24:56.516458 [info ] [Thread-1 (]: 2 of 7 OK created sql view model main.clean .................................... [[32mOK[0m in 0.04s]
[0m12:24:56.516763 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m12:24:56.516981 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m12:24:56.517319 [info ] [Thread-1 (]: 3 of 7 START sql view model main.grain_jour .................................... [RUN]
[0m12:24:56.517563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m12:24:56.517747 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m12:24:56.518776 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m12:24:56.519657 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m12:24:56.521420 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m12:24:56.522337 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:24:56.522528 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m12:24:56.522755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:56.532647 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m12:24:56.532874 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:24:56.533130 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS thermique_total,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS nucleaire_total,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS eolien_total,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS solaire_total,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS hydraulique_total,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS bioenergies_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_total,
    SUM(COALESCE(production_totale, 0)) AS production_totale
FROM clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m12:24:56.533886 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:24:56.535420 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:24:56.535623 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour" rename to "grain_jour__dbt_backup"
[0m12:24:56.536117 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:56.537592 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:24:56.537813 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour__dbt_tmp" rename to "grain_jour"
[0m12:24:56.538209 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:56.539021 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:24:56.539210 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:24:56.539397 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:24:56.543933 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:24:56.545079 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:24:56.545281 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
drop view if exists "dev"."main"."grain_jour__dbt_backup" cascade
[0m12:24:56.545883 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:56.547088 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m12:24:56.558362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e5af614-fe5a-4d5f-8601-a9ddc9d624de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b0523d4250>]}
[0m12:24:56.558726 [info ] [Thread-1 (]: 3 of 7 OK created sql view model main.grain_jour ............................... [[32mOK[0m in 0.04s]
[0m12:24:56.559033 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m12:24:56.559242 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m12:24:56.559506 [info ] [Thread-1 (]: 4 of 7 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m12:24:56.559727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m12:24:56.559942 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m12:24:56.583518 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m12:24:56.584549 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m12:24:56.594364 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m12:24:56.595299 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:24:56.595496 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m12:24:56.595756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:56.605614 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m12:24:56.605839 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:24:56.606098 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m12:24:56.606631 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:56.608103 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:24:56.608311 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m12:24:56.608728 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:56.610412 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:24:56.610658 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m12:24:56.611082 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:56.613657 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:24:56.613889 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:24:56.614251 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:24:56.618656 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:24:56.619940 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:24:56.620144 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m12:24:56.620797 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:56.621494 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m12:24:56.635920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e5af614-fe5a-4d5f-8601-a9ddc9d624de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b0523c9360>]}
[0m12:24:56.636383 [info ] [Thread-1 (]: 4 of 7 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.08s]
[0m12:24:56.636704 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m12:24:56.636934 [debug] [Thread-1 (]: Began running node model.transform.test
[0m12:24:56.637276 [info ] [Thread-1 (]: 5 of 7 START sql view model main.test .......................................... [RUN]
[0m12:24:56.637533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.test)
[0m12:24:56.637733 [debug] [Thread-1 (]: Began compiling node model.transform.test
[0m12:24:56.638793 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.test"
[0m12:24:56.639735 [debug] [Thread-1 (]: Began executing node model.transform.test
[0m12:24:56.642214 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.test"
[0m12:24:56.643114 [debug] [Thread-1 (]: Using duckdb connection "model.transform.test"
[0m12:24:56.643315 [debug] [Thread-1 (]: On model.transform.test: BEGIN
[0m12:24:56.643556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:56.653762 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m12:24:56.654007 [debug] [Thread-1 (]: Using duckdb connection "model.transform.test"
[0m12:24:56.654308 [debug] [Thread-1 (]: On model.transform.test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.test"} */

  
  create view "dev"."main"."test__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           -- Traitement de la colonne "Consommation (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Consommation (MW)" = '' OR "Consommation (MW)" = 'ND' OR "Consommation (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Consommation (MW)" AS INT)
           END AS "Consommation (MW)",
           
           -- Traitement de la colonne "Eolien (MW)" : remplacer 'ND' par 0
           CASE
               WHEN "Eolien (MW)" = 'ND' OR "Eolien (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Eolien (MW)" AS INT)
           END AS "Eolien (MW)",
           
           -- Traitement de la colonne "Thermique (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Thermique (MW)" = '' OR "Thermique (MW)" = 'ND' OR "Thermique (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Thermique (MW)" AS INT)
           END AS "Thermique (MW)",

           -- Traitement de la colonne "Bioénergies (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Bioénergies (MW)" = '' OR "Bioénergies (MW)" = 'ND' OR "Bioénergies (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Bioénergies (MW)" AS INT)
           END AS "Bioénergies (MW)",

           -- Traitement des autres colonnes : remplacer les vides par 0
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) AS "Nucléaire (MW)",
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) AS "Solaire (MW)",
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) AS "Hydraulique (MW)",
           COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0) AS "Pompage (MW)",
           COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0) AS "Ech. physiques (MW)"
    FROM eco2
    WHERE "Région" IS NOT NULL AND "Date" IS NOT NULL
),
clean AS (
    SELECT *, 
           -- Calcul de la production totale en sommant les valeurs traitées (assurant que toutes les valeurs sont numériques)
           COALESCE("Nucléaire (MW)", 0) + 
           COALESCE("Eolien (MW)", 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Code INSEE région",
    "Région", 
    "Date", 
    "Heure", 
    "Consommation (MW)",
    "Thermique (MW)",
    "Nucléaire (MW)",
    "Eolien (MW)",
    "Solaire (MW)",
    "Hydraulique (MW)",
    "Pompage (MW)",
    "Bioénergies (MW)",
    "Ech. physiques (MW)",
    production_totale
FROM clean;
  );

[0m12:24:56.654763 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.test"} */

  
  create view "dev"."main"."test__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           -- Traitement de la colonne "Consommation (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Consommation (MW)" = '' OR "Consommation (MW)" = 'ND' OR "Consommation (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Consommation (MW)" AS INT)
           END AS "Consommation (MW)",
           
           -- Traitement de la colonne "Eolien (MW)" : remplacer 'ND' par 0
           CASE
               WHEN "Eolien (MW)" = 'ND' OR "Eolien (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Eolien (MW)" AS INT)
           END AS "Eolien (MW)",
           
           -- Traitement de la colonne "Thermique (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Thermique (MW)" = '' OR "Thermique (MW)" = 'ND' OR "Thermique (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Thermique (MW)" AS INT)
           END AS "Thermique (MW)",

           -- Traitement de la colonne "Bioénergies (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Bioénergies (MW)" = '' OR "Bioénergies (MW)" = 'ND' OR "Bioénergies (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Bioénergies (MW)" AS INT)
           END AS "Bioénergies (MW)",

           -- Traitement des autres colonnes : remplacer les vides par 0
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) AS "Nucléaire (MW)",
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) AS "Solaire (MW)",
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) AS "Hydraulique (MW)",
           COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0) AS "Pompage (MW)",
           COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0) AS "Ech. physiques (MW)"
    FROM eco2
    WHERE "Région" IS NOT NULL AND "Date" IS NOT NULL
),
clean AS (
    SELECT *, 
           -- Calcul de la production totale en sommant les valeurs traitées (assurant que toutes les valeurs sont numériques)
           COALESCE("Nucléaire (MW)", 0) + 
           COALESCE("Eolien (MW)", 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Code INSEE région",
    "Région", 
    "Date", 
    "Heure", 
    "Consommation (MW)",
    "Thermique (MW)",
    "Nucléaire (MW)",
    "Eolien (MW)",
    "Solaire (MW)",
    "Hydraulique (MW)",
    "Pompage (MW)",
    "Bioénergies (MW)",
    "Ech. physiques (MW)",
    production_totale
FROM clean;
  );

[0m12:24:56.655014 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:24:56.655348 [debug] [Thread-1 (]: On model.transform.test: ROLLBACK
[0m12:24:56.657342 [debug] [Thread-1 (]: Failed to rollback 'model.transform.test'
[0m12:24:56.657548 [debug] [Thread-1 (]: On model.transform.test: Close
[0m12:24:56.658936 [debug] [Thread-1 (]: Runtime Error in model test (models/test.sql)
  Parser Error: syntax error at or near ";"
[0m12:24:56.659178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e5af614-fe5a-4d5f-8601-a9ddc9d624de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b052d62230>]}
[0m12:24:56.659496 [error] [Thread-1 (]: 5 of 7 ERROR creating sql view model main.test ................................. [[31mERROR[0m in 0.02s]
[0m12:24:56.659795 [debug] [Thread-1 (]: Finished running node model.transform.test
[0m12:24:56.660003 [debug] [Thread-1 (]: Began running node model.transform.3_2
[0m12:24:56.660584 [info ] [Thread-1 (]: 6 of 7 START sql view model main.3_2 ........................................... [RUN]
[0m12:24:56.660832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.test, now model.transform.3_2)
[0m12:24:56.661037 [debug] [Thread-1 (]: Began compiling node model.transform.3_2
[0m12:24:56.663461 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_2"
[0m12:24:56.664381 [debug] [Thread-1 (]: Began executing node model.transform.3_2
[0m12:24:56.666209 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_2"
[0m12:24:56.667099 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:24:56.667284 [debug] [Thread-1 (]: On model.transform.3_2: BEGIN
[0m12:24:56.667517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:56.677566 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m12:24:56.677831 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:24:56.678153 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */

  
  create view "dev"."main"."3_2__dbt_tmp" as (
    -- Récupérer les régions distinctes dans un set Jinja


SELECT 
    Date,
    
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bourgogne-Franche-Comté' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bourgogne-Franche-Comté"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Centre-Val de Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Centre-Val de Loire"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Nouvelle-Aquitaine' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Nouvelle-Aquitaine"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Occitanie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Occitanie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Île-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Île-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Normandie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Normandie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Grand Est' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Grand Est"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Provence-Alpes-Côte d''Azur' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Provence-Alpes-Côte d''Azur"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bretagne' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bretagne"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Hauts-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Hauts-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Auvergne-Rhône-Alpes' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Auvergne-Rhône-Alpes"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Pays de la Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Pays de la Loire"
        
    
    
FROM 
    "dev"."main"."clean"
GROUP BY 
    Date
ORDER BY 
    Date
  );

[0m12:24:56.679248 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:24:56.681136 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:24:56.681411 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
alter view "dev"."main"."3_2" rename to "3_2__dbt_backup"
[0m12:24:56.681970 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:56.684334 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:24:56.684730 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
alter view "dev"."main"."3_2__dbt_tmp" rename to "3_2"
[0m12:24:56.685351 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:56.686980 [debug] [Thread-1 (]: On model.transform.3_2: COMMIT
[0m12:24:56.687406 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:24:56.687765 [debug] [Thread-1 (]: On model.transform.3_2: COMMIT
[0m12:24:56.693113 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:24:56.697395 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:24:56.698161 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
drop view if exists "dev"."main"."3_2__dbt_backup" cascade
[0m12:24:56.699655 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:24:56.701693 [debug] [Thread-1 (]: On model.transform.3_2: Close
[0m12:24:56.717579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e5af614-fe5a-4d5f-8601-a9ddc9d624de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b052d516c0>]}
[0m12:24:56.718187 [info ] [Thread-1 (]: 6 of 7 OK created sql view model main.3_2 ...................................... [[32mOK[0m in 0.06s]
[0m12:24:56.718701 [debug] [Thread-1 (]: Finished running node model.transform.3_2
[0m12:24:56.719046 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m12:24:56.719460 [info ] [Thread-1 (]: 7 of 7 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m12:24:56.719801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_2, now model.transform.my_second_dbt_model)
[0m12:24:56.720065 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m12:24:56.721860 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m12:24:56.722793 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m12:24:56.725244 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m12:24:56.726116 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:24:56.726310 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m12:24:56.726541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:56.736825 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m12:24:56.737087 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:24:56.737368 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m12:24:56.737869 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:56.739486 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:24:56.739694 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m12:24:56.740125 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:56.741576 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:24:56.741783 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m12:24:56.742188 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:24:56.742998 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:24:56.743198 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:24:56.743444 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:24:56.747811 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:24:56.749052 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:24:56.749259 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m12:24:56.751837 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:24:56.752590 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m12:24:56.764413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e5af614-fe5a-4d5f-8601-a9ddc9d624de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b052360f40>]}
[0m12:24:56.764847 [info ] [Thread-1 (]: 7 of 7 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m12:24:56.765165 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m12:24:56.765793 [debug] [MainThread]: Using duckdb connection "master"
[0m12:24:56.766009 [debug] [MainThread]: On master: BEGIN
[0m12:24:56.766203 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:24:56.779035 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m12:24:56.779605 [debug] [MainThread]: On master: COMMIT
[0m12:24:56.780036 [debug] [MainThread]: Using duckdb connection "master"
[0m12:24:56.780396 [debug] [MainThread]: On master: COMMIT
[0m12:24:56.781116 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:24:56.781560 [debug] [MainThread]: On master: Close
[0m12:24:56.783807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:24:56.784250 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m12:24:56.784580 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m12:24:56.785045 [info ] [MainThread]: 
[0m12:24:56.785433 [info ] [MainThread]: Finished running 6 view models, 1 table model in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m12:24:56.786748 [debug] [MainThread]: Command end result
[0m12:24:56.809028 [info ] [MainThread]: 
[0m12:24:56.809319 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:24:56.809672 [info ] [MainThread]: 
[0m12:24:56.809932 [error] [MainThread]:   Runtime Error in model test (models/test.sql)
  Parser Error: syntax error at or near ";"
[0m12:24:56.810139 [info ] [MainThread]: 
[0m12:24:56.810399 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m12:24:56.810896 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1524189, "process_in_blocks": "13472", "process_kernel_time": 0.149462, "process_mem_max_rss": "139660", "process_out_blocks": "11232", "process_user_time": 1.464929}
[0m12:24:56.811197 [debug] [MainThread]: Command `dbt run` failed at 12:24:56.811147 after 1.15 seconds
[0m12:24:56.811398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b05cefbc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b05c0dcdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b055506380>]}
[0m12:24:56.811629 [debug] [MainThread]: Flushing usage events
[0m12:25:03.096189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7388616ffc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738861a32890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738861a330a0>]}


============================== 12:25:03.098900 | fc4f3c05-2f18-4ad8-9896-6874d3d01a61 ==============================
[0m12:25:03.098900 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:25:03.099705 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:25:03.229591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc4f3c05-2f18-4ad8-9896-6874d3d01a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738861161120>]}
[0m12:25:03.256976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc4f3c05-2f18-4ad8-9896-6874d3d01a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7388608e4d90>]}
[0m12:25:03.259738 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m12:25:03.301584 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:25:03.429798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:25:03.430537 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:25:03.440292 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m12:25:03.459097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc4f3c05-2f18-4ad8-9896-6874d3d01a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73885a7e1d50>]}
[0m12:25:03.519091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc4f3c05-2f18-4ad8-9896-6874d3d01a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73885a76fdc0>]}
[0m12:25:03.519363 [info ] [MainThread]: Found 7 models, 4 data tests, 421 macros
[0m12:25:03.519819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc4f3c05-2f18-4ad8-9896-6874d3d01a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73885a76eef0>]}
[0m12:25:03.520861 [info ] [MainThread]: 
[0m12:25:03.521155 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:25:03.524345 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:25:03.726199 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:25:03.726477 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:25:03.726886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:03.739178 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m12:25:03.739846 [debug] [ThreadPool]: On list_dev: Close
[0m12:25:03.741515 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:25:03.741805 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:25:03.745451 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:25:03.745651 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:25:03.746017 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:03.757332 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m12:25:03.758420 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:25:03.758756 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:25:03.759401 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:25:03.759712 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:25:03.760131 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:25:03.760816 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:25:03.761523 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:25:03.761831 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:25:03.762229 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:25:03.762778 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:25:03.763036 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:25:03.765412 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:25:03.773152 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:25:03.773350 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:25:03.773713 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:03.792256 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m12:25:03.793056 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:25:03.793762 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:25:03.817998 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m12:25:03.818686 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:25:03.819441 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:25:03.819610 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:25:03.822180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc4f3c05-2f18-4ad8-9896-6874d3d01a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738859d0d780>]}
[0m12:25:03.822419 [debug] [MainThread]: Using duckdb connection "master"
[0m12:25:03.822757 [debug] [MainThread]: On master: BEGIN
[0m12:25:03.823078 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:25:03.835543 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m12:25:03.835977 [debug] [MainThread]: On master: COMMIT
[0m12:25:03.836745 [debug] [MainThread]: Using duckdb connection "master"
[0m12:25:03.837283 [debug] [MainThread]: On master: COMMIT
[0m12:25:03.838017 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:25:03.838426 [debug] [MainThread]: On master: Close
[0m12:25:03.841023 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:25:03.841556 [info ] [MainThread]: 
[0m12:25:03.843877 [debug] [Thread-1 (]: Began running node model.transform.3_1
[0m12:25:03.844483 [info ] [Thread-1 (]: 1 of 7 START sql view model main.3_1 ........................................... [RUN]
[0m12:25:03.845169 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.3_1'
[0m12:25:03.845632 [debug] [Thread-1 (]: Began compiling node model.transform.3_1
[0m12:25:03.851671 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_1"
[0m12:25:03.852956 [debug] [Thread-1 (]: Began executing node model.transform.3_1
[0m12:25:03.869057 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_1"
[0m12:25:03.870287 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:25:03.870481 [debug] [Thread-1 (]: On model.transform.3_1: BEGIN
[0m12:25:03.870801 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:25:03.882034 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:25:03.882258 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:25:03.882855 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    strftime('%Y-%m', Date) AS mois,  -- Utilisation de strftime pour extraire l'année et le mois
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0))/2000 AS consommation_totale_en_GWH,
    SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,

    MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
FROM clean
GROUP BY strftime('%Y-%m', Date), "Région"  -- Remplacer TO_CHAR par strftime
ORDER BY mois, "Région"  -- Tri par mois et région
  );

[0m12:25:03.883791 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:25:03.886948 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:25:03.887159 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1" rename to "3_1__dbt_backup"
[0m12:25:03.887625 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:25:03.889022 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:25:03.889222 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1__dbt_tmp" rename to "3_1"
[0m12:25:03.889768 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:25:03.897842 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m12:25:03.898061 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:25:03.898387 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m12:25:03.902215 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:25:03.904666 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:25:03.904887 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
drop view if exists "dev"."main"."3_1__dbt_backup" cascade
[0m12:25:03.905661 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:25:03.906923 [debug] [Thread-1 (]: On model.transform.3_1: Close
[0m12:25:03.920400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc4f3c05-2f18-4ad8-9896-6874d3d01a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73885a7fd9c0>]}
[0m12:25:03.920819 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.3_1 ...................................... [[32mOK[0m in 0.07s]
[0m12:25:03.921155 [debug] [Thread-1 (]: Finished running node model.transform.3_1
[0m12:25:03.921436 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m12:25:03.921768 [info ] [Thread-1 (]: 2 of 7 START sql view model main.clean ......................................... [RUN]
[0m12:25:03.922149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_1, now model.transform.clean)
[0m12:25:03.922413 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m12:25:03.923519 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m12:25:03.924696 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m12:25:03.926945 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m12:25:03.928243 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:25:03.928522 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m12:25:03.928833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:03.943446 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m12:25:03.943916 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:25:03.944607 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT "Code INSEE région",	"Région"	,	"Date",	"Heure",	
"Consommation (MW)"	,"Thermique (MW)",	"Nucléaire (MW)",	"Eolien (MW)",	"Solaire (MW)",	"Hydraulique (MW)",	"Pompage (MW)",	"Bioénergies (MW)",	"Ech. physiques (MW)","production_totale"

     FROM clean
  );

[0m12:25:03.945822 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:25:03.949060 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:25:03.949360 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m12:25:03.949989 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:25:03.952128 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:25:03.952473 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m12:25:03.953032 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:25:03.954647 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:25:03.955083 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:25:03.955542 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:25:03.960818 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:25:03.964500 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:25:03.965068 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m12:25:03.966127 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:25:03.967614 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m12:25:03.982227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc4f3c05-2f18-4ad8-9896-6874d3d01a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738856b89960>]}
[0m12:25:03.982772 [info ] [Thread-1 (]: 2 of 7 OK created sql view model main.clean .................................... [[32mOK[0m in 0.06s]
[0m12:25:03.983210 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m12:25:03.983512 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m12:25:03.983930 [info ] [Thread-1 (]: 3 of 7 START sql view model main.grain_jour .................................... [RUN]
[0m12:25:03.984358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m12:25:03.984697 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m12:25:03.986021 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m12:25:03.987420 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m12:25:03.989282 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m12:25:03.990573 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:25:03.990757 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m12:25:03.991062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:04.002390 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:25:04.002664 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:25:04.003238 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS thermique_total,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS nucleaire_total,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS eolien_total,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS solaire_total,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS hydraulique_total,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS bioenergies_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_total,
    SUM(COALESCE(production_totale, 0)) AS production_totale
FROM clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m12:25:04.004181 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:25:04.005734 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:25:04.005940 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour" rename to "grain_jour__dbt_backup"
[0m12:25:04.006454 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:25:04.007886 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:25:04.008089 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour__dbt_tmp" rename to "grain_jour"
[0m12:25:04.008648 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:25:04.009437 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:25:04.009623 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:25:04.009925 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:25:04.015161 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:25:04.016302 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:25:04.016500 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
drop view if exists "dev"."main"."grain_jour__dbt_backup" cascade
[0m12:25:04.017193 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:25:04.018411 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m12:25:04.031630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc4f3c05-2f18-4ad8-9896-6874d3d01a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738856bd8220>]}
[0m12:25:04.032251 [info ] [Thread-1 (]: 3 of 7 OK created sql view model main.grain_jour ............................... [[32mOK[0m in 0.05s]
[0m12:25:04.032825 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m12:25:04.033229 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m12:25:04.033696 [info ] [Thread-1 (]: 4 of 7 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m12:25:04.034100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m12:25:04.034438 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m12:25:04.058111 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m12:25:04.059695 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m12:25:04.069532 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m12:25:04.070861 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:25:04.071077 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m12:25:04.071586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:04.083190 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m12:25:04.083421 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:25:04.084043 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m12:25:04.084807 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:25:04.086320 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:25:04.086526 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m12:25:04.087188 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:25:04.088688 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:25:04.088918 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m12:25:04.089433 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:25:04.092201 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:25:04.092431 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:25:04.092797 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:25:04.097733 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:25:04.099066 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:25:04.099296 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m12:25:04.100268 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:25:04.101193 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m12:25:04.117624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc4f3c05-2f18-4ad8-9896-6874d3d01a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738856bc9390>]}
[0m12:25:04.118253 [info ] [Thread-1 (]: 4 of 7 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.08s]
[0m12:25:04.118762 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m12:25:04.119123 [debug] [Thread-1 (]: Began running node model.transform.test
[0m12:25:04.119594 [info ] [Thread-1 (]: 5 of 7 START sql view model main.test .......................................... [RUN]
[0m12:25:04.120036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.test)
[0m12:25:04.120425 [debug] [Thread-1 (]: Began compiling node model.transform.test
[0m12:25:04.121739 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.test"
[0m12:25:04.123109 [debug] [Thread-1 (]: Began executing node model.transform.test
[0m12:25:04.126095 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.test"
[0m12:25:04.127390 [debug] [Thread-1 (]: Using duckdb connection "model.transform.test"
[0m12:25:04.127580 [debug] [Thread-1 (]: On model.transform.test: BEGIN
[0m12:25:04.127900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:04.139371 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:25:04.139687 [debug] [Thread-1 (]: Using duckdb connection "model.transform.test"
[0m12:25:04.140444 [debug] [Thread-1 (]: On model.transform.test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.test"} */

  
  create view "dev"."main"."test__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           -- Traitement de la colonne "Consommation (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Consommation (MW)" = '' OR "Consommation (MW)" = 'ND' OR "Consommation (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Consommation (MW)" AS INT)
           END AS "Consommation (MW)",
           
           -- Traitement de la colonne "Eolien (MW)" : remplacer 'ND' par 0
           CASE
               WHEN "Eolien (MW)" = 'ND' OR "Eolien (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Eolien (MW)" AS INT)
           END AS "Eolien (MW)",
           
           -- Traitement de la colonne "Thermique (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Thermique (MW)" = '' OR "Thermique (MW)" = 'ND' OR "Thermique (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Thermique (MW)" AS INT)
           END AS "Thermique (MW)",

           -- Traitement de la colonne "Bioénergies (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Bioénergies (MW)" = '' OR "Bioénergies (MW)" = 'ND' OR "Bioénergies (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Bioénergies (MW)" AS INT)
           END AS "Bioénergies (MW)",

           -- Traitement des autres colonnes : remplacer les vides par 0
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) AS "Nucléaire (MW)",
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) AS "Solaire (MW)",
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) AS "Hydraulique (MW)",
           COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0) AS "Pompage (MW)",
           COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0) AS "Ech. physiques (MW)"
    FROM eco2
    WHERE "Région" IS NOT NULL AND "Date" IS NOT NULL
),
clean AS (
    SELECT *, 
           -- Calcul de la production totale en sommant les valeurs traitées (assurant que toutes les valeurs sont numériques)
           COALESCE("Nucléaire (MW)", 0) + 
           COALESCE("Eolien (MW)", 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Code INSEE région",
    "Région", 
    "Date", 
    "Heure", 
    "Consommation (MW)",
    "Thermique (MW)",
    "Nucléaire (MW)",
    "Eolien (MW)",
    "Solaire (MW)",
    "Hydraulique (MW)",
    "Pompage (MW)",
    "Bioénergies (MW)",
    "Ech. physiques (MW)",
    production_totale
FROM clean
  );

[0m12:25:04.141528 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.test"} */

  
  create view "dev"."main"."test__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           -- Traitement de la colonne "Consommation (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Consommation (MW)" = '' OR "Consommation (MW)" = 'ND' OR "Consommation (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Consommation (MW)" AS INT)
           END AS "Consommation (MW)",
           
           -- Traitement de la colonne "Eolien (MW)" : remplacer 'ND' par 0
           CASE
               WHEN "Eolien (MW)" = 'ND' OR "Eolien (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Eolien (MW)" AS INT)
           END AS "Eolien (MW)",
           
           -- Traitement de la colonne "Thermique (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Thermique (MW)" = '' OR "Thermique (MW)" = 'ND' OR "Thermique (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Thermique (MW)" AS INT)
           END AS "Thermique (MW)",

           -- Traitement de la colonne "Bioénergies (MW)" : remplacer les vides et 'ND' par 0
           CASE
               WHEN "Bioénergies (MW)" = '' OR "Bioénergies (MW)" = 'ND' OR "Bioénergies (MW)" IS NULL THEN 0
               ELSE TRY_CAST("Bioénergies (MW)" AS INT)
           END AS "Bioénergies (MW)",

           -- Traitement des autres colonnes : remplacer les vides par 0
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) AS "Nucléaire (MW)",
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) AS "Solaire (MW)",
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) AS "Hydraulique (MW)",
           COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0) AS "Pompage (MW)",
           COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0) AS "Ech. physiques (MW)"
    FROM eco2
    WHERE "Région" IS NOT NULL AND "Date" IS NOT NULL
),
clean AS (
    SELECT *, 
           -- Calcul de la production totale en sommant les valeurs traitées (assurant que toutes les valeurs sont numériques)
           COALESCE("Nucléaire (MW)", 0) + 
           COALESCE("Eolien (MW)", 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Code INSEE région",
    "Région", 
    "Date", 
    "Heure", 
    "Consommation (MW)",
    "Thermique (MW)",
    "Nucléaire (MW)",
    "Eolien (MW)",
    "Solaire (MW)",
    "Hydraulique (MW)",
    "Pompage (MW)",
    "Bioénergies (MW)",
    "Ech. physiques (MW)",
    production_totale
FROM clean
  );

[0m12:25:04.141847 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:25:04.142440 [debug] [Thread-1 (]: On model.transform.test: ROLLBACK
[0m12:25:04.145323 [debug] [Thread-1 (]: Failed to rollback 'model.transform.test'
[0m12:25:04.145551 [debug] [Thread-1 (]: On model.transform.test: Close
[0m12:25:04.147425 [debug] [Thread-1 (]: Runtime Error in model test (models/test.sql)
  Binder Error: Cannot mix values of type VARCHAR and INTEGER_LITERAL in COALESCE operator - an explicit cast is required
[0m12:25:04.147715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc4f3c05-2f18-4ad8-9896-6874d3d01a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73885754d2d0>]}
[0m12:25:04.148215 [error] [Thread-1 (]: 5 of 7 ERROR creating sql view model main.test ................................. [[31mERROR[0m in 0.03s]
[0m12:25:04.148540 [debug] [Thread-1 (]: Finished running node model.transform.test
[0m12:25:04.148816 [debug] [Thread-1 (]: Began running node model.transform.3_2
[0m12:25:04.149573 [info ] [Thread-1 (]: 6 of 7 START sql view model main.3_2 ........................................... [RUN]
[0m12:25:04.149862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.test, now model.transform.3_2)
[0m12:25:04.150136 [debug] [Thread-1 (]: Began compiling node model.transform.3_2
[0m12:25:04.152679 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_2"
[0m12:25:04.153844 [debug] [Thread-1 (]: Began executing node model.transform.3_2
[0m12:25:04.155651 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_2"
[0m12:25:04.156834 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:25:04.157019 [debug] [Thread-1 (]: On model.transform.3_2: BEGIN
[0m12:25:04.157313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:04.168104 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:25:04.168383 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:25:04.169100 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */

  
  create view "dev"."main"."3_2__dbt_tmp" as (
    -- Récupérer les régions distinctes dans un set Jinja


SELECT 
    Date,
    
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bourgogne-Franche-Comté' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bourgogne-Franche-Comté"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Centre-Val de Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Centre-Val de Loire"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Nouvelle-Aquitaine' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Nouvelle-Aquitaine"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Occitanie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Occitanie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Île-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Île-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Normandie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Normandie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Grand Est' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Grand Est"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Provence-Alpes-Côte d''Azur' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Provence-Alpes-Côte d''Azur"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bretagne' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bretagne"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Hauts-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Hauts-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Auvergne-Rhône-Alpes' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Auvergne-Rhône-Alpes"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Pays de la Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Pays de la Loire"
        
    
    
FROM 
    "dev"."main"."clean"
GROUP BY 
    Date
ORDER BY 
    Date
  );

[0m12:25:04.170621 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:25:04.173354 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:25:04.173748 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
alter view "dev"."main"."3_2" rename to "3_2__dbt_backup"
[0m12:25:04.174514 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:25:04.177700 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:25:04.178116 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
alter view "dev"."main"."3_2__dbt_tmp" rename to "3_2"
[0m12:25:04.179092 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:25:04.180495 [debug] [Thread-1 (]: On model.transform.3_2: COMMIT
[0m12:25:04.180795 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:25:04.181230 [debug] [Thread-1 (]: On model.transform.3_2: COMMIT
[0m12:25:04.186393 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:25:04.188314 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:25:04.188635 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
drop view if exists "dev"."main"."3_2__dbt_backup" cascade
[0m12:25:04.189612 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:25:04.190549 [debug] [Thread-1 (]: On model.transform.3_2: Close
[0m12:25:04.206973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc4f3c05-2f18-4ad8-9896-6874d3d01a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73885753e6e0>]}
[0m12:25:04.208155 [info ] [Thread-1 (]: 6 of 7 OK created sql view model main.3_2 ...................................... [[32mOK[0m in 0.06s]
[0m12:25:04.209071 [debug] [Thread-1 (]: Finished running node model.transform.3_2
[0m12:25:04.209675 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m12:25:04.210414 [info ] [Thread-1 (]: 7 of 7 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m12:25:04.210993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_2, now model.transform.my_second_dbt_model)
[0m12:25:04.211465 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m12:25:04.214224 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m12:25:04.215314 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m12:25:04.218884 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m12:25:04.219905 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:25:04.220121 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m12:25:04.220342 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:04.231027 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:25:04.231355 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:25:04.231656 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m12:25:04.232230 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:25:04.234011 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:25:04.234226 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m12:25:04.234584 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:25:04.236027 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:25:04.236232 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m12:25:04.236574 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:25:04.237368 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:25:04.237564 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:25:04.237830 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:25:04.242218 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:25:04.243421 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:25:04.243632 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m12:25:04.244237 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:25:04.244933 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m12:25:04.256660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc4f3c05-2f18-4ad8-9896-6874d3d01a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738856b62260>]}
[0m12:25:04.257052 [info ] [Thread-1 (]: 7 of 7 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m12:25:04.257362 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m12:25:04.258016 [debug] [MainThread]: Using duckdb connection "master"
[0m12:25:04.258204 [debug] [MainThread]: On master: BEGIN
[0m12:25:04.258472 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:25:04.271809 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m12:25:04.272438 [debug] [MainThread]: On master: COMMIT
[0m12:25:04.272898 [debug] [MainThread]: Using duckdb connection "master"
[0m12:25:04.273326 [debug] [MainThread]: On master: COMMIT
[0m12:25:04.274050 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:25:04.274543 [debug] [MainThread]: On master: Close
[0m12:25:04.276836 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:25:04.277236 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m12:25:04.277558 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m12:25:04.277950 [info ] [MainThread]: 
[0m12:25:04.278276 [info ] [MainThread]: Finished running 6 view models, 1 table model in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m12:25:04.279461 [debug] [MainThread]: Command end result
[0m12:25:04.300831 [info ] [MainThread]: 
[0m12:25:04.301077 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:25:04.301444 [info ] [MainThread]: 
[0m12:25:04.301713 [error] [MainThread]:   Runtime Error in model test (models/test.sql)
  Binder Error: Cannot mix values of type VARCHAR and INTEGER_LITERAL in COALESCE operator - an explicit cast is required
[0m12:25:04.301868 [info ] [MainThread]: 
[0m12:25:04.302073 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m12:25:04.302498 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.234148, "process_in_blocks": "13440", "process_kernel_time": 0.136264, "process_mem_max_rss": "140504", "process_out_blocks": "11240", "process_user_time": 1.477866}
[0m12:25:04.302795 [debug] [MainThread]: Command `dbt run` failed at 12:25:04.302738 after 1.23 seconds
[0m12:25:04.302990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7388616ffc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7388608e4dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738859d0b0d0>]}
[0m12:25:04.303216 [debug] [MainThread]: Flushing usage events
[0m12:41:44.090612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a6e977c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a6edae8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a6edaf1f0>]}


============================== 12:41:44.093971 | 4877509a-c724-4aea-8515-76db4e9fdb24 ==============================
[0m12:41:44.093971 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:41:44.094687 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:41:44.235490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4877509a-c724-4aea-8515-76db4e9fdb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a6e8a17e0>]}
[0m12:41:44.264703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4877509a-c724-4aea-8515-76db4e9fdb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a6dd1ce20>]}
[0m12:41:44.267372 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m12:41:44.309588 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:41:44.457337 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m12:41:44.458623 [debug] [MainThread]: Partial parsing: deleted file: transform://models/test.sql
[0m12:41:44.506260 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m12:41:44.508910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4877509a-c724-4aea-8515-76db4e9fdb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a6718c5b0>]}
[0m12:41:44.577842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4877509a-c724-4aea-8515-76db4e9fdb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a6718cdf0>]}
[0m12:41:44.578115 [info ] [MainThread]: Found 7 models, 4 data tests, 421 macros
[0m12:41:44.578622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4877509a-c724-4aea-8515-76db4e9fdb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a6718ce50>]}
[0m12:41:44.579737 [info ] [MainThread]: 
[0m12:41:44.580059 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:41:44.583884 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:41:45.008690 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:41:45.009471 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:41:45.010118 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:45.029417 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m12:41:45.030699 [debug] [ThreadPool]: On list_dev: Close
[0m12:41:45.033941 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:41:45.034378 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:41:45.038765 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:41:45.038974 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:41:45.039324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:41:45.050767 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m12:41:45.051608 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:41:45.051840 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:41:45.052303 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:41:45.052539 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:41:45.052853 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:41:45.053322 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:41:45.053752 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:41:45.053926 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:41:45.054234 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:41:45.054685 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:41:45.054867 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:41:45.056686 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:41:45.061214 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:41:45.061475 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:41:45.061839 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:41:45.077285 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m12:41:45.078048 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:41:45.078658 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:41:45.099747 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m12:41:45.100442 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:41:45.101192 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:41:45.101377 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:41:45.103686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4877509a-c724-4aea-8515-76db4e9fdb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a698f5f00>]}
[0m12:41:45.103929 [debug] [MainThread]: Using duckdb connection "master"
[0m12:41:45.104268 [debug] [MainThread]: On master: BEGIN
[0m12:41:45.104585 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:41:45.116217 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m12:41:45.116565 [debug] [MainThread]: On master: COMMIT
[0m12:41:45.117160 [debug] [MainThread]: Using duckdb connection "master"
[0m12:41:45.117523 [debug] [MainThread]: On master: COMMIT
[0m12:41:45.118058 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:41:45.118388 [debug] [MainThread]: On master: Close
[0m12:41:45.120922 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:41:45.121420 [info ] [MainThread]: 
[0m12:41:45.125406 [debug] [Thread-1 (]: Began running node model.transform.3_1
[0m12:41:45.126278 [info ] [Thread-1 (]: 1 of 7 START sql view model main.3_1 ........................................... [RUN]
[0m12:41:45.127182 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.3_1'
[0m12:41:45.127836 [debug] [Thread-1 (]: Began compiling node model.transform.3_1
[0m12:41:45.135655 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_1"
[0m12:41:45.137866 [debug] [Thread-1 (]: Began executing node model.transform.3_1
[0m12:41:45.154418 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_1"
[0m12:41:45.156615 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:41:45.156813 [debug] [Thread-1 (]: On model.transform.3_1: BEGIN
[0m12:41:45.157133 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:41:45.168405 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:41:45.168633 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:41:45.169266 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    strftime('%Y-%m', Date) AS mois,  -- Utilisation de strftime pour extraire l'année et le mois
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0))/2000 AS consommation_totale_en_GWH,
    SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,

    MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
FROM clean
GROUP BY strftime('%Y-%m', Date), "Région"  -- Remplacer TO_CHAR par strftime
ORDER BY mois, "Région"  -- Tri par mois et région
  );

[0m12:41:45.170156 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:41:45.173842 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:41:45.174079 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1" rename to "3_1__dbt_backup"
[0m12:41:45.174672 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:41:45.176133 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:41:45.176334 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1__dbt_tmp" rename to "3_1"
[0m12:41:45.176852 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:41:45.185343 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m12:41:45.185563 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:41:45.185959 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m12:41:45.187656 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:41:45.190077 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:41:45.190747 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
drop view if exists "dev"."main"."3_1__dbt_backup" cascade
[0m12:41:45.191527 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:41:45.192802 [debug] [Thread-1 (]: On model.transform.3_1: Close
[0m12:41:45.205939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4877509a-c724-4aea-8515-76db4e9fdb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a6718cd30>]}
[0m12:41:45.206306 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.3_1 ...................................... [[32mOK[0m in 0.08s]
[0m12:41:45.206618 [debug] [Thread-1 (]: Finished running node model.transform.3_1
[0m12:41:45.206837 [debug] [Thread-1 (]: Began running node model.transform.cleaan
[0m12:41:45.207161 [info ] [Thread-1 (]: 2 of 7 START sql view model main.cleaan ........................................ [RUN]
[0m12:41:45.207390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_1, now model.transform.cleaan)
[0m12:41:45.207653 [debug] [Thread-1 (]: Began compiling node model.transform.cleaan
[0m12:41:45.208693 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.cleaan"
[0m12:41:45.210064 [debug] [Thread-1 (]: Began executing node model.transform.cleaan
[0m12:41:45.211870 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.cleaan"
[0m12:41:45.213057 [debug] [Thread-1 (]: Using duckdb connection "model.transform.cleaan"
[0m12:41:45.213247 [debug] [Thread-1 (]: On model.transform.cleaan: BEGIN
[0m12:41:45.213557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:45.224746 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:41:45.224994 [debug] [Thread-1 (]: Using duckdb connection "model.transform.cleaan"
[0m12:41:45.225664 [debug] [Thread-1 (]: On model.transform.cleaan: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.cleaan"} */

  
  create view "dev"."main"."cleaan__dbt_tmp" as (
    WITH data_clean AS(

    SELECT *,COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0) AS consommation,
    COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) AS eolien,
    COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS thermique,
    COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0) AS bioenergies,
    COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) AS nucleaire,
    COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) AS solaire,
    COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) AS hydraulique,
    COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0) AS pompage,
    COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0) AS ech_physiques
    FROM eco2
    WHERE "Région" IS NOT NULL AND "Date" IS NOT NULL
)

final AS(
    SELECT "Code INSEE région",	"Région"	,	"Date",	"Heure",consommation,eolien,thermique,bioenergies,nucleaire,solaire,hydraulique,pompage,ech_physiques,
    COALESCE(nucleaire, 0) + 
    COALESCE(eolien, 0) +
    COALESCE(solaire, 0) +
    COALESCE(hydraulique, 0) +
    COALESCE(thermique, 0) AS production_totale
    FROM data_clean
)

SELECT * FROM final
  );

[0m12:41:45.226325 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.cleaan"} */

  
  create view "dev"."main"."cleaan__dbt_tmp" as (
    WITH data_clean AS(

    SELECT *,COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0) AS consommation,
    COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) AS eolien,
    COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS thermique,
    COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0) AS bioenergies,
    COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) AS nucleaire,
    COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) AS solaire,
    COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) AS hydraulique,
    COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0) AS pompage,
    COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0) AS ech_physiques
    FROM eco2
    WHERE "Région" IS NOT NULL AND "Date" IS NOT NULL
)

final AS(
    SELECT "Code INSEE région",	"Région"	,	"Date",	"Heure",consommation,eolien,thermique,bioenergies,nucleaire,solaire,hydraulique,pompage,ech_physiques,
    COALESCE(nucleaire, 0) + 
    COALESCE(eolien, 0) +
    COALESCE(solaire, 0) +
    COALESCE(hydraulique, 0) +
    COALESCE(thermique, 0) AS production_totale
    FROM data_clean
)

SELECT * FROM final
  );

[0m12:41:45.226544 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:41:45.226910 [debug] [Thread-1 (]: On model.transform.cleaan: ROLLBACK
[0m12:41:45.230140 [debug] [Thread-1 (]: Failed to rollback 'model.transform.cleaan'
[0m12:41:45.230353 [debug] [Thread-1 (]: On model.transform.cleaan: Close
[0m12:41:45.232845 [debug] [Thread-1 (]: Runtime Error in model cleaan (models/example/cleaan.sql)
  Parser Error: syntax error at or near "final"
[0m12:41:45.233295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4877509a-c724-4aea-8515-76db4e9fdb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a649c1720>]}
[0m12:41:45.233736 [error] [Thread-1 (]: 2 of 7 ERROR creating sql view model main.cleaan ............................... [[31mERROR[0m in 0.03s]
[0m12:41:45.234031 [debug] [Thread-1 (]: Finished running node model.transform.cleaan
[0m12:41:45.234296 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m12:41:45.235161 [info ] [Thread-1 (]: 3 of 7 START sql view model main.clean ......................................... [RUN]
[0m12:41:45.235429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.cleaan, now model.transform.clean)
[0m12:41:45.235711 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m12:41:45.236820 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m12:41:45.238007 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m12:41:45.239788 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m12:41:45.241028 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:41:45.241214 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m12:41:45.241634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:45.252576 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:41:45.252795 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:41:45.253367 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT "Code INSEE région",	"Région"	,	"Date",	"Heure",	
"Consommation (MW)"	,"Thermique (MW)",	"Nucléaire (MW)",	"Eolien (MW)",	"Solaire (MW)",	"Hydraulique (MW)",	"Pompage (MW)",	"Bioénergies (MW)",	"Ech. physiques (MW)","production_totale"

     FROM clean
  );

[0m12:41:45.254125 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:41:45.255671 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:41:45.255875 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m12:41:45.256385 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:41:45.257864 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:41:45.258067 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m12:41:45.258528 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:41:45.259329 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:41:45.259526 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:41:45.259834 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:41:45.261533 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:41:45.262688 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:41:45.262896 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m12:41:45.263672 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:41:45.264306 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m12:41:45.276777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4877509a-c724-4aea-8515-76db4e9fdb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a64978130>]}
[0m12:41:45.277141 [info ] [Thread-1 (]: 3 of 7 OK created sql view model main.clean .................................... [[32mOK[0m in 0.04s]
[0m12:41:45.277524 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m12:41:45.277789 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m12:41:45.278123 [info ] [Thread-1 (]: 4 of 7 START sql view model main.grain_jour .................................... [RUN]
[0m12:41:45.278476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m12:41:45.278759 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m12:41:45.300249 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m12:41:45.301889 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m12:41:45.303735 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m12:41:45.304959 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:41:45.305151 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m12:41:45.305461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:45.316584 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:41:45.316815 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:41:45.317357 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS thermique_total,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS nucleaire_total,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS eolien_total,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS solaire_total,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS hydraulique_total,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS bioenergies_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_total,
    SUM(COALESCE(production_totale, 0)) AS production_totale
FROM clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m12:41:45.318326 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:41:45.319912 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:41:45.320116 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour" rename to "grain_jour__dbt_backup"
[0m12:41:45.320790 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:41:45.322207 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:41:45.322407 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour__dbt_tmp" rename to "grain_jour"
[0m12:41:45.323074 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:41:45.323897 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:41:45.324090 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:41:45.324469 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:41:45.326404 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:41:45.327603 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:41:45.327806 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
drop view if exists "dev"."main"."grain_jour__dbt_backup" cascade
[0m12:41:45.328547 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:41:45.329174 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m12:41:45.341509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4877509a-c724-4aea-8515-76db4e9fdb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a6dd09c30>]}
[0m12:41:45.341872 [info ] [Thread-1 (]: 4 of 7 OK created sql view model main.grain_jour ............................... [[32mOK[0m in 0.06s]
[0m12:41:45.342177 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m12:41:45.342424 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m12:41:45.342719 [info ] [Thread-1 (]: 5 of 7 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m12:41:45.342955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m12:41:45.343220 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m12:41:45.344704 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m12:41:45.345828 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m12:41:45.355882 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m12:41:45.357311 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:41:45.357519 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m12:41:45.357817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:45.368571 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:41:45.368804 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:41:45.369144 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m12:41:45.369727 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:41:45.371190 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:41:45.371397 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m12:41:45.371922 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:41:45.373382 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:41:45.373596 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m12:41:45.374058 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:41:45.376626 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:41:45.376842 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:41:45.377229 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:41:45.378824 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:41:45.380021 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:41:45.380223 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m12:41:45.380991 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:41:45.381705 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m12:41:45.396430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4877509a-c724-4aea-8515-76db4e9fdb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a698f4a60>]}
[0m12:41:45.396810 [info ] [Thread-1 (]: 5 of 7 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m12:41:45.397126 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m12:41:45.397379 [debug] [Thread-1 (]: Began running node model.transform.3_2
[0m12:41:45.397734 [info ] [Thread-1 (]: 6 of 7 START sql view model main.3_2 ........................................... [RUN]
[0m12:41:45.398050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.3_2)
[0m12:41:45.398300 [debug] [Thread-1 (]: Began compiling node model.transform.3_2
[0m12:41:45.400646 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_2"
[0m12:41:45.401875 [debug] [Thread-1 (]: Began executing node model.transform.3_2
[0m12:41:45.403699 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_2"
[0m12:41:45.404816 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:41:45.405021 [debug] [Thread-1 (]: On model.transform.3_2: BEGIN
[0m12:41:45.405312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:45.416141 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:41:45.416366 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:41:45.417048 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */

  
  create view "dev"."main"."3_2__dbt_tmp" as (
    -- Récupérer les régions distinctes dans un set Jinja


SELECT 
    Date,
    
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bourgogne-Franche-Comté' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bourgogne-Franche-Comté"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Centre-Val de Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Centre-Val de Loire"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Nouvelle-Aquitaine' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Nouvelle-Aquitaine"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Occitanie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Occitanie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Île-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Île-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Normandie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Normandie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Grand Est' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Grand Est"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Provence-Alpes-Côte d''Azur' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Provence-Alpes-Côte d''Azur"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bretagne' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bretagne"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Hauts-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Hauts-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Auvergne-Rhône-Alpes' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Auvergne-Rhône-Alpes"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Pays de la Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Pays de la Loire"
        
    
    
FROM 
    "dev"."main"."clean"
GROUP BY 
    Date
ORDER BY 
    Date
  );

[0m12:41:45.418044 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:41:45.419616 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:41:45.419823 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
alter view "dev"."main"."3_2" rename to "3_2__dbt_backup"
[0m12:41:45.420337 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:41:45.421722 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:41:45.421920 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
alter view "dev"."main"."3_2__dbt_tmp" rename to "3_2"
[0m12:41:45.422491 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:41:45.423276 [debug] [Thread-1 (]: On model.transform.3_2: COMMIT
[0m12:41:45.423473 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:41:45.423786 [debug] [Thread-1 (]: On model.transform.3_2: COMMIT
[0m12:41:45.425882 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:41:45.427653 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:41:45.427856 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
drop view if exists "dev"."main"."3_2__dbt_backup" cascade
[0m12:41:45.428641 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:41:45.429267 [debug] [Thread-1 (]: On model.transform.3_2: Close
[0m12:41:45.441464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4877509a-c724-4aea-8515-76db4e9fdb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a63fa5ae0>]}
[0m12:41:45.441863 [info ] [Thread-1 (]: 6 of 7 OK created sql view model main.3_2 ...................................... [[32mOK[0m in 0.04s]
[0m12:41:45.442187 [debug] [Thread-1 (]: Finished running node model.transform.3_2
[0m12:41:45.442448 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m12:41:45.442781 [info ] [Thread-1 (]: 7 of 7 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m12:41:45.443151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_2, now model.transform.my_second_dbt_model)
[0m12:41:45.443437 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m12:41:45.444968 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m12:41:45.446114 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m12:41:45.447921 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m12:41:45.449026 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:41:45.449225 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m12:41:45.449533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:45.459889 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m12:41:45.460126 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:41:45.460669 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m12:41:45.461144 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:41:45.462730 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:41:45.462950 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m12:41:45.463409 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:41:45.464838 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:41:45.465054 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m12:41:45.465511 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:41:45.466354 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:41:45.466562 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:41:45.466874 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:41:45.468481 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:41:45.469705 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:41:45.469907 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m12:41:45.470659 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:41:45.471332 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m12:41:45.483438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4877509a-c724-4aea-8515-76db4e9fdb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a64978070>]}
[0m12:41:45.483833 [info ] [Thread-1 (]: 7 of 7 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m12:41:45.484152 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m12:41:45.485176 [debug] [MainThread]: Using duckdb connection "master"
[0m12:41:45.485361 [debug] [MainThread]: On master: BEGIN
[0m12:41:45.485691 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:41:45.496750 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m12:41:45.496970 [debug] [MainThread]: On master: COMMIT
[0m12:41:45.497486 [debug] [MainThread]: Using duckdb connection "master"
[0m12:41:45.497854 [debug] [MainThread]: On master: COMMIT
[0m12:41:45.498276 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:41:45.498466 [debug] [MainThread]: On master: Close
[0m12:41:45.499908 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:41:45.500122 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m12:41:45.500461 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m12:41:45.500848 [info ] [MainThread]: 
[0m12:41:45.501086 [info ] [MainThread]: Finished running 6 view models, 1 table model in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m12:41:45.501912 [debug] [MainThread]: Command end result
[0m12:41:45.523507 [info ] [MainThread]: 
[0m12:41:45.523757 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:41:45.524234 [info ] [MainThread]: 
[0m12:41:45.524594 [error] [MainThread]:   Runtime Error in model cleaan (models/example/cleaan.sql)
  Parser Error: syntax error at or near "final"
[0m12:41:45.524865 [info ] [MainThread]: 
[0m12:41:45.525164 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m12:41:45.525679 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4625276, "process_in_blocks": "13440", "process_kernel_time": 0.228911, "process_mem_max_rss": "139484", "process_out_blocks": "12080", "process_user_time": 1.633234}
[0m12:41:45.525966 [debug] [MainThread]: Command `dbt run` failed at 12:41:45.525917 after 1.46 seconds
[0m12:41:45.526198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a6e977c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a7069ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a649af1f0>]}
[0m12:41:45.526473 [debug] [MainThread]: Flushing usage events
[0m12:43:13.027367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b315f3ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b319cb2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b319cb250>]}


============================== 12:43:13.030448 | a7fdf862-4d10-4d7a-a6cd-267fc7da3eed ==============================
[0m12:43:13.030448 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:43:13.031151 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:43:13.176068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7fdf862-4d10-4d7a-a6cd-267fc7da3eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b31967730>]}
[0m12:43:13.205719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7fdf862-4d10-4d7a-a6cd-267fc7da3eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b307d5ae0>]}
[0m12:43:13.209246 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m12:43:13.251557 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:43:13.379041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:43:13.379807 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:43:13.388686 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m12:43:13.407657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7fdf862-4d10-4d7a-a6cd-267fc7da3eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b29dd9de0>]}
[0m12:43:13.477778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7fdf862-4d10-4d7a-a6cd-267fc7da3eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b29dd8520>]}
[0m12:43:13.478165 [info ] [MainThread]: Found 7 models, 4 data tests, 421 macros
[0m12:43:13.478671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7fdf862-4d10-4d7a-a6cd-267fc7da3eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b29dd84f0>]}
[0m12:43:13.480233 [info ] [MainThread]: 
[0m12:43:13.480663 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:43:13.484277 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:43:13.909957 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:43:13.910702 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:43:13.911317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:13.936036 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m12:43:13.938011 [debug] [ThreadPool]: On list_dev: Close
[0m12:43:13.942426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:43:13.943051 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:43:13.948366 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:43:13.948600 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:43:13.948954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:13.959871 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m12:43:13.960660 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:43:13.960893 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:43:13.961315 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:43:13.961554 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:43:13.961850 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:43:13.962359 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:43:13.962769 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:43:13.962945 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:43:13.963246 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:43:13.963613 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:43:13.963792 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:43:13.965581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:43:13.968545 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:43:13.968745 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:43:13.969119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:13.979486 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m12:43:13.979708 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:43:13.980228 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:43:13.994276 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m12:43:13.994976 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:43:13.995539 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:43:13.995708 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:43:13.997983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7fdf862-4d10-4d7a-a6cd-267fc7da3eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2fdc0d90>]}
[0m12:43:13.998227 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:13.998497 [debug] [MainThread]: On master: BEGIN
[0m12:43:13.998792 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:43:14.009801 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m12:43:14.010043 [debug] [MainThread]: On master: COMMIT
[0m12:43:14.010615 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:14.010937 [debug] [MainThread]: On master: COMMIT
[0m12:43:14.011399 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:43:14.011662 [debug] [MainThread]: On master: Close
[0m12:43:14.013270 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:43:14.013609 [info ] [MainThread]: 
[0m12:43:14.015675 [debug] [Thread-1 (]: Began running node model.transform.3_1
[0m12:43:14.016862 [info ] [Thread-1 (]: 1 of 7 START sql view model main.3_1 ........................................... [RUN]
[0m12:43:14.017593 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.3_1'
[0m12:43:14.018019 [debug] [Thread-1 (]: Began compiling node model.transform.3_1
[0m12:43:14.028181 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_1"
[0m12:43:14.031048 [debug] [Thread-1 (]: Began executing node model.transform.3_1
[0m12:43:14.055897 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_1"
[0m12:43:14.058575 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:43:14.058792 [debug] [Thread-1 (]: On model.transform.3_1: BEGIN
[0m12:43:14.059248 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:43:14.070953 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m12:43:14.071220 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:43:14.071795 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    strftime('%Y-%m', Date) AS mois,  -- Utilisation de strftime pour extraire l'année et le mois
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0))/2000 AS consommation_totale_en_GWH,
    SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,

    MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
FROM clean
GROUP BY strftime('%Y-%m', Date), "Région"  -- Remplacer TO_CHAR par strftime
ORDER BY mois, "Région"  -- Tri par mois et région
  );

[0m12:43:14.072801 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:43:14.076095 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:43:14.076313 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1" rename to "3_1__dbt_backup"
[0m12:43:14.076799 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:14.078240 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:43:14.078437 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1__dbt_tmp" rename to "3_1"
[0m12:43:14.078953 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:14.087014 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m12:43:14.087238 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:43:14.087610 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m12:43:14.089397 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:43:14.091830 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:43:14.092047 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
drop view if exists "dev"."main"."3_1__dbt_backup" cascade
[0m12:43:14.092698 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:14.093956 [debug] [Thread-1 (]: On model.transform.3_1: Close
[0m12:43:14.106549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7fdf862-4d10-4d7a-a6cd-267fc7da3eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b29dfe7d0>]}
[0m12:43:14.106958 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.3_1 ...................................... [[32mOK[0m in 0.09s]
[0m12:43:14.107276 [debug] [Thread-1 (]: Finished running node model.transform.3_1
[0m12:43:14.107534 [debug] [Thread-1 (]: Began running node model.transform.cleaan
[0m12:43:14.107883 [info ] [Thread-1 (]: 2 of 7 START sql view model main.cleaan ........................................ [RUN]
[0m12:43:14.108153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_1, now model.transform.cleaan)
[0m12:43:14.108415 [debug] [Thread-1 (]: Began compiling node model.transform.cleaan
[0m12:43:14.109601 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.cleaan"
[0m12:43:14.111011 [debug] [Thread-1 (]: Began executing node model.transform.cleaan
[0m12:43:14.112823 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.cleaan"
[0m12:43:14.113912 [debug] [Thread-1 (]: Using duckdb connection "model.transform.cleaan"
[0m12:43:14.114099 [debug] [Thread-1 (]: On model.transform.cleaan: BEGIN
[0m12:43:14.114403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:14.125425 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:43:14.125634 [debug] [Thread-1 (]: Using duckdb connection "model.transform.cleaan"
[0m12:43:14.126063 [debug] [Thread-1 (]: On model.transform.cleaan: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.cleaan"} */

  
  create view "dev"."main"."cleaan__dbt_tmp" as (
    WITH data_clean AS (
    SELECT 
        *,
        COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0) AS consommation,
        COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) AS eolien,
        COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS thermique,
        COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0) AS bioenergies,
        COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) AS nucleaire,
        COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) AS solaire,
        COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) AS hydraulique,
        COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0) AS pompage,
        COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0) AS ech_physiques
    FROM eco2
    WHERE "Région" IS NOT NULL AND "Date" IS NOT NULL
),
data_final AS (
    SELECT 
        "Code INSEE région",
        "Région", 
        "Date", 
        "Heure",
        consommation,
        eolien,
        thermique,
        bioenergies,
        nucleaire,
        solaire,
        hydraulique,
        pompage,
        ech_physiques,
        COALESCE(nucleaire, 0) + 
        COALESCE(eolien, 0) +
        COALESCE(solaire, 0) +
        COALESCE(hydraulique, 0) +
        COALESCE(thermique, 0) AS production_totale
    FROM data_clean
)

SELECT * FROM data_final;
  );

[0m12:43:14.126618 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.cleaan"} */

  
  create view "dev"."main"."cleaan__dbt_tmp" as (
    WITH data_clean AS (
    SELECT 
        *,
        COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0) AS consommation,
        COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) AS eolien,
        COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS thermique,
        COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0) AS bioenergies,
        COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) AS nucleaire,
        COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) AS solaire,
        COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) AS hydraulique,
        COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0) AS pompage,
        COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0) AS ech_physiques
    FROM eco2
    WHERE "Région" IS NOT NULL AND "Date" IS NOT NULL
),
data_final AS (
    SELECT 
        "Code INSEE région",
        "Région", 
        "Date", 
        "Heure",
        consommation,
        eolien,
        thermique,
        bioenergies,
        nucleaire,
        solaire,
        hydraulique,
        pompage,
        ech_physiques,
        COALESCE(nucleaire, 0) + 
        COALESCE(eolien, 0) +
        COALESCE(solaire, 0) +
        COALESCE(hydraulique, 0) +
        COALESCE(thermique, 0) AS production_totale
    FROM data_clean
)

SELECT * FROM data_final;
  );

[0m12:43:14.126846 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:43:14.127210 [debug] [Thread-1 (]: On model.transform.cleaan: ROLLBACK
[0m12:43:14.130162 [debug] [Thread-1 (]: Failed to rollback 'model.transform.cleaan'
[0m12:43:14.130383 [debug] [Thread-1 (]: On model.transform.cleaan: Close
[0m12:43:14.132034 [debug] [Thread-1 (]: Runtime Error in model cleaan (models/example/cleaan.sql)
  Parser Error: syntax error at or near ";"
[0m12:43:14.132287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7fdf862-4d10-4d7a-a6cd-267fc7da3eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b26b46800>]}
[0m12:43:14.132716 [error] [Thread-1 (]: 2 of 7 ERROR creating sql view model main.cleaan ............................... [[31mERROR[0m in 0.02s]
[0m12:43:14.133021 [debug] [Thread-1 (]: Finished running node model.transform.cleaan
[0m12:43:14.133270 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m12:43:14.134094 [info ] [Thread-1 (]: 3 of 7 START sql view model main.clean ......................................... [RUN]
[0m12:43:14.134383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.cleaan, now model.transform.clean)
[0m12:43:14.134661 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m12:43:14.136221 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m12:43:14.137305 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m12:43:14.139041 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m12:43:14.140165 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:43:14.140370 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m12:43:14.140694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:14.151295 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:43:14.151526 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:43:14.152085 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT "Code INSEE région",	"Région"	,	"Date",	"Heure",	
"Consommation (MW)"	,"Thermique (MW)",	"Nucléaire (MW)",	"Eolien (MW)",	"Solaire (MW)",	"Hydraulique (MW)",	"Pompage (MW)",	"Bioénergies (MW)",	"Ech. physiques (MW)","production_totale"

     FROM clean
  );

[0m12:43:14.152857 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:14.154564 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:43:14.154792 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m12:43:14.155341 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:14.156698 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:43:14.156905 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m12:43:14.157381 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:14.158215 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:43:14.158423 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:43:14.158756 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:43:14.160469 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:43:14.161684 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:43:14.161901 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m12:43:14.162722 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:14.163377 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m12:43:14.175473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7fdf862-4d10-4d7a-a6cd-267fc7da3eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b26152d10>]}
[0m12:43:14.175843 [info ] [Thread-1 (]: 3 of 7 OK created sql view model main.clean .................................... [[32mOK[0m in 0.04s]
[0m12:43:14.176175 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m12:43:14.176398 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m12:43:14.176779 [info ] [Thread-1 (]: 4 of 7 START sql view model main.grain_jour .................................... [RUN]
[0m12:43:14.177020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m12:43:14.177274 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m12:43:14.178301 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m12:43:14.179292 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m12:43:14.181360 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m12:43:14.182586 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:43:14.182854 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m12:43:14.183168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:14.198610 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m12:43:14.199405 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:43:14.200106 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS thermique_total,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS nucleaire_total,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS eolien_total,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS solaire_total,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS hydraulique_total,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS bioenergies_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_total,
    SUM(COALESCE(production_totale, 0)) AS production_totale
FROM clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m12:43:14.202697 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:43:14.207760 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:43:14.208174 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour" rename to "grain_jour__dbt_backup"
[0m12:43:14.208841 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:14.230210 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:43:14.230536 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour__dbt_tmp" rename to "grain_jour"
[0m12:43:14.231464 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:14.232425 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:43:14.232623 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:43:14.233152 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:43:14.235616 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:43:14.236821 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:43:14.237026 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
drop view if exists "dev"."main"."grain_jour__dbt_backup" cascade
[0m12:43:14.237839 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:14.238514 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m12:43:14.251376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7fdf862-4d10-4d7a-a6cd-267fc7da3eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b257039d0>]}
[0m12:43:14.251746 [info ] [Thread-1 (]: 4 of 7 OK created sql view model main.grain_jour ............................... [[32mOK[0m in 0.07s]
[0m12:43:14.252069 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m12:43:14.252408 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m12:43:14.252756 [info ] [Thread-1 (]: 5 of 7 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m12:43:14.253043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m12:43:14.253298 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m12:43:14.254895 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m12:43:14.256023 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m12:43:14.265716 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m12:43:14.267035 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:43:14.267256 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m12:43:14.267566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:14.278634 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:43:14.278878 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:43:14.279422 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m12:43:14.280185 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:14.281712 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:43:14.281923 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m12:43:14.282388 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:14.283842 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:43:14.284048 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m12:43:14.284580 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:14.287173 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:43:14.287390 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:43:14.287724 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:43:14.289542 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:43:14.290717 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:43:14.290924 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m12:43:14.291668 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:14.292914 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m12:43:14.308094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7fdf862-4d10-4d7a-a6cd-267fc7da3eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b29dee110>]}
[0m12:43:14.308590 [info ] [Thread-1 (]: 5 of 7 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m12:43:14.309009 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m12:43:14.309297 [debug] [Thread-1 (]: Began running node model.transform.3_2
[0m12:43:14.309598 [info ] [Thread-1 (]: 6 of 7 START sql view model main.3_2 ........................................... [RUN]
[0m12:43:14.309921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.3_2)
[0m12:43:14.310323 [debug] [Thread-1 (]: Began compiling node model.transform.3_2
[0m12:43:14.312995 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_2"
[0m12:43:14.314350 [debug] [Thread-1 (]: Began executing node model.transform.3_2
[0m12:43:14.316994 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_2"
[0m12:43:14.318255 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:43:14.318472 [debug] [Thread-1 (]: On model.transform.3_2: BEGIN
[0m12:43:14.318781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:14.332481 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m12:43:14.333001 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:43:14.333775 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */

  
  create view "dev"."main"."3_2__dbt_tmp" as (
    -- Récupérer les régions distinctes dans un set Jinja


SELECT 
    Date,
    
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bourgogne-Franche-Comté' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bourgogne-Franche-Comté"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Centre-Val de Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Centre-Val de Loire"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Nouvelle-Aquitaine' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Nouvelle-Aquitaine"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Occitanie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Occitanie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Île-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Île-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Normandie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Normandie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Grand Est' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Grand Est"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Provence-Alpes-Côte d''Azur' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Provence-Alpes-Côte d''Azur"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bretagne' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bretagne"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Hauts-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Hauts-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Auvergne-Rhône-Alpes' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Auvergne-Rhône-Alpes"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Pays de la Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Pays de la Loire"
        
    
    
FROM 
    "dev"."main"."clean"
GROUP BY 
    Date
ORDER BY 
    Date
  );

[0m12:43:14.335664 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:43:14.338238 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:43:14.338537 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
alter view "dev"."main"."3_2" rename to "3_2__dbt_backup"
[0m12:43:14.339050 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:14.340797 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:43:14.341016 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
alter view "dev"."main"."3_2__dbt_tmp" rename to "3_2"
[0m12:43:14.341493 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:14.342303 [debug] [Thread-1 (]: On model.transform.3_2: COMMIT
[0m12:43:14.342507 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:43:14.342818 [debug] [Thread-1 (]: On model.transform.3_2: COMMIT
[0m12:43:14.345081 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:43:14.346298 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:43:14.346498 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
drop view if exists "dev"."main"."3_2__dbt_backup" cascade
[0m12:43:14.347244 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:14.347894 [debug] [Thread-1 (]: On model.transform.3_2: Close
[0m12:43:14.360524 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7fdf862-4d10-4d7a-a6cd-267fc7da3eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b26b559c0>]}
[0m12:43:14.360907 [info ] [Thread-1 (]: 6 of 7 OK created sql view model main.3_2 ...................................... [[32mOK[0m in 0.05s]
[0m12:43:14.361223 [debug] [Thread-1 (]: Finished running node model.transform.3_2
[0m12:43:14.361477 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m12:43:14.361803 [info ] [Thread-1 (]: 7 of 7 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m12:43:14.362078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_2, now model.transform.my_second_dbt_model)
[0m12:43:14.362330 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m12:43:14.363801 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m12:43:14.365000 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m12:43:14.366786 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m12:43:14.367879 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:43:14.368069 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m12:43:14.368317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:14.379044 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:43:14.379276 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:43:14.379817 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m12:43:14.380370 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:14.382699 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:43:14.382920 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m12:43:14.383382 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:14.384798 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:43:14.385006 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m12:43:14.385597 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:14.386484 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:43:14.386698 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:43:14.387034 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:43:14.388779 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:43:14.389934 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:43:14.390142 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m12:43:14.390880 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:14.391527 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m12:43:14.403804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7fdf862-4d10-4d7a-a6cd-267fc7da3eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b29deb1c0>]}
[0m12:43:14.404186 [info ] [Thread-1 (]: 7 of 7 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m12:43:14.404489 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m12:43:14.405291 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:14.405494 [debug] [MainThread]: On master: BEGIN
[0m12:43:14.405790 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:43:14.416624 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m12:43:14.416830 [debug] [MainThread]: On master: COMMIT
[0m12:43:14.417401 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:14.417700 [debug] [MainThread]: On master: COMMIT
[0m12:43:14.418132 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:43:14.418316 [debug] [MainThread]: On master: Close
[0m12:43:14.419603 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:14.419815 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m12:43:14.420210 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m12:43:14.420597 [info ] [MainThread]: 
[0m12:43:14.420835 [info ] [MainThread]: Finished running 6 view models, 1 table model in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m12:43:14.421583 [debug] [MainThread]: Command end result
[0m12:43:14.443161 [info ] [MainThread]: 
[0m12:43:14.443407 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:43:14.443900 [info ] [MainThread]: 
[0m12:43:14.444262 [error] [MainThread]:   Runtime Error in model cleaan (models/example/cleaan.sql)
  Parser Error: syntax error at or near ";"
[0m12:43:14.444522 [info ] [MainThread]: 
[0m12:43:14.444848 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m12:43:14.445387 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4458477, "process_in_blocks": "13440", "process_kernel_time": 0.163509, "process_mem_max_rss": "139908", "process_out_blocks": "11224", "process_user_time": 1.429151}
[0m12:43:14.445666 [debug] [MainThread]: Command `dbt run` failed at 12:43:14.445617 after 1.45 seconds
[0m12:43:14.445901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b315f3ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b307d7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b275d5d50>]}
[0m12:43:14.446192 [debug] [MainThread]: Flushing usage events
[0m12:43:24.983892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515691fbb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751569533010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515695327a0>]}


============================== 12:43:24.986684 | 2bf3f042-ef8c-4a37-9426-14ee6ee3dd7d ==============================
[0m12:43:24.986684 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:43:24.987327 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:43:25.110617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2bf3f042-ef8c-4a37-9426-14ee6ee3dd7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75156912c670>]}
[0m12:43:25.138176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2bf3f042-ef8c-4a37-9426-14ee6ee3dd7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515683e2d10>]}
[0m12:43:25.141049 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m12:43:25.182479 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:43:25.307294 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:43:25.307993 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:43:25.317211 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m12:43:25.335881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2bf3f042-ef8c-4a37-9426-14ee6ee3dd7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515619e1c60>]}
[0m12:43:25.397721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2bf3f042-ef8c-4a37-9426-14ee6ee3dd7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515619e00d0>]}
[0m12:43:25.398236 [info ] [MainThread]: Found 7 models, 4 data tests, 421 macros
[0m12:43:25.398749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bf3f042-ef8c-4a37-9426-14ee6ee3dd7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515619e00a0>]}
[0m12:43:25.400823 [info ] [MainThread]: 
[0m12:43:25.401379 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:43:25.406010 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:43:25.629757 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:43:25.630391 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:43:25.630984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:25.654926 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m12:43:25.656757 [debug] [ThreadPool]: On list_dev: Close
[0m12:43:25.660448 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:43:25.661050 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:43:25.665933 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:43:25.666146 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:43:25.666490 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:25.677901 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m12:43:25.678750 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:43:25.678975 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:43:25.679474 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:43:25.679656 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:43:25.679963 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:43:25.680429 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:43:25.680878 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:43:25.681055 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:43:25.681350 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:43:25.681733 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:43:25.681960 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:43:25.683661 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:43:25.686664 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:43:25.686867 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:43:25.687230 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:25.697578 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m12:43:25.697782 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:43:25.698362 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:43:25.710157 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m12:43:25.710837 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:43:25.711402 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:43:25.711571 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:43:25.713472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bf3f042-ef8c-4a37-9426-14ee6ee3dd7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515619efe80>]}
[0m12:43:25.713722 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:25.714027 [debug] [MainThread]: On master: BEGIN
[0m12:43:25.714272 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:43:25.725526 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m12:43:25.725791 [debug] [MainThread]: On master: COMMIT
[0m12:43:25.726370 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:25.726728 [debug] [MainThread]: On master: COMMIT
[0m12:43:25.727185 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:43:25.727436 [debug] [MainThread]: On master: Close
[0m12:43:25.729027 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:43:25.729371 [info ] [MainThread]: 
[0m12:43:25.731423 [debug] [Thread-1 (]: Began running node model.transform.3_1
[0m12:43:25.732483 [info ] [Thread-1 (]: 1 of 7 START sql view model main.3_1 ........................................... [RUN]
[0m12:43:25.733577 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.3_1'
[0m12:43:25.734337 [debug] [Thread-1 (]: Began compiling node model.transform.3_1
[0m12:43:25.742322 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_1"
[0m12:43:25.743533 [debug] [Thread-1 (]: Began executing node model.transform.3_1
[0m12:43:25.765766 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_1"
[0m12:43:25.767096 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:43:25.767307 [debug] [Thread-1 (]: On model.transform.3_1: BEGIN
[0m12:43:25.767608 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:43:25.779116 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:43:25.779349 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:43:25.779901 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    strftime('%Y-%m', Date) AS mois,  -- Utilisation de strftime pour extraire l'année et le mois
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0))/2000 AS consommation_totale_en_GWH,
    SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,

    MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
FROM clean
GROUP BY strftime('%Y-%m', Date), "Région"  -- Remplacer TO_CHAR par strftime
ORDER BY mois, "Région"  -- Tri par mois et région
  );

[0m12:43:25.780853 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:43:25.784091 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:43:25.784314 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1" rename to "3_1__dbt_backup"
[0m12:43:25.784792 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:25.786438 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:43:25.786645 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1__dbt_tmp" rename to "3_1"
[0m12:43:25.787129 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:25.795445 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m12:43:25.795669 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:43:25.796118 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m12:43:25.798887 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:43:25.801382 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:43:25.801597 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
drop view if exists "dev"."main"."3_1__dbt_backup" cascade
[0m12:43:25.802436 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:25.803720 [debug] [Thread-1 (]: On model.transform.3_1: Close
[0m12:43:25.817026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bf3f042-ef8c-4a37-9426-14ee6ee3dd7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515619efe80>]}
[0m12:43:25.817422 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.3_1 ...................................... [[32mOK[0m in 0.08s]
[0m12:43:25.817737 [debug] [Thread-1 (]: Finished running node model.transform.3_1
[0m12:43:25.817973 [debug] [Thread-1 (]: Began running node model.transform.cleaan
[0m12:43:25.818302 [info ] [Thread-1 (]: 2 of 7 START sql view model main.cleaan ........................................ [RUN]
[0m12:43:25.818536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_1, now model.transform.cleaan)
[0m12:43:25.818853 [debug] [Thread-1 (]: Began compiling node model.transform.cleaan
[0m12:43:25.819939 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.cleaan"
[0m12:43:25.821136 [debug] [Thread-1 (]: Began executing node model.transform.cleaan
[0m12:43:25.823078 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.cleaan"
[0m12:43:25.824254 [debug] [Thread-1 (]: Using duckdb connection "model.transform.cleaan"
[0m12:43:25.824502 [debug] [Thread-1 (]: On model.transform.cleaan: BEGIN
[0m12:43:25.824817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:25.838163 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m12:43:25.838612 [debug] [Thread-1 (]: Using duckdb connection "model.transform.cleaan"
[0m12:43:25.839217 [debug] [Thread-1 (]: On model.transform.cleaan: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.cleaan"} */

  
  create view "dev"."main"."cleaan__dbt_tmp" as (
    WITH data_clean AS (
    SELECT 
        *,
        COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0) AS consommation,
        COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) AS eolien,
        COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS thermique,
        COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0) AS bioenergies,
        COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) AS nucleaire,
        COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) AS solaire,
        COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) AS hydraulique,
        COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0) AS pompage,
        COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0) AS ech_physiques
    FROM eco2
    WHERE "Région" IS NOT NULL AND "Date" IS NOT NULL
),
data_final AS (
    SELECT 
        "Code INSEE région",
        "Région", 
        "Date", 
        "Heure",
        consommation,
        eolien,
        thermique,
        bioenergies,
        nucleaire,
        solaire,
        hydraulique,
        pompage,
        ech_physiques,
        COALESCE(nucleaire, 0) + 
        COALESCE(eolien, 0) +
        COALESCE(solaire, 0) +
        COALESCE(hydraulique, 0) +
        COALESCE(thermique, 0) AS production_totale
    FROM data_clean
)

SELECT * FROM data_final
  );

[0m12:43:25.840363 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:43:25.843268 [debug] [Thread-1 (]: Using duckdb connection "model.transform.cleaan"
[0m12:43:25.843561 [debug] [Thread-1 (]: On model.transform.cleaan: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.cleaan"} */
alter view "dev"."main"."cleaan__dbt_tmp" rename to "cleaan"
[0m12:43:25.844081 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:25.844963 [debug] [Thread-1 (]: On model.transform.cleaan: COMMIT
[0m12:43:25.845182 [debug] [Thread-1 (]: Using duckdb connection "model.transform.cleaan"
[0m12:43:25.845483 [debug] [Thread-1 (]: On model.transform.cleaan: COMMIT
[0m12:43:25.848150 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:43:25.849490 [debug] [Thread-1 (]: Using duckdb connection "model.transform.cleaan"
[0m12:43:25.849713 [debug] [Thread-1 (]: On model.transform.cleaan: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.cleaan"} */
drop view if exists "dev"."main"."cleaan__dbt_backup" cascade
[0m12:43:25.850247 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:25.850906 [debug] [Thread-1 (]: On model.transform.cleaan: Close
[0m12:43:25.863191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bf3f042-ef8c-4a37-9426-14ee6ee3dd7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75155dd89870>]}
[0m12:43:25.863549 [info ] [Thread-1 (]: 2 of 7 OK created sql view model main.cleaan ................................... [[32mOK[0m in 0.04s]
[0m12:43:25.863882 [debug] [Thread-1 (]: Finished running node model.transform.cleaan
[0m12:43:25.864092 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m12:43:25.864449 [info ] [Thread-1 (]: 3 of 7 START sql view model main.clean ......................................... [RUN]
[0m12:43:25.864667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.cleaan, now model.transform.clean)
[0m12:43:25.864921 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m12:43:25.865911 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m12:43:25.867054 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m12:43:25.868853 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m12:43:25.869979 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:43:25.870198 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m12:43:25.870505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:25.883969 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m12:43:25.884504 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:43:25.885145 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, COALESCE("Nucléaire (MW)", 0) +
           COALESCE(Eolien, 0) +
           COALESCE("Solaire (MW)", 0) +
           COALESCE("Hydraulique (MW)", 0) +
           COALESCE("Thermique (MW)", 0) AS production_totale
    FROM data_clean
)
SELECT "Code INSEE région",	"Région"	,	"Date",	"Heure",	
"Consommation (MW)"	,"Thermique (MW)",	"Nucléaire (MW)",	"Eolien (MW)",	"Solaire (MW)",	"Hydraulique (MW)",	"Pompage (MW)",	"Bioénergies (MW)",	"Ech. physiques (MW)","production_totale"

     FROM clean
  );

[0m12:43:25.886468 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:43:25.888996 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:43:25.889320 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m12:43:25.889994 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:25.892037 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:43:25.892319 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m12:43:25.892881 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:25.893819 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:43:25.894043 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:43:25.894368 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:43:25.897185 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:43:25.898363 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:43:25.898580 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m12:43:25.899482 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:43:25.900147 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m12:43:25.912454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bf3f042-ef8c-4a37-9426-14ee6ee3dd7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75155dd625c0>]}
[0m12:43:25.912829 [info ] [Thread-1 (]: 3 of 7 OK created sql view model main.clean .................................... [[32mOK[0m in 0.05s]
[0m12:43:25.913153 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m12:43:25.913380 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m12:43:25.913725 [info ] [Thread-1 (]: 4 of 7 START sql view model main.grain_jour .................................... [RUN]
[0m12:43:25.913983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m12:43:25.914398 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m12:43:25.915507 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m12:43:25.916730 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m12:43:25.940670 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m12:43:25.942068 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:43:25.942282 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m12:43:25.942591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:25.953420 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:43:25.953647 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:43:25.954246 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS thermique_total,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS nucleaire_total,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS eolien_total,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS solaire_total,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS hydraulique_total,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS bioenergies_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_total,
    SUM(COALESCE(production_totale, 0)) AS production_totale
FROM clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m12:43:25.955097 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:43:25.956716 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:43:25.956932 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour" rename to "grain_jour__dbt_backup"
[0m12:43:25.957481 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:25.958937 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:43:25.959146 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour__dbt_tmp" rename to "grain_jour"
[0m12:43:25.959654 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:25.960462 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:43:25.960666 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:43:25.960976 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:43:25.964029 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:43:25.965304 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:43:25.965541 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
drop view if exists "dev"."main"."grain_jour__dbt_backup" cascade
[0m12:43:25.966432 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:25.967283 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m12:43:25.981315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bf3f042-ef8c-4a37-9426-14ee6ee3dd7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75156378b280>]}
[0m12:43:25.982043 [info ] [Thread-1 (]: 4 of 7 OK created sql view model main.grain_jour ............................... [[32mOK[0m in 0.07s]
[0m12:43:25.982674 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m12:43:25.983183 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m12:43:25.983857 [info ] [Thread-1 (]: 5 of 7 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m12:43:25.984442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m12:43:25.984922 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m12:43:25.988236 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m12:43:25.989468 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m12:43:26.006425 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m12:43:26.007749 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:43:26.008056 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m12:43:26.008443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:26.019628 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:43:26.019939 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:43:26.020334 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m12:43:26.021009 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:26.023264 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:43:26.023596 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m12:43:26.024195 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:26.026804 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:43:26.027042 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m12:43:26.027537 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:26.030270 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:43:26.030484 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:43:26.030817 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:43:26.033430 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:43:26.034622 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:43:26.034822 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m12:43:26.035591 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:26.036367 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m12:43:26.050918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bf3f042-ef8c-4a37-9426-14ee6ee3dd7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75155dde9cc0>]}
[0m12:43:26.051312 [info ] [Thread-1 (]: 5 of 7 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.07s]
[0m12:43:26.051631 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m12:43:26.051927 [debug] [Thread-1 (]: Began running node model.transform.3_2
[0m12:43:26.052425 [info ] [Thread-1 (]: 6 of 7 START sql view model main.3_2 ........................................... [RUN]
[0m12:43:26.052703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.3_2)
[0m12:43:26.052974 [debug] [Thread-1 (]: Began compiling node model.transform.3_2
[0m12:43:26.055465 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_2"
[0m12:43:26.056738 [debug] [Thread-1 (]: Began executing node model.transform.3_2
[0m12:43:26.058654 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_2"
[0m12:43:26.059961 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:43:26.060168 [debug] [Thread-1 (]: On model.transform.3_2: BEGIN
[0m12:43:26.060591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:26.071608 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:43:26.071836 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:43:26.072425 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */

  
  create view "dev"."main"."3_2__dbt_tmp" as (
    -- Récupérer les régions distinctes dans un set Jinja


SELECT 
    Date,
    
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bourgogne-Franche-Comté' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bourgogne-Franche-Comté"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Centre-Val de Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Centre-Val de Loire"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Nouvelle-Aquitaine' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Nouvelle-Aquitaine"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Occitanie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Occitanie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Île-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Île-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Normandie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Normandie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Grand Est' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Grand Est"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Provence-Alpes-Côte d''Azur' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Provence-Alpes-Côte d''Azur"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bretagne' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bretagne"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Hauts-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Hauts-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Auvergne-Rhône-Alpes' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Auvergne-Rhône-Alpes"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Pays de la Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Pays de la Loire"
        
    
    
FROM 
    "dev"."main"."clean"
GROUP BY 
    Date
ORDER BY 
    Date
  );

[0m12:43:26.073480 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:43:26.075121 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:43:26.075324 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
alter view "dev"."main"."3_2" rename to "3_2__dbt_backup"
[0m12:43:26.075866 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:26.077221 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:43:26.077415 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
alter view "dev"."main"."3_2__dbt_tmp" rename to "3_2"
[0m12:43:26.077886 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:26.078881 [debug] [Thread-1 (]: On model.transform.3_2: COMMIT
[0m12:43:26.079077 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:43:26.079473 [debug] [Thread-1 (]: On model.transform.3_2: COMMIT
[0m12:43:26.082820 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:43:26.083987 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:43:26.084181 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
drop view if exists "dev"."main"."3_2__dbt_backup" cascade
[0m12:43:26.084994 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:26.085622 [debug] [Thread-1 (]: On model.transform.3_2: Close
[0m12:43:26.098090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bf3f042-ef8c-4a37-9426-14ee6ee3dd7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751560f168c0>]}
[0m12:43:26.098449 [info ] [Thread-1 (]: 6 of 7 OK created sql view model main.3_2 ...................................... [[32mOK[0m in 0.05s]
[0m12:43:26.098779 [debug] [Thread-1 (]: Finished running node model.transform.3_2
[0m12:43:26.099057 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m12:43:26.099355 [info ] [Thread-1 (]: 7 of 7 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m12:43:26.099641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_2, now model.transform.my_second_dbt_model)
[0m12:43:26.099917 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m12:43:26.102027 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m12:43:26.103215 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m12:43:26.105031 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m12:43:26.106162 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:43:26.106368 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m12:43:26.106693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:26.117453 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:43:26.117691 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:43:26.118231 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m12:43:26.118758 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:26.120305 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:43:26.120528 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m12:43:26.121062 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:26.122491 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:43:26.122713 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m12:43:26.123217 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:26.124072 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:43:26.124289 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:43:26.124621 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:43:26.127573 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:43:26.128779 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:43:26.128997 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m12:43:26.129793 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:26.130447 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m12:43:26.142426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bf3f042-ef8c-4a37-9426-14ee6ee3dd7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75155dd00f40>]}
[0m12:43:26.142814 [info ] [Thread-1 (]: 7 of 7 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m12:43:26.143139 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m12:43:26.143989 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:26.144191 [debug] [MainThread]: On master: BEGIN
[0m12:43:26.144394 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:43:26.155504 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m12:43:26.155741 [debug] [MainThread]: On master: COMMIT
[0m12:43:26.156175 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:26.156472 [debug] [MainThread]: On master: COMMIT
[0m12:43:26.156830 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:43:26.157007 [debug] [MainThread]: On master: Close
[0m12:43:26.158139 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:26.158373 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m12:43:26.158615 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m12:43:26.158901 [info ] [MainThread]: 
[0m12:43:26.159111 [info ] [MainThread]: Finished running 6 view models, 1 table model in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m12:43:26.159956 [debug] [MainThread]: Command end result
[0m12:43:26.182580 [info ] [MainThread]: 
[0m12:43:26.182836 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:43:26.183199 [info ] [MainThread]: 
[0m12:43:26.183438 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:43:26.183894 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2277045, "process_in_blocks": "13440", "process_kernel_time": 0.13832, "process_mem_max_rss": "138176", "process_out_blocks": "12304", "process_user_time": 1.345573}
[0m12:43:26.184172 [debug] [MainThread]: Command `dbt run` succeeded at 12:43:26.184124 after 1.23 seconds
[0m12:43:26.184359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515691fbb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75156af26920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75155dd62bc0>]}
[0m12:43:26.184598 [debug] [MainThread]: Flushing usage events
[0m12:44:40.888257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a793bbf7be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a793bf2b100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a793bf2a860>]}


============================== 12:44:40.891745 | 95863654-eca8-44fa-8594-e22cbe061d1c ==============================
[0m12:44:40.891745 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:44:40.892577 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:44:41.029626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95863654-eca8-44fa-8594-e22cbe061d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a793a33e7d0>]}
[0m12:44:41.058574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95863654-eca8-44fa-8594-e22cbe061d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a793add8d60>]}
[0m12:44:41.061345 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m12:44:41.103317 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:44:41.230218 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m12:44:41.231091 [debug] [MainThread]: Partial parsing: deleted file: transform://models/example/cleaan.sql
[0m12:44:41.279237 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m12:44:41.281887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95863654-eca8-44fa-8594-e22cbe061d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7933900130>]}
[0m12:44:41.352929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95863654-eca8-44fa-8594-e22cbe061d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7934dbd2a0>]}
[0m12:44:41.353661 [info ] [MainThread]: Found 6 models, 4 data tests, 421 macros
[0m12:44:41.354220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95863654-eca8-44fa-8594-e22cbe061d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7934dbc5b0>]}
[0m12:44:41.356496 [info ] [MainThread]: 
[0m12:44:41.357162 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:44:41.362261 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:44:41.734944 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:44:41.735693 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:44:41.736385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:41.756049 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m12:44:41.757125 [debug] [ThreadPool]: On list_dev: Close
[0m12:44:41.759932 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:44:41.760282 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:44:41.764093 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:44:41.764298 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:44:41.764650 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:44:41.776134 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m12:44:41.776947 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:44:41.777166 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:44:41.777666 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:44:41.777856 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:44:41.778245 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:44:41.778720 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:44:41.779234 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:44:41.779418 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:44:41.779858 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:44:41.780257 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:44:41.780454 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:44:41.782114 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:44:41.787432 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:44:41.787912 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:44:41.788338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:44:41.807470 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m12:44:41.808013 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:44:41.808492 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:44:41.825392 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m12:44:41.826095 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:44:41.826704 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:44:41.826878 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:44:41.829093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95863654-eca8-44fa-8594-e22cbe061d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a793a33e0b0>]}
[0m12:44:41.829364 [debug] [MainThread]: Using duckdb connection "master"
[0m12:44:41.829667 [debug] [MainThread]: On master: BEGIN
[0m12:44:41.829964 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:44:41.842062 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m12:44:41.842484 [debug] [MainThread]: On master: COMMIT
[0m12:44:41.843171 [debug] [MainThread]: Using duckdb connection "master"
[0m12:44:41.843682 [debug] [MainThread]: On master: COMMIT
[0m12:44:41.844400 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:44:41.844842 [debug] [MainThread]: On master: Close
[0m12:44:41.847578 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:44:41.848068 [info ] [MainThread]: 
[0m12:44:41.851446 [debug] [Thread-1 (]: Began running node model.transform.3_1
[0m12:44:41.852529 [info ] [Thread-1 (]: 1 of 6 START sql view model main.3_1 ........................................... [RUN]
[0m12:44:41.853652 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.3_1'
[0m12:44:41.854540 [debug] [Thread-1 (]: Began compiling node model.transform.3_1
[0m12:44:41.864874 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_1"
[0m12:44:41.866662 [debug] [Thread-1 (]: Began executing node model.transform.3_1
[0m12:44:41.889352 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_1"
[0m12:44:41.891460 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:44:41.891655 [debug] [Thread-1 (]: On model.transform.3_1: BEGIN
[0m12:44:41.892046 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:44:41.904382 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m12:44:41.904816 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:44:41.905585 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    strftime('%Y-%m', Date) AS mois,  -- Utilisation de strftime pour extraire l'année et le mois
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0))/2000 AS consommation_totale_en_GWH,
    SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,

    MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
FROM clean
GROUP BY strftime('%Y-%m', Date), "Région"  -- Remplacer TO_CHAR par strftime
ORDER BY mois, "Région"  -- Tri par mois et région
  );

[0m12:44:41.907446 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:44:41.912483 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:44:41.912759 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1" rename to "3_1__dbt_backup"
[0m12:44:41.913463 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:44:41.915005 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:44:41.915214 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1__dbt_tmp" rename to "3_1"
[0m12:44:41.915776 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:44:41.923835 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m12:44:41.924050 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:44:41.924504 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m12:44:41.926236 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:44:41.928754 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:44:41.929420 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
drop view if exists "dev"."main"."3_1__dbt_backup" cascade
[0m12:44:41.930101 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:44:41.931363 [debug] [Thread-1 (]: On model.transform.3_1: Close
[0m12:44:41.944144 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95863654-eca8-44fa-8594-e22cbe061d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a793bcdb160>]}
[0m12:44:41.944505 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.3_1 ...................................... [[32mOK[0m in 0.09s]
[0m12:44:41.944963 [debug] [Thread-1 (]: Finished running node model.transform.3_1
[0m12:44:41.945233 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m12:44:41.945562 [info ] [Thread-1 (]: 2 of 6 START sql view model main.clean ......................................... [RUN]
[0m12:44:41.945855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_1, now model.transform.clean)
[0m12:44:41.946122 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m12:44:41.947156 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m12:44:41.948337 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m12:44:41.950061 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m12:44:41.951335 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:44:41.951529 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m12:44:41.951971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:44:41.963266 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:44:41.963506 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:44:41.964125 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT 
        *,
        COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0) AS consommation,
        COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) AS eolien,
        COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS thermique,
        COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0) AS bioenergies,
        COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) AS nucleaire,
        COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) AS solaire,
        COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) AS hydraulique,
        COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0) AS pompage,
        COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0) AS ech_physiques
    FROM eco2
    WHERE "Région" IS NOT NULL AND "Date" IS NOT NULL
),
data_final AS (
    SELECT 
        "Code INSEE région",
        "Région", 
        "Date", 
        "Heure",
        consommation,
        eolien,
        thermique,
        bioenergies,
        nucleaire,
        solaire,
        hydraulique,
        pompage,
        ech_physiques,
        COALESCE(nucleaire, 0) + 
        COALESCE(eolien, 0) +
        COALESCE(solaire, 0) +
        COALESCE(hydraulique, 0) +
        COALESCE(thermique, 0) AS production_totale
    FROM data_clean
)

SELECT * FROM data_final
  );

[0m12:44:41.964969 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:44:41.966581 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:44:41.966791 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m12:44:41.967541 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:44:41.969032 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:44:41.969241 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m12:44:41.969747 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:44:41.970539 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:44:41.970738 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:44:41.971041 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:44:41.972735 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:44:41.973917 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:44:41.974116 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m12:44:41.974878 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:44:41.975506 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m12:44:41.987767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95863654-eca8-44fa-8594-e22cbe061d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7930768d00>]}
[0m12:44:41.988135 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.clean .................................... [[32mOK[0m in 0.04s]
[0m12:44:41.988446 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m12:44:41.988706 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m12:44:41.989061 [info ] [Thread-1 (]: 3 of 6 START sql view model main.grain_jour .................................... [RUN]
[0m12:44:41.989412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m12:44:41.989692 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m12:44:41.990913 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m12:44:41.992108 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m12:44:41.993886 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m12:44:41.995031 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:44:41.995221 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m12:44:41.995524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:44:42.006322 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:44:42.006536 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:44:42.007122 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *,
           TRY_CAST("Eolien (MW)" AS INT) AS Eolien
    FROM eco2
    WHERE Région IS NOT NULL AND Date IS NOT NULL
),
clean AS (
    SELECT *, 
           COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) +
           COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS production_totale
    FROM data_clean
)
SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0)) AS thermique_total,
    SUM(COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0)) AS nucleaire_total,
    SUM(COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0)) AS eolien_total,
    SUM(COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0)) AS solaire_total,
    SUM(COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0)) AS hydraulique_total,
    SUM(COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0)) AS bioenergies_total,
    SUM(COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0)) AS echanges_physiques_total,
    SUM(COALESCE(production_totale, 0)) AS production_totale
FROM clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m12:44:42.007923 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:44:42.029762 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:44:42.030045 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour" rename to "grain_jour__dbt_backup"
[0m12:44:42.030948 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:44:42.032429 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:44:42.032637 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour__dbt_tmp" rename to "grain_jour"
[0m12:44:42.033432 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:44:42.034289 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:44:42.034487 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:44:42.034810 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:44:42.036951 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:44:42.038100 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:44:42.038303 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
drop view if exists "dev"."main"."grain_jour__dbt_backup" cascade
[0m12:44:42.039099 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:44:42.039792 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m12:44:42.052277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95863654-eca8-44fa-8594-e22cbe061d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a793bcdb160>]}
[0m12:44:42.052663 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.grain_jour ............................... [[32mOK[0m in 0.06s]
[0m12:44:42.052980 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m12:44:42.053197 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m12:44:42.053541 [info ] [Thread-1 (]: 4 of 6 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m12:44:42.053847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m12:44:42.054131 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m12:44:42.055610 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m12:44:42.056772 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m12:44:42.066308 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m12:44:42.067525 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:44:42.067719 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m12:44:42.068013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:44:42.079179 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:44:42.079410 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:44:42.080001 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m12:44:42.080639 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:44:42.082094 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:44:42.082301 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m12:44:42.082970 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:44:42.084413 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:44:42.084620 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m12:44:42.085158 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:44:42.087778 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:44:42.087998 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:44:42.088370 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:44:42.090150 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:44:42.091896 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:44:42.092110 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m12:44:42.092909 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:44:42.093567 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m12:44:42.108663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95863654-eca8-44fa-8594-e22cbe061d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a79307456f0>]}
[0m12:44:42.109055 [info ] [Thread-1 (]: 4 of 6 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m12:44:42.109466 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m12:44:42.109813 [debug] [Thread-1 (]: Began running node model.transform.3_2
[0m12:44:42.110238 [info ] [Thread-1 (]: 5 of 6 START sql view model main.3_2 ........................................... [RUN]
[0m12:44:42.110590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.3_2)
[0m12:44:42.110916 [debug] [Thread-1 (]: Began compiling node model.transform.3_2
[0m12:44:42.113377 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_2"
[0m12:44:42.114559 [debug] [Thread-1 (]: Began executing node model.transform.3_2
[0m12:44:42.116394 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_2"
[0m12:44:42.117696 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:44:42.117901 [debug] [Thread-1 (]: On model.transform.3_2: BEGIN
[0m12:44:42.118266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:44:42.129077 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:44:42.129296 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:44:42.129902 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */

  
  create view "dev"."main"."3_2__dbt_tmp" as (
    -- Récupérer les régions distinctes dans un set Jinja


SELECT 
    Date,
    
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bourgogne-Franche-Comté' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bourgogne-Franche-Comté"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Centre-Val de Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Centre-Val de Loire"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Nouvelle-Aquitaine' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Nouvelle-Aquitaine"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Occitanie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Occitanie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Île-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Île-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Normandie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Normandie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Grand Est' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Grand Est"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Provence-Alpes-Côte d''Azur' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Provence-Alpes-Côte d''Azur"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bretagne' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bretagne"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Hauts-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Hauts-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Auvergne-Rhône-Alpes' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Auvergne-Rhône-Alpes"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Pays de la Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Pays de la Loire"
        
    
    
FROM 
    "dev"."main"."clean"
GROUP BY 
    Date
ORDER BY 
    Date
  );

[0m12:44:42.131007 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */

  
  create view "dev"."main"."3_2__dbt_tmp" as (
    -- Récupérer les régions distinctes dans un set Jinja


SELECT 
    Date,
    
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bourgogne-Franche-Comté' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bourgogne-Franche-Comté"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Centre-Val de Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Centre-Val de Loire"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Nouvelle-Aquitaine' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Nouvelle-Aquitaine"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Occitanie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Occitanie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Île-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Île-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Normandie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Normandie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Grand Est' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Grand Est"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Provence-Alpes-Côte d''Azur' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Provence-Alpes-Côte d''Azur"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bretagne' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bretagne"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Hauts-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Hauts-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Auvergne-Rhône-Alpes' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Auvergne-Rhône-Alpes"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Pays de la Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Pays de la Loire"
        
    
    
FROM 
    "dev"."main"."clean"
GROUP BY 
    Date
ORDER BY 
    Date
  );

[0m12:44:42.131303 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:44:42.131715 [debug] [Thread-1 (]: On model.transform.3_2: ROLLBACK
[0m12:44:42.134853 [debug] [Thread-1 (]: Failed to rollback 'model.transform.3_2'
[0m12:44:42.135058 [debug] [Thread-1 (]: On model.transform.3_2: Close
[0m12:44:42.136589 [debug] [Thread-1 (]: Runtime Error in model 3_2 (models/example/3_2.sql)
  Binder Error: Referenced column "Consommation (MW)" not found in FROM clause!
  Candidate bindings: "clean.consommation", "clean.Date", "clean.pompage", "clean.solaire", "clean.nucleaire"
  LINE 13: ..., "profile_name": "transform", "target_name": "dev", "node_id": "model.transfor...
                                                     ^
[0m12:44:42.136839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95863654-eca8-44fa-8594-e22cbe061d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a793a33c0d0>]}
[0m12:44:42.137285 [error] [Thread-1 (]: 5 of 6 ERROR creating sql view model main.3_2 .................................. [[31mERROR[0m in 0.03s]
[0m12:44:42.137592 [debug] [Thread-1 (]: Finished running node model.transform.3_2
[0m12:44:42.137811 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m12:44:42.138528 [info ] [Thread-1 (]: 6 of 6 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m12:44:42.138858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_2, now model.transform.my_second_dbt_model)
[0m12:44:42.139129 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m12:44:42.140651 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m12:44:42.141741 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m12:44:42.143523 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m12:44:42.144586 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:44:42.144779 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m12:44:42.145088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:44:42.155772 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:44:42.155999 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:44:42.156407 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m12:44:42.156911 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:44:42.158422 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:44:42.158625 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m12:44:42.159057 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:44:42.160528 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:44:42.160735 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m12:44:42.161193 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:44:42.162015 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:44:42.162219 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:44:42.162467 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:44:42.163680 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:44:42.165565 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:44:42.165777 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m12:44:42.166354 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:44:42.167067 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m12:44:42.178804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95863654-eca8-44fa-8594-e22cbe061d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a79311223e0>]}
[0m12:44:42.179213 [info ] [Thread-1 (]: 6 of 6 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m12:44:42.179519 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m12:44:42.180431 [debug] [MainThread]: Using duckdb connection "master"
[0m12:44:42.180777 [debug] [MainThread]: On master: BEGIN
[0m12:44:42.181071 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:44:42.191221 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m12:44:42.191422 [debug] [MainThread]: On master: COMMIT
[0m12:44:42.191684 [debug] [MainThread]: Using duckdb connection "master"
[0m12:44:42.191952 [debug] [MainThread]: On master: COMMIT
[0m12:44:42.192310 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:44:42.192500 [debug] [MainThread]: On master: Close
[0m12:44:42.193773 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:44:42.193975 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m12:44:42.194246 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m12:44:42.194573 [info ] [MainThread]: 
[0m12:44:42.194794 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m12:44:42.195514 [debug] [MainThread]: Command end result
[0m12:44:42.216152 [info ] [MainThread]: 
[0m12:44:42.216395 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:44:42.216776 [info ] [MainThread]: 
[0m12:44:42.217124 [error] [MainThread]:   Runtime Error in model 3_2 (models/example/3_2.sql)
  Binder Error: Referenced column "Consommation (MW)" not found in FROM clause!
  Candidate bindings: "clean.consommation", "clean.Date", "clean.pompage", "clean.solaire", "clean.nucleaire"
  LINE 13: ..., "profile_name": "transform", "target_name": "dev", "node_id": "model.transfor...
                                                     ^
[0m12:44:42.217286 [info ] [MainThread]: 
[0m12:44:42.217504 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m12:44:42.217929 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3573297, "process_in_blocks": "12320", "process_kernel_time": 0.195495, "process_mem_max_rss": "140040", "process_out_blocks": "10728", "process_user_time": 1.622509}
[0m12:44:42.218212 [debug] [MainThread]: Command `dbt run` failed at 12:44:42.218162 after 1.36 seconds
[0m12:44:42.218406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a793bbf7be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a793a5e0c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a793a5e06a0>]}
[0m12:44:42.218596 [debug] [MainThread]: Flushing usage events
[0m12:49:10.451638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2ac528bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2ac56bf1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2ac56bf310>]}


============================== 12:49:10.454995 | 4de6a198-7a01-4cec-8504-ae6a52766948 ==============================
[0m12:49:10.454995 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:49:10.455686 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'debug': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:49:10.607188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4de6a198-7a01-4cec-8504-ae6a52766948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2abf956950>]}
[0m12:49:10.636323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4de6a198-7a01-4cec-8504-ae6a52766948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2ac3b7e0b0>]}
[0m12:49:10.639390 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m12:49:10.681312 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:49:10.822599 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:49:10.823351 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:49:10.834772 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m12:49:10.854477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4de6a198-7a01-4cec-8504-ae6a52766948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2abd181900>]}
[0m12:49:10.924232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4de6a198-7a01-4cec-8504-ae6a52766948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2abd10bb50>]}
[0m12:49:10.924626 [info ] [MainThread]: Found 6 models, 4 data tests, 421 macros
[0m12:49:10.925138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4de6a198-7a01-4cec-8504-ae6a52766948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2abd109e40>]}
[0m12:49:10.926578 [info ] [MainThread]: 
[0m12:49:10.926992 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:49:10.930531 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:49:11.309435 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:49:11.310184 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:49:11.310820 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:11.330616 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m12:49:11.331902 [debug] [ThreadPool]: On list_dev: Close
[0m12:49:11.334767 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:49:11.335195 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:49:11.339468 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:49:11.339672 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:49:11.340027 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:49:11.351613 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m12:49:11.352442 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:49:11.352673 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:49:11.353136 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:49:11.353319 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:49:11.353634 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:49:11.354090 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:49:11.354503 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:49:11.354684 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:49:11.354991 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:49:11.355440 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:49:11.355636 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:49:11.357369 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:49:11.361128 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:49:11.361361 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:49:11.361776 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:49:11.373004 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m12:49:11.373283 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:49:11.373865 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:49:11.387227 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m12:49:11.387904 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:49:11.388442 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:49:11.388614 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:49:11.390821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4de6a198-7a01-4cec-8504-ae6a52766948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2ac3b7e020>]}
[0m12:49:11.391069 [debug] [MainThread]: Using duckdb connection "master"
[0m12:49:11.391347 [debug] [MainThread]: On master: BEGIN
[0m12:49:11.391647 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:49:11.403358 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m12:49:11.403652 [debug] [MainThread]: On master: COMMIT
[0m12:49:11.404019 [debug] [MainThread]: Using duckdb connection "master"
[0m12:49:11.404331 [debug] [MainThread]: On master: COMMIT
[0m12:49:11.404719 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:49:11.405006 [debug] [MainThread]: On master: Close
[0m12:49:11.406744 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:49:11.407135 [info ] [MainThread]: 
[0m12:49:11.409227 [debug] [Thread-1 (]: Began running node model.transform.3_1
[0m12:49:11.409912 [info ] [Thread-1 (]: 1 of 6 START sql view model main.3_1 ........................................... [RUN]
[0m12:49:11.410597 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.3_1'
[0m12:49:11.411078 [debug] [Thread-1 (]: Began compiling node model.transform.3_1
[0m12:49:11.421170 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_1"
[0m12:49:11.423811 [debug] [Thread-1 (]: Began executing node model.transform.3_1
[0m12:49:11.442389 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_1"
[0m12:49:11.444692 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:49:11.444907 [debug] [Thread-1 (]: On model.transform.3_1: BEGIN
[0m12:49:11.445336 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:49:11.456523 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:49:11.456755 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:49:11.457317 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    strftime('%Y-%m', Date) AS mois,  -- Utilisation de strftime pour extraire l'année et le mois
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0))/2000 AS consommation_totale_en_GWH,
    SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,

    MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
FROM clean
GROUP BY strftime('%Y-%m', Date), "Région"  -- Remplacer TO_CHAR par strftime
ORDER BY mois, "Région"  -- Tri par mois et région
  );

[0m12:49:11.458338 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    strftime('%Y-%m', Date) AS mois,  -- Utilisation de strftime pour extraire l'année et le mois
    "Région", 
    SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0))/2000 AS consommation_totale_en_GWH,
    SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,

    MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
FROM clean
GROUP BY strftime('%Y-%m', Date), "Région"  -- Remplacer TO_CHAR par strftime
ORDER BY mois, "Région"  -- Tri par mois et région
  );

[0m12:49:11.458580 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:49:11.458978 [debug] [Thread-1 (]: On model.transform.3_1: ROLLBACK
[0m12:49:11.462017 [debug] [Thread-1 (]: Failed to rollback 'model.transform.3_1'
[0m12:49:11.462217 [debug] [Thread-1 (]: On model.transform.3_1: Close
[0m12:49:11.464112 [debug] [Thread-1 (]: Runtime Error in model 3_1 (models/example/3_1.sql)
  Binder Error: Referenced column "Consommation (MW)" not found in FROM clause!
  Candidate bindings: "clean.consommation", "clean.Date", "clean.pompage", "clean.solaire", "clean.nucleaire"
  LINE 8:     SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0))/2000 AS consommation_totale_en_GWH,
      SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,
  
      MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
      MIN(COALESCE(production_totale, 0)) AS min_production_totale,
  
      MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
      MAX(COALESCE(production_totale, 0)) AS max_production_totale,
      
      AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,
  
      AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
  FROM clean
  GROUP BY strftime('%Y-%m', Date), "Région"  -- Remplacer TO_CHAR par strftime
  ORDER BY mois, "Région"  -- Tri par mois et région
    );
  ...
                                    ^
[0m12:49:11.465008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4de6a198-7a01-4cec-8504-ae6a52766948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2ac461dc00>]}
[0m12:49:11.465376 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model main.3_1 .................................. [[31mERROR[0m in 0.05s]
[0m12:49:11.465706 [debug] [Thread-1 (]: Finished running node model.transform.3_1
[0m12:49:11.465946 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m12:49:11.466729 [info ] [Thread-1 (]: 2 of 6 START sql view model main.clean ......................................... [RUN]
[0m12:49:11.467007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_1, now model.transform.clean)
[0m12:49:11.467284 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m12:49:11.468409 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m12:49:11.469593 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m12:49:11.471506 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m12:49:11.472723 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:49:11.472985 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m12:49:11.473304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:11.485341 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m12:49:11.485668 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:49:11.486262 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT 
        *,
        COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0) AS consommation,
        COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) AS eolien,
        COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS thermique,
        COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0) AS bioenergies,
        COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) AS nucleaire,
        COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) AS solaire,
        COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) AS hydraulique,
        COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0) AS pompage,
        COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0) AS ech_physiques
    FROM eco2
    WHERE "Région" IS NOT NULL AND "Date" IS NOT NULL
),
data_final AS (
    SELECT 
        "Code INSEE région",
        "Région", 
        "Date", 
        "Heure",
        consommation,
        eolien,
        thermique,
        bioenergies,
        nucleaire,
        solaire,
        hydraulique,
        pompage,
        ech_physiques,
        COALESCE(nucleaire, 0) + 
        COALESCE(eolien, 0) +
        COALESCE(solaire, 0) +
        COALESCE(hydraulique, 0) +
        COALESCE(thermique, 0) AS production_totale
    FROM data_clean
)

SELECT * FROM data_final
  );

[0m12:49:11.487175 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:49:11.490896 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:49:11.491121 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m12:49:11.491595 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:49:11.493073 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:49:11.493273 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m12:49:11.493773 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:49:11.501884 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:49:11.502097 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:49:11.502482 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:49:11.504126 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:49:11.506590 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:49:11.506807 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m12:49:11.507571 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:49:11.508828 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m12:49:11.521028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4de6a198-7a01-4cec-8504-ae6a52766948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2abd190220>]}
[0m12:49:11.521389 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.clean .................................... [[32mOK[0m in 0.05s]
[0m12:49:11.521688 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m12:49:11.521951 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m12:49:11.522284 [info ] [Thread-1 (]: 3 of 6 START sql view model main.grain_jour .................................... [RUN]
[0m12:49:11.522587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m12:49:11.522866 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m12:49:11.524337 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m12:49:11.525485 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m12:49:11.527220 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m12:49:11.528283 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:49:11.528470 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m12:49:11.528768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:11.539413 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:49:11.539652 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:49:11.540237 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *
    from clean
          
)
SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("consommation" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("thermique" AS INT), 0)) AS thermique_total,
    SUM(COALESCE(TRY_CAST("bioenergies" AS INT), 0)) AS bioenergies_total,
    SUM(COALESCE(TRY_CAST("eolien" AS INT), 0)) AS eolien_total,
    SUM(COALESCE(TRY_CAST("nucleaire" AS INT), 0)) AS nucleaire_total,
    SUM(COALESCE(TRY_CAST("solaire" AS INT), 0)) AS solaire_total,
    SUM(COALESCE(TRY_CAST("hydraulique" AS INT), 0)) AS hydraulique_total,
    SUM(COALESCE(TRY_CAST("pompage" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("ech_physiques" AS INT), 0)) AS ech_physiques_total,
    SUM(COALESCE(TRY_CAST("production_totale" AS INT), 0)) AS production_totale
   
FROM data_clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m12:49:11.541149 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:49:11.542750 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:49:11.542960 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour" rename to "grain_jour__dbt_backup"
[0m12:49:11.543465 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:49:11.544876 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:49:11.545078 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour__dbt_tmp" rename to "grain_jour"
[0m12:49:11.545630 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:49:11.546421 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:49:11.546621 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:49:11.546928 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:49:11.548668 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:49:11.549863 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:49:11.550063 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
drop view if exists "dev"."main"."grain_jour__dbt_backup" cascade
[0m12:49:11.550894 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:49:11.551532 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m12:49:11.563981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4de6a198-7a01-4cec-8504-ae6a52766948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2ab955a0b0>]}
[0m12:49:11.564365 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.grain_jour ............................... [[32mOK[0m in 0.04s]
[0m12:49:11.564706 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m12:49:11.565026 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m12:49:11.565354 [info ] [Thread-1 (]: 4 of 6 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m12:49:11.565647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m12:49:11.565871 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m12:49:11.567299 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m12:49:11.568686 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m12:49:11.578298 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m12:49:11.579699 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:49:11.579914 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m12:49:11.580229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:11.591071 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:49:11.591290 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:49:11.591867 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m12:49:11.592574 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:49:11.594476 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:49:11.594683 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m12:49:11.595272 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:49:11.616795 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:49:11.617104 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m12:49:11.618101 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:49:11.620758 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:49:11.620975 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:49:11.621515 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:49:11.623517 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:49:11.624745 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:49:11.624947 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m12:49:11.625962 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:49:11.626650 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m12:49:11.642469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4de6a198-7a01-4cec-8504-ae6a52766948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2ab95dca90>]}
[0m12:49:11.642857 [info ] [Thread-1 (]: 4 of 6 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.08s]
[0m12:49:11.643240 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m12:49:11.643506 [debug] [Thread-1 (]: Began running node model.transform.3_2
[0m12:49:11.643888 [info ] [Thread-1 (]: 5 of 6 START sql view model main.3_2 ........................................... [RUN]
[0m12:49:11.644175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.3_2)
[0m12:49:11.644460 [debug] [Thread-1 (]: Began compiling node model.transform.3_2
[0m12:49:11.646863 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_2"
[0m12:49:11.648170 [debug] [Thread-1 (]: Began executing node model.transform.3_2
[0m12:49:11.650019 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_2"
[0m12:49:11.651275 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:49:11.651468 [debug] [Thread-1 (]: On model.transform.3_2: BEGIN
[0m12:49:11.651827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:11.662864 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:49:11.663083 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:49:11.663488 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */

  
  create view "dev"."main"."3_2__dbt_tmp" as (
    -- Récupérer les régions distinctes dans un set Jinja


SELECT 
    Date,
    
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bourgogne-Franche-Comté' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bourgogne-Franche-Comté"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Centre-Val de Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Centre-Val de Loire"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Nouvelle-Aquitaine' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Nouvelle-Aquitaine"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Occitanie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Occitanie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Île-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Île-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Normandie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Normandie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Grand Est' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Grand Est"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Provence-Alpes-Côte d''Azur' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Provence-Alpes-Côte d''Azur"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bretagne' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bretagne"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Hauts-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Hauts-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Auvergne-Rhône-Alpes' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Auvergne-Rhône-Alpes"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Pays de la Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Pays de la Loire"
        
    
    
FROM 
    "dev"."main"."clean"
GROUP BY 
    Date
ORDER BY 
    Date
  );

[0m12:49:11.664470 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */

  
  create view "dev"."main"."3_2__dbt_tmp" as (
    -- Récupérer les régions distinctes dans un set Jinja


SELECT 
    Date,
    
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bourgogne-Franche-Comté' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bourgogne-Franche-Comté"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Centre-Val de Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Centre-Val de Loire"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Nouvelle-Aquitaine' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Nouvelle-Aquitaine"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Occitanie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Occitanie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Île-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Île-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Normandie' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Normandie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Grand Est' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Grand Est"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Provence-Alpes-Côte d''Azur' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Provence-Alpes-Côte d''Azur"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bretagne' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Bretagne"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Hauts-de-France' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Hauts-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Auvergne-Rhône-Alpes' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Auvergne-Rhône-Alpes"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Pays de la Loire' THEN COALESCE(CAST("Consommation (MW)" AS INT), 0) / 2000 ELSE 0 END) AS "Pays de la Loire"
        
    
    
FROM 
    "dev"."main"."clean"
GROUP BY 
    Date
ORDER BY 
    Date
  );

[0m12:49:11.664756 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:49:11.665174 [debug] [Thread-1 (]: On model.transform.3_2: ROLLBACK
[0m12:49:11.665684 [debug] [Thread-1 (]: Failed to rollback 'model.transform.3_2'
[0m12:49:11.665865 [debug] [Thread-1 (]: On model.transform.3_2: Close
[0m12:49:11.667465 [debug] [Thread-1 (]: Runtime Error in model 3_2 (models/example/3_2.sql)
  Binder Error: Referenced column "Consommation (MW)" not found in FROM clause!
  Candidate bindings: "clean.consommation", "clean.Date", "clean.pompage", "clean.solaire", "clean.nucleaire"
  LINE 13: ..., "profile_name": "transform", "target_name": "dev", "node_id": "model.transfor...
                                                     ^
[0m12:49:11.667709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4de6a198-7a01-4cec-8504-ae6a52766948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2ab95a7790>]}
[0m12:49:11.668188 [error] [Thread-1 (]: 5 of 6 ERROR creating sql view model main.3_2 .................................. [[31mERROR[0m in 0.02s]
[0m12:49:11.668480 [debug] [Thread-1 (]: Finished running node model.transform.3_2
[0m12:49:11.668741 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m12:49:11.669104 [info ] [Thread-1 (]: 6 of 6 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m12:49:11.669381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_2, now model.transform.my_second_dbt_model)
[0m12:49:11.669664 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m12:49:11.671093 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m12:49:11.672295 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m12:49:11.674065 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m12:49:11.675205 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:49:11.675395 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m12:49:11.675709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:11.686449 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:49:11.686666 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:49:11.687298 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m12:49:11.687853 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:49:11.689952 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:49:11.690174 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m12:49:11.690679 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:49:11.692092 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:49:11.692299 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m12:49:11.692789 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:49:11.693581 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:49:11.693771 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:49:11.694005 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:49:11.695712 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:49:11.696902 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:49:11.697109 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m12:49:11.698008 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:49:11.698679 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m12:49:11.710495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4de6a198-7a01-4cec-8504-ae6a52766948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2ab95dca90>]}
[0m12:49:11.710868 [info ] [Thread-1 (]: 6 of 6 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m12:49:11.711173 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m12:49:11.712091 [debug] [MainThread]: Using duckdb connection "master"
[0m12:49:11.712436 [debug] [MainThread]: On master: BEGIN
[0m12:49:11.712806 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:49:11.724552 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m12:49:11.724882 [debug] [MainThread]: On master: COMMIT
[0m12:49:11.725441 [debug] [MainThread]: Using duckdb connection "master"
[0m12:49:11.725808 [debug] [MainThread]: On master: COMMIT
[0m12:49:11.726213 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:49:11.726515 [debug] [MainThread]: On master: Close
[0m12:49:11.727983 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:49:11.728234 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m12:49:11.728563 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m12:49:11.728954 [info ] [MainThread]: 
[0m12:49:11.729227 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m12:49:11.730122 [debug] [MainThread]: Command end result
[0m12:49:11.751796 [info ] [MainThread]: 
[0m12:49:11.752035 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m12:49:11.752529 [info ] [MainThread]: 
[0m12:49:11.752917 [error] [MainThread]:   Runtime Error in model 3_1 (models/example/3_1.sql)
  Binder Error: Referenced column "Consommation (MW)" not found in FROM clause!
  Candidate bindings: "clean.consommation", "clean.Date", "clean.pompage", "clean.solaire", "clean.nucleaire"
  LINE 8:     SUM(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0))/2000 AS consommation_totale_en_GWH,
      SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,
  
      MIN(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS min_consommation_totale,
      MIN(COALESCE(production_totale, 0)) AS min_production_totale,
  
      MAX(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS max_consommation_totale,
      MAX(COALESCE(production_totale, 0)) AS max_production_totale,
      
      AVG(COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0)) AS moyenne_consommation_totale,
  
      AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
  FROM clean
  GROUP BY strftime('%Y-%m', Date), "Région"  -- Remplacer TO_CHAR par strftime
  ORDER BY mois, "Région"  -- Tri par mois et région
    );
  ...
                                    ^
[0m12:49:11.753165 [info ] [MainThread]: 
[0m12:49:11.753510 [error] [MainThread]:   Runtime Error in model 3_2 (models/example/3_2.sql)
  Binder Error: Referenced column "Consommation (MW)" not found in FROM clause!
  Candidate bindings: "clean.consommation", "clean.Date", "clean.pompage", "clean.solaire", "clean.nucleaire"
  LINE 13: ..., "profile_name": "transform", "target_name": "dev", "node_id": "model.transfor...
                                                     ^
[0m12:49:11.753718 [info ] [MainThread]: 
[0m12:49:11.754101 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m12:49:11.754672 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3313674, "process_in_blocks": "12320", "process_kernel_time": 0.20789, "process_mem_max_rss": "140520", "process_out_blocks": "8744", "process_user_time": 1.532565}
[0m12:49:11.754968 [debug] [MainThread]: Command `dbt run` failed at 12:49:11.754919 after 1.33 seconds
[0m12:49:11.755198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2ac528bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2ac4634df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2ab956b4c0>]}
[0m12:49:11.755474 [debug] [MainThread]: Flushing usage events
[0m12:51:18.964501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8bb04f7c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8bb082a890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8bb082b0a0>]}


============================== 12:51:18.966929 | b5134a7f-e314-4c24-92f4-d998d8fcf68e ==============================
[0m12:51:18.966929 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:51:18.967560 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:51:19.101134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5134a7f-e314-4c24-92f4-d998d8fcf68e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8baff59120>]}
[0m12:51:19.129947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5134a7f-e314-4c24-92f4-d998d8fcf68e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8baf6d8d90>]}
[0m12:51:19.133024 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m12:51:19.174612 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:51:19.311751 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:51:19.312510 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:51:19.322689 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m12:51:19.341575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5134a7f-e314-4c24-92f4-d998d8fcf68e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ba95dd8d0>]}
[0m12:51:19.410939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5134a7f-e314-4c24-92f4-d998d8fcf68e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ba95df8e0>]}
[0m12:51:19.411308 [info ] [MainThread]: Found 6 models, 4 data tests, 421 macros
[0m12:51:19.411819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5134a7f-e314-4c24-92f4-d998d8fcf68e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8bab3446a0>]}
[0m12:51:19.413212 [info ] [MainThread]: 
[0m12:51:19.413616 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:51:19.417046 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:51:19.792561 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:51:19.793314 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:51:19.793953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:19.814546 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m12:51:19.815673 [debug] [ThreadPool]: On list_dev: Close
[0m12:51:19.818247 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:51:19.818613 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:51:19.822630 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:51:19.822842 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:51:19.823281 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:19.834577 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m12:51:19.835313 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:51:19.835513 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:51:19.836087 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:51:19.836272 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:51:19.836518 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:51:19.836960 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:51:19.837389 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:51:19.837568 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:51:19.837870 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:51:19.838307 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:51:19.838493 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:51:19.840217 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:51:19.844988 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:51:19.845233 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:51:19.845582 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:19.860383 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m12:51:19.860982 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:51:19.861651 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:51:19.877108 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m12:51:19.877794 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:51:19.878422 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:51:19.878609 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:51:19.880895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5134a7f-e314-4c24-92f4-d998d8fcf68e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8bae983310>]}
[0m12:51:19.881143 [debug] [MainThread]: Using duckdb connection "master"
[0m12:51:19.881422 [debug] [MainThread]: On master: BEGIN
[0m12:51:19.881742 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:51:19.893642 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m12:51:19.893995 [debug] [MainThread]: On master: COMMIT
[0m12:51:19.894568 [debug] [MainThread]: Using duckdb connection "master"
[0m12:51:19.894918 [debug] [MainThread]: On master: COMMIT
[0m12:51:19.895500 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:51:19.895820 [debug] [MainThread]: On master: Close
[0m12:51:19.897801 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:51:19.898276 [info ] [MainThread]: 
[0m12:51:19.900739 [debug] [Thread-1 (]: Began running node model.transform.3_1
[0m12:51:19.901798 [info ] [Thread-1 (]: 1 of 6 START sql view model main.3_1 ........................................... [RUN]
[0m12:51:19.902884 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.3_1'
[0m12:51:19.903707 [debug] [Thread-1 (]: Began compiling node model.transform.3_1
[0m12:51:19.912145 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_1"
[0m12:51:19.914628 [debug] [Thread-1 (]: Began executing node model.transform.3_1
[0m12:51:19.940379 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_1"
[0m12:51:19.943079 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:51:19.943288 [debug] [Thread-1 (]: On model.transform.3_1: BEGIN
[0m12:51:19.943658 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:51:19.956923 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m12:51:19.957416 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:51:19.958236 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    strftime('%Y-%m', Date) AS mois,  -- Utilisation de strftime pour extraire l'année et le mois
    "Région", 
    SUM(COALESCE(TRY_CAST("consommation " AS INT), 0))/2000 AS consommation_totale_en_GWH,
    SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,

    MIN(COALESCE(TRY_CAST("consommation " AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("consommation " AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("consommation " AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
FROM clean
GROUP BY strftime('%Y-%m', Date), "Région"  -- Remplacer TO_CHAR par strftime
ORDER BY mois, "Région"  -- Tri par mois et région
  );

[0m12:51:19.960392 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    strftime('%Y-%m', Date) AS mois,  -- Utilisation de strftime pour extraire l'année et le mois
    "Région", 
    SUM(COALESCE(TRY_CAST("consommation " AS INT), 0))/2000 AS consommation_totale_en_GWH,
    SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,

    MIN(COALESCE(TRY_CAST("consommation " AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("consommation " AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("consommation " AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
FROM clean
GROUP BY strftime('%Y-%m', Date), "Région"  -- Remplacer TO_CHAR par strftime
ORDER BY mois, "Région"  -- Tri par mois et région
  );

[0m12:51:19.961081 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:51:19.961859 [debug] [Thread-1 (]: On model.transform.3_1: ROLLBACK
[0m12:51:19.966580 [debug] [Thread-1 (]: Failed to rollback 'model.transform.3_1'
[0m12:51:19.967174 [debug] [Thread-1 (]: On model.transform.3_1: Close
[0m12:51:19.970619 [debug] [Thread-1 (]: Runtime Error in model 3_1 (models/example/3_1.sql)
  Binder Error: Referenced column "consommation " not found in FROM clause!
  Candidate bindings: "clean.consommation", "clean.pompage", "clean.solaire", "clean.production_totale", "clean.bioenergies"
  LINE 8:     SUM(COALESCE(TRY_CAST("consommation " AS INT), 0))/2000 AS consommation_totale_en_GWH,
      SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,
  
      MIN(COALESCE(TRY_CAST("consommation " AS INT), 0)) AS min_consommation_totale,
      MIN(COALESCE(production_totale, 0)) AS min_production_totale,
  
      MAX(COALESCE(TRY_CAST("consommation " AS INT), 0)) AS max_consommation_totale,
      MAX(COALESCE(production_totale, 0)) AS max_production_totale,
      
      AVG(COALESCE(TRY_CAST("consommation " AS INT), 0)) AS moyenne_consommation_totale,
  
      AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
  FROM clean
  GROUP BY strftime('%Y-%m', Date), "Région"  -- Remplacer TO_CHAR par strftime
  ORDER BY mois, "Région"  -- Tri par mois et région
    );
  ...
                                    ^
[0m12:51:19.972973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5134a7f-e314-4c24-92f4-d998d8fcf68e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8bb05da680>]}
[0m12:51:19.974131 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model main.3_1 .................................. [[31mERROR[0m in 0.07s]
[0m12:51:19.975327 [debug] [Thread-1 (]: Finished running node model.transform.3_1
[0m12:51:19.976119 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m12:51:19.978378 [info ] [Thread-1 (]: 2 of 6 START sql view model main.clean ......................................... [RUN]
[0m12:51:19.979290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_1, now model.transform.clean)
[0m12:51:19.979975 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m12:51:19.983468 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m12:51:19.985511 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m12:51:19.990178 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m12:51:19.991677 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:51:19.992127 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m12:51:19.992561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:20.009391 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m12:51:20.009942 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:51:20.010610 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT 
        *,
        COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0) AS consommation,
        COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) AS eolien,
        COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS thermique,
        COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0) AS bioenergies,
        COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) AS nucleaire,
        COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) AS solaire,
        COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) AS hydraulique,
        COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0) AS pompage,
        COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0) AS ech_physiques
    FROM eco2
    WHERE "Région" IS NOT NULL AND "Date" IS NOT NULL
),
data_final AS (
    SELECT 
        "Code INSEE région",
        "Région", 
        "Date", 
        "Heure",
        consommation,
        eolien,
        thermique,
        bioenergies,
        nucleaire,
        solaire,
        hydraulique,
        pompage,
        ech_physiques,
        COALESCE(nucleaire, 0) + 
        COALESCE(eolien, 0) +
        COALESCE(solaire, 0) +
        COALESCE(hydraulique, 0) +
        COALESCE(thermique, 0) AS production_totale
    FROM data_clean
)

SELECT * FROM data_final
  );

[0m12:51:20.011954 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:51:20.016563 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:51:20.016798 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m12:51:20.017313 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:20.018792 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:51:20.018992 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m12:51:20.019554 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:20.027627 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:51:20.027853 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:51:20.028230 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:51:20.029788 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:51:20.032316 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:51:20.032533 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m12:51:20.033288 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:20.034556 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m12:51:20.047169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5134a7f-e314-4c24-92f4-d998d8fcf68e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ba9571cc0>]}
[0m12:51:20.047691 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.clean .................................... [[32mOK[0m in 0.07s]
[0m12:51:20.048143 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m12:51:20.048471 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m12:51:20.048900 [info ] [Thread-1 (]: 3 of 6 START sql view model main.grain_jour .................................... [RUN]
[0m12:51:20.049231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m12:51:20.049573 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m12:51:20.051713 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m12:51:20.052933 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m12:51:20.055774 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m12:51:20.057047 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:51:20.057338 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m12:51:20.057649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:20.068763 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:51:20.069005 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:51:20.069609 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *
    from clean
          
)
SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("consommation" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("thermique" AS INT), 0)) AS thermique_total,
    SUM(COALESCE(TRY_CAST("bioenergies" AS INT), 0)) AS bioenergies_total,
    SUM(COALESCE(TRY_CAST("eolien" AS INT), 0)) AS eolien_total,
    SUM(COALESCE(TRY_CAST("nucleaire" AS INT), 0)) AS nucleaire_total,
    SUM(COALESCE(TRY_CAST("solaire" AS INT), 0)) AS solaire_total,
    SUM(COALESCE(TRY_CAST("hydraulique" AS INT), 0)) AS hydraulique_total,
    SUM(COALESCE(TRY_CAST("pompage" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("ech_physiques" AS INT), 0)) AS ech_physiques_total,
    SUM(COALESCE(TRY_CAST("production_totale" AS INT), 0)) AS production_totale
   
FROM data_clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m12:51:20.070552 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:51:20.072205 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:51:20.072423 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour" rename to "grain_jour__dbt_backup"
[0m12:51:20.072970 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:20.074419 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:51:20.074625 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour__dbt_tmp" rename to "grain_jour"
[0m12:51:20.075193 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:20.076009 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:51:20.076220 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:51:20.076539 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:51:20.077988 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:51:20.079217 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:51:20.079430 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
drop view if exists "dev"."main"."grain_jour__dbt_backup" cascade
[0m12:51:20.080195 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:20.080899 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m12:51:20.092950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5134a7f-e314-4c24-92f4-d998d8fcf68e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ba59b1f60>]}
[0m12:51:20.093344 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.grain_jour ............................... [[32mOK[0m in 0.04s]
[0m12:51:20.093667 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m12:51:20.093918 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m12:51:20.094233 [info ] [Thread-1 (]: 4 of 6 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m12:51:20.094502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m12:51:20.094764 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m12:51:20.096246 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m12:51:20.097399 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m12:51:20.106884 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m12:51:20.108042 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:51:20.108239 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m12:51:20.108523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:20.119048 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m12:51:20.119277 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:51:20.119823 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m12:51:20.120476 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:20.122441 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:51:20.122650 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m12:51:20.123179 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:20.145721 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:51:20.146019 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m12:51:20.146888 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:20.149574 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:51:20.149804 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:51:20.150259 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:51:20.151823 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:51:20.153096 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:51:20.153299 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m12:51:20.154214 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:20.154919 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m12:51:20.170490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5134a7f-e314-4c24-92f4-d998d8fcf68e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ba4f34a60>]}
[0m12:51:20.170899 [info ] [Thread-1 (]: 4 of 6 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.08s]
[0m12:51:20.171223 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m12:51:20.171482 [debug] [Thread-1 (]: Began running node model.transform.3_2
[0m12:51:20.171880 [info ] [Thread-1 (]: 5 of 6 START sql view model main.3_2 ........................................... [RUN]
[0m12:51:20.172128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.3_2)
[0m12:51:20.172316 [debug] [Thread-1 (]: Began compiling node model.transform.3_2
[0m12:51:20.174865 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_2"
[0m12:51:20.176029 [debug] [Thread-1 (]: Began executing node model.transform.3_2
[0m12:51:20.177913 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_2"
[0m12:51:20.179003 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:51:20.179196 [debug] [Thread-1 (]: On model.transform.3_2: BEGIN
[0m12:51:20.179476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:20.190402 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:51:20.190646 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:51:20.191234 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */

  
  create view "dev"."main"."3_2__dbt_tmp" as (
    -- Récupérer les régions distinctes dans un set Jinja


SELECT 
    Date,
    
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bourgogne-Franche-Comté' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Bourgogne-Franche-Comté"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Centre-Val de Loire' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Centre-Val de Loire"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Nouvelle-Aquitaine' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Nouvelle-Aquitaine"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Occitanie' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Occitanie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Île-de-France' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Île-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Normandie' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Normandie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Grand Est' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Grand Est"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Provence-Alpes-Côte d''Azur' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Provence-Alpes-Côte d''Azur"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bretagne' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Bretagne"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Hauts-de-France' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Hauts-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Auvergne-Rhône-Alpes' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Auvergne-Rhône-Alpes"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Pays de la Loire' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Pays de la Loire"
        
    
    
FROM 
    "dev"."main"."clean"
GROUP BY 
    Date
ORDER BY 
    Date
  );

[0m12:51:20.192247 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:51:20.193876 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:51:20.194103 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
alter view "dev"."main"."3_2" rename to "3_2__dbt_backup"
[0m12:51:20.194578 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:20.196086 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:51:20.196289 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
alter view "dev"."main"."3_2__dbt_tmp" rename to "3_2"
[0m12:51:20.196745 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:20.197555 [debug] [Thread-1 (]: On model.transform.3_2: COMMIT
[0m12:51:20.197754 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:51:20.198069 [debug] [Thread-1 (]: On model.transform.3_2: COMMIT
[0m12:51:20.199835 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:51:20.201014 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:51:20.201215 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
drop view if exists "dev"."main"."3_2__dbt_backup" cascade
[0m12:51:20.201921 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:20.202566 [debug] [Thread-1 (]: On model.transform.3_2: Close
[0m12:51:20.214541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5134a7f-e314-4c24-92f4-d998d8fcf68e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ba4f36080>]}
[0m12:51:20.214941 [info ] [Thread-1 (]: 5 of 6 OK created sql view model main.3_2 ...................................... [[32mOK[0m in 0.04s]
[0m12:51:20.215286 [debug] [Thread-1 (]: Finished running node model.transform.3_2
[0m12:51:20.215544 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m12:51:20.215893 [info ] [Thread-1 (]: 6 of 6 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m12:51:20.216129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_2, now model.transform.my_second_dbt_model)
[0m12:51:20.216382 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m12:51:20.218510 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m12:51:20.219673 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m12:51:20.221485 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m12:51:20.222672 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:51:20.222875 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m12:51:20.223172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:20.233527 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m12:51:20.233756 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:51:20.234323 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m12:51:20.234871 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:20.236356 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:51:20.236566 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m12:51:20.237065 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:20.238507 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:51:20.238711 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m12:51:20.239266 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:20.240103 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:51:20.240304 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:51:20.240601 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:51:20.242074 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:51:20.243281 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:51:20.243491 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m12:51:20.244232 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:20.244941 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m12:51:20.257327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5134a7f-e314-4c24-92f4-d998d8fcf68e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8bb1236290>]}
[0m12:51:20.257712 [info ] [Thread-1 (]: 6 of 6 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m12:51:20.258027 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m12:51:20.258889 [debug] [MainThread]: Using duckdb connection "master"
[0m12:51:20.259112 [debug] [MainThread]: On master: BEGIN
[0m12:51:20.259390 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:51:20.271517 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m12:51:20.271925 [debug] [MainThread]: On master: COMMIT
[0m12:51:20.272497 [debug] [MainThread]: Using duckdb connection "master"
[0m12:51:20.272849 [debug] [MainThread]: On master: COMMIT
[0m12:51:20.273394 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:51:20.273678 [debug] [MainThread]: On master: Close
[0m12:51:20.275204 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:51:20.275414 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m12:51:20.275787 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m12:51:20.276183 [info ] [MainThread]: 
[0m12:51:20.276462 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m12:51:20.277279 [debug] [MainThread]: Command end result
[0m12:51:20.301662 [info ] [MainThread]: 
[0m12:51:20.302042 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:51:20.302560 [info ] [MainThread]: 
[0m12:51:20.302987 [error] [MainThread]:   Runtime Error in model 3_1 (models/example/3_1.sql)
  Binder Error: Referenced column "consommation " not found in FROM clause!
  Candidate bindings: "clean.consommation", "clean.pompage", "clean.solaire", "clean.production_totale", "clean.bioenergies"
  LINE 8:     SUM(COALESCE(TRY_CAST("consommation " AS INT), 0))/2000 AS consommation_totale_en_GWH,
      SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,
  
      MIN(COALESCE(TRY_CAST("consommation " AS INT), 0)) AS min_consommation_totale,
      MIN(COALESCE(production_totale, 0)) AS min_production_totale,
  
      MAX(COALESCE(TRY_CAST("consommation " AS INT), 0)) AS max_consommation_totale,
      MAX(COALESCE(production_totale, 0)) AS max_production_totale,
      
      AVG(COALESCE(TRY_CAST("consommation " AS INT), 0)) AS moyenne_consommation_totale,
  
      AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
  FROM clean
  GROUP BY strftime('%Y-%m', Date), "Région"  -- Remplacer TO_CHAR par strftime
  ORDER BY mois, "Région"  -- Tri par mois et région
    );
  ...
                                    ^
[0m12:51:20.303279 [info ] [MainThread]: 
[0m12:51:20.303654 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m12:51:20.304313 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3680812, "process_in_blocks": "12320", "process_kernel_time": 0.236601, "process_mem_max_rss": "140132", "process_out_blocks": "9872", "process_user_time": 1.560989}
[0m12:51:20.304621 [debug] [MainThread]: Command `dbt run` failed at 12:51:20.304570 after 1.37 seconds
[0m12:51:20.304888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8bb04f7c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8baf6d8d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ba4f35870>]}
[0m12:51:20.305292 [debug] [MainThread]: Flushing usage events
[0m12:51:48.918199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76edf9ff7c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76edfa326890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76edfa3270a0>]}


============================== 12:51:48.921022 | 84da4e72-6007-4507-a62b-3c9d1e56a8ce ==============================
[0m12:51:48.921022 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:51:48.921841 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:51:49.043673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84da4e72-6007-4507-a62b-3c9d1e56a8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76edf8745ea0>]}
[0m12:51:49.070897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84da4e72-6007-4507-a62b-3c9d1e56a8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76edf89a3970>]}
[0m12:51:49.073968 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m12:51:49.116216 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:51:49.252360 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:51:49.253115 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:51:49.263175 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m12:51:49.282114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84da4e72-6007-4507-a62b-3c9d1e56a8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76edf27e18d0>]}
[0m12:51:49.342320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84da4e72-6007-4507-a62b-3c9d1e56a8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76edf27e18d0>]}
[0m12:51:49.342586 [info ] [MainThread]: Found 6 models, 4 data tests, 421 macros
[0m12:51:49.343089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84da4e72-6007-4507-a62b-3c9d1e56a8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76edf27e3bb0>]}
[0m12:51:49.344144 [info ] [MainThread]: 
[0m12:51:49.344548 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:51:49.347498 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:51:49.574759 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:51:49.575438 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:51:49.576024 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:49.593821 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m12:51:49.595015 [debug] [ThreadPool]: On list_dev: Close
[0m12:51:49.597731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:51:49.598114 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:51:49.602009 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:51:49.602220 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:51:49.602550 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:49.613698 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m12:51:49.614471 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:51:49.614679 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:51:49.615101 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:51:49.615305 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:51:49.615601 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:51:49.616041 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:51:49.616469 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:51:49.616648 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:51:49.616953 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:51:49.617412 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:51:49.617592 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:51:49.619502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:51:49.622527 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:51:49.622737 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:51:49.623059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:49.636675 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m12:51:49.637361 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:51:49.638004 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:51:49.654567 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m12:51:49.655254 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:51:49.655832 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:51:49.656000 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:51:49.658166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84da4e72-6007-4507-a62b-3c9d1e56a8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76edf9deb400>]}
[0m12:51:49.658414 [debug] [MainThread]: Using duckdb connection "master"
[0m12:51:49.658687 [debug] [MainThread]: On master: BEGIN
[0m12:51:49.658980 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:51:49.670857 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m12:51:49.671196 [debug] [MainThread]: On master: COMMIT
[0m12:51:49.671780 [debug] [MainThread]: Using duckdb connection "master"
[0m12:51:49.672140 [debug] [MainThread]: On master: COMMIT
[0m12:51:49.672645 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:51:49.673020 [debug] [MainThread]: On master: Close
[0m12:51:49.675189 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:51:49.675661 [info ] [MainThread]: 
[0m12:51:49.678311 [debug] [Thread-1 (]: Began running node model.transform.3_1
[0m12:51:49.679451 [info ] [Thread-1 (]: 1 of 6 START sql view model main.3_1 ........................................... [RUN]
[0m12:51:49.680624 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.3_1'
[0m12:51:49.681518 [debug] [Thread-1 (]: Began compiling node model.transform.3_1
[0m12:51:49.690874 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_1"
[0m12:51:49.693015 [debug] [Thread-1 (]: Began executing node model.transform.3_1
[0m12:51:49.717181 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_1"
[0m12:51:49.718436 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:51:49.718644 [debug] [Thread-1 (]: On model.transform.3_1: BEGIN
[0m12:51:49.718947 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:51:49.730575 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m12:51:49.730813 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:51:49.731419 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    strftime('%Y-%m', Date) AS mois,  -- Utilisation de strftime pour extraire l'année et le mois
    "Région", 
    SUM(COALESCE(TRY_CAST("consommation" AS INT), 0))/2000 AS consommation_totale_en_GWH,
    SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,

    MIN(COALESCE(TRY_CAST("consommation" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("consommation" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("consommation" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
FROM clean
GROUP BY strftime('%Y-%m', Date), "Région"  -- Remplacer TO_CHAR par strftime
ORDER BY mois, "Région"  -- Tri par mois et région
  );

[0m12:51:49.732352 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:51:49.735595 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:51:49.735820 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1" rename to "3_1__dbt_backup"
[0m12:51:49.736478 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:49.737890 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:51:49.738091 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1__dbt_tmp" rename to "3_1"
[0m12:51:49.738597 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:49.746655 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m12:51:49.746877 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:51:49.747267 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m12:51:49.748829 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:51:49.751268 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:51:49.751479 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
drop view if exists "dev"."main"."3_1__dbt_backup" cascade
[0m12:51:49.752343 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:49.753611 [debug] [Thread-1 (]: On model.transform.3_1: Close
[0m12:51:49.766583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84da4e72-6007-4507-a62b-3c9d1e56a8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76edf9deb400>]}
[0m12:51:49.766982 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.3_1 ...................................... [[32mOK[0m in 0.09s]
[0m12:51:49.767300 [debug] [Thread-1 (]: Finished running node model.transform.3_1
[0m12:51:49.767550 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m12:51:49.767916 [info ] [Thread-1 (]: 2 of 6 START sql view model main.clean ......................................... [RUN]
[0m12:51:49.768185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_1, now model.transform.clean)
[0m12:51:49.768374 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m12:51:49.769445 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m12:51:49.770594 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m12:51:49.772416 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m12:51:49.773709 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:51:49.773935 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m12:51:49.774233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:49.787196 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m12:51:49.787652 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:51:49.788291 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT 
        *,
        COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0) AS consommation,
        COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) AS eolien,
        COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS thermique,
        COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0) AS bioenergies,
        COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) AS nucleaire,
        COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) AS solaire,
        COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) AS hydraulique,
        COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0) AS pompage,
        COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0) AS ech_physiques
    FROM eco2
    WHERE "Région" IS NOT NULL AND "Date" IS NOT NULL
),
data_final AS (
    SELECT 
        "Code INSEE région",
        "Région", 
        "Date", 
        "Heure",
        consommation,
        eolien,
        thermique,
        bioenergies,
        nucleaire,
        solaire,
        hydraulique,
        pompage,
        ech_physiques,
        COALESCE(nucleaire, 0) + 
        COALESCE(eolien, 0) +
        COALESCE(solaire, 0) +
        COALESCE(hydraulique, 0) +
        COALESCE(thermique, 0) AS production_totale
    FROM data_clean
)

SELECT * FROM data_final
  );

[0m12:51:49.789501 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:51:49.792588 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:51:49.792878 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m12:51:49.793512 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:49.795148 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:51:49.795363 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m12:51:49.795881 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:49.796718 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:51:49.796916 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:51:49.797330 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:51:49.798794 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:51:49.799916 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:51:49.800106 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m12:51:49.801057 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:49.801685 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m12:51:49.814001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84da4e72-6007-4507-a62b-3c9d1e56a8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76edf9deb400>]}
[0m12:51:49.814366 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.clean .................................... [[32mOK[0m in 0.05s]
[0m12:51:49.814679 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m12:51:49.814944 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m12:51:49.815298 [info ] [Thread-1 (]: 3 of 6 START sql view model main.grain_jour .................................... [RUN]
[0m12:51:49.815580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m12:51:49.815860 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m12:51:49.816933 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m12:51:49.818145 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m12:51:49.819883 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m12:51:49.821074 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:51:49.821269 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m12:51:49.821565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:49.832299 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:51:49.832543 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:51:49.833178 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *
    from clean
          
)
SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("consommation" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("thermique" AS INT), 0)) AS thermique_total,
    SUM(COALESCE(TRY_CAST("bioenergies" AS INT), 0)) AS bioenergies_total,
    SUM(COALESCE(TRY_CAST("eolien" AS INT), 0)) AS eolien_total,
    SUM(COALESCE(TRY_CAST("nucleaire" AS INT), 0)) AS nucleaire_total,
    SUM(COALESCE(TRY_CAST("solaire" AS INT), 0)) AS solaire_total,
    SUM(COALESCE(TRY_CAST("hydraulique" AS INT), 0)) AS hydraulique_total,
    SUM(COALESCE(TRY_CAST("pompage" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("ech_physiques" AS INT), 0)) AS ech_physiques_total,
    SUM(COALESCE(TRY_CAST("production_totale" AS INT), 0)) AS production_totale
   
FROM data_clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m12:51:49.834128 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:51:49.835602 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:51:49.835807 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour" rename to "grain_jour__dbt_backup"
[0m12:51:49.836349 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:49.837779 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:51:49.837984 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour__dbt_tmp" rename to "grain_jour"
[0m12:51:49.838553 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:49.839416 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:51:49.839617 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:51:49.839914 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:51:49.841682 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:51:49.842861 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:51:49.843068 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
drop view if exists "dev"."main"."grain_jour__dbt_backup" cascade
[0m12:51:49.843869 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:49.845036 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m12:51:49.857293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84da4e72-6007-4507-a62b-3c9d1e56a8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76edf91c1c00>]}
[0m12:51:49.857646 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.grain_jour ............................... [[32mOK[0m in 0.04s]
[0m12:51:49.857943 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m12:51:49.858190 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m12:51:49.858568 [info ] [Thread-1 (]: 4 of 6 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m12:51:49.858919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m12:51:49.859182 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m12:51:49.882741 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m12:51:49.884195 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m12:51:49.893742 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m12:51:49.895012 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:51:49.895211 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m12:51:49.895503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:49.906505 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:51:49.906731 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:51:49.907325 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m12:51:49.908061 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:49.909516 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:51:49.909725 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m12:51:49.910233 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:49.911750 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:51:49.911973 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m12:51:49.912533 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:49.915087 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:51:49.915312 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:51:49.915653 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:51:49.917098 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:51:49.918276 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:51:49.918478 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m12:51:49.919293 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:49.919985 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m12:51:49.935005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84da4e72-6007-4507-a62b-3c9d1e56a8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76edeebc4d90>]}
[0m12:51:49.935386 [info ] [Thread-1 (]: 4 of 6 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.08s]
[0m12:51:49.935701 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m12:51:49.935951 [debug] [Thread-1 (]: Began running node model.transform.3_2
[0m12:51:49.936344 [info ] [Thread-1 (]: 5 of 6 START sql view model main.3_2 ........................................... [RUN]
[0m12:51:49.936577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.3_2)
[0m12:51:49.936838 [debug] [Thread-1 (]: Began compiling node model.transform.3_2
[0m12:51:49.939171 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_2"
[0m12:51:49.940449 [debug] [Thread-1 (]: Began executing node model.transform.3_2
[0m12:51:49.942794 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_2"
[0m12:51:49.944014 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:51:49.944205 [debug] [Thread-1 (]: On model.transform.3_2: BEGIN
[0m12:51:49.944472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:49.955148 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:51:49.955373 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:51:49.955986 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */

  
  create view "dev"."main"."3_2__dbt_tmp" as (
    -- Récupérer les régions distinctes dans un set Jinja


SELECT 
    Date,
    
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bourgogne-Franche-Comté' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Bourgogne-Franche-Comté"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Centre-Val de Loire' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Centre-Val de Loire"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Nouvelle-Aquitaine' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Nouvelle-Aquitaine"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Occitanie' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Occitanie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Île-de-France' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Île-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Normandie' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Normandie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Grand Est' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Grand Est"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Provence-Alpes-Côte d''Azur' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Provence-Alpes-Côte d''Azur"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bretagne' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Bretagne"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Hauts-de-France' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Hauts-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Auvergne-Rhône-Alpes' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Auvergne-Rhône-Alpes"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Pays de la Loire' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Pays de la Loire"
        
    
    
FROM 
    "dev"."main"."clean"
GROUP BY 
    Date
ORDER BY 
    Date
  );

[0m12:51:49.956988 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:51:49.958528 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:51:49.958729 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
alter view "dev"."main"."3_2" rename to "3_2__dbt_backup"
[0m12:51:49.959264 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:49.960638 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:51:49.960840 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
alter view "dev"."main"."3_2__dbt_tmp" rename to "3_2"
[0m12:51:49.961395 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:49.962181 [debug] [Thread-1 (]: On model.transform.3_2: COMMIT
[0m12:51:49.962384 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:51:49.962697 [debug] [Thread-1 (]: On model.transform.3_2: COMMIT
[0m12:51:49.964509 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:51:49.965717 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:51:49.965924 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
drop view if exists "dev"."main"."3_2__dbt_backup" cascade
[0m12:51:49.966770 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:49.967415 [debug] [Thread-1 (]: On model.transform.3_2: Close
[0m12:51:49.979502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84da4e72-6007-4507-a62b-3c9d1e56a8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76edeeb5bb20>]}
[0m12:51:49.979888 [info ] [Thread-1 (]: 5 of 6 OK created sql view model main.3_2 ...................................... [[32mOK[0m in 0.04s]
[0m12:51:49.980200 [debug] [Thread-1 (]: Finished running node model.transform.3_2
[0m12:51:49.980454 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m12:51:49.980767 [info ] [Thread-1 (]: 6 of 6 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m12:51:49.981042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_2, now model.transform.my_second_dbt_model)
[0m12:51:49.981317 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m12:51:49.982902 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m12:51:49.984217 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m12:51:49.986050 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m12:51:49.987198 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:51:49.987388 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m12:51:49.987668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:49.998095 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m12:51:49.998325 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:51:49.998858 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m12:51:49.999476 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:50.001040 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:51:50.001244 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m12:51:50.001691 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:50.003105 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:51:50.003308 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m12:51:50.003849 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:50.004654 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:51:50.004849 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:51:50.005704 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:51:50.007155 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:51:50.008308 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:51:50.008504 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m12:51:50.009198 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:50.009833 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m12:51:50.021880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84da4e72-6007-4507-a62b-3c9d1e56a8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76edeeb74880>]}
[0m12:51:50.022275 [info ] [Thread-1 (]: 6 of 6 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m12:51:50.022588 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m12:51:50.023384 [debug] [MainThread]: Using duckdb connection "master"
[0m12:51:50.023581 [debug] [MainThread]: On master: BEGIN
[0m12:51:50.023881 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:51:50.035106 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m12:51:50.035313 [debug] [MainThread]: On master: COMMIT
[0m12:51:50.035891 [debug] [MainThread]: Using duckdb connection "master"
[0m12:51:50.036211 [debug] [MainThread]: On master: COMMIT
[0m12:51:50.036610 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:51:50.036850 [debug] [MainThread]: On master: Close
[0m12:51:50.038104 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:51:50.038315 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m12:51:50.038609 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m12:51:50.038966 [info ] [MainThread]: 
[0m12:51:50.039206 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m12:51:50.039928 [debug] [MainThread]: Command end result
[0m12:51:50.061307 [info ] [MainThread]: 
[0m12:51:50.061562 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:51:50.062045 [info ] [MainThread]: 
[0m12:51:50.062371 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m12:51:50.062879 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1720073, "process_in_blocks": "12320", "process_kernel_time": 0.13835, "process_mem_max_rss": "137860", "process_out_blocks": "10984", "process_user_time": 1.255328}
[0m12:51:50.063171 [debug] [MainThread]: Command `dbt run` succeeded at 12:51:50.063121 after 1.17 seconds
[0m12:51:50.063397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76edf9ff7c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76edfa3279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76edfa327280>]}
[0m12:51:50.063693 [debug] [MainThread]: Flushing usage events
[0m12:56:02.184508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76714bcf7b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76714c02b5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76714c02afb0>]}


============================== 12:56:02.188015 | 76823b71-1c83-4b4d-a4e8-dd2ac7a082fe ==============================
[0m12:56:02.188015 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:56:02.188731 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:56:02.337931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76823b71-1c83-4b4d-a4e8-dd2ac7a082fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76714c06abc0>]}
[0m12:56:02.366978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76823b71-1c83-4b4d-a4e8-dd2ac7a082fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76714a6a38e0>]}
[0m12:56:02.370028 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m12:56:02.412206 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:56:02.539520 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:56:02.540304 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:56:02.551190 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m12:56:02.576616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76823b71-1c83-4b4d-a4e8-dd2ac7a082fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767144dd9cc0>]}
[0m12:56:02.663107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76823b71-1c83-4b4d-a4e8-dd2ac7a082fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767144d66b30>]}
[0m12:56:02.663861 [info ] [MainThread]: Found 7 models, 4 data tests, 421 macros
[0m12:56:02.664546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76823b71-1c83-4b4d-a4e8-dd2ac7a082fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767144d65b70>]}
[0m12:56:02.667006 [info ] [MainThread]: 
[0m12:56:02.667674 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:56:02.672462 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:56:03.063833 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:56:03.064686 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:56:03.065346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:03.086438 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m12:56:03.087887 [debug] [ThreadPool]: On list_dev: Close
[0m12:56:03.091148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:56:03.091625 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:56:03.096542 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:56:03.096795 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:56:03.097211 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:56:03.109650 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m12:56:03.110662 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:56:03.110937 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:56:03.111385 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:56:03.111613 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:56:03.111949 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:56:03.112383 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:56:03.112909 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:56:03.113115 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:56:03.113416 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:56:03.113832 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:56:03.114050 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:56:03.115732 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:56:03.119235 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:56:03.119466 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:56:03.119817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:56:03.131245 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m12:56:03.131461 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:56:03.132002 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:56:03.144257 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m12:56:03.144989 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:56:03.145577 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:56:03.145746 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:56:03.148400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76823b71-1c83-4b4d-a4e8-dd2ac7a082fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76714430d450>]}
[0m12:56:03.148755 [debug] [MainThread]: Using duckdb connection "master"
[0m12:56:03.149100 [debug] [MainThread]: On master: BEGIN
[0m12:56:03.149553 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:56:03.167459 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m12:56:03.168228 [debug] [MainThread]: On master: COMMIT
[0m12:56:03.168944 [debug] [MainThread]: Using duckdb connection "master"
[0m12:56:03.169508 [debug] [MainThread]: On master: COMMIT
[0m12:56:03.170345 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:56:03.170948 [debug] [MainThread]: On master: Close
[0m12:56:03.173848 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:56:03.174345 [info ] [MainThread]: 
[0m12:56:03.176811 [debug] [Thread-1 (]: Began running node model.transform.3_1
[0m12:56:03.177837 [info ] [Thread-1 (]: 1 of 7 START sql view model main.3_1 ........................................... [RUN]
[0m12:56:03.178924 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.3_1'
[0m12:56:03.179763 [debug] [Thread-1 (]: Began compiling node model.transform.3_1
[0m12:56:03.190729 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_1"
[0m12:56:03.193226 [debug] [Thread-1 (]: Began executing node model.transform.3_1
[0m12:56:03.212554 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_1"
[0m12:56:03.214795 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:56:03.215000 [debug] [Thread-1 (]: On model.transform.3_1: BEGIN
[0m12:56:03.215451 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:56:03.226664 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:56:03.226892 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:56:03.227546 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    strftime('%Y-%m', Date) AS mois,  -- Utilisation de strftime pour extraire l'année et le mois
    "Région", 
    SUM(COALESCE(TRY_CAST("consommation" AS INT), 0))/2000 AS consommation_totale_en_GWH,
    SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,

    MIN(COALESCE(TRY_CAST("consommation" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("consommation" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("consommation" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
FROM clean
GROUP BY strftime('%Y-%m', Date), "Région"  -- Remplacer TO_CHAR par strftime
ORDER BY mois, "Région"  -- Tri par mois et région
  );

[0m12:56:03.228518 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:56:03.231723 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:56:03.231957 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1" rename to "3_1__dbt_backup"
[0m12:56:03.232586 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:56:03.233974 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:56:03.234175 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1__dbt_tmp" rename to "3_1"
[0m12:56:03.234712 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:56:03.242793 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m12:56:03.243008 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:56:03.243380 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m12:56:03.244787 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:56:03.247235 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m12:56:03.247446 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
drop view if exists "dev"."main"."3_1__dbt_backup" cascade
[0m12:56:03.248173 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:56:03.249427 [debug] [Thread-1 (]: On model.transform.3_1: Close
[0m12:56:03.261965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76823b71-1c83-4b4d-a4e8-dd2ac7a082fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76714430d450>]}
[0m12:56:03.262324 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.3_1 ...................................... [[32mOK[0m in 0.08s]
[0m12:56:03.262653 [debug] [Thread-1 (]: Finished running node model.transform.3_1
[0m12:56:03.262884 [debug] [Thread-1 (]: Began running node model.transform.3_3
[0m12:56:03.263295 [info ] [Thread-1 (]: 2 of 7 START sql view model main.3_3 ........................................... [RUN]
[0m12:56:03.263584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_1, now model.transform.3_3)
[0m12:56:03.263871 [debug] [Thread-1 (]: Began compiling node model.transform.3_3
[0m12:56:03.264913 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_3"
[0m12:56:03.268160 [debug] [Thread-1 (]: Began executing node model.transform.3_3
[0m12:56:03.269999 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_3"
[0m12:56:03.271466 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_3"
[0m12:56:03.271655 [debug] [Thread-1 (]: On model.transform.3_3: BEGIN
[0m12:56:03.272097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:03.283272 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:56:03.283488 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_3"
[0m12:56:03.284011 [debug] [Thread-1 (]: On model.transform.3_3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_3"} */

  
  create view "dev"."main"."3_3__dbt_tmp" as (
    WITH data_with_consumption AS (
    SELECT 
        "Code INSEE région",
        "Région", 
        "Date", 
        consommation,  -- Consommation en MW
        -- Calcul de la consommation cumulée en GWh pour chaque jour du mois écoulé
        SUM(COALESCE(consommation, 0)) OVER (
            PARTITION BY "Région", EXTRACT(YEAR FROM "Date"), EXTRACT(MONTH FROM "Date")
            ORDER BY "Date"
            RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
        ) / 2000 AS consommation_gwh  -- Conversion de la consommation en GWh
    FROM clean
)

SELECT 
    "Code INSEE région", 
    "Région", 
    "Date", 
    consommation, 
    consommation_gwh
FROM data_with_consumption
ORDER BY "Région", "Date"
  );

[0m12:56:03.284893 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:56:03.286828 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_3"
[0m12:56:03.287034 [debug] [Thread-1 (]: On model.transform.3_3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_3"} */
alter view "dev"."main"."3_3__dbt_tmp" rename to "3_3"
[0m12:56:03.287551 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:56:03.288261 [debug] [Thread-1 (]: On model.transform.3_3: COMMIT
[0m12:56:03.288453 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_3"
[0m12:56:03.288761 [debug] [Thread-1 (]: On model.transform.3_3: COMMIT
[0m12:56:03.290409 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:56:03.291545 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_3"
[0m12:56:03.291737 [debug] [Thread-1 (]: On model.transform.3_3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_3"} */
drop view if exists "dev"."main"."3_3__dbt_backup" cascade
[0m12:56:03.292176 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:56:03.292801 [debug] [Thread-1 (]: On model.transform.3_3: Close
[0m12:56:03.304747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76823b71-1c83-4b4d-a4e8-dd2ac7a082fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767141181a80>]}
[0m12:56:03.305118 [info ] [Thread-1 (]: 2 of 7 OK created sql view model main.3_3 ...................................... [[32mOK[0m in 0.04s]
[0m12:56:03.305423 [debug] [Thread-1 (]: Finished running node model.transform.3_3
[0m12:56:03.305672 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m12:56:03.305995 [info ] [Thread-1 (]: 3 of 7 START sql view model main.clean ......................................... [RUN]
[0m12:56:03.306252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_3, now model.transform.clean)
[0m12:56:03.306519 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m12:56:03.307540 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m12:56:03.308673 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m12:56:03.310450 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m12:56:03.311531 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:56:03.311719 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m12:56:03.312032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:03.322588 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:56:03.322813 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:56:03.323384 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT 
        *,
        COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0) AS consommation,
        COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) AS eolien,
        COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS thermique,
        COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0) AS bioenergies,
        COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) AS nucleaire,
        COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) AS solaire,
        COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) AS hydraulique,
        COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0) AS pompage,
        COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0) AS ech_physiques
    FROM eco2
    WHERE "Région" IS NOT NULL AND "Date" IS NOT NULL
),
data_final AS (
    SELECT 
        "Code INSEE région",
        "Région", 
        "Date", 
        "Heure",
        consommation,
        eolien,
        thermique,
        bioenergies,
        nucleaire,
        solaire,
        hydraulique,
        pompage,
        ech_physiques,
        COALESCE(nucleaire, 0) + 
        COALESCE(eolien, 0) +
        COALESCE(solaire, 0) +
        COALESCE(hydraulique, 0) +
        COALESCE(thermique, 0) AS production_totale
    FROM data_clean
)

SELECT * FROM data_final
  );

[0m12:56:03.324214 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:56:03.325763 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:56:03.325964 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m12:56:03.326419 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:56:03.327787 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:56:03.327986 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m12:56:03.328435 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:56:03.329214 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:56:03.329407 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:56:03.329705 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m12:56:03.331346 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:56:03.332503 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m12:56:03.332700 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m12:56:03.333511 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:56:03.334146 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m12:56:03.346765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76823b71-1c83-4b4d-a4e8-dd2ac7a082fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76714115ada0>]}
[0m12:56:03.347226 [info ] [Thread-1 (]: 3 of 7 OK created sql view model main.clean .................................... [[32mOK[0m in 0.04s]
[0m12:56:03.347523 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m12:56:03.347794 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m12:56:03.348128 [info ] [Thread-1 (]: 4 of 7 START sql view model main.grain_jour .................................... [RUN]
[0m12:56:03.348407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m12:56:03.348704 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m12:56:03.349633 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m12:56:03.350743 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m12:56:03.372871 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m12:56:03.374462 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:56:03.374676 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m12:56:03.374980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:03.386283 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:56:03.386503 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:56:03.387042 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *
    from clean
          
)
SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("consommation" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("thermique" AS INT), 0)) AS thermique_total,
    SUM(COALESCE(TRY_CAST("bioenergies" AS INT), 0)) AS bioenergies_total,
    SUM(COALESCE(TRY_CAST("eolien" AS INT), 0)) AS eolien_total,
    SUM(COALESCE(TRY_CAST("nucleaire" AS INT), 0)) AS nucleaire_total,
    SUM(COALESCE(TRY_CAST("solaire" AS INT), 0)) AS solaire_total,
    SUM(COALESCE(TRY_CAST("hydraulique" AS INT), 0)) AS hydraulique_total,
    SUM(COALESCE(TRY_CAST("pompage" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("ech_physiques" AS INT), 0)) AS ech_physiques_total,
    SUM(COALESCE(TRY_CAST("production_totale" AS INT), 0)) AS production_totale
   
FROM data_clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m12:56:03.387954 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:56:03.389606 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:56:03.389822 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour" rename to "grain_jour__dbt_backup"
[0m12:56:03.390332 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:56:03.391831 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:56:03.392035 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour__dbt_tmp" rename to "grain_jour"
[0m12:56:03.392502 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:56:03.393319 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:56:03.393515 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:56:03.393814 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m12:56:03.395461 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:56:03.396614 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m12:56:03.396819 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
drop view if exists "dev"."main"."grain_jour__dbt_backup" cascade
[0m12:56:03.397620 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:56:03.398272 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m12:56:03.410393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76823b71-1c83-4b4d-a4e8-dd2ac7a082fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76714111cac0>]}
[0m12:56:03.410763 [info ] [Thread-1 (]: 4 of 7 OK created sql view model main.grain_jour ............................... [[32mOK[0m in 0.06s]
[0m12:56:03.411074 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m12:56:03.411322 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m12:56:03.411635 [info ] [Thread-1 (]: 5 of 7 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m12:56:03.411900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m12:56:03.412106 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m12:56:03.413618 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m12:56:03.414818 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m12:56:03.424472 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m12:56:03.425689 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:56:03.425900 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m12:56:03.426193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:03.436946 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:56:03.437182 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:56:03.437730 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m12:56:03.438376 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:56:03.439873 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:56:03.440080 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m12:56:03.440545 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:56:03.442555 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:56:03.442774 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m12:56:03.443294 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:56:03.445926 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:56:03.446153 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:56:03.446473 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m12:56:03.448159 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:56:03.449299 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m12:56:03.449503 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m12:56:03.450331 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:56:03.451079 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m12:56:03.466465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76823b71-1c83-4b4d-a4e8-dd2ac7a082fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767141181270>]}
[0m12:56:03.466858 [info ] [Thread-1 (]: 5 of 7 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m12:56:03.467186 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m12:56:03.467447 [debug] [Thread-1 (]: Began running node model.transform.3_2
[0m12:56:03.467824 [info ] [Thread-1 (]: 6 of 7 START sql view model main.3_2 ........................................... [RUN]
[0m12:56:03.468075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.3_2)
[0m12:56:03.468283 [debug] [Thread-1 (]: Began compiling node model.transform.3_2
[0m12:56:03.470658 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_2"
[0m12:56:03.471957 [debug] [Thread-1 (]: Began executing node model.transform.3_2
[0m12:56:03.473823 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_2"
[0m12:56:03.475050 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:56:03.475249 [debug] [Thread-1 (]: On model.transform.3_2: BEGIN
[0m12:56:03.475546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:03.486662 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:56:03.486901 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:56:03.487317 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */

  
  create view "dev"."main"."3_2__dbt_tmp" as (
    -- Récupérer les régions distinctes dans un set Jinja


SELECT 
    Date,
    
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bourgogne-Franche-Comté' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Bourgogne-Franche-Comté"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Centre-Val de Loire' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Centre-Val de Loire"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Nouvelle-Aquitaine' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Nouvelle-Aquitaine"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Occitanie' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Occitanie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Île-de-France' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Île-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Normandie' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Normandie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Grand Est' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Grand Est"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Provence-Alpes-Côte d''Azur' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Provence-Alpes-Côte d''Azur"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bretagne' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Bretagne"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Hauts-de-France' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Hauts-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Auvergne-Rhône-Alpes' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Auvergne-Rhône-Alpes"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Pays de la Loire' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Pays de la Loire"
        
    
    
FROM 
    "dev"."main"."clean"
GROUP BY 
    Date
ORDER BY 
    Date
  );

[0m12:56:03.488378 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:56:03.489984 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:56:03.490208 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
alter view "dev"."main"."3_2" rename to "3_2__dbt_backup"
[0m12:56:03.490757 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:56:03.492164 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:56:03.492366 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
alter view "dev"."main"."3_2__dbt_tmp" rename to "3_2"
[0m12:56:03.492832 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:56:03.493634 [debug] [Thread-1 (]: On model.transform.3_2: COMMIT
[0m12:56:03.493844 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:56:03.494140 [debug] [Thread-1 (]: On model.transform.3_2: COMMIT
[0m12:56:03.496212 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:56:03.497398 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m12:56:03.497598 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
drop view if exists "dev"."main"."3_2__dbt_backup" cascade
[0m12:56:03.498456 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:56:03.499110 [debug] [Thread-1 (]: On model.transform.3_2: Close
[0m12:56:03.511806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76823b71-1c83-4b4d-a4e8-dd2ac7a082fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7671411e7430>]}
[0m12:56:03.512207 [info ] [Thread-1 (]: 6 of 7 OK created sql view model main.3_2 ...................................... [[32mOK[0m in 0.04s]
[0m12:56:03.512519 [debug] [Thread-1 (]: Finished running node model.transform.3_2
[0m12:56:03.512774 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m12:56:03.513112 [info ] [Thread-1 (]: 7 of 7 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m12:56:03.513396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_2, now model.transform.my_second_dbt_model)
[0m12:56:03.513668 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m12:56:03.515898 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m12:56:03.517021 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m12:56:03.518893 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m12:56:03.520003 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:56:03.520197 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m12:56:03.520574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:03.531412 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:56:03.531640 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:56:03.532102 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m12:56:03.532604 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:56:03.534194 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:56:03.534404 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m12:56:03.534860 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:56:03.536288 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:56:03.536494 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m12:56:03.536993 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:56:03.537779 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:56:03.537977 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:56:03.538278 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m12:56:03.539657 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:56:03.540890 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m12:56:03.541094 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m12:56:03.541866 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:56:03.542507 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m12:56:03.555177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76823b71-1c83-4b4d-a4e8-dd2ac7a082fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76714a9e8a90>]}
[0m12:56:03.555547 [info ] [Thread-1 (]: 7 of 7 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m12:56:03.555858 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m12:56:03.556712 [debug] [MainThread]: Using duckdb connection "master"
[0m12:56:03.556915 [debug] [MainThread]: On master: BEGIN
[0m12:56:03.557220 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:56:03.568270 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m12:56:03.568472 [debug] [MainThread]: On master: COMMIT
[0m12:56:03.568825 [debug] [MainThread]: Using duckdb connection "master"
[0m12:56:03.569073 [debug] [MainThread]: On master: COMMIT
[0m12:56:03.569388 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:56:03.569623 [debug] [MainThread]: On master: Close
[0m12:56:03.570945 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:03.571141 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m12:56:03.571440 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m12:56:03.571818 [info ] [MainThread]: 
[0m12:56:03.572012 [info ] [MainThread]: Finished running 6 view models, 1 table model in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m12:56:03.572745 [debug] [MainThread]: Command end result
[0m12:56:03.596433 [info ] [MainThread]: 
[0m12:56:03.596677 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:56:03.597199 [info ] [MainThread]: 
[0m12:56:03.597533 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:56:03.598069 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4413093, "process_in_blocks": "13440", "process_kernel_time": 0.179326, "process_mem_max_rss": "138924", "process_out_blocks": "12304", "process_user_time": 1.55011}
[0m12:56:03.598345 [debug] [MainThread]: Command `dbt run` succeeded at 12:56:03.598292 after 1.44 seconds
[0m12:56:03.598553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76714bcf7b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7671411e50f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7671411e6c50>]}
[0m12:56:03.598797 [debug] [MainThread]: Flushing usage events
[0m13:00:13.955693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aef75f7bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aef79ca410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aef79ca470>]}


============================== 13:00:13.958295 | f448c611-d713-4852-9027-d95b22ff457b ==============================
[0m13:00:13.958295 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:00:13.958915 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/ETUDIANT/e24a518u/.dbt', 'log_path': '/home/ETUDIANT/e24a518u/Bureau/tp sql/transform/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:00:14.102182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f448c611-d713-4852-9027-d95b22ff457b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aef705a260>]}
[0m13:00:14.130329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f448c611-d713-4852-9027-d95b22ff457b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aef5e27c10>]}
[0m13:00:14.133593 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m13:00:14.175981 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:00:14.297167 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:00:14.297405 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:00:14.301342 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform.nettoyage
[0m13:00:14.319579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f448c611-d713-4852-9027-d95b22ff457b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aeefdddcf0>]}
[0m13:00:14.391090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f448c611-d713-4852-9027-d95b22ff457b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aeefd69ff0>]}
[0m13:00:14.391466 [info ] [MainThread]: Found 7 models, 4 data tests, 421 macros
[0m13:00:14.391933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f448c611-d713-4852-9027-d95b22ff457b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aeefd6bd30>]}
[0m13:00:14.393308 [info ] [MainThread]: 
[0m13:00:14.393719 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:00:14.397170 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:00:14.691117 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:00:14.691393 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:00:14.691807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:14.704301 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m13:00:14.705057 [debug] [ThreadPool]: On list_dev: Close
[0m13:00:14.707149 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:00:14.707447 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:00:14.710948 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:00:14.711153 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m13:00:14.711416 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:00:14.721504 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m13:00:14.722164 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:00:14.722344 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:00:14.722763 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:00:14.722923 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:00:14.723196 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m13:00:14.723602 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:00:14.724028 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:00:14.724192 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:00:14.724458 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:00:14.724851 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:00:14.725007 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:00:14.726714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:00:14.730866 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:00:14.731170 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:00:14.731493 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:00:14.742366 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m13:00:14.742590 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:00:14.742853 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:00:14.755938 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m13:00:14.756698 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:00:14.757243 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:00:14.757417 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:00:14.759379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f448c611-d713-4852-9027-d95b22ff457b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aeef3114b0>]}
[0m13:00:14.759743 [debug] [MainThread]: Using duckdb connection "master"
[0m13:00:14.759940 [debug] [MainThread]: On master: BEGIN
[0m13:00:14.760179 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:00:14.770547 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m13:00:14.770791 [debug] [MainThread]: On master: COMMIT
[0m13:00:14.771104 [debug] [MainThread]: Using duckdb connection "master"
[0m13:00:14.771343 [debug] [MainThread]: On master: COMMIT
[0m13:00:14.771682 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:00:14.771872 [debug] [MainThread]: On master: Close
[0m13:00:14.773063 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:00:14.773297 [info ] [MainThread]: 
[0m13:00:14.774656 [debug] [Thread-1 (]: Began running node model.transform.3_1
[0m13:00:14.775191 [info ] [Thread-1 (]: 1 of 7 START sql view model main.3_1 ........................................... [RUN]
[0m13:00:14.775698 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.transform.3_1'
[0m13:00:14.776050 [debug] [Thread-1 (]: Began compiling node model.transform.3_1
[0m13:00:14.779991 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_1"
[0m13:00:14.781408 [debug] [Thread-1 (]: Began executing node model.transform.3_1
[0m13:00:14.797724 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_1"
[0m13:00:14.799388 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m13:00:14.799618 [debug] [Thread-1 (]: On model.transform.3_1: BEGIN
[0m13:00:14.799878 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:00:14.810483 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m13:00:14.810714 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m13:00:14.811074 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */

  
  create view "dev"."main"."3_1__dbt_tmp" as (
    SELECT 
    strftime('%Y-%m', Date) AS mois,  -- Utilisation de strftime pour extraire l'année et le mois
    "Région", 
    SUM(COALESCE(TRY_CAST("consommation" AS INT), 0))/2000 AS consommation_totale_en_GWH,
    SUM(COALESCE(production_totale, 0))/2000 AS production_totale_en_GWH,

    MIN(COALESCE(TRY_CAST("consommation" AS INT), 0)) AS min_consommation_totale,
    MIN(COALESCE(production_totale, 0)) AS min_production_totale,

    MAX(COALESCE(TRY_CAST("consommation" AS INT), 0)) AS max_consommation_totale,
    MAX(COALESCE(production_totale, 0)) AS max_production_totale,
    
    AVG(COALESCE(TRY_CAST("consommation" AS INT), 0)) AS moyenne_consommation_totale,

    AVG(COALESCE(production_totale, 0)) AS moyenne_production_totale
FROM clean
GROUP BY strftime('%Y-%m', Date), "Région"  -- Remplacer TO_CHAR par strftime
ORDER BY mois, "Région"  -- Tri par mois et région
  );

[0m13:00:14.812033 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:00:14.815312 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m13:00:14.815533 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1" rename to "3_1__dbt_backup"
[0m13:00:14.816015 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:00:14.817465 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m13:00:14.817664 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
alter view "dev"."main"."3_1__dbt_tmp" rename to "3_1"
[0m13:00:14.818132 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:00:14.826151 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m13:00:14.826378 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m13:00:14.826673 [debug] [Thread-1 (]: On model.transform.3_1: COMMIT
[0m13:00:14.828131 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:00:14.830564 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_1"
[0m13:00:14.830786 [debug] [Thread-1 (]: On model.transform.3_1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_1"} */
drop view if exists "dev"."main"."3_1__dbt_backup" cascade
[0m13:00:14.831586 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:00:14.832946 [debug] [Thread-1 (]: On model.transform.3_1: Close
[0m13:00:14.845667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f448c611-d713-4852-9027-d95b22ff457b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aeef3114b0>]}
[0m13:00:14.846052 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.3_1 ...................................... [[32mOK[0m in 0.07s]
[0m13:00:14.846358 [debug] [Thread-1 (]: Finished running node model.transform.3_1
[0m13:00:14.846574 [debug] [Thread-1 (]: Began running node model.transform.3_3
[0m13:00:14.846902 [info ] [Thread-1 (]: 2 of 7 START sql view model main.3_3 ........................................... [RUN]
[0m13:00:14.847138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_1, now model.transform.3_3)
[0m13:00:14.847365 [debug] [Thread-1 (]: Began compiling node model.transform.3_3
[0m13:00:14.848405 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_3"
[0m13:00:14.849464 [debug] [Thread-1 (]: Began executing node model.transform.3_3
[0m13:00:14.851296 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_3"
[0m13:00:14.852298 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_3"
[0m13:00:14.852495 [debug] [Thread-1 (]: On model.transform.3_3: BEGIN
[0m13:00:14.852753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:00:14.864278 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m13:00:14.864693 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_3"
[0m13:00:14.865061 [debug] [Thread-1 (]: On model.transform.3_3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_3"} */

  
  create view "dev"."main"."3_3__dbt_tmp" as (
    WITH data_with_consumption AS (
    SELECT 
        "Code INSEE région",
        "Région", 
        "Date", 
        consommation,  -- Consommation en MW
        -- Calcul de la consommation cumulée en GWh pour chaque jour du mois écoulé
        SUM(COALESCE(consommation, 0)) OVER (
            PARTITION BY "Région", EXTRACT(YEAR FROM "Date"), EXTRACT(MONTH FROM "Date")
            ORDER BY "Date"
            RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
        ) / 2000 AS consommation_gwh  -- Conversion de la consommation en GWh
    FROM clean
)

SELECT 
    "Code INSEE région", 
    "Région", 
    "Date", 
    consommation, 
    consommation_gwh
FROM data_with_consumption
ORDER BY "Région", "Date"
  );

[0m13:00:14.866372 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:00:14.869189 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_3"
[0m13:00:14.869436 [debug] [Thread-1 (]: On model.transform.3_3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_3"} */
alter view "dev"."main"."3_3" rename to "3_3__dbt_backup"
[0m13:00:14.869862 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:00:14.871367 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_3"
[0m13:00:14.871568 [debug] [Thread-1 (]: On model.transform.3_3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_3"} */
alter view "dev"."main"."3_3__dbt_tmp" rename to "3_3"
[0m13:00:14.871986 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:00:14.872829 [debug] [Thread-1 (]: On model.transform.3_3: COMMIT
[0m13:00:14.873023 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_3"
[0m13:00:14.873253 [debug] [Thread-1 (]: On model.transform.3_3: COMMIT
[0m13:00:14.874586 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:00:14.875697 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_3"
[0m13:00:14.875882 [debug] [Thread-1 (]: On model.transform.3_3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_3"} */
drop view if exists "dev"."main"."3_3__dbt_backup" cascade
[0m13:00:14.876527 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:00:14.877151 [debug] [Thread-1 (]: On model.transform.3_3: Close
[0m13:00:14.888788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f448c611-d713-4852-9027-d95b22ff457b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aeec185c60>]}
[0m13:00:14.889144 [info ] [Thread-1 (]: 2 of 7 OK created sql view model main.3_3 ...................................... [[32mOK[0m in 0.04s]
[0m13:00:14.889443 [debug] [Thread-1 (]: Finished running node model.transform.3_3
[0m13:00:14.889658 [debug] [Thread-1 (]: Began running node model.transform.clean
[0m13:00:14.889936 [info ] [Thread-1 (]: 3 of 7 START sql view model main.clean ......................................... [RUN]
[0m13:00:14.890163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_3, now model.transform.clean)
[0m13:00:14.890388 [debug] [Thread-1 (]: Began compiling node model.transform.clean
[0m13:00:14.891403 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.clean"
[0m13:00:14.892321 [debug] [Thread-1 (]: Began executing node model.transform.clean
[0m13:00:14.894069 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.clean"
[0m13:00:14.894964 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m13:00:14.895159 [debug] [Thread-1 (]: On model.transform.clean: BEGIN
[0m13:00:14.895419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:00:14.905808 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m13:00:14.906041 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m13:00:14.906373 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */

  
  create view "dev"."main"."clean__dbt_tmp" as (
    WITH data_clean AS (
    SELECT 
        *,
        COALESCE(TRY_CAST("Consommation (MW)" AS INT), 0) AS consommation,
        COALESCE(TRY_CAST("Eolien (MW)" AS INT), 0) AS eolien,
        COALESCE(TRY_CAST("Thermique (MW)" AS INT), 0) AS thermique,
        COALESCE(TRY_CAST("Bioénergies (MW)" AS INT), 0) AS bioenergies,
        COALESCE(TRY_CAST("Nucléaire (MW)" AS INT), 0) AS nucleaire,
        COALESCE(TRY_CAST("Solaire (MW)" AS INT), 0) AS solaire,
        COALESCE(TRY_CAST("Hydraulique (MW)" AS INT), 0) AS hydraulique,
        COALESCE(TRY_CAST("Pompage (MW)" AS INT), 0) AS pompage,
        COALESCE(TRY_CAST("Ech. physiques (MW)" AS INT), 0) AS ech_physiques
    FROM eco2
    WHERE "Région" IS NOT NULL AND "Date" IS NOT NULL
),
data_final AS (
    SELECT 
        "Code INSEE région",
        "Région", 
        "Date", 
        "Heure",
        consommation,
        eolien,
        thermique,
        bioenergies,
        nucleaire,
        solaire,
        hydraulique,
        pompage,
        ech_physiques,
        COALESCE(nucleaire, 0) + 
        COALESCE(eolien, 0) +
        COALESCE(solaire, 0) +
        COALESCE(hydraulique, 0) +
        COALESCE(thermique, 0) AS production_totale
    FROM data_clean
)

SELECT * FROM data_final
  );

[0m13:00:14.907102 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:00:14.908608 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m13:00:14.908816 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean" rename to "clean__dbt_backup"
[0m13:00:14.909232 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:00:14.910714 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m13:00:14.910925 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
alter view "dev"."main"."clean__dbt_tmp" rename to "clean"
[0m13:00:14.911267 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:00:14.912073 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m13:00:14.912261 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m13:00:14.912506 [debug] [Thread-1 (]: On model.transform.clean: COMMIT
[0m13:00:14.913827 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:00:14.914953 [debug] [Thread-1 (]: Using duckdb connection "model.transform.clean"
[0m13:00:14.915151 [debug] [Thread-1 (]: On model.transform.clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.clean"} */
drop view if exists "dev"."main"."clean__dbt_backup" cascade
[0m13:00:14.915721 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:00:14.916911 [debug] [Thread-1 (]: On model.transform.clean: Close
[0m13:00:14.928502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f448c611-d713-4852-9027-d95b22ff457b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aeec1d83d0>]}
[0m13:00:14.928895 [info ] [Thread-1 (]: 3 of 7 OK created sql view model main.clean .................................... [[32mOK[0m in 0.04s]
[0m13:00:14.929212 [debug] [Thread-1 (]: Finished running node model.transform.clean
[0m13:00:14.929435 [debug] [Thread-1 (]: Began running node model.transform.grain_jour
[0m13:00:14.929782 [info ] [Thread-1 (]: 4 of 7 START sql view model main.grain_jour .................................... [RUN]
[0m13:00:14.930032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.clean, now model.transform.grain_jour)
[0m13:00:14.930265 [debug] [Thread-1 (]: Began compiling node model.transform.grain_jour
[0m13:00:14.956356 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.grain_jour"
[0m13:00:14.957580 [debug] [Thread-1 (]: Began executing node model.transform.grain_jour
[0m13:00:14.959441 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.grain_jour"
[0m13:00:14.960439 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m13:00:14.960669 [debug] [Thread-1 (]: On model.transform.grain_jour: BEGIN
[0m13:00:14.960869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:00:14.970995 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m13:00:14.971304 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m13:00:14.971577 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */

  
  create view "dev"."main"."grain_jour__dbt_tmp" as (
    WITH data_clean AS (
    SELECT *
    from clean
          
)
SELECT 
    "Date", 
    "Région", 
    SUM(COALESCE(TRY_CAST("consommation" AS INT), 0)) AS consommation_totale,
    SUM(COALESCE(TRY_CAST("thermique" AS INT), 0)) AS thermique_total,
    SUM(COALESCE(TRY_CAST("bioenergies" AS INT), 0)) AS bioenergies_total,
    SUM(COALESCE(TRY_CAST("eolien" AS INT), 0)) AS eolien_total,
    SUM(COALESCE(TRY_CAST("nucleaire" AS INT), 0)) AS nucleaire_total,
    SUM(COALESCE(TRY_CAST("solaire" AS INT), 0)) AS solaire_total,
    SUM(COALESCE(TRY_CAST("hydraulique" AS INT), 0)) AS hydraulique_total,
    SUM(COALESCE(TRY_CAST("pompage" AS INT), 0)) AS pompage_total,
    SUM(COALESCE(TRY_CAST("ech_physiques" AS INT), 0)) AS ech_physiques_total,
    SUM(COALESCE(TRY_CAST("production_totale" AS INT), 0)) AS production_totale
   
FROM data_clean
GROUP BY "Date", "Région"
ORDER BY "Date", "Région"
  );

[0m13:00:14.972485 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:00:14.974321 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m13:00:14.974540 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour" rename to "grain_jour__dbt_backup"
[0m13:00:14.975023 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:00:14.976545 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m13:00:14.976748 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
alter view "dev"."main"."grain_jour__dbt_tmp" rename to "grain_jour"
[0m13:00:14.977181 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:00:14.977991 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m13:00:14.978190 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m13:00:14.978440 [debug] [Thread-1 (]: On model.transform.grain_jour: COMMIT
[0m13:00:14.979799 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:00:14.980951 [debug] [Thread-1 (]: Using duckdb connection "model.transform.grain_jour"
[0m13:00:14.981155 [debug] [Thread-1 (]: On model.transform.grain_jour: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.grain_jour"} */
drop view if exists "dev"."main"."grain_jour__dbt_backup" cascade
[0m13:00:14.981829 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:00:14.982487 [debug] [Thread-1 (]: On model.transform.grain_jour: Close
[0m13:00:14.995273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f448c611-d713-4852-9027-d95b22ff457b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aeec1c8790>]}
[0m13:00:14.996035 [info ] [Thread-1 (]: 4 of 7 OK created sql view model main.grain_jour ............................... [[32mOK[0m in 0.07s]
[0m13:00:14.996631 [debug] [Thread-1 (]: Finished running node model.transform.grain_jour
[0m13:00:14.997055 [debug] [Thread-1 (]: Began running node model.transform.my_first_dbt_model
[0m13:00:14.997541 [info ] [Thread-1 (]: 5 of 7 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m13:00:14.997961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.grain_jour, now model.transform.my_first_dbt_model)
[0m13:00:14.998302 [debug] [Thread-1 (]: Began compiling node model.transform.my_first_dbt_model
[0m13:00:15.000706 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_first_dbt_model"
[0m13:00:15.001737 [debug] [Thread-1 (]: Began executing node model.transform.my_first_dbt_model
[0m13:00:15.014093 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_first_dbt_model"
[0m13:00:15.015022 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m13:00:15.015229 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: BEGIN
[0m13:00:15.015435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:00:15.026441 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m13:00:15.026780 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m13:00:15.027074 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m13:00:15.027771 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:00:15.029489 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m13:00:15.029714 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m13:00:15.030260 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:00:15.031847 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m13:00:15.032059 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m13:00:15.032476 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:00:15.035271 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m13:00:15.035495 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m13:00:15.035742 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: COMMIT
[0m13:00:15.037072 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:00:15.038308 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_first_dbt_model"
[0m13:00:15.038516 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m13:00:15.039126 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:00:15.039890 [debug] [Thread-1 (]: On model.transform.my_first_dbt_model: Close
[0m13:00:15.054578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f448c611-d713-4852-9027-d95b22ff457b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aef5fe0d60>]}
[0m13:00:15.055046 [info ] [Thread-1 (]: 5 of 7 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m13:00:15.055387 [debug] [Thread-1 (]: Finished running node model.transform.my_first_dbt_model
[0m13:00:15.055628 [debug] [Thread-1 (]: Began running node model.transform.3_2
[0m13:00:15.056014 [info ] [Thread-1 (]: 6 of 7 START sql view model main.3_2 ........................................... [RUN]
[0m13:00:15.056277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.my_first_dbt_model, now model.transform.3_2)
[0m13:00:15.056474 [debug] [Thread-1 (]: Began compiling node model.transform.3_2
[0m13:00:15.058909 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.3_2"
[0m13:00:15.059855 [debug] [Thread-1 (]: Began executing node model.transform.3_2
[0m13:00:15.061788 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.3_2"
[0m13:00:15.062896 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m13:00:15.063106 [debug] [Thread-1 (]: On model.transform.3_2: BEGIN
[0m13:00:15.063323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:00:15.073523 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m13:00:15.073808 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m13:00:15.074179 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */

  
  create view "dev"."main"."3_2__dbt_tmp" as (
    -- Récupérer les régions distinctes dans un set Jinja


SELECT 
    Date,
    
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bourgogne-Franche-Comté' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Bourgogne-Franche-Comté"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Centre-Val de Loire' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Centre-Val de Loire"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Nouvelle-Aquitaine' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Nouvelle-Aquitaine"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Occitanie' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Occitanie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Île-de-France' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Île-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Normandie' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Normandie"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Grand Est' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Grand Est"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Provence-Alpes-Côte d''Azur' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Provence-Alpes-Côte d''Azur"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Bretagne' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Bretagne"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Hauts-de-France' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Hauts-de-France"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Auvergne-Rhône-Alpes' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Auvergne-Rhône-Alpes"
        , 
    
        -- On s'assure que les noms de régions contenant des caractères spéciaux sont correctement échappés
        SUM(CASE WHEN "Région" = 'Pays de la Loire' THEN COALESCE(CAST("consommation" AS INT), 0) / 2000 ELSE 0 END) AS "Pays de la Loire"
        
    
    
FROM 
    "dev"."main"."clean"
GROUP BY 
    Date
ORDER BY 
    Date
  );

[0m13:00:15.075277 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:00:15.076984 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m13:00:15.077194 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
alter view "dev"."main"."3_2" rename to "3_2__dbt_backup"
[0m13:00:15.077676 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:00:15.079111 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m13:00:15.079312 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
alter view "dev"."main"."3_2__dbt_tmp" rename to "3_2"
[0m13:00:15.079699 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:00:15.080511 [debug] [Thread-1 (]: On model.transform.3_2: COMMIT
[0m13:00:15.080707 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m13:00:15.080956 [debug] [Thread-1 (]: On model.transform.3_2: COMMIT
[0m13:00:15.082619 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:00:15.084489 [debug] [Thread-1 (]: Using duckdb connection "model.transform.3_2"
[0m13:00:15.084694 [debug] [Thread-1 (]: On model.transform.3_2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.3_2"} */
drop view if exists "dev"."main"."3_2__dbt_backup" cascade
[0m13:00:15.085293 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:00:15.085951 [debug] [Thread-1 (]: On model.transform.3_2: Close
[0m13:00:15.098247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f448c611-d713-4852-9027-d95b22ff457b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aeec1cf2e0>]}
[0m13:00:15.099034 [info ] [Thread-1 (]: 6 of 7 OK created sql view model main.3_2 ...................................... [[32mOK[0m in 0.04s]
[0m13:00:15.099687 [debug] [Thread-1 (]: Finished running node model.transform.3_2
[0m13:00:15.100140 [debug] [Thread-1 (]: Began running node model.transform.my_second_dbt_model
[0m13:00:15.100625 [info ] [Thread-1 (]: 7 of 7 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m13:00:15.101071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transform.3_2, now model.transform.my_second_dbt_model)
[0m13:00:15.101532 [debug] [Thread-1 (]: Began compiling node model.transform.my_second_dbt_model
[0m13:00:15.103349 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.my_second_dbt_model"
[0m13:00:15.104296 [debug] [Thread-1 (]: Began executing node model.transform.my_second_dbt_model
[0m13:00:15.106259 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.my_second_dbt_model"
[0m13:00:15.107145 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m13:00:15.107343 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: BEGIN
[0m13:00:15.107618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:00:15.117755 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m13:00:15.118007 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m13:00:15.118271 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m13:00:15.118798 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:00:15.120506 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m13:00:15.120720 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m13:00:15.121204 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:00:15.122677 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m13:00:15.122903 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m13:00:15.123379 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:00:15.124237 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m13:00:15.124441 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m13:00:15.124696 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: COMMIT
[0m13:00:15.126032 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:00:15.128188 [debug] [Thread-1 (]: Using duckdb connection "model.transform.my_second_dbt_model"
[0m13:00:15.128545 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "transform", "target_name": "dev", "node_id": "model.transform.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m13:00:15.129244 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:00:15.129936 [debug] [Thread-1 (]: On model.transform.my_second_dbt_model: Close
[0m13:00:15.142023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f448c611-d713-4852-9027-d95b22ff457b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aeec14aad0>]}
[0m13:00:15.142464 [info ] [Thread-1 (]: 7 of 7 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m13:00:15.142789 [debug] [Thread-1 (]: Finished running node model.transform.my_second_dbt_model
[0m13:00:15.143614 [debug] [MainThread]: Using duckdb connection "master"
[0m13:00:15.143916 [debug] [MainThread]: On master: BEGIN
[0m13:00:15.144206 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:00:15.156765 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m13:00:15.157190 [debug] [MainThread]: On master: COMMIT
[0m13:00:15.157531 [debug] [MainThread]: Using duckdb connection "master"
[0m13:00:15.157851 [debug] [MainThread]: On master: COMMIT
[0m13:00:15.158292 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:00:15.158618 [debug] [MainThread]: On master: Close
[0m13:00:15.159881 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:00:15.160105 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m13:00:15.160374 [debug] [MainThread]: Connection 'model.transform.my_second_dbt_model' was properly closed.
[0m13:00:15.160719 [info ] [MainThread]: 
[0m13:00:15.160975 [info ] [MainThread]: Finished running 6 view models, 1 table model in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m13:00:15.161706 [debug] [MainThread]: Command end result
[0m13:00:15.183020 [info ] [MainThread]: 
[0m13:00:15.183351 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:00:15.183601 [info ] [MainThread]: 
[0m13:00:15.183829 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m13:00:15.184285 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2568157, "process_in_blocks": "13440", "process_kernel_time": 0.176561, "process_mem_max_rss": "138888", "process_out_blocks": "12336", "process_user_time": 1.49633}
[0m13:00:15.184630 [debug] [MainThread]: Command `dbt run` succeeded at 13:00:15.184574 after 1.26 seconds
[0m13:00:15.184849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aef75f7bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aef1baefe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aef1bae1a0>]}
[0m13:00:15.185110 [debug] [MainThread]: Flushing usage events
